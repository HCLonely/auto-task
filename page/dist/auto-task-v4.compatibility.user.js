/*! For license information please see auto-task-v4.compatibility.user.js.LICENSE.txt */
// ==UserScript==
// @name               auto-task-v4.compatibility
// @namespace          auto-task-v4.compatibility
// @version            4.7.4
// @description        自动完成 Freeanywhere，Giveawaysu，GiveeClub，Givekey，Gleam，Indiedb，keyhub，OpiumPulses，Opquests，SweepWidget 等网站的任务。
// @description:en     Automatically complete the tasks of FreeAnyWhere, GiveawaySu, GiveeClub, Givekey, Gleam, Indiedb, keyhub, OpiumPulses, Opquests, SweepWidget websites.
// @author             HCLonely
// @license            MIT
// @run-at             document-start
// @homepage           https://auto-task-doc.js.org/
// @supportURL         https://github.com/HCLonely/auto-task-v4/issues
// @updateURL          https://github.com/HCLonely/auto-task-new/raw/main/dist/auto-task-v4.compatibility.user.js
// @installURL         https://github.com/HCLonely/auto-task-new/raw/main/dist/auto-task-v4.compatibility.user.js
// @downloadURL        https://github.com/HCLonely/auto-task-new/raw/main/dist/auto-task-v4.compatibility.user.js
// @icon               https://auto-task-v4.hclonely.com/favicon.ico

// @include            *://freeanywhere.net/*
// @include            *://giveaway.su/giveaway/view/*
// @include            *://givee.club/*/event/*
// @include            *://givekey.ru/giveaway/*
// @include            *://www.indiedb.com/giveaways*
// @include            *://key-hub.eu/giveaway/*
// @include            *://keylol.com/*
// @include            *://www.opiumpulses.com/giveaways
// @include            *://prys.revadike.com/giveaway/?id=*
// @include            *://opquests.com/quests/*
// @include            *://gleam.io/*
// @include            *://sweepwidget.com/view/*
// @include            *://giveawayhopper.com/c/*

// @include            *://discord.com/*
// @include            *://www.twitch.tv/*
// @include            *://www.youtube.com/*
// @include            *://*.reddit.com/*
// @include            *://twitter.com/settings/account?k*
// @include            *://x.com/settings/account*
// @include            *://steamcommunity.com/*
// @include            *://store.steampowered.com/*
// @include            https://auto-task-v4.hclonely.com/setting.html
// @include            https://auto-task-v4.hclonely.com/history.html

// @grant              GM_setValue
// @grant              GM_getValue
// @grant              GM_listValues
// @grant              GM_deleteValue
// @grant              GM_addStyle
// @grant              GM_xmlhttpRequest
// @grant              GM_registerMenuCommand
// @grant              GM_info
// @grant              GM_openInTab
// @grant              GM_setClipboard
// @grant              GM_getResourceText
// @grant              GM_cookie
// @grant              GM_addValueChangeListener
// @grant              GM_removeValueChangeListener
// @grant              unsafeWindow
// @grant              window.close
// @grant              window.localStorage
// @grant              window.sessionStorage
// @grant              window.focus

// @connect            cdn.jsdelivr.net
// @connect            store.steampowered.com
// @connect            steamcommunity.com
// @connect            login.steampowered.com
// @connect            twitter.com
// @connect            x.com
// @connect            abs.twimg.com
// @connect            api.twitter.com
// @connect            youtube.com
// @connect            www.youtube.com
// @connect            facebook.com
// @connect            instagram.com
// @connect            vk.com
// @connect            twitch.tv
// @connect            www.twitch.tv
// @connect            gql.twitch.tv
// @connect            github.com
// @connect            discordapp.com
// @connect            discord.gg
// @connect            discord.com
// @connect            www.reddit.com
// @connect            oauth.reddit.com
// @connect            raw.githubusercontent.com
// @connect            t.me
// @connect            bit.ly
// @connect            giveaway.su
// @connect            google.com
// @connect            www.vloot.io
// @connect            givee.club
// @connect            gleam.io
// @connect            www.indiedb.com
// @connect            key-hub.eu
// @connect            opquests.com
// @connect            itch.io
// @connect            auto-task-v4.hclonely.com
// @connect            giveawayhopper.com
// @connect            *
// @require            https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js
// @require            https://cdn.jsdelivr.net/npm/js-cookie@3.0.1/dist/js.cookie.min.js
// @require            https://cdn.jsdelivr.net/npm/regenerator-runtime@0.13.5/runtime.min.js
// @require            https://cdn.jsdelivr.net/npm/js-sha1@0.6.0/src/sha1.min.js
// @require            https://cdn.jsdelivr.net/npm/js-sha256@0.11.0/src/sha256.min.js
// @require            https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.js
// @resource           style https://cdn.jsdelivr.net/npm/sweetalert2@11.3.5/dist/sweetalert2.min.css
// @require            https://cdn.jsdelivr.net/npm/keyboardjs@2.6.4/dist/keyboard.min.js
// @require            https://cdn.jsdelivr.net/npm/dayjs@1.10.7/dayjs.min.js
// @require            https://bundle.run/buffer@6.0.3

// @noframes
// ==/UserScript==

console.log('%c%s', 'color:blue', 'Auto-Task[Load]: 脚本开始加载');
(()=>{var __webpack_modules__={251:function(__unused_webpack_module,exports){exports.read=function(buffer,offset,isLE,mLen,nBytes){var e,m,eLen=8*nBytes-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,nBits=-7,i=isLE?nBytes-1:0,d=isLE?-1:1,nBytes=buffer[offset+i];for(i+=d,e=nBytes&(1<<-nBits)-1,nBytes>>=-nBits,nBits+=eLen;0<nBits;e=256*e+buffer[offset+i],i+=d,nBits-=8);for(m=e&(1<<-nBits)-1,e>>=-nBits,nBits+=mLen;0<nBits;m=256*m+buffer[offset+i],i+=d,nBits-=8);if(0===e)e=1-eBias;else{if(e===eMax)return m?NaN:1/0*(nBytes?-1:1);m+=Math.pow(2,mLen),e-=eBias}return(nBytes?-1:1)*m*Math.pow(2,e-mLen)},exports.write=function(buffer,value,offset,isLE,mLen,nBytes){var e,m,eLen=8*nBytes-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,rt=23===mLen?Math.pow(2,-24)-Math.pow(2,-77):0,i=isLE?0:nBytes-1,d=isLE?1:-1,nBytes=value<0||0===value&&1/value<0?1:0;for(value=Math.abs(value),isNaN(value)||value===1/0?(m=isNaN(value)?1:0,e=eMax):(e=Math.floor(Math.log(value)/Math.LN2),value*(isLE=Math.pow(2,-e))<1&&(e--,isLE*=2),2<=(value+=1<=e+eBias?rt/isLE:rt*Math.pow(2,1-eBias))*isLE&&(e++,isLE/=2),eMax<=e+eBias?(m=0,e=eMax):1<=e+eBias?(m=(value*isLE-1)*Math.pow(2,mLen),e+=eBias):(m=value*Math.pow(2,eBias-1)*Math.pow(2,mLen),e=0));8<=mLen;buffer[offset+i]=255&m,i+=d,m/=256,mLen-=8);for(e=e<<mLen|m,eLen+=mLen;0<eLen;buffer[offset+i]=255&e,i+=d,e/=256,eLen-=8);buffer[offset+i-d]|=128*nBytes}},287:function(__unused_webpack_module,exports,__webpack_require__){let base64=__webpack_require__(526),ieee754=__webpack_require__(251);__webpack_require__="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;exports.hp=Buffer,exports.IS=50;let K_MAX_LENGTH=2147483647;function createBuffer(length){if(length>K_MAX_LENGTH)throw new RangeError('The value "'+length+'" is invalid for option "size"');length=new Uint8Array(length);return Object.setPrototypeOf(length,Buffer.prototype),length}function Buffer(arg,encodingOrOffset,length){if("number"!=typeof arg)return from(arg,encodingOrOffset,length);if("string"==typeof encodingOrOffset)throw new TypeError('The "string" argument must be of type string. Received type number');return allocUnsafe(arg)}function from(value,encodingOrOffset,length){if("string"==typeof value)return((string,encoding)=>{if(!Buffer.isEncoding(encoding="string"==typeof encoding&&""!==encoding?encoding:"utf8"))throw new TypeError("Unknown encoding: "+encoding);let length=0|byteLength(string,encoding),buf=createBuffer(length),actual=buf.write(string,encoding);return buf=actual!==length?buf.slice(0,actual):buf})(value,encodingOrOffset);if(ArrayBuffer.isView(value))return isInstance(arrayView=value,Uint8Array)?fromArrayBuffer((copy=new Uint8Array(arrayView)).buffer,copy.byteOffset,copy.byteLength):fromArrayLike(arrayView);if(null!=value){if(isInstance(value,ArrayBuffer)||value&&isInstance(value.buffer,ArrayBuffer))return fromArrayBuffer(value,encodingOrOffset,length);if("undefined"!=typeof SharedArrayBuffer&&(isInstance(value,SharedArrayBuffer)||value&&isInstance(value.buffer,SharedArrayBuffer)))return fromArrayBuffer(value,encodingOrOffset,length);if("number"==typeof value)throw new TypeError('The "value" argument must not be of type number. Received type number');var copy=value.valueOf&&value.valueOf();if(null!=copy&&copy!==value)return Buffer.from(copy,encodingOrOffset,length);var arrayView=(obj=>{var len,buf;return Buffer.isBuffer(obj)?(len=0|checked(obj.length),0!==(buf=createBuffer(len)).length&&obj.copy(buf,0,0,len),buf):void 0!==obj.length?"number"!=typeof obj.length||numberIsNaN(obj.length)?createBuffer(0):fromArrayLike(obj):"Buffer"===obj.type&&Array.isArray(obj.data)?fromArrayLike(obj.data):void 0})(value);if(arrayView)return arrayView;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof value[Symbol.toPrimitive])return Buffer.from(value[Symbol.toPrimitive]("string"),encodingOrOffset,length)}throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof value)}function assertSize(size){if("number"!=typeof size)throw new TypeError('"size" argument must be of type number');if(size<0)throw new RangeError('The value "'+size+'" is invalid for option "size"')}function allocUnsafe(size){return assertSize(size),createBuffer(size<0?0:0|checked(size))}function fromArrayLike(array){var length=array.length<0?0:0|checked(array.length),buf=createBuffer(length);for(let i=0;i<length;i+=1)buf[i]=255&array[i];return buf}function fromArrayBuffer(array,byteOffset,length){if(byteOffset<0||array.byteLength<byteOffset)throw new RangeError('"offset" is outside of buffer bounds');if(array.byteLength<byteOffset+(length||0))throw new RangeError('"length" is outside of buffer bounds');let buf;return buf=void 0===byteOffset&&void 0===length?new Uint8Array(array):void 0===length?new Uint8Array(array,byteOffset):new Uint8Array(array,byteOffset,length),Object.setPrototypeOf(buf,Buffer.prototype),buf}function checked(length){if(length>=K_MAX_LENGTH)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+K_MAX_LENGTH.toString(16)+" bytes");return 0|length}function byteLength(string,encoding){if(Buffer.isBuffer(string))return string.length;if(ArrayBuffer.isView(string)||isInstance(string,ArrayBuffer))return string.byteLength;if("string"!=typeof string)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof string);var len=string.length,mustMatch=2<arguments.length&&!0===arguments[2];if(!mustMatch&&0===len)return 0;let loweredCase=!1;for(;;)switch(encoding){case"ascii":case"latin1":case"binary":return len;case"utf8":case"utf-8":return utf8ToBytes(string).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*len;case"hex":return len>>>1;case"base64":return base64ToBytes(string).length;default:if(loweredCase)return mustMatch?-1:utf8ToBytes(string).length;encoding=(""+encoding).toLowerCase(),loweredCase=!0}}function slowToString(encoding,start,end){let loweredCase=!1;if((start=void 0===start||start<0?0:start)>this.length)return"";if((end=void 0===end||end>this.length?this.length:end)<=0)return"";if((end>>>=0)<=(start>>>=0))return"";for(encoding=encoding||"utf8";;)switch(encoding){case"hex":return((buf,start,end)=>{var len=buf.length;(!end||end<0||len<end)&&(end=len);let out="";for(let i=start=!start||start<0?0:start;i<end;++i)out+=hexSliceLookupTable[buf[i]];return out})(this,start,end);case"utf8":case"utf-8":return utf8Slice(this,start,end);case"ascii":return((buf,start,end)=>{let ret="";end=Math.min(buf.length,end);for(let i=start;i<end;++i)ret+=String.fromCharCode(127&buf[i]);return ret})(this,start,end);case"latin1":case"binary":return((buf,start,end)=>{let ret="";end=Math.min(buf.length,end);for(let i=start;i<end;++i)ret+=String.fromCharCode(buf[i]);return ret})(this,start,end);case"base64":return((buf,start,end)=>0===start&&end===buf.length?base64.fromByteArray(buf):base64.fromByteArray(buf.slice(start,end)))(this,start,end);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return((buf,start,end)=>{let bytes=buf.slice(start,end),res="";for(let i=0;i<bytes.length-1;i+=2)res+=String.fromCharCode(bytes[i]+256*bytes[i+1]);return res})(this,start,end);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(encoding+"").toLowerCase(),loweredCase=!0}}function swap(b,n,m){var i=b[n];b[n]=b[m],b[m]=i}function bidirectionalIndexOf(buffer,val,byteOffset,encoding,dir){if(0===buffer.length)return-1;if("string"==typeof byteOffset?(encoding=byteOffset,byteOffset=0):2147483647<byteOffset?byteOffset=2147483647:byteOffset<-2147483648&&(byteOffset=-2147483648),(byteOffset=numberIsNaN(byteOffset=+byteOffset)?dir?0:buffer.length-1:byteOffset)<0&&(byteOffset=buffer.length+byteOffset),buffer.length<=byteOffset){if(dir)return-1;byteOffset=buffer.length-1}else if(byteOffset<0){if(!dir)return-1;byteOffset=0}if("string"==typeof val&&(val=Buffer.from(val,encoding)),Buffer.isBuffer(val))return 0===val.length?-1:arrayIndexOf(buffer,val,byteOffset,encoding,dir);if("number"==typeof val)return val&=255,"function"==typeof Uint8Array.prototype.indexOf?(dir?Uint8Array.prototype.indexOf:Uint8Array.prototype.lastIndexOf).call(buffer,val,byteOffset):arrayIndexOf(buffer,[val],byteOffset,encoding,dir);throw new TypeError("val must be string, number or Buffer")}function arrayIndexOf(arr,val,byteOffset,encoding,dir){let indexSize=1,arrLength=arr.length,valLength=val.length;if(void 0!==encoding&&("ucs2"===(encoding=String(encoding).toLowerCase())||"ucs-2"===encoding||"utf16le"===encoding||"utf-16le"===encoding)){if(arr.length<2||val.length<2)return-1;indexSize=2,arrLength/=2,valLength/=2,byteOffset/=2}function read(buf,i){return 1===indexSize?buf[i]:buf.readUInt16BE(i*indexSize)}let i;if(dir){let foundIndex=-1;for(i=byteOffset;i<arrLength;i++)if(read(arr,i)===read(val,-1===foundIndex?0:i-foundIndex)){if(-1===foundIndex&&(foundIndex=i),i-foundIndex+1===valLength)return foundIndex*indexSize}else-1!==foundIndex&&(i-=i-foundIndex),foundIndex=-1}else for(byteOffset+valLength>arrLength&&(byteOffset=arrLength-valLength),i=byteOffset;0<=i;i--){let found=!0;for(let j=0;j<valLength;j++)if(read(arr,i+j)!==read(val,j)){found=!1;break}if(found)return i}return-1}function asciiWrite(buf,string,offset,length){return blitBuffer((str=>{var byteArray=[];for(let i=0;i<str.length;++i)byteArray.push(255&str.charCodeAt(i));return byteArray})(string),buf,offset,length)}function ucs2Write(buf,string,offset,length){return blitBuffer(((str,units)=>{let c,hi,byteArray=[];for(let i=0;i<str.length&&!((units-=2)<0);++i)c=str.charCodeAt(i),hi=c>>8,byteArray.push(c%256),byteArray.push(hi);return byteArray})(string,buf.length-offset),buf,offset,length)}function utf8Slice(buf,start,end){end=Math.min(buf.length,end);var res=[];let i=start;for(;i<end;){var firstByte=buf[i];let codePoint=null,bytesPerSequence=239<firstByte?4:223<firstByte?3:191<firstByte?2:1;if(i+bytesPerSequence<=end){let secondByte,thirdByte,fourthByte,tempCodePoint;switch(bytesPerSequence){case 1:firstByte<128&&(codePoint=firstByte);break;case 2:128==(192&(secondByte=buf[i+1]))&&127<(tempCodePoint=(31&firstByte)<<6|63&secondByte)&&(codePoint=tempCodePoint);break;case 3:secondByte=buf[i+1],thirdByte=buf[i+2],128==(192&secondByte)&&128==(192&thirdByte)&&2047<(tempCodePoint=(15&firstByte)<<12|(63&secondByte)<<6|63&thirdByte)&&(tempCodePoint<55296||57343<tempCodePoint)&&(codePoint=tempCodePoint);break;case 4:secondByte=buf[i+1],thirdByte=buf[i+2],fourthByte=buf[i+3],128==(192&secondByte)&&128==(192&thirdByte)&&128==(192&fourthByte)&&65535<(tempCodePoint=(15&firstByte)<<18|(63&secondByte)<<12|(63&thirdByte)<<6|63&fourthByte)&&tempCodePoint<1114112&&(codePoint=tempCodePoint)}}null===codePoint?(codePoint=65533,bytesPerSequence=1):65535<codePoint&&(codePoint-=65536,res.push(codePoint>>>10&1023|55296),codePoint=56320|1023&codePoint),res.push(codePoint),i+=bytesPerSequence}return(codePoints=>{var len=codePoints.length;if(len<=MAX_ARGUMENTS_LENGTH)return String.fromCharCode.apply(String,codePoints);let res="",i=0;for(;i<len;)res+=String.fromCharCode.apply(String,codePoints.slice(i,i+=MAX_ARGUMENTS_LENGTH));return res})(res)}K_MAX_LENGTH,(Buffer.TYPED_ARRAY_SUPPORT=(()=>{try{var arr=new Uint8Array(1),proto={foo:function(){return 42}};return Object.setPrototypeOf(proto,Uint8Array.prototype),Object.setPrototypeOf(arr,proto),42===arr.foo()}catch(e){return!1}})())||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(Buffer.prototype,"parent",{enumerable:!0,get:function(){if(Buffer.isBuffer(this))return this.buffer}}),Object.defineProperty(Buffer.prototype,"offset",{enumerable:!0,get:function(){if(Buffer.isBuffer(this))return this.byteOffset}}),Buffer.poolSize=8192,Buffer.from=from,Object.setPrototypeOf(Buffer.prototype,Uint8Array.prototype),Object.setPrototypeOf(Buffer,Uint8Array),Buffer.alloc=function(size,fill,encoding){return((size,fill,encoding)=>(assertSize(size),!(size<=0)&&void 0!==fill?"string"==typeof encoding?createBuffer(size).fill(fill,encoding):createBuffer(size).fill(fill):createBuffer(size)))(size,fill,encoding)},Buffer.allocUnsafe=allocUnsafe,Buffer.allocUnsafeSlow=allocUnsafe,Buffer.isBuffer=function(b){return null!=b&&!0===b._isBuffer&&b!==Buffer.prototype},Buffer.compare=function(a,b){if(isInstance(a,Uint8Array)&&(a=Buffer.from(a,a.offset,a.byteLength)),isInstance(b,Uint8Array)&&(b=Buffer.from(b,b.offset,b.byteLength)),!Buffer.isBuffer(a)||!Buffer.isBuffer(b))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(a===b)return 0;let x=a.length,y=b.length;for(let i=0,len=Math.min(x,y);i<len;++i)if(a[i]!==b[i]){x=a[i],y=b[i];break}return x<y?-1:y<x?1:0},Buffer.isEncoding=function(encoding){switch(String(encoding).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer.concat=function(list,length){if(!Array.isArray(list))throw new TypeError('"list" argument must be an Array of Buffers');if(0===list.length)return Buffer.alloc(0);let i;if(void 0===length)for(length=0,i=0;i<list.length;++i)length+=list[i].length;var buffer=Buffer.allocUnsafe(length);let pos=0;for(i=0;i<list.length;++i){let buf=list[i];if(isInstance(buf,Uint8Array))pos+buf.length>buffer.length?(buf=Buffer.isBuffer(buf)?buf:Buffer.from(buf)).copy(buffer,pos):Uint8Array.prototype.set.call(buffer,buf,pos);else{if(!Buffer.isBuffer(buf))throw new TypeError('"list" argument must be an Array of Buffers');buf.copy(buffer,pos)}pos+=buf.length}return buffer},Buffer.byteLength=byteLength,Buffer.prototype._isBuffer=!0,Buffer.prototype.swap16=function(){var len=this.length;if(len%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let i=0;i<len;i+=2)swap(this,i,i+1);return this},Buffer.prototype.swap32=function(){var len=this.length;if(len%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let i=0;i<len;i+=4)swap(this,i,i+3),swap(this,i+1,i+2);return this},Buffer.prototype.swap64=function(){var len=this.length;if(len%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let i=0;i<len;i+=8)swap(this,i,i+7),swap(this,i+1,i+6),swap(this,i+2,i+5),swap(this,i+3,i+4);return this},Buffer.prototype.toLocaleString=Buffer.prototype.toString=function(){var length=this.length;return 0===length?"":0===arguments.length?utf8Slice(this,0,length):slowToString.apply(this,arguments)},Buffer.prototype.equals=function(b){if(Buffer.isBuffer(b))return this===b||0===Buffer.compare(this,b);throw new TypeError("Argument must be a Buffer")},Buffer.prototype.inspect=function(){let str="";var max=exports.IS;return str=this.toString("hex",0,max).replace(/(.{2})/g,"$1 ").trim(),this.length>max&&(str+=" ... "),"<Buffer "+str+">"},__webpack_require__&&(Buffer.prototype[__webpack_require__]=Buffer.prototype.inspect),Buffer.prototype.compare=function(target,start,end,thisStart,thisEnd){if(isInstance(target,Uint8Array)&&(target=Buffer.from(target,target.offset,target.byteLength)),!Buffer.isBuffer(target))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof target);if(void 0===end&&(end=target?target.length:0),void 0===thisStart&&(thisStart=0),void 0===thisEnd&&(thisEnd=this.length),(start=void 0===start?0:start)<0||end>target.length||thisStart<0||thisEnd>this.length)throw new RangeError("out of range index");if(thisEnd<=thisStart&&end<=start)return 0;if(thisEnd<=thisStart)return-1;if(end<=start)return 1;if(this===target)return 0;let x=(thisEnd>>>=0)-(thisStart>>>=0),y=(end>>>=0)-(start>>>=0);var len=Math.min(x,y),thisCopy=this.slice(thisStart,thisEnd),targetCopy=target.slice(start,end);for(let i=0;i<len;++i)if(thisCopy[i]!==targetCopy[i]){x=thisCopy[i],y=targetCopy[i];break}return x<y?-1:y<x?1:0},Buffer.prototype.includes=function(val,byteOffset,encoding){return-1!==this.indexOf(val,byteOffset,encoding)},Buffer.prototype.indexOf=function(val,byteOffset,encoding){return bidirectionalIndexOf(this,val,byteOffset,encoding,!0)},Buffer.prototype.lastIndexOf=function(val,byteOffset,encoding){return bidirectionalIndexOf(this,val,byteOffset,encoding,!1)},Buffer.prototype.write=function(string,offset,length,encoding){if(void 0===offset)encoding="utf8",length=this.length,offset=0;else if(void 0===length&&"string"==typeof offset)encoding=offset,length=this.length,offset=0;else{if(!isFinite(offset))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");offset>>>=0,isFinite(length)?(length>>>=0,void 0===encoding&&(encoding="utf8")):(encoding=length,length=void 0)}var remaining=this.length-offset;if((void 0===length||remaining<length)&&(length=remaining),0<string.length&&(length<0||offset<0)||offset>this.length)throw new RangeError("Attempt to write outside buffer bounds");encoding=encoding||"utf8";let loweredCase=!1;for(;;)switch(encoding){case"hex":return((buf,string,offset,length)=>{offset=Number(offset)||0;var remaining=buf.length-offset;(!length||remaining<(length=Number(length)))&&(length=remaining),(remaining=string.length)/2<length&&(length=remaining/2);let i;for(i=0;i<length;++i){var parsed=parseInt(string.substr(2*i,2),16);if(numberIsNaN(parsed))return i;buf[offset+i]=parsed}return i})(this,string,offset,length);case"utf8":case"utf-8":return((buf,string,offset,length)=>blitBuffer(utf8ToBytes(string,buf.length-offset),buf,offset,length))(this,string,offset,length);case"ascii":case"latin1":case"binary":return asciiWrite(this,string,offset,length);case"base64":return((buf,string,offset,length)=>blitBuffer(base64ToBytes(string),buf,offset,length))(this,string,offset,length);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,string,offset,length);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(""+encoding).toLowerCase(),loweredCase=!0}},Buffer.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};let MAX_ARGUMENTS_LENGTH=4096;function checkOffset(offset,ext,length){if(offset%1!=0||offset<0)throw new RangeError("offset is not uint");if(length<offset+ext)throw new RangeError("Trying to access beyond buffer length")}function checkInt(buf,value,offset,ext,max,min){if(!Buffer.isBuffer(buf))throw new TypeError('"buffer" argument must be a Buffer instance');if(max<value||value<min)throw new RangeError('"value" argument is out of bounds');if(offset+ext>buf.length)throw new RangeError("Index out of range")}function wrtBigUInt64LE(buf,value,offset,min,max){checkIntBI(value,min,max,buf,offset,7);min=Number(value&BigInt(4294967295)),buf[offset++]=min,buf[offset++]=min>>=8,buf[offset++]=min>>=8,buf[offset++]=min>>=8,max=Number(value>>BigInt(32)&BigInt(4294967295));return buf[offset++]=max,buf[offset++]=max>>=8,buf[offset++]=max>>=8,buf[offset++]=max>>=8,offset}function wrtBigUInt64BE(buf,value,offset,min,max){checkIntBI(value,min,max,buf,offset,7);min=Number(value&BigInt(4294967295)),buf[offset+7]=min,buf[offset+6]=min>>=8,buf[offset+5]=min>>=8,buf[offset+4]=min>>=8,max=Number(value>>BigInt(32)&BigInt(4294967295));return buf[offset+3]=max,buf[offset+2]=max>>=8,buf[offset+1]=max>>=8,buf[offset]=max>>=8,offset+8}function checkIEEE754(buf,value,offset,ext){if(offset+ext>buf.length)throw new RangeError("Index out of range");if(offset<0)throw new RangeError("Index out of range")}function writeFloat(buf,value,offset,littleEndian,noAssert){return value=+value,offset>>>=0,noAssert||checkIEEE754(buf,0,offset,4),ieee754.write(buf,value,offset,littleEndian,23,4),offset+4}function writeDouble(buf,value,offset,littleEndian,noAssert){return value=+value,offset>>>=0,noAssert||checkIEEE754(buf,0,offset,8),ieee754.write(buf,value,offset,littleEndian,52,8),offset+8}Buffer.prototype.slice=function(start,end){var len=this.length,len=((start=~~start)<0?(start+=len)<0&&(start=0):len<start&&(start=len),(end=void 0===end?len:~~end)<0?(end+=len)<0&&(end=0):len<end&&(end=len),end<start&&(end=start),this.subarray(start,end));return Object.setPrototypeOf(len,Buffer.prototype),len},Buffer.prototype.readUintLE=Buffer.prototype.readUIntLE=function(offset,byteLength,noAssert){offset>>>=0,byteLength>>>=0,noAssert||checkOffset(offset,byteLength,this.length);let val=this[offset],mul=1,i=0;for(;++i<byteLength&&(mul*=256);)val+=this[offset+i]*mul;return val},Buffer.prototype.readUintBE=Buffer.prototype.readUIntBE=function(offset,byteLength,noAssert){offset>>>=0,byteLength>>>=0,noAssert||checkOffset(offset,byteLength,this.length);let val=this[offset+--byteLength],mul=1;for(;0<byteLength&&(mul*=256);)val+=this[offset+--byteLength]*mul;return val},Buffer.prototype.readUint8=Buffer.prototype.readUInt8=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,1,this.length),this[offset]},Buffer.prototype.readUint16LE=Buffer.prototype.readUInt16LE=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,2,this.length),this[offset]|this[offset+1]<<8},Buffer.prototype.readUint16BE=Buffer.prototype.readUInt16BE=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,2,this.length),this[offset]<<8|this[offset+1]},Buffer.prototype.readUint32LE=Buffer.prototype.readUInt32LE=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,4,this.length),(this[offset]|this[offset+1]<<8|this[offset+2]<<16)+16777216*this[offset+3]},Buffer.prototype.readUint32BE=Buffer.prototype.readUInt32BE=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,4,this.length),16777216*this[offset]+(this[offset+1]<<16|this[offset+2]<<8|this[offset+3])},Buffer.prototype.readBigUInt64LE=defineBigIntMethod(function(offset){validateNumber(offset>>>=0,"offset");var first=this[offset],last=this[offset+7],first=(void 0!==first&&void 0!==last||boundsError(offset,this.length-8),first+256*this[++offset]+65536*this[++offset]+this[++offset]*2**24),offset=this[++offset]+256*this[++offset]+65536*this[++offset]+last*2**24;return BigInt(first)+(BigInt(offset)<<BigInt(32))}),Buffer.prototype.readBigUInt64BE=defineBigIntMethod(function(offset){validateNumber(offset>>>=0,"offset");var first=this[offset],last=this[offset+7],first=(void 0!==first&&void 0!==last||boundsError(offset,this.length-8),first*2**24+65536*this[++offset]+256*this[++offset]+this[++offset]),offset=this[++offset]*2**24+65536*this[++offset]+256*this[++offset]+last;return(BigInt(first)<<BigInt(32))+BigInt(offset)}),Buffer.prototype.readIntLE=function(offset,byteLength,noAssert){offset>>>=0,byteLength>>>=0,noAssert||checkOffset(offset,byteLength,this.length);let val=this[offset],mul=1,i=0;for(;++i<byteLength&&(mul*=256);)val+=this[offset+i]*mul;return mul*=128,val>=mul&&(val-=Math.pow(2,8*byteLength)),val},Buffer.prototype.readIntBE=function(offset,byteLength,noAssert){offset>>>=0,byteLength>>>=0,noAssert||checkOffset(offset,byteLength,this.length);let i=byteLength,mul=1,val=this[offset+--i];for(;0<i&&(mul*=256);)val+=this[offset+--i]*mul;return mul*=128,val>=mul&&(val-=Math.pow(2,8*byteLength)),val},Buffer.prototype.readInt8=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,1,this.length),128&this[offset]?-1*(255-this[offset]+1):this[offset]},Buffer.prototype.readInt16LE=function(offset,noAssert){offset>>>=0,noAssert||checkOffset(offset,2,this.length);noAssert=this[offset]|this[offset+1]<<8;return 32768&noAssert?4294901760|noAssert:noAssert},Buffer.prototype.readInt16BE=function(offset,noAssert){offset>>>=0,noAssert||checkOffset(offset,2,this.length);noAssert=this[offset+1]|this[offset]<<8;return 32768&noAssert?4294901760|noAssert:noAssert},Buffer.prototype.readInt32LE=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,4,this.length),this[offset]|this[offset+1]<<8|this[offset+2]<<16|this[offset+3]<<24},Buffer.prototype.readInt32BE=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,4,this.length),this[offset]<<24|this[offset+1]<<16|this[offset+2]<<8|this[offset+3]},Buffer.prototype.readBigInt64LE=defineBigIntMethod(function(offset){validateNumber(offset>>>=0,"offset");var first=this[offset],last=this[offset+7],last=(void 0!==first&&void 0!==last||boundsError(offset,this.length-8),this[offset+4]+256*this[offset+5]+65536*this[offset+6]+(last<<24));return(BigInt(last)<<BigInt(32))+BigInt(first+256*this[++offset]+65536*this[++offset]+this[++offset]*2**24)}),Buffer.prototype.readBigInt64BE=defineBigIntMethod(function(offset){validateNumber(offset>>>=0,"offset");var first=this[offset],last=this[offset+7],first=(void 0!==first&&void 0!==last||boundsError(offset,this.length-8),(first<<24)+65536*this[++offset]+256*this[++offset]+this[++offset]);return(BigInt(first)<<BigInt(32))+BigInt(this[++offset]*2**24+65536*this[++offset]+256*this[++offset]+last)}),Buffer.prototype.readFloatLE=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,4,this.length),ieee754.read(this,offset,!0,23,4)},Buffer.prototype.readFloatBE=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,4,this.length),ieee754.read(this,offset,!1,23,4)},Buffer.prototype.readDoubleLE=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,8,this.length),ieee754.read(this,offset,!0,52,8)},Buffer.prototype.readDoubleBE=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,8,this.length),ieee754.read(this,offset,!1,52,8)},Buffer.prototype.writeUintLE=Buffer.prototype.writeUIntLE=function(value,offset,byteLength,noAssert){value=+value,offset>>>=0,byteLength>>>=0,noAssert||checkInt(this,value,offset,byteLength,Math.pow(2,8*byteLength)-1,0);let mul=1,i=0;for(this[offset]=255&value;++i<byteLength&&(mul*=256);)this[offset+i]=value/mul&255;return offset+byteLength},Buffer.prototype.writeUintBE=Buffer.prototype.writeUIntBE=function(value,offset,byteLength,noAssert){value=+value,offset>>>=0,byteLength>>>=0,noAssert||checkInt(this,value,offset,byteLength,Math.pow(2,8*byteLength)-1,0);let i=byteLength-1,mul=1;for(this[offset+i]=255&value;0<=--i&&(mul*=256);)this[offset+i]=value/mul&255;return offset+byteLength},Buffer.prototype.writeUint8=Buffer.prototype.writeUInt8=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,1,255,0),this[offset]=255&value,offset+1},Buffer.prototype.writeUint16LE=Buffer.prototype.writeUInt16LE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,2,65535,0),this[offset]=255&value,this[offset+1]=value>>>8,offset+2},Buffer.prototype.writeUint16BE=Buffer.prototype.writeUInt16BE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,2,65535,0),this[offset]=value>>>8,this[offset+1]=255&value,offset+2},Buffer.prototype.writeUint32LE=Buffer.prototype.writeUInt32LE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,4,4294967295,0),this[offset+3]=value>>>24,this[offset+2]=value>>>16,this[offset+1]=value>>>8,this[offset]=255&value,offset+4},Buffer.prototype.writeUint32BE=Buffer.prototype.writeUInt32BE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,4,4294967295,0),this[offset]=value>>>24,this[offset+1]=value>>>16,this[offset+2]=value>>>8,this[offset+3]=255&value,offset+4},Buffer.prototype.writeBigUInt64LE=defineBigIntMethod(function(value,offset=0){return wrtBigUInt64LE(this,value,offset,BigInt(0),BigInt("0xffffffffffffffff"))}),Buffer.prototype.writeBigUInt64BE=defineBigIntMethod(function(value,offset=0){return wrtBigUInt64BE(this,value,offset,BigInt(0),BigInt("0xffffffffffffffff"))}),Buffer.prototype.writeIntLE=function(value,offset,byteLength,noAssert){value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,byteLength,(noAssert=Math.pow(2,8*byteLength-1))-1,-noAssert);let i=0,mul=1,sub=0;for(this[offset]=255&value;++i<byteLength&&(mul*=256);)value<0&&0===sub&&0!==this[offset+i-1]&&(sub=1),this[offset+i]=(value/mul>>0)-sub&255;return offset+byteLength},Buffer.prototype.writeIntBE=function(value,offset,byteLength,noAssert){value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,byteLength,(noAssert=Math.pow(2,8*byteLength-1))-1,-noAssert);let i=byteLength-1,mul=1,sub=0;for(this[offset+i]=255&value;0<=--i&&(mul*=256);)value<0&&0===sub&&0!==this[offset+i+1]&&(sub=1),this[offset+i]=(value/mul>>0)-sub&255;return offset+byteLength},Buffer.prototype.writeInt8=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,1,127,-128),this[offset]=255&(value=value<0?255+value+1:value),offset+1},Buffer.prototype.writeInt16LE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,2,32767,-32768),this[offset]=255&value,this[offset+1]=value>>>8,offset+2},Buffer.prototype.writeInt16BE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,2,32767,-32768),this[offset]=value>>>8,this[offset+1]=255&value,offset+2},Buffer.prototype.writeInt32LE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,4,2147483647,-2147483648),this[offset]=255&value,this[offset+1]=value>>>8,this[offset+2]=value>>>16,this[offset+3]=value>>>24,offset+4},Buffer.prototype.writeInt32BE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,4,2147483647,-2147483648),this[offset]=(value=value<0?4294967295+value+1:value)>>>24,this[offset+1]=value>>>16,this[offset+2]=value>>>8,this[offset+3]=255&value,offset+4},Buffer.prototype.writeBigInt64LE=defineBigIntMethod(function(value,offset=0){return wrtBigUInt64LE(this,value,offset,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),Buffer.prototype.writeBigInt64BE=defineBigIntMethod(function(value,offset=0){return wrtBigUInt64BE(this,value,offset,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),Buffer.prototype.writeFloatLE=function(value,offset,noAssert){return writeFloat(this,value,offset,!0,noAssert)},Buffer.prototype.writeFloatBE=function(value,offset,noAssert){return writeFloat(this,value,offset,!1,noAssert)},Buffer.prototype.writeDoubleLE=function(value,offset,noAssert){return writeDouble(this,value,offset,!0,noAssert)},Buffer.prototype.writeDoubleBE=function(value,offset,noAssert){return writeDouble(this,value,offset,!1,noAssert)},Buffer.prototype.copy=function(target,targetStart,start,end){if(!Buffer.isBuffer(target))throw new TypeError("argument should be a Buffer");if(start=start||0,end||0===end||(end=this.length),targetStart>=target.length&&(targetStart=target.length),(end=0<end&&end<start?start:end)===start)return 0;if(0===target.length||0===this.length)return 0;if((targetStart=targetStart||0)<0)throw new RangeError("targetStart out of bounds");if(start<0||start>=this.length)throw new RangeError("Index out of range");if(end<0)throw new RangeError("sourceEnd out of bounds");end>this.length&&(end=this.length);var len=(end=target.length-targetStart<end-start?target.length-targetStart+start:end)-start;return this===target&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(targetStart,start,end):Uint8Array.prototype.set.call(target,this.subarray(start,end),targetStart),len},Buffer.prototype.fill=function(val,start,end,encoding){if("string"==typeof val){if("string"==typeof start?(encoding=start,start=0,end=this.length):"string"==typeof end&&(encoding=end,end=this.length),void 0!==encoding&&"string"!=typeof encoding)throw new TypeError("encoding must be a string");if("string"==typeof encoding&&!Buffer.isEncoding(encoding))throw new TypeError("Unknown encoding: "+encoding);var code;1===val.length&&(code=val.charCodeAt(0),"utf8"===encoding&&code<128||"latin1"===encoding)&&(val=code)}else"number"==typeof val?val&=255:"boolean"==typeof val&&(val=Number(val));if(start<0||this.length<start||this.length<end)throw new RangeError("Out of range index");if(!(end<=start)){start>>>=0,end=void 0===end?this.length:end>>>0;let i;if("number"==typeof(val=val||0))for(i=start;i<end;++i)this[i]=val;else{var bytes=Buffer.isBuffer(val)?val:Buffer.from(val,encoding),len=bytes.length;if(0===len)throw new TypeError('The value "'+val+'" is invalid for argument "value"');for(i=0;i<end-start;++i)this[i+start]=bytes[i%len]}}return this};let errors={};function E(sym,getMessage,Base){errors[sym]=class extends Base{constructor(){super(),Object.defineProperty(this,"message",{value:getMessage.apply(this,arguments),writable:!0,configurable:!0}),this.name=this.name+` [${sym}]`,this.stack,delete this.name}get code(){return sym}set code(value){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:value,writable:!0})}toString(){return this.name+` [${sym}]: `+this.message}}}function addNumericalSeparator(val){let res="",i=val.length;for(var start="-"===val[0]?1:0;i>=4+start;i-=3)res="_"+val.slice(i-3,i)+res;return""+val.slice(0,i)+res}function checkIntBI(value,min,max,buf,offset,byteLength){if(max<value||value<min){var n="bigint"==typeof min?"n":"";let range;throw range=3<byteLength?0===min||min===BigInt(0)?`>= 0${n} and < 2${n} ** `+8*(byteLength+1)+n:`>= -(2${n} ** ${8*(byteLength+1)-1}${n}) and < 2 ** `+(8*(byteLength+1)-1)+n:`>= ${min}${n} and <= `+max+n,new errors.ERR_OUT_OF_RANGE("value",range,value)}((buf,offset,byteLength)=>{validateNumber(offset,"offset"),void 0!==buf[offset]&&void 0!==buf[offset+byteLength]||boundsError(offset,buf.length-(byteLength+1))})(buf,offset,byteLength)}function validateNumber(value,name){if("number"!=typeof value)throw new errors.ERR_INVALID_ARG_TYPE(name,"number",value)}function boundsError(value,length,type){if(Math.floor(value)!==value)throw validateNumber(value,type),new errors.ERR_OUT_OF_RANGE(type||"offset","an integer",value);if(length<0)throw new errors.ERR_BUFFER_OUT_OF_BOUNDS;throw new errors.ERR_OUT_OF_RANGE(type||"offset",`>= ${type?1:0} and <= `+length,value)}E("ERR_BUFFER_OUT_OF_BOUNDS",function(name){return name?name+" is outside of buffer bounds":"Attempt to access memory outside buffer bounds"},RangeError),E("ERR_INVALID_ARG_TYPE",function(name,actual){return`The "${name}" argument must be of type number. Received type `+typeof actual},TypeError),E("ERR_OUT_OF_RANGE",function(str,range,input){str=`The value of "${str}" is out of range.`;let received=input;return Number.isInteger(input)&&Math.abs(input)>2**32?received=addNumericalSeparator(String(input)):"bigint"==typeof input&&(received=String(input),(input>BigInt(2)**BigInt(32)||input<-(BigInt(2)**BigInt(32)))&&(received=addNumericalSeparator(received)),received+="n"),str+=` It must be ${range}. Received `+received},RangeError);let INVALID_BASE64_RE=/[^+/0-9A-Za-z-_]/g;function utf8ToBytes(string,units){units=units||1/0;let codePoint;var length=string.length;let leadSurrogate=null;var bytes=[];for(let i=0;i<length;++i){if(55295<(codePoint=string.charCodeAt(i))&&codePoint<57344){if(!leadSurrogate){if(56319<codePoint){-1<(units-=3)&&bytes.push(239,191,189);continue}if(i+1===length){-1<(units-=3)&&bytes.push(239,191,189);continue}leadSurrogate=codePoint;continue}if(codePoint<56320){-1<(units-=3)&&bytes.push(239,191,189),leadSurrogate=codePoint;continue}codePoint=65536+(leadSurrogate-55296<<10|codePoint-56320)}else leadSurrogate&&-1<(units-=3)&&bytes.push(239,191,189);if(leadSurrogate=null,codePoint<128){if(--units<0)break;bytes.push(codePoint)}else if(codePoint<2048){if((units-=2)<0)break;bytes.push(codePoint>>6|192,63&codePoint|128)}else if(codePoint<65536){if((units-=3)<0)break;bytes.push(codePoint>>12|224,codePoint>>6&63|128,63&codePoint|128)}else{if(!(codePoint<1114112))throw new Error("Invalid code point");if((units-=4)<0)break;bytes.push(codePoint>>18|240,codePoint>>12&63|128,codePoint>>6&63|128,63&codePoint|128)}}return bytes}function base64ToBytes(str){return base64.toByteArray((str=>{if((str=(str=str.split("=")[0]).trim().replace(INVALID_BASE64_RE,"")).length<2)return"";for(;str.length%4!=0;)str+="=";return str})(str))}function blitBuffer(src,dst,offset,length){let i;for(i=0;i<length&&!(i+offset>=dst.length||i>=src.length);++i)dst[i+offset]=src[i];return i}function isInstance(obj,type){return obj instanceof type||null!=obj&&null!=obj.constructor&&null!=obj.constructor.name&&obj.constructor.name===type.name}function numberIsNaN(obj){return obj!=obj}let hexSliceLookupTable=(()=>{var table=new Array(256);for(let i=0;i<16;++i){var i16=16*i;for(let j=0;j<16;++j)table[i16+j]="0123456789abcdef"[i]+"0123456789abcdef"[j]}return table})();function defineBigIntMethod(fn){return"undefined"==typeof BigInt?BufferBigIntNotDefined:fn}function BufferBigIntNotDefined(){throw new Error("BigInt not supported")}},312:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_RESULT__;(()=>{function createOutputMethod(outputType,is224){return function(message){return new Sha256(is224,!0).update(message)[outputType]()}}function createMethod(is224){var method=createOutputMethod("hex",is224);(method=NODE_JS?((method,is224)=>{var bufferFrom,crypto=__webpack_require__(394),Buffer=__webpack_require__(903).Buffer,algorithm=is224?"sha224":"sha256";return bufferFrom=Buffer.from&&!root.JS_SHA256_NO_BUFFER_FROM?Buffer.from:function(message){return new Buffer(message)},function(message){if("string"==typeof message)return crypto.createHash(algorithm).update(message,"utf8").digest("hex");if(null==message)throw new Error(ERROR);return message.constructor===ArrayBuffer&&(message=new Uint8Array(message)),Array.isArray(message)||ArrayBuffer.isView(message)||message.constructor===Buffer?crypto.createHash(algorithm).update(bufferFrom(message)).digest("hex"):method(message)}})(method,is224):method).create=function(){return new Sha256(is224)},method.update=function(message){return method.create().update(message)};for(var i=0;i<OUTPUT_TYPES.length;++i){var type=OUTPUT_TYPES[i];method[type]=createOutputMethod(type,is224)}return method}function createHmacOutputMethod(outputType,is224){return function(key,message){return new HmacSha256(key,is224,!0).update(message)[outputType]()}}function createHmacMethod(is224){var method=createHmacOutputMethod("hex",is224);method.create=function(key){return new HmacSha256(key,is224)},method.update=function(key,message){return method.create(key).update(message)};for(var i=0;i<OUTPUT_TYPES.length;++i){var type=OUTPUT_TYPES[i];method[type]=createHmacOutputMethod(type,is224)}return method}var ERROR="input is invalid type",root=(WINDOW="object"==typeof window)?window:{},WINDOW=!(WINDOW=root.JS_SHA256_NO_WINDOW?!1:WINDOW)&&"object"==typeof self,NODE_JS=!root.JS_SHA256_NO_NODE_JS&&"object"==typeof process&&process.versions&&process.versions.node,WINDOW=(NODE_JS?root=__webpack_require__.g:WINDOW&&(root=self),!root.JS_SHA256_NO_COMMON_JS&&module.exports),AMD=__webpack_require__.amdO,ARRAY_BUFFER=!root.JS_SHA256_NO_ARRAY_BUFFER&&"undefined"!=typeof ArrayBuffer,HEX_CHARS="0123456789abcdef".split(""),EXTRA=[-2147483648,8388608,32768,128],SHIFT=[24,16,8,0],K=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],OUTPUT_TYPES=["hex","array","digest","arrayBuffer"],blocks=[];function Sha256(is224,sharedMemory){sharedMemory?(blocks[0]=blocks[16]=blocks[1]=blocks[2]=blocks[3]=blocks[4]=blocks[5]=blocks[6]=blocks[7]=blocks[8]=blocks[9]=blocks[10]=blocks[11]=blocks[12]=blocks[13]=blocks[14]=blocks[15]=0,this.blocks=blocks):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],is224?(this.h0=3238371032,this.h1=914150663,this.h2=812702999,this.h3=4144912697,this.h4=4290775857,this.h5=1750603025,this.h6=1694076839,this.h7=3204075428):(this.h0=1779033703,this.h1=3144134277,this.h2=1013904242,this.h3=2773480762,this.h4=1359893119,this.h5=2600822924,this.h6=528734635,this.h7=1541459225),this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0,this.is224=is224}function HmacSha256(key,is224,sharedMemory){var type=typeof key;if("string"==type){for(var code,bytes=[],length=key.length,index=0,i=0;i<length;++i)(code=key.charCodeAt(i))<128?bytes[index++]=code:(code<2048?bytes[index++]=192|code>>>6:(code<55296||57344<=code?bytes[index++]=224|code>>>12:(code=65536+((1023&code)<<10|1023&key.charCodeAt(++i)),bytes[index++]=240|code>>>18,bytes[index++]=128|code>>>12&63),bytes[index++]=128|code>>>6&63),bytes[index++]=128|63&code);key=bytes}else{if("object"!=type)throw new Error(ERROR);if(null===key)throw new Error(ERROR);if(ARRAY_BUFFER&&key.constructor===ArrayBuffer)key=new Uint8Array(key);else if(!(Array.isArray(key)||ARRAY_BUFFER&&ArrayBuffer.isView(key)))throw new Error(ERROR)}64<key.length&&(key=new Sha256(is224,!0).update(key).array());var oKeyPad=[],iKeyPad=[];for(i=0;i<64;++i){var b=key[i]||0;oKeyPad[i]=92^b,iKeyPad[i]=54^b}Sha256.call(this,is224,sharedMemory),this.update(iKeyPad),this.oKeyPad=oKeyPad,this.inner=!0,this.sharedMemory=sharedMemory}!root.JS_SHA256_NO_NODE_JS&&Array.isArray||(Array.isArray=function(obj){return"[object Array]"===Object.prototype.toString.call(obj)}),!ARRAY_BUFFER||!root.JS_SHA256_NO_ARRAY_BUFFER_IS_VIEW&&ArrayBuffer.isView||(ArrayBuffer.isView=function(obj){return"object"==typeof obj&&obj.buffer&&obj.buffer.constructor===ArrayBuffer}),Sha256.prototype.update=function(message){if(!this.finalized){var notString,type=typeof message;if("string"!=type){if("object"!=type)throw new Error(ERROR);if(null===message)throw new Error(ERROR);if(ARRAY_BUFFER&&message.constructor===ArrayBuffer)message=new Uint8Array(message);else if(!(Array.isArray(message)||ARRAY_BUFFER&&ArrayBuffer.isView(message)))throw new Error(ERROR);notString=!0}for(var code,i,index=0,length=message.length,blocks=this.blocks;index<length;){if(this.hashed&&(this.hashed=!1,blocks[0]=this.block,this.block=blocks[16]=blocks[1]=blocks[2]=blocks[3]=blocks[4]=blocks[5]=blocks[6]=blocks[7]=blocks[8]=blocks[9]=blocks[10]=blocks[11]=blocks[12]=blocks[13]=blocks[14]=blocks[15]=0),notString)for(i=this.start;index<length&&i<64;++index)blocks[i>>>2]|=message[index]<<SHIFT[3&i++];else for(i=this.start;index<length&&i<64;++index)(code=message.charCodeAt(index))<128?blocks[i>>>2]|=code<<SHIFT[3&i++]:(code<2048?blocks[i>>>2]|=(192|code>>>6)<<SHIFT[3&i++]:(code<55296||57344<=code?blocks[i>>>2]|=(224|code>>>12)<<SHIFT[3&i++]:(code=65536+((1023&code)<<10|1023&message.charCodeAt(++index)),blocks[i>>>2]|=(240|code>>>18)<<SHIFT[3&i++],blocks[i>>>2]|=(128|code>>>12&63)<<SHIFT[3&i++]),blocks[i>>>2]|=(128|code>>>6&63)<<SHIFT[3&i++]),blocks[i>>>2]|=(128|63&code)<<SHIFT[3&i++]);this.lastByteIndex=i,this.bytes+=i-this.start,64<=i?(this.block=blocks[16],this.start=i-64,this.hash(),this.hashed=!0):this.start=i}return 4294967295<this.bytes&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},Sha256.prototype.finalize=function(){var blocks,i;this.finalized||(this.finalized=!0,blocks=this.blocks,i=this.lastByteIndex,blocks[16]=this.block,blocks[i>>>2]|=EXTRA[3&i],this.block=blocks[16],56<=i&&(this.hashed||this.hash(),blocks[0]=this.block,blocks[16]=blocks[1]=blocks[2]=blocks[3]=blocks[4]=blocks[5]=blocks[6]=blocks[7]=blocks[8]=blocks[9]=blocks[10]=blocks[11]=blocks[12]=blocks[13]=blocks[14]=blocks[15]=0),blocks[14]=this.hBytes<<3|this.bytes>>>29,blocks[15]=this.bytes<<3,this.hash())},Sha256.prototype.hash=function(){for(var s0,t1,ab,da,cd,bc,a=this.h0,b=this.h1,c=this.h2,d=this.h3,e=this.h4,f=this.h5,g=this.h6,h=this.h7,blocks=this.blocks,j=16;j<64;++j)s0=((t1=blocks[j-15])>>>7|t1<<25)^(t1>>>18|t1<<14)^t1>>>3,t1=blocks[j-2],blocks[j]=blocks[j-16]+s0+blocks[j-7]+((t1>>>17|t1<<15)^(t1>>>19|t1<<13)^t1>>>10)<<0;for(bc=b&c,j=0;j<64;j+=4)this.first?(d=this.is224?(ab=300032,h=(t1=blocks[0]-1413257819)-150054599<<0,t1+24177077<<0):(ab=704751109,h=(t1=blocks[0]-210244248)-1521486534<<0,t1+143694565<<0),this.first=!1):(h=d+(t1=h+((e>>>6|e<<26)^(e>>>11|e<<21)^(e>>>25|e<<7))+(e&f^~e&g)+K[j]+blocks[j])<<0,d=t1+((s0=(a>>>2|a<<30)^(a>>>13|a<<19)^(a>>>22|a<<10))+((ab=a&b)^a&c^bc))<<0),g=c+(t1=g+((h>>>6|h<<26)^(h>>>11|h<<21)^(h>>>25|h<<7))+(h&e^~h&f)+K[j+1]+blocks[j+1])<<0,c=t1+((s0=(d>>>2|d<<30)^(d>>>13|d<<19)^(d>>>22|d<<10))+((da=d&a)^d&b^ab))<<0,f=b+(t1=f+((g>>>6|g<<26)^(g>>>11|g<<21)^(g>>>25|g<<7))+(g&h^~g&e)+K[j+2]+blocks[j+2])<<0,b=t1+((s0=(c>>>2|c<<30)^(c>>>13|c<<19)^(c>>>22|c<<10))+((cd=c&d)^c&a^da))<<0,e=a+(t1=e+((f>>>6|f<<26)^(f>>>11|f<<21)^(f>>>25|f<<7))+(f&g^~f&h)+K[j+3]+blocks[j+3])<<0,a=t1+((s0=(b>>>2|b<<30)^(b>>>13|b<<19)^(b>>>22|b<<10))+((bc=b&c)^b&d^cd))<<0,this.chromeBugWorkAround=!0;this.h0=this.h0+a<<0,this.h1=this.h1+b<<0,this.h2=this.h2+c<<0,this.h3=this.h3+d<<0,this.h4=this.h4+e<<0,this.h5=this.h5+f<<0,this.h6=this.h6+g<<0,this.h7=this.h7+h<<0},Sha256.prototype.toString=Sha256.prototype.hex=function(){this.finalize();var h0=this.h0,h1=this.h1,h2=this.h2,h3=this.h3,h4=this.h4,h5=this.h5,h6=this.h6,h7=this.h7,h0=HEX_CHARS[h0>>>28&15]+HEX_CHARS[h0>>>24&15]+HEX_CHARS[h0>>>20&15]+HEX_CHARS[h0>>>16&15]+HEX_CHARS[h0>>>12&15]+HEX_CHARS[h0>>>8&15]+HEX_CHARS[h0>>>4&15]+HEX_CHARS[15&h0]+HEX_CHARS[h1>>>28&15]+HEX_CHARS[h1>>>24&15]+HEX_CHARS[h1>>>20&15]+HEX_CHARS[h1>>>16&15]+HEX_CHARS[h1>>>12&15]+HEX_CHARS[h1>>>8&15]+HEX_CHARS[h1>>>4&15]+HEX_CHARS[15&h1]+HEX_CHARS[h2>>>28&15]+HEX_CHARS[h2>>>24&15]+HEX_CHARS[h2>>>20&15]+HEX_CHARS[h2>>>16&15]+HEX_CHARS[h2>>>12&15]+HEX_CHARS[h2>>>8&15]+HEX_CHARS[h2>>>4&15]+HEX_CHARS[15&h2]+HEX_CHARS[h3>>>28&15]+HEX_CHARS[h3>>>24&15]+HEX_CHARS[h3>>>20&15]+HEX_CHARS[h3>>>16&15]+HEX_CHARS[h3>>>12&15]+HEX_CHARS[h3>>>8&15]+HEX_CHARS[h3>>>4&15]+HEX_CHARS[15&h3]+HEX_CHARS[h4>>>28&15]+HEX_CHARS[h4>>>24&15]+HEX_CHARS[h4>>>20&15]+HEX_CHARS[h4>>>16&15]+HEX_CHARS[h4>>>12&15]+HEX_CHARS[h4>>>8&15]+HEX_CHARS[h4>>>4&15]+HEX_CHARS[15&h4]+HEX_CHARS[h5>>>28&15]+HEX_CHARS[h5>>>24&15]+HEX_CHARS[h5>>>20&15]+HEX_CHARS[h5>>>16&15]+HEX_CHARS[h5>>>12&15]+HEX_CHARS[h5>>>8&15]+HEX_CHARS[h5>>>4&15]+HEX_CHARS[15&h5]+HEX_CHARS[h6>>>28&15]+HEX_CHARS[h6>>>24&15]+HEX_CHARS[h6>>>20&15]+HEX_CHARS[h6>>>16&15]+HEX_CHARS[h6>>>12&15]+HEX_CHARS[h6>>>8&15]+HEX_CHARS[h6>>>4&15]+HEX_CHARS[15&h6];return this.is224||(h0+=HEX_CHARS[h7>>>28&15]+HEX_CHARS[h7>>>24&15]+HEX_CHARS[h7>>>20&15]+HEX_CHARS[h7>>>16&15]+HEX_CHARS[h7>>>12&15]+HEX_CHARS[h7>>>8&15]+HEX_CHARS[h7>>>4&15]+HEX_CHARS[15&h7]),h0},Sha256.prototype.array=Sha256.prototype.digest=function(){this.finalize();var h0=this.h0,h1=this.h1,h2=this.h2,h3=this.h3,h4=this.h4,h5=this.h5,h6=this.h6,h7=this.h7,h0=[h0>>>24&255,h0>>>16&255,h0>>>8&255,255&h0,h1>>>24&255,h1>>>16&255,h1>>>8&255,255&h1,h2>>>24&255,h2>>>16&255,h2>>>8&255,255&h2,h3>>>24&255,h3>>>16&255,h3>>>8&255,255&h3,h4>>>24&255,h4>>>16&255,h4>>>8&255,255&h4,h5>>>24&255,h5>>>16&255,h5>>>8&255,255&h5,h6>>>24&255,h6>>>16&255,h6>>>8&255,255&h6];return this.is224||h0.push(h7>>>24&255,h7>>>16&255,h7>>>8&255,255&h7),h0},Sha256.prototype.arrayBuffer=function(){this.finalize();var buffer=new ArrayBuffer(this.is224?28:32),dataView=new DataView(buffer);return dataView.setUint32(0,this.h0),dataView.setUint32(4,this.h1),dataView.setUint32(8,this.h2),dataView.setUint32(12,this.h3),dataView.setUint32(16,this.h4),dataView.setUint32(20,this.h5),dataView.setUint32(24,this.h6),this.is224||dataView.setUint32(28,this.h7),buffer},(HmacSha256.prototype=new Sha256).finalize=function(){var innerHash;Sha256.prototype.finalize.call(this),this.inner&&(this.inner=!1,innerHash=this.array(),Sha256.call(this,this.is224,this.sharedMemory),this.update(this.oKeyPad),this.update(innerHash),Sha256.prototype.finalize.call(this))};var exports=createMethod();(exports.sha256=exports).sha224=createMethod(!0),exports.sha256.hmac=createHmacMethod(),exports.sha224.hmac=createHmacMethod(!0),WINDOW?module.exports=exports:(root.sha256=exports.sha256,root.sha224=exports.sha224,AMD&&void 0!==(__WEBPACK_AMD_DEFINE_RESULT__=function(){return exports}.call(exports,__webpack_require__,exports,module))&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))})()},314:function(module){module.exports=function(cssWithMappingToString){var list=[];return list.toString=function(){return this.map(function(item){var content="",needLayer=void 0!==item[5];return item[4]&&(content+="@supports (".concat(item[4],") {")),item[2]&&(content+="@media ".concat(item[2]," {")),needLayer&&(content+="@layer".concat(0<item[5].length?" ".concat(item[5]):""," {")),content+=cssWithMappingToString(item),needLayer&&(content+="}"),item[2]&&(content+="}"),item[4]&&(content+="}"),content}).join("")},list.i=function(modules,media,dedupe,supports,layer){"string"==typeof modules&&(modules=[[null,modules,void 0]]);var alreadyImportedModules={};if(dedupe)for(var k=0;k<this.length;k++){var id=this[k][0];null!=id&&(alreadyImportedModules[id]=!0)}for(var _k=0;_k<modules.length;_k++){var item=[].concat(modules[_k]);dedupe&&alreadyImportedModules[item[0]]||(void 0!==layer&&(void 0!==item[5]&&(item[1]="@layer".concat(0<item[5].length?" ".concat(item[5]):""," {").concat(item[1],"}")),item[5]=layer),media&&(item[2]&&(item[1]="@media ".concat(item[2]," {").concat(item[1],"}")),item[2]=media),supports&&(item[4]?(item[1]="@supports (".concat(item[4],") {").concat(item[1],"}"),item[4]=supports):item[4]="".concat(supports)),list.push(item))}},list}},394:function(){},526:function(__unused_webpack_module,exports){exports.byteLength=function(b64){var b64=getLens(b64),validLen=b64[0],b64=b64[1];return 3*(validLen+b64)/4-b64},exports.toByteArray=function(b64){var tmp,i,lens=getLens(b64),validLen=lens[0],lens=lens[1],arr=new Arr(((validLen,placeHoldersLen)=>3*(validLen+placeHoldersLen)/4-placeHoldersLen)(validLen,lens)),curByte=0,len=0<lens?validLen-4:validLen;for(i=0;i<len;i+=4)tmp=revLookup[b64.charCodeAt(i)]<<18|revLookup[b64.charCodeAt(i+1)]<<12|revLookup[b64.charCodeAt(i+2)]<<6|revLookup[b64.charCodeAt(i+3)],arr[curByte++]=tmp>>16&255,arr[curByte++]=tmp>>8&255,arr[curByte++]=255&tmp;2===lens&&(tmp=revLookup[b64.charCodeAt(i)]<<2|revLookup[b64.charCodeAt(i+1)]>>4,arr[curByte++]=255&tmp);1===lens&&(tmp=revLookup[b64.charCodeAt(i)]<<10|revLookup[b64.charCodeAt(i+1)]<<4|revLookup[b64.charCodeAt(i+2)]>>2,arr[curByte++]=tmp>>8&255,arr[curByte++]=255&tmp);return arr},exports.fromByteArray=function(uint8){for(var tmp,len=uint8.length,extraBytes=len%3,parts=[],i=0,len2=len-extraBytes;i<len2;i+=16383)parts.push(((uint8,start,end)=>{for(var tmp,output=[],i=start;i<end;i+=3)tmp=(uint8[i]<<16&16711680)+(uint8[i+1]<<8&65280)+(255&uint8[i+2]),output.push((num=>lookup[num>>18&63]+lookup[num>>12&63]+lookup[num>>6&63]+lookup[63&num])(tmp));return output.join("")})(uint8,i,len2<i+16383?len2:i+16383));1==extraBytes?(tmp=uint8[len-1],parts.push(lookup[tmp>>2]+lookup[tmp<<4&63]+"==")):2==extraBytes&&(tmp=(uint8[len-2]<<8)+uint8[len-1],parts.push(lookup[tmp>>10]+lookup[tmp>>4&63]+lookup[tmp<<2&63]+"="));return parts.join("")};for(var lookup=[],revLookup=[],Arr="undefined"!=typeof Uint8Array?Uint8Array:Array,code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,len=code.length;i<len;++i)lookup[i]=code[i],revLookup[code.charCodeAt(i)]=i;function getLens(b64){var len=b64.length;if(0<len%4)throw new Error("Invalid string. Length must be a multiple of 4");b64=b64.indexOf("="),len=(b64=-1===b64?len:b64)===len?0:4-b64%4;return[b64,len]}revLookup["-".charCodeAt(0)]=62,revLookup["_".charCodeAt(0)]=63},601:function(module){module.exports=function(i){return i[1]}},675:function(module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{A:function(){return __WEBPACK_DEFAULT_EXPORT__}});var __webpack_exports__=__webpack_require__(601),__webpack_exports__=__webpack_require__.n(__webpack_exports__),_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(314),__webpack_require__=__webpack_require__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__)()(__webpack_exports__());__webpack_require__.push([module.id,`.colorful-button,#auto-task-buttons a.auto-task-website-btn,.show-button-div a.auto-task-website-btn,body.auto-task-options .auto-task-form table button{position:relative;padding:5px 10px;text-align:center;color:#fff;-webkit-text-decoration:none;text-decoration:none;background:linear-gradient(90deg, #03a9f4, #f441a5, #ffeb3b, #03a9f4);border-radius:30px;background-size:400%;text-transform:capitalize}.colorful-button:hover,#auto-task-buttons a.auto-task-website-btn:hover,.show-button-div a.auto-task-website-btn:hover,body.auto-task-options .auto-task-form table button:hover{transform:scale(1.05);box-shadow:0 6px 20px rgba(0,0,0,.3);cursor:pointer}.colorful-button:hover::before,#auto-task-buttons a.auto-task-website-btn:hover::before,.show-button-div a.auto-task-website-btn:hover::before,body.auto-task-options .auto-task-form table button:hover::before{filter:blur(10px);opacity:1}.colorful-button::before,#auto-task-buttons a.auto-task-website-btn::before,.show-button-div a.auto-task-website-btn::before,body.auto-task-options .auto-task-form table button::before{content:"";position:absolute;top:-5px;left:-5px;right:-5px;bottom:-5px;z-index:-1;background:linear-gradient(90deg, #03a9f4, #f441a5, #ffeb3b, #03a9f4);border-radius:40px;background-size:400%;opacity:-1}#auto-task-info{position:fixed;bottom:10px;right:10px;width:60%;max-width:500px;max-height:60%;overflow-y:auto;color:#000;background-color:#fff;padding-left:5px;z-index:999999999 !important;border:solid 2px #add8e6;border-radius:10px}#auto-task-info li{text-align:left}#auto-task-info li a.high-light{color:#00aeff;font-weight:bold}#auto-task-info .success{color:green}#auto-task-info .error{color:red}#auto-task-info .warning{color:blue}#auto-task-info .info{color:#ff0}#auto-task-info .update-text{color:green;border:solid 2px #8dcb69;margin:5px 10px 5px 20px;border-radius:10px;padding:5px 20px}.auto-task-keylol{display:inline-block;text-transform:capitalize;margin-left:10px;-webkit-text-decoration:none !important;text-decoration:none !important;border:solid 1px;border-radius:5px;padding:0 2px}.auto-task-keylol[selected=selected]{background-color:blue !important;color:#fff !important}.auto-task-form table{font-family:verdana,arial,sans-serif;font-size:11px;color:#333;border-width:1px;border-color:#999;border-collapse:collapse;width:100%}.auto-task-form table thead td{border-width:1px;padding:8px;border-style:solid;border-color:#a9c6c9;font-weight:bold;background-color:#fff}.auto-task-form table tbody tr{background-color:#d4e3e5}.auto-task-form table tbody tr:hover{background-color:#ff6 !important}.auto-task-form table tbody tr th{background-color:#c3dde0;border-width:1px;padding:8px;border-style:solid;border-color:#a9c6c9;text-transform:capitalize}.auto-task-form table tbody tr td{border-width:1px;padding:8px;border-style:solid;border-color:#a9c6c9}.swal2-modal{width:70% !important;max-width:1000px !important}body.auto-task-options{padding-top:10px;text-align:center}body.auto-task-options .auto-task-form{width:80%;max-width:1000px;margin:0 auto;padding-bottom:20px}body.auto-task-options .auto-task-form table input.editOption{width:80%}body.auto-task-options .auto-task-form table #getTwitterUserId,body.auto-task-options .auto-task-form table #getYoutubeChannelId{margin-top:5px}body.auto-task-options .auto-task-form table button{z-index:1}body.auto-task-options .auto-task-form table input[type=text]{outline-style:none;border:1px solid #ccc;border-radius:3px;padding:5px 10px;font-size:14px}body.auto-task-options .auto-task-form table input[type=text]:focus{border-color:#66afe9;outline:0;box-shadow:inset 0 1px 1px rgba(0,0,0,.075),0 0 8px rgba(102,175,233,.6)}body.auto-task-options .auto-task-form table label{position:relative;width:160px;height:80px;cursor:pointer;transform:scale(0.25);margin:-25% 0;top:-30px;display:inline-block}body.auto-task-options .auto-task-form table label input{position:relative;z-index:1;-webkit-appearance:none;-moz-appearance:none;appearance:none}body.auto-task-options .auto-task-form table label input:checked~span{background:#05be05;box-shadow:0 15px 25px rgba(5,190,5,.4)}body.auto-task-options .auto-task-form table label input:checked~span i{left:84px}body.auto-task-options .auto-task-form table label input:checked~span i::before{background:#05be05;box-shadow:35px 0 0 #05be05}body.auto-task-options .auto-task-form table label input:checked~span i::after{bottom:12px;height:15px;border-bottom-left-radius:15px;border-bottom-right-radius:15px;background:#05be05}body.auto-task-options .auto-task-form table label span{position:absolute;top:0;left:0;width:100%;height:100%;background:#fe0000;border-radius:80px;transition:.5s;box-shadow:0 15px 25px rgba(254,0,0,.4)}body.auto-task-options .auto-task-form table label span i{position:absolute;top:4px;left:4px;width:72px;height:72px;background:#fff;border-radius:50%}body.auto-task-options .auto-task-form table label span i::before{content:"";position:absolute;top:22px;left:12px;width:12px;height:12px;border-radius:50%;background:#fe0000;box-shadow:35px 0 0 #fe0000;transition:.5s}body.auto-task-options .auto-task-form table label span i::after{content:"";position:absolute;bottom:15px;left:calc(50% - 15px);width:30px;height:6px;border-radius:6px;background:#fe0000;transition:.5s}body.auto-task-history{font-size:15px;font-weight:400;line-height:1.5}body.auto-task-history .container a{color:#007bff;-webkit-text-decoration:none;text-decoration:none;background-color:rgba(0,0,0,0)}body.auto-task-history .container .card{width:80%;max-width:800px;border-radius:10px;background:rgba(118,118,118,.1019607843);border-top:1px solid hsla(0,0%,100%,.5019607843);-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px);box-shadow:0 15px 25px rgba(0,0,0,.1019607843);margin:20px auto;position:relative;display:flex;flex-direction:column;word-wrap:break-word;-webkit-background-clip:border-box;background-clip:border-box;border:1px solid rgba(0,0,0,.125);border-radius:.25rem}body.auto-task-history .container .card .title{text-align:center;font-size:30px;font-weight:bold;margin:5px 0}body.auto-task-history .container .card .title a:hover{-webkit-text-decoration:none;text-decoration:none;background:#93e1ff;border-radius:10px;padding:3px}body.auto-task-history .container .card ul{margin-bottom:25px}body.auto-task-history .container .card ul li{margin-bottom:5px;line-height:20px}body.auto-task-history .container .card ul a:hover{-webkit-text-decoration:underline;text-decoration:underline}body.auto-task-history .container .card .delete-task{right:10px;width:38px;height:35px;position:absolute;font-size:24px;cursor:pointer;border-radius:10px}body.auto-task-history .container .card .delete-task:hover{background:#fff}body.auto-task-history .container .card .time{right:5px;position:absolute;bottom:0;color:#e83e8c;font-family:'SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace';font-size:15px}#auto-task-buttons,.show-button-div{position:fixed;top:30px;right:15px;width:124px;z-index:999999999 !important;transform:scale(0.85)}#auto-task-buttons p,.show-button-div p{line-height:30px;height:40px;text-align:center;margin:5px !important}#auto-task-buttons a.auto-task-website-btn,.show-button-div a.auto-task-website-btn{width:105px;line-height:27px;font-size:20px;display:block}.show-button-div{width:20px}.auto-task-capitalize{text-transform:capitalize !important}.swal2-file:focus,.swal2-input:focus,.swal2-textarea:focus{box-shadow:inset 0px 0px 4px 1px rgba(100,150,200,.5) !important}.swal2-checkbox-custom{align-items:center;justify-content:center;background:#fff;color:inherit;margin:1em auto}.swal2-checkbox-custom input{flex-shrink:0;margin:0 .4em}.giveaway-actions #getKey{display:none !important}.auto-task-giveaway-status{color:#fff;border-radius:10px;padding:0 5px;margin-left:5px}.auto-task-giveaway-status.active{background-color:#5cb85c}.auto-task-giveaway-status.not-active{background-color:#d9534f}`,""]);let __WEBPACK_DEFAULT_EXPORT__=__webpack_require__.toString()},903:function(){},991:function(__unused_webpack_module,exports){(e=>{function l(e){return"[object Object]"===o(e)}function n(e){return/^\d+$/.test(e+"")}function t(e){return/^\d+\.\d+$/.test(e+"")}function o(e){return Object.prototype.toString.call(e)}var r=function(){return(r=Object.assign||function(e){for(var n,t=1,o=arguments.length;t<o;t++)for(var r in n=arguments[t])Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r]);return e}).apply(this,arguments)};function i(e,n,t){if(t||2===arguments.length)for(var o,r=0,i=n.length;r<i;r++)!o&&r in n||((o=o||Array.prototype.slice.call(n,0,r))[r]=n[r]);return e.concat(o||Array.prototype.slice.call(n))}a.prototype.init=function(){try{this.getSystemName(),this.getBrowserName()}catch(e){console.warn("[UA formatter error] ".concat(e))}},a.prototype.getEngine=function(){var e=this.agent;return-1!==e.indexOf("Trident")?"Trident":-1!==e.indexOf("Firefox")?"Gecko":-1!==e.indexOf("Presto")?"Presto":"WebKit"},a.prototype.getSystemName=function(){var e,n=(this.agent.match(/^[a-z]+\/\d+\.\d+\s?\(([a-z\d\s:;./_-]+)\)/i)||[])[1];try{var t,o="";if(/Windows/i.test(n)){var r=(n.match(/NT\s(\d+\.\d+)/)||[])[1];switch(this.info.os="Windows",r){case"6.3":o="8.1";break;case"6.2":o="8";break;case"6.1":o="7";break;case"5.2":case"5.1":o="XP";break;default:o=r}this.info.device="PC",this.info.osVersion=o}else/^Macintosh/i.test(n)?(o=(n.match(/X\s((\d+(_|\.))+\d+)/)||[])[1],this.info.os="Macintosh",this.info.device="PC",this.info.osVersion=null!=(e=null==o?void 0:o.replace(/_/g,"."))?e:"Unknown"):/^iPad/i.test(n)?(o=(n.match(/((\d+_)+\d+)/)||[])[1],this.info.os="iPad",this.info.device="Tablet",this.info.osVersion=o.replace(/_/g,".")):/^iPhone/i.test(n)?(o=(n.match(/((\d+_)+\d+)/)||[])[1],this.info.os="iPhone",this.info.device="Mobile",this.info.osVersion=o.replace(/_/g,".")):-1!==n.indexOf("Android")?(t=(n.match(/Android\s((\d+\.?)+\d?)/)||[])[1],this.info.device="Mobile",this.info.os="Android",this.info.osVersion=t):(/Linux\s[a-z\d_]+/.test(n)?this.info.os="Linux":this.info.os="Unknown",this.info.osVersion="Unknown")}catch(e){this.info.os="Unknown",this.info.osVersion="Unknown"}},a.prototype.getBrowserName=function(){var e=Object.keys(this.browserNameMap).map(function(e){return new RegExp("".concat(e,"(\\/|\\s)(\\d+\\.)+\\d+"))}),n=1<(n=(this.agent.match(/[a-z\d]+(\/|\s)(\d+\.)+\d+/gi)||[]).filter(function(n){return-1!==e.findIndex(function(e){return e.test(n)})})).length&&!/^Safari/.test(n[n.length-1])?n.reverse():n;this.info=r(r({},this.info),this._formatBrowserVersion(n[0]))},a.prototype._formatBrowserVersion=function(e){var n,t,o,r;try{for(var i=null!=(t=null==(n=e.match(/(?<name>[a-z\d]+)(\/|\s)(?<version>(\d+\.)+\d+)/i))?void 0:n.groups)?t:{},s=i.name,a=i.version,c={},u=0,f=Object.entries(this.browserNameMap);u<f.length;u++){var l=f[u],d=l[0],h=l[1];if(new RegExp(d).test(s)){c=h;break}}var p={browserVersion:null!=a?a:"Unknown",browser:null!=(o=c.en)?o:"Unknown",browserZH:null!=(r=(null==c?void 0:c.zh)||c.en)?r:"Unknown"};return"Trident"===s&&(p.browserVersion={"4.0":8,"5.0":9,"6.0":10,"7.0":11}[a]),p}catch(e){return console.warn("[UA formatter error] ".concat(e)),{browser:"Unknown",browserVersion:"Unknown"}}};var s=a;function a(e){this.agent="",this.info={browser:"",browserZH:"",browserVersion:"",os:"",osVersion:"",device:"Unknown",engine:"WebKit"},this.browserNameMap={MicroMessenger:{en:"MicroMessenger",zh:"微信"},MetaSr:{en:"MetaSr",zh:"搜狗浏览器"},"QQ(Browser)?":{en:"QQBrowser",zh:"QQ浏览器"},UCBrowser:{en:"UCBrowser",zh:"UC浏览器"},"2345Explorer":{en:"2345Explorer",zh:"2345极速浏览器"},Mb2345Browser:{en:"Mb2345Browser",zh:"2345手机浏览器"},Trident:{en:"Internet Explorer"},"Edge?":{en:"Edge"},OPR:{en:"Opera"},Vivaldi:{en:"Vivaldi"},Firefox:{en:"Firefox"},Chrome:{en:"Chrome"},Safari:{en:"Safari"}},this.agent=e,this.init();var n=(e=this.info).browser,t=e.browserVersion,e=e.osVersion;this.info=r(r({},this.info),{engine:this.getEngine(),browserVersion:"Safari"===n?e:t})}u.prototype.init=function(){var t;"undefined"!=typeof window&&(t={},document.cookie.split(/;\s/).forEach(function(e){var n=(e=e.split(/=/))[0],e=e[1];t[n]=e}),this.cookies=t)},u.prototype.getItem=function(e){return this.cookies[e]},u.prototype.getAllItems=function(){return this.cookies},u.prototype.setItem=function(e,n,t,o,r,i){document.cookie="".concat(e,"=").concat(n).concat(t?"; expires=".concat(t):"").concat(o?"; path=".concat(o):"").concat(r?"; domain=".concat(r):"").concat(i?"; secure":"")};var c=u;function u(){this.cookies={},this.init()}function d(e,n){var t=i(i([],n||[],!0),["_"],!1).join("|");return e.replace(new RegExp("((".concat(t,")[a-z])+"),"g"),function(e,n){return n.replace(new RegExp(t),"").toLocaleUpperCase()})}function f(e){return e.replace(/(-\w)/g,function(e){return e.substr(1,1).toUpperCase()}).replace(/^(\w)/,function(e){return e.toUpperCase()})}e.countDown=function e(n,t,o,r){if(!window)throw new Error("window is not defined.");if(0<n)return r&&r(),n--,window[t]=window.setTimeout(function(){e(n,t,o,r)},1e3),function(){return clearTimeout(window[t])};clearTimeout(window[t]),o&&o()},e.createRandomID=function(e){void 0===e&&(e=12);for(var n=[],t="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),o=t.length,r=0;r<e;r++)n.push(t[Math.round(Math.random()*o)]);return n.join("")},e.dCookie=function(){return new c},e.debounce=function(o,r,i){var s;return void 0===r&&(r=0),void 0===i&&(i=!1),function(){for(var e=this,n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];i?o.apply(this,n):(clearTimeout(s),s=setTimeout(function(){o.apply(e,n)},r))}},e.debounceDecorator=function(r,i){var s;return function(e,n,t){var o=t.value;return t.value=function(){for(var e=this,n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];i?o.apply(this,n):(clearTimeout(s),s=setTimeout(function(){o.apply(e,n)},r))},t}},e.debugWarn=function(e,n){console.warn("[".concat(e,"]: ").concat(n))},e.deepCopy=function e(n){if(l(n)||Array.isArray(n)){var t,o=Array.isArray(n)?[]:{};for(t in n)o[t]=e(n[t]);return o}return n},e.deleteArrayItems=function(n,e,t){return"object"==typeof e[0]?e.filter(function(e){return!n.includes(e[t])}):e.filter(function(e){return!n.includes(e)})},e.formatQueryParams=function(e){if(!(e=null==(e=/\?(?<params>(.*)=.+)/.exec(decodeURIComponent(e)))?void 0:e.groups))return{};for(var n=e.params.split("&"),o={},t=0;t<n.length;t++)n[t].replace(/([^?&]*)=([^?&]*)/,function(e,n,t){return o[n]=t,e});return o},e.formatThousandth=function(e){var n=(e="".concat(e).split("."))[0],e=void 0===(e=e[1])?"":e,n=n.replace(/\d{1,3}(?=(\d{3})+$)/g,"$&,");return"".concat(n).concat(e?".".concat(e):"")},e.generateTree=function e(n,t,o,r){for(var i=[],s=0;s<n.length;s++){var a=n[s];a[o]===t&&(i.push(a),a.children=e(n,a[null!=r?r:"id"],o,r))}return i},e.isBoolean=function(e){return"boolean"==typeof e},e.isEmpty=function(e){return Array.isArray(e)?0===e.length:l(e)?0===Object.keys(e).length:["[object Set]","[object Map]"].includes(o(e))?0===e.size:[null,void 0,""].includes(e)},e.isFloatNumber=t,e.isFunction=function(e){return"[object Function]"===o(e)},e.isImageUrl=function(e){return/\.((png)|(jpe?g)|(gif)|(svg)|(webp))$/gi.test(e)},e.isInteger=n,e.isNumber=function(e){return n(e)||t(e)},e.isObject=l,e.isPromise=function(e){return"[object Promise]"===o(e)},e.isRegexp=function(e){return"[object RegExp]"===o(e)},e.objectKeyToCamelCase=function e(n,t,o){if(Array.isArray(n))for(var r=[],i=0;i<n.length;i++)r[i]=e(t&&n[i][t]?n[i][t]:n[i],t,o);else if(l(n))for(var r={},s=t&&n[t]?n[t]:n,a=0,c=Object.entries(s);a<c.length;a++){var u=(f=c[a])[0],f=f[1];Array.isArray(f)||l(s)?r[d(u,o)]=e(f,t,o):r[d(u,o)]=f}else r=n;return r},e.pickLastItem=function(e){return e[e.length-1]},e.realType=o,e.searchParams=function(e,n){return void 0===e&&(e=null==location?void 0:location.search),new URLSearchParams(e).get(n)},e.throwError=function(e,n){throw"[".concat(f(e),"]: ").concat(n)},e.toBoolean=function(e){return"true"===e||"false"!==e&&Boolean(e)},e.toLowerCamelCase=d,e.toPascalCase=f,e.toUnderline=function(e){return e.replace(/([A-Z])/g,function(e){return"_".concat(e.toLocaleLowerCase())})},e.ua=function(e){return void 0===e&&(e=navigator.userAgent),new s(e).info}})(exports)}},__webpack_module_cache__={};function __webpack_require__(moduleId){var cachedModule=__webpack_module_cache__[moduleId];return void 0!==cachedModule||(cachedModule=__webpack_module_cache__[moduleId]={id:moduleId,exports:{}},__webpack_modules__[moduleId].call(cachedModule.exports,cachedModule,cachedModule.exports,__webpack_require__)),cachedModule.exports}__webpack_require__.amdO={},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function(){return module.default}:function(){return module};return __webpack_require__.d(getter,{a:getter}),getter},__webpack_require__.d=function(exports,definition){for(var key in definition)__webpack_require__.o(definition,key)&&!__webpack_require__.o(exports,key)&&Object.defineProperty(exports,key,{enumerable:!0,get:definition[key]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=function(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)};{var external_Swal_namespaceObject=Swal,external_Swal_default=__webpack_require__.n(external_Swal_namespaceObject),external_Swal_namespaceObject=Cookies,external_Cookies_default=__webpack_require__.n(external_Swal_namespaceObject),external_Swal_namespaceObject=__webpack_require__(675),javascript_utils_umd_min=__webpack_require__(991);let httpRequest=async(options,times=0)=>{window.TRACE&&console.trace("%cAuto-Task[Debug]:","color:blue");try{var result=await new Promise(resolve=>{options.dataType&&(options.responseType=options.dataType);var requestObj={timeout:3e4,ontimeout(data){resolve({result:"Error",statusText:"Timeout",status:601,data:data,options:options})},onabort(){resolve({result:"Error",statusText:"Aborted",status:602,data:void 0,options:options})},onerror(data){resolve({result:"Error",statusText:"Error",status:603,data:data,options:options})},onload(data){let headers={};if(data.responseHeaders?.split("\n").forEach(header=>{var header=header.trim().split(":"),name=header.shift()?.trim()||"",header=header.join(":").trim();name&&header&&(headers[name]?Array.isArray(headers[name])?headers[name].push(header):headers[name]=[headers[name],header]:headers[name]=header)}),headers["set-cookie"]&&!Array.isArray(headers["set-cookie"])&&(headers["set-cookie"]=[headers["set-cookie"]]),data.responseHeadersText=data.responseHeaders,data.responseHeaders=headers,data.finalUrl=data.responseHeaders?.location||data.finalUrl,"json"===options.responseType&&data?.response&&"object"!=typeof data.response)try{data.response=JSON.parse(data.responseText)}catch(error){}resolve({result:"Success",statusText:"Load",status:600,data:data,options:options})},...options};GM_xmlhttpRequest(requestObj)});return window.DEBUG&&console.log("%cAuto-Task[httpRequest]:","color:blue",JSON.stringify(result)),600!==result.status&&times<2?await httpRequest(options,times+1):result}catch(error){return console.log("%cAuto-Task[httpRequest]:","color:red",JSON.stringify({errorMsg:error,options:options})),throwError(error,"httpRequest"),{result:"JsError",statusText:"Error",status:604,error:error,options:options}}},tools_httpRequest=httpRequest,scripts_echoLog=({type,text,html,id})=>{let emptyStatus={success:()=>emptyStatus,error:()=>emptyStatus,warning:()=>emptyStatus,info:()=>emptyStatus,view:()=>emptyStatus};try{let ele;if(type)switch(type){case"joiningSteamGroup":case"leavingSteamGroup":case"gettingSteamGroupId":ele=$(`<li>${i18n(type)}[<a href="https://steamcommunity.com/groups/${text}" target="_blank">${text}</a>]...<font></font></li>`);break;case"joiningSteamOfficialGroup":case"leavingSteamOfficialGroup":case"gettingSteamOfficialGroupId":ele=$(`<li>${i18n(type)}[<a href="https://steamcommunity.com/games/${text}" target="_blank">${text}</a>]...<font></font></li>`);break;case"subscribingForum":case"unsubscribingForum":case"gettingForumId":ele=$(`<li>${i18n(type)}[<a href="https://steamcommunity.com/app/${text}/discussions/" target="_blank">${text}</a>]...<font></font></li>`);break;case"followingCurator":case"unfollowingCurator":case"gettingCuratorId":ele=$(`<li>${i18n(type)}[<a href="https://store.steampowered.com/${text?.includes("/")?text:"curator/"+text}" target="_blank">${text}</a>]...<font></font></li>`);break;case"addingToWishlist":case"removingFromWishlist":case"followingGame":case"unfollowingGame":case"gettingSubid":case"addingFreeLicense":case"requestingPlayTestAccess":ele=$(`<li>${i18n(type)}[<a href="https://store.steampowered.com/app/${text}" target="_blank">${text}</a>]...<font></font></li>`);break;case"addingFreeLicenseSubid":ele=$(`<li>${i18n("addingFreeLicense")}[<a href="https://steamdb.info/sub/${text}/" target="_blank">${text}</a>]...<font></font></li>`);break;case"favoritingWorkshop":case"unfavoritingWorkshop":case"gettingWorkshopAppId":case"votingUpWorkshop":ele=$(`<li>${i18n(type)}[<a href="https://steamcommunity.com/sharedfiles/filedetails/?id=${text}" target="_blank">
      ${text}</a>]...<font></font></li>`);break;case"gettingAnnouncementParams":case"likingAnnouncement":ele=$(`<li>${i18n(type)}[<a href="https://store.steampowered.com/news/app/${text}/view/${id}" target="_blank">
      ${id}</a>]...<font></font></li>`);break;case"joiningDiscordServer":case"gettingDiscordGuild":ele=$(`<li>${i18n(type)}[<a href="https://discord.com/invite/${text}" target="_blank">${text}</a>]...<font></font></li>`);break;case"leavingDiscordServer":ele=$(`<li>${i18n(type)}[<a href="https://discord.com/channels/@me/${text}" target="_blank">${text}</a>]...<font></font></li>`);break;case"updateDiscordAuth":ele=$(`<li style="color:red;">${i18n("updateDiscordAuth")}</li>`);break;case"followingTwitchChannel":case"unfollowingTwitchChannel":case"gettingTwitchChannelId":ele=$(`<li>${i18n(type)}[<a href="https://www.twitch.tv/${text}" target="_blank">${text}</a>]...<font></font></li>`);break;case"gettingInsUserId":case"followingIns":case"unfollowingIns":ele=$(`<li>${i18n(type)}[<a href="https://www.instagram.com/${text}/" target="_blank">${text}</a>]...<font></font></li>`);break;case"gettingTwitterUserId":case"followingTwitterUser":case"unfollowingTwitterUser":ele=$(`<li>${i18n(type)}[<a href="https://x.com/${text}" target="_blank">${text}</a>]...<font></font></li>`);break;case"retweetting":case"unretweetting":ele=$(`<li>${i18n(type)}${text}...<font></font></li>`);break;case"joiningReddit":case"leavingReddit":ele=$(`<li>${i18n(type)}[<a href="https://www.reddit.com/r/${text}/" target="_blank">${text}</a>]...<font></font></li>`);break;case"followingRedditUser":case"unfollowingRedditUser":ele=$(`<li>${i18n(type)}[<a href="https://www.reddit.com/user/${text?.replace("u_","")}" target="_blank">
      ${text?.replace("u_","")}</a>]...<font></font></li>`);break;case"followingYtbChannel":case"unfollowingYtbChannel":ele=$(`<li>${i18n(type)}[<a href="https://www.youtube.com/channel/${text}" target="_blank">${text}</a>]...<font></font></li>`);break;case"likingYtbVideo":case"unlikingYtbVideo":ele=$(`<li>${i18n(type)}[<a href="https://www.youtube.com/watch?v=${text}" target="_blank">${text}</a>]...<font></font></li>`);break;case"gettingVkId":case"joiningVkGroup":case"leavingVkGroup":case"joiningVkPublic":case"leavingVkPublic":case"sendingVkWall":case"deletingVkWall":ele=$(`<li>${i18n(type)}[<a href="https://vk.com/${text}/" target="_blank">${text}</a>]...<font></font></li>`);break;case"visitingLink":ele=$(`<li>${i18n("visitingLink")}[<a href="${text}" target="_blank">${text}</a>]...<font></font></li>`);break;case"verifyingInsAuth":case"text":ele=$(`<li>${i18n(text)}<font></font></li>`);break;case"html":ele=$(text||html);break;case"whiteList":ele=$(`<li><font class="warning">${i18n("skipTask")}[${text}(${id})](${i18n("whiteList")})</font></li>`);break;case"globalOptionsSkip":ele=$(`<li>${i18n("skipTaskOption")}<font class="warning">${text}</font></li>`);break;default:ele=$(`<li>${i18n("unKnown")}:${type}(${text})...<font></font></li>`)}else ele=text?$(`<li>${i18n(text)}<font></font></li>`):html?$(html):$("<li><font></font></li>");return ele.addClass("card-text"),$("#auto-task-info").append(ele),ele[0]?.scrollIntoView(),{font:ele.find("font"),success(text="Success",html=!1){return this.font?.attr("class","").addClass("success"),html?this.font?.html(text):this.font?.text(text),this},error(text="Error",html=!1){return this.font?.attr("class","").addClass("error"),html?this.font?.html(text):this.font?.text(text),this},warning(text="Warning",html=!1){return this.font?.attr("class","").addClass("warning"),html?this.font?.html(text):this.font?.text(text),this},info(text="Info",html=!1){return this.font?.attr("class","").addClass("info"),html?this.font?.html(text):this.font?.text(text),this},view(){return this.font?.[0].scrollIntoView(),this}}}catch(error){return throwError(error,"echoLog"),emptyStatus}},unique=array=>{try{return[...new Set(array)]}catch(error){return throwError(error,"unique"),[]}},delay=(time=1e3)=>new Promise(resolve=>{setTimeout(()=>{resolve(!0)},time)}),getRedirectLink=async link=>{try{if(!link)return null;let redirectLinksCache=GM_getValue("redirectLinks")||{};return redirectLinksCache[link],await tools_httpRequest({url:link,method:"GET"}).then(({data})=>data?.finalUrl?(redirectLinksCache[link]=data.finalUrl,GM_setValue("redirectLinks",redirectLinksCache),data.finalUrl):null)}catch(error){return throwError(error,"getRedirectLink"),null}},visitLink=async(link,options)=>{try{let logStatus=scripts_echoLog({type:"visitLink",text:link});return await tools_httpRequest({url:link,method:"GET",...options}).then(({result,statusText,status})=>"Success"===result?(logStatus.success(),!0):(logStatus.error(result+`:${statusText}(${status})`),!1))}catch(error){return throwError(error,"visitLink"),!1}},stringToColour=str=>{try{let hash=0;for(let i=0;i<str.length;i++)hash=str.charCodeAt(i)+((hash<<5)-hash);let colour="#";for(let i=0;i<3;i++){var value=hash>>8*i&255;colour+=("00"+value.toString(16)).slice(-2)}return colour}catch(error){return throwError(error,"stringToColour"),"#fff"}},debug=(log,data)=>{window.DEBUG&&(console.log("%c%s","color:#a7a7a7","Auto-Task[Debug]: "+log),data)&&console.log("%c%s","color:#a7a7a7","Auto-Task[Debug]: ",data)},defaultGlobalOptions={doTask:{discord:{servers:!0},instagram:{users:!0},twitch:{channels:!0},twitter:{users:!0,retweets:!0},vk:{names:!0},youtube:{channels:!0,likes:!0},reddit:{reddits:!0},steam:{groups:!0,officialGroups:!0,wishlists:!0,follows:!0,forums:!0,workshops:!0,curators:!0,workshopVotes:!0,announcements:!0,licenses:!0,playtests:!0}},undoTask:{discord:{servers:!0},instagram:{users:!0},twitch:{channels:!0},twitter:{users:!0,retweets:!0},vk:{names:!0},youtube:{channels:!0,likes:!0},reddit:{reddits:!0},steam:{groups:!0,officialGroups:!0,wishlists:!0,follows:!0,forums:!0,workshops:!0,curators:!0}},ASF:{AsfEnabled:!1,AsfIpcUrl:"",AsfIpcPassword:"",AsfBotname:"asf"},position:{buttonSideX:"right",buttonSideY:"top",buttonDistance:"15,30",showButtonSideX:"right",showButtonSideY:"top",showButtonDistance:"15,30",logSideX:"right",logSideY:"bottom",logDistance:"10,10"},hotKey:{doTaskKey:"alt + d",undoTaskKey:"alt + u",toggleLogKey:"alt + l"},other:{twitterVerifyId:"783214",youtubeVerifyChannel:"UCrXUsMBcfTVqwAS7DKg9C0Q",autoUpdateSource:"jsdelivr",language:"zh",checkLogin:!0,checkLeftKey:!0,defaultShowButton:!0,defaultShowLog:!0,debug:!1,receivePreview:!0}};var userDefinedGlobalOptions=GM_getValue("globalOptions")||{};let assignObject=(obj1,obj2)=>{try{var key,value,newObj={};for([key,value]of Object.entries(obj1))"[object Object]"===Object.prototype.toString.call(value)&&"[object Object]"===Object.prototype.toString.call(obj2[key])?newObj[key]=assignObject(value,obj2[key]):newObj[key]=obj2[key]??value;return newObj}catch(error){return throwError(error,"assignObject"),defaultGlobalOptions}},globalOptions=assignObject(defaultGlobalOptions,userDefinedGlobalOptions),saveData=()=>{try{let data={};$("#globalOptionsForm").serializeArray().map(value=>(data[value.name]=value.value,value)),$.makeArray($("#globalOptionsForm input")).map(element=>{var name=$(element).attr("name"),keys=name.split(".");return 3===keys.length?globalOptions[keys[0]][keys[1]][keys[2]]=data[name]?"on"===data[name]||data[name]:data[name]??!1:2===keys.length&&(globalOptions[keys[0]][keys[1]]=data[name]?"on"===data[name]||data[name]:data[name]??!1),element}),GM_setValue("globalOptions",globalOptions),external_Swal_default().fire({title:i18n("changeGlobalOptionsSuccess"),icon:"success"})}catch(error){throwError(error,"saveData")}},changeGlobalOptions=showType=>{try{let globalOptionsForm=`<form id="globalOptionsForm" class="auto-task-form">
      <table class="auto-task-table"><thead><tr><td>${i18n("type")}</td><td>${i18n("option")}</td><td>${i18n("value")}</td></tr></thead><tbody>`;for(let[type,data1]of Object.entries(globalOptions))for(var[option,data2]of Object.entries(data1))if(["other","position","hotKey","ASF"].includes(type))"boolean"==typeof data2?globalOptionsForm+=`<tr style="background-color: ${stringToColour(type)}44">${0===Object.keys(data1).indexOf(option)?`<th rowspan="${Object.keys(data1).length}">${i18n(type)}</th>`:""}<td>${i18n(option)}</td><td><label><input type="checkbox" name="${type}.${option}"${data2?' checked="checked"':""}/><span><i></i></span></label></td></tr>`:globalOptionsForm+=`<tr style="background-color: ${stringToColour(type)}44">${0===Object.keys(data1).indexOf(option)?`<th rowspan="${Object.keys(data1).length}" style="background-color: ${stringToColour(type)}66">${i18n(type)}</th>`:""}<td>${i18n(option)}</td><td><input class="editOption" type="text" name="${type}.${option}" value="${data2}"/></td></tr>`;else for(var[socialType,data3]of Object.entries(data2))globalOptionsForm+=`<tr style="background-color: ${stringToColour(option)}66">${0===Object.keys(data1).indexOf(option)?`<th rowspan="${Object.keys(data1).map(key=>Object.keys(data1[key]).length).reduce((acr,cur)=>acr+cur)}" style="background-color: ${stringToColour(type)}66">${i18n(type)}</th>`:""}<td>${option}.${i18n(socialType)}</td><td><label><input type="checkbox" name="${type}.${option}.${socialType}"${data3?' checked="checked"':""}/><span><i></i></span></label></td></tr>`;globalOptionsForm+="</tbody></table></form>","swal"===showType?external_Swal_default().fire({title:i18n("globalOptions"),html:globalOptionsForm,showConfirmButton:!0,confirmButtonText:i18n("save"),showCancelButton:!0,cancelButtonText:i18n("close")}).then(({isConfirmed})=>{isConfirmed&&saveData()}):$("body").append(`<h2>${i18n("globalOptions")}</h2>`+globalOptionsForm)}catch(error){throwError(error,"changeGlobalOptions")}},languages={zh:{website:"网站",type:"类型",edit:"编辑",whiteList:"白名单",skipTask:"跳过撤销任务",whiteListOptions:"白名单设置",changeWhiteListOption:"设置白名单(%0)",whiteListNotFound:"找不到此项白名单: %0",changeWhiteListSuccess:"白名单修改成功，刷新生效！",changeWebsiteOptions:"网站设置",changeGlobalOptions:"全局设置",ok:"是",save:"保存",close:"关闭",return:"返回",option:"选项",value:"值",websiteOptions:"当前网站设置",changeWebsiteOptionsSuccess:"更改当前网站设置成功，刷新生效！",changeGlobalOptionsSuccess:"更改全局设置成功，刷新生效！",needLogin:"请先登录！",getTasksInfo:"正在获取并处理任务信息...",gettingKey:"正在获取Key...",verifyingTask:"正在验证任务",notice:"自动任务脚本提醒",noKeysLeft:"此页面已经没有剩余key了，是否关闭？",giveawayEnded:"此活动已结束，是否关闭？",giveawayNotWork:"此活动因某些原因(已结束/暂停/未开始...)不可用(如果是脚本误判请及时反馈)，是否关闭？",confirm:"确定",cancel:"取消",unKnown:"未知",unKnownTaskType:"未识别的任务",doing:"正在做任务",allTasksComplete:"所有任务已完成！",getTaskIdFailed:"获取任务Id失败！",initSuccess:"%0 初始化成功！",initFailed:"%0 初始化失败！",errorLink:"链接错误: %0",needInit:"请先初始化",verifyingAuth:"正在验证%0凭证...",updatingAuth:"正在更新%0凭证...",refreshingToken:"正在刷新%0凭证...",settingToken:"正在设置%0凭证...",steamStoreTab:"Steam商店(弹窗)",steamCommunityTab:"Steam社区(弹窗)",initing:"正在初始化...",getFailed:"获取%0失败！",checkLoginFailed:"检测登录状态失败！",checkLeftKeyFailed:"检测剩余Key失败！",userId:"用户Id",joiningGiveaway:"正在加入赠Key",needJoinGiveaway:"需要先加入赠Key",cannotUndo:"此网站不支持取消任务",verifyAuth:"正在验证 %0 凭证...",closePageNotice:"如果此页面没有自动关闭，请自行关闭本页面。",errorReport:"检测到脚本报错，是否前往反馈BUG？",visitingLink:"正在访问链接...",doTask:"做任务",undoTask:"撤销任务",verifyTask:"验证任务",getKey:"获取Key",selectAll:"全选",selectNone:"全不选",invertSelect:"反选",doFreeTask:"加入免费赠品",doPointTask:"加入点数赠品",skipTaskOption:"设置中已配置跳过任务",other:"其他",globalOptions:"全局设置",checkLogin:"登录检测</br>需要登录的网站自动登录，部分网站支持",checkLeftKey:"剩余Key检测</br>赠Key活动结束提示是否关闭，部分网站支持",twitterVerifyId:"通过尝试关注该账号验证Twitter凭证</br>默认为Twitter官方帐号 783214</br>不想关注官方账号可以改为自己的帐号",youtubeVerifyChannel:"通过尝试订阅该频道验证YouTube凭证</br>默认为YouTube官方频道 UCrXUsMBcfTVqwAS7DKg9C0Q</br>不想关注官方频道可以改为自己的频道",autoUpdateSource:"更新源</br>github: 需代理，实时更新</br>jsdelivr: 可不用代理，更新有延迟</br>standby: 备用</br>auto: 依次使用github, jsdelivr, standby源进行尝试更新",saveGlobalOptions:"保存设置",settingPage:"设置页面",name:"名称",version:"版本",scriptManager:"脚本管理器",script:"脚本",environment:"环境",os:"系统",browser:"浏览器",getId:"获取 %0 id",getTwitterUserId:"获取Twitter用户id(获取id功能仅在设置页面可用)",getYoutubeChannelId:"获取Youtube频道id(获取id功能仅在设置页面可用)",showButton:"显示按钮",hideButton:"隐藏按钮",showLog:"显示日志",hideLog:"隐藏日志",defaultShowButton:"默认显示按钮",defaultShowLog:"默认显示日志",debug:"输出调试日志，不要开启此选项！",receivePreview:"接收预览版更新",position:"组件位置",buttonSideX:"按钮区域水平方向定位(实时预览功能仅在设置页面可用)</br>left: 靠左 | right: 靠右",buttonSideY:"按钮区域垂直方向定位(实时预览功能仅在设置页面可用)</br>top: 靠上 | bottom: 靠下",buttonDistance:"按钮区域距边缘的距离(实时预览功能仅在设置页面可用)</br>格式: X距离,Y距离",showButtonSideX:"显示按钮水平方向定位(实时预览功能仅在设置页面可用)</br>left: 靠左 | right: 靠右",showButtonSideY:"显示按钮垂直方向定位(实时预览功能仅在设置页面可用)</br>top: 靠上 | bottom: 靠下",showButtonDistance:"显示按钮距边缘的距离(实时预览功能仅在设置页面可用)</br>格式: X距离,Y距离",logSideX:"日志区域水平方向定位(实时预览功能仅在设置页面可用)</br>left: 靠左 | right: 靠右",logSideY:"日志区域垂直方向定位(实时预览功能仅在设置页面可用)</br>top: 靠上 | bottom: 靠下",logDistance:"日志区域距边缘的距离(实时预览功能仅在设置页面可用)</br>格式: X距离,Y距离",hotKey:"快捷键",doTaskKey:"做任务快捷键</br>(实时预览功能仅在设置页面可用)",undoTaskKey:"撤销任务快捷键</br>(实时预览功能仅在设置页面可用)",toggleLogKey:"显示/隐藏日志快捷键</br>(实时预览功能仅在设置页面可用)",tasksHistory:"任务历史",clearHistory:"清空历史",clearHistoryFinished:"已清空任务历史！",deleteTask:"删除任务",lastChangeTime:"最后一次修改时间",clearTaskFinished:"删除以下任务完成！",clearTaskFailed:"删除任务失败，没有找到任务名！",syncData:"数据同步",settingData:"正在上传数据...",gettingData:"正在获取数据...",help:"帮助",fileName:"文件名",upload2gist:"同步到Gist",downloadFromGist:"从Gist同步",saveAndTest:"保存配置并测试",testSuccess:"测试成功！",testFailed:"测试失败！",saveAndTestNotice:"请先保存配置并测试！",processingData:"正在处理数据...",updatingData:"正在上传数据...",syncDataSuccess:"同步数据成功！",syncDataFailed:"同步数据失败，请在控制台查看错误信息！",downloadingData:"正在下载数据...",checkedNoData:"没有检测到远程数据，请确认配置是否正确！",savingData:"正在保存数据...",syncHistory:"同步任务历史",checkUpdateFailed:"检测更新失败",newVersionNotice:'检测到新版本V%0, <a class="high-light" href="%1" target="_blank">点此更新</a>',language:"语言</br>目前仅支持zh: 中文, en: 英文",gistOptions:"Gist 设置",swalNotice:"检测到您第一次安装V4版本脚本，请前往阅读用前必读内容！",echoNotice:'检测到您第一次安装V4版本脚本，请<a class="high-light" href="%0" target="_blank">点此前往</a>阅读用前必读内容！',noticeLink:"https://auto-task-doc.js.org/guide/#用前必读",toGithub:"前往Github反馈",toKeylol:"前往其乐论坛反馈",copySuccess:"错误信息已复制到剪切板，是否前往其乐论坛反馈？",copyFailed:"请复制下方错误信息后前往Keylol论坛反馈！",updateText:"%0 版本更新内容：",Active:"进行中",Ended:"已结束",Banned:"已封禁",Paused:"已暂停",notStart:"未开始",noRemoteData:"检测到远程无数据",errorRemoteDataFormat:"远程数据格式错误",updateHistory:'历史更新记录<a class="high-light" href="https://auto-task-doc.js.org/logs/" target="_blank">点此查看</a>',AsfEnabled:'使用ASF做Steam相关任务(需<a href="https://github.com/chr233/ASFEnhance" target="_blank">ASFEnhance</a>插件)',AsfIpcUrl:"ASF IPC 地址",AsfIpcPassword:"ASF IPC 密码",versionNotMatched:"脚本管理器版本过低，需TamperMonkey >= 5.2.0或TamperMonkey Beta >= 5.2.6196",groups:"组",officialGroups:"官方组",wishlists:"愿望单",follows:"游戏关注",forums:"论坛",workshops:"创意工坊收藏",curators:"鉴赏家",workshopVotes:"创意工坊点赞",announcements:"社区通知",steamCommunity:"Steam社区",steamStore:"Steam商店",licenses:"入库免费游戏",playtests:"请求访问权限",needLoginSteamStore:'请先<a href="https://store.steampowered.com/login/" target="_blank">登录Steam商店</a>',needLoginSteamCommunity:'请先<a href="https://steamcommunity.com/login/home/" target="_blank">登录Steam社区</a>',joiningSteamGroup:"正在加入Steam组",leavingSteamGroup:"正在退出Steam组",gettingSteamGroupId:"正在获取Steam组Id",joiningSteamOfficialGroup:"正在加入Steam官方组",leavingSteamOfficialGroup:"正在退出Steam官方组",gettingSteamOfficialGroupId:"正在获取Steam官方组Id",subscribingForum:"正在订阅Steam论坛",unsubscribingForum:"正在取消订阅Steam论坛",gettingForumId:"正在获取Steam论坛Id",followingCurator:"正在关注Steam鉴赏家",unfollowingCurator:"正在取关Steam鉴赏家",gettingCuratorId:"正在获取Steam鉴赏家Id",addingToWishlist:"正在添加游戏到Steam愿望单",removingFromWishlist:"正在从Steam愿望单移除游戏",followingGame:"正在关注Steam游戏",unfollowingGame:"正在取关Steam游戏",favoritingWorkshop:"正在收藏Steam创意工坊物品",unfavoritingWorkshop:"正在取消收藏Steam创意工坊物品",gettingWorkshopAppId:"正在获取Steam创意工坊物品Id",votingUpWorkshop:"正在点赞Steam创意工坊物品",gettingAnnouncementParams:"正在获取Steam通知信息",likingAnnouncement:"正在点赞Steam通知",changingArea:"正在更换Steam地区: %0...",notNeededChangeArea:"当前地区不需要更换",noAnotherArea:"请检测是否开启正确开启代理",gettingAreaInfo:"正在获取Steam地区信息...",changeAreaNotice:"疑似锁区游戏，尝试换区执行",steamFinishNotice:"Steam任务完成，尝试将购物车地区换回",gettingSubid:"正在获取游戏subid",addingFreeLicense:"正在入库",missParams:"缺少参数",gettingLicenses:"正在获取Licenses...",requestingPlayTestAccess:"正在请求访问权限",tryChangeAreaNotice:"此功能无法检测游戏是否限区，因此会尝试换区后再入库，换区失败也不影响后续入库",gettingUserLink:"正在获取Steam用户社区链接...",retry:"重试",owned:"已拥有",redirect:"重定向",noSubid:"无法获取，跳过",initingASF:"正在初始化ASF...",servers:"服务器",joiningDiscordServer:"正在加入Discord服务器",leavingDiscordServer:"正在退出Discord服务器",gettingDiscordGuild:"正在获取Discord服务器Id",getDiscordAuthFailed:"获取Discord凭证失败，请检测Discord帐号是否已登录",discordImportantNotice:"重要提醒！！！",discordImportantNoticeText:"由于Discord网站后台更新，目前使用此脚本加组后可能会导致Discord帐号被强制退出，且需要两步验证才能正常登录，请谨慎使用！！！",continue:"继续",skipDiscordTask:"跳过Discord任务",continueAndDontRemindAgain:"继续且不再提醒",users:"用户",loginIns:'请先<a href="https://www.instagram.com/accounts/login/" target="_blank">登录Instagram</a>',insBanned:"您的Instagram账户已被封禁",verifyingInsAuth:"正在验证Instagram凭证...",gettingInsUserId:"正在获取Instagram用户Id",followingIns:"正在关注Instagram用户",unfollowingIns:"正在取关Instagram用户",reddits:"社区/用户",loginReddit:'请先<a href="https://www.reddit.com/login/" target="_blank">登录Reddit</a>',changingRedditVersion:"正在切换Reddit为新版页面...",joiningReddit:"正在加入Reddit社区",leavingReddit:"正在退出Reddit社区",followingRedditUser:"正在关注Reddit用户",unfollowingRedditUser:"正在取关Reddit用户",channels:"频道",followingTwitchChannel:"正在关注Twitch频道",unfollowingTwitchChannel:"正在取关Twitch频道",gettingTwitchChannelId:"正在获取Twitch频道Id",checkingTwitchIntegrity:"正在检查Twitch完整性...",twitterUser:"推特用户",retweets:"转推",gettingTwitterUserId:"正在获取推特用户Id",followingTwitterUser:"正在关注推特用户",unfollowingTwitterUser:"正在取关推特用户",retweetting:"正在转推",unretweetting:"正在撤销转推",names:"组/社区/动态",loginVk:'请先<a href="https://vk.com/login/" target="_blank">登录Vk</a>',gettingVkId:"正在获取Vk任务Id",joiningVkGroup:"正在加入Vk组",leavingVkGroup:"正在退出Vk组",joiningVkPublic:"正在加入Vk社区",leavingVkPublic:"正在退出Vk社区",sendingVkWall:"正在转发Vk动态",deletingVkWall:"正在撤销转发Vk动态",youtubeChannel:"YouTube频道",likes:"点赞",loginYtb:'请先<a href="https://accounts.google.com/ServiceLogin?service=youtube" target="_blank">登录YouTube</a>',tryUpdateYtbAuth:'请尝试<a href="https://www.youtube.com/#auth" target="_blank">更新YouTube凭证</a>',gettingYtbToken:"正在获取YouTube Token...",followingYtbChannel:"正在订阅YouTube频道",unfollowingYtbChannel:"正在退订YouTube频道",likingYtbVideo:"正在点赞YouTube视频",unlikingYtbVideo:"正在取消点赞YouTube视频",giveKeyNoticeBefore:"每次验证间隔15s",giveKeyNoticeAfter:'如果没有key, 请在<a href="https://givekey.ru/profile" target="_blank">https://givekey.ru/profile</a>查看',noPoints:"点数不够，跳过抽奖",getNeedPointsFailed:"获取所需点数失败，跳过抽奖",joiningLottery:"正在加入抽奖",doingGleamTask:"正在做Gleam任务...",gettingGleamLink:"正在获取Gleam任务链接...",gleamTaskNotice:"如果此页面长时间未关闭，请完成任一任务后自行关闭！",verifiedGleamTasks:"已尝试验证所有任务，验证失败的任务请尝试手动验证或完成！",campaign:"检测到人机验证，请完成验证后重新验证任务！",gsNotice:'为避免得到"0000-0000-0000"key, 已自动屏蔽"Grab Key"按钮，获取key时请关闭脚本！',giveeClubVerifyNotice:"正在验证任务...",giveeClubVerifyFinished:"请等待验证完成后自行加入赠Key",doingKeyhubTask:"正在做Keyhub任务...",SweepWidgetNotice:"正在处理并验证任务，每次验证任务有1~3s间隔防止触发验证过快警告...",tasksNotCompleted:"任务未完成",notConnect:"社交平台未连接，跳过任务",tgTaskNotice:"检测到Telegram任务，需要手动完成",confirmingTask:"正在跳过警告页面..."},en:{website:"Website",type:"Type",edit:"Edit",whiteList:"Whitelist",skipTask:"Skip undo task",whiteListOptions:"Whitelist options",changeWhiteListOption:"Whitelist option(%0)",whiteListNotFound:"Cannot find this whitelist: %0",changeWhiteListSuccess:"The whitelist is successfully modified, and the page refresh will take effect!",changeWebsiteOptions:"Website options",changeGlobalOptions:"Global options",ok:"OK",save:"Save",close:"Close",return:"Return",option:"Option",value:"Value",websiteOptions:"Current website settings",changeWebsiteOptionsSuccess:"The current website setting is changed successfully, and the page refresh will take effect!",changeGlobalOptionsSuccess:"The global setting is changed successfully, and the refresh will take effect!",needLogin:"Please log in first!",getTasksInfo:"Obtaining and processing task information...",gettingKey:"Getting Key...",verifyingTask:"Verifying task",notice:"Automatic task script notice",noKeysLeft:"There are no more keys left on this page. Do you want to close it?",giveawayEnded:"This event has ended, do you want to close it?",giveawayNotWork:"This activity is unavailable for some reasons (banned/ended/paused/not started...) (if it is a script misjudgment, please give us feedback in time), is it closed?",confirm:"Confirm",cancel:"Cancel",unKnown:"Unknown",unKnownTaskType:"Unrecognized task",doing:"Doing a task",allTasksComplete:"All tasks have been completed!",getTaskIdFailed:"Failed to obtain task Id!",initSuccess:"%0 was initialized successfully!",initFailed:"%0 initialization failed!",errorLink:"Link error: %0",needInit:"Please initialize first",verifyingAuth:"Verifying %0 token...",updatingAuth:"Update %0 token...",refreshingToken:"Refreshing %0 token...",settingToken:"Setting %0 token...",steamStoreTab:"Steam store (new tab)",steamCommunityTab:"Steam community(new tab)",initing:"Initializing...",getFailed:"Failed to get %0!",checkLoginFailed:"Failed to detect login status!",checkLeftKeyFailed:"Failed to detect the remaining keys!",userId:"User Id",joiningGiveaway:"Joining giveaway",needJoinGiveaway:"Need to join the giveaway first",cannotUndo:"This website does not support canceling tasks",verifyAuth:"Verifying %0 token...",closePageNotice:"f this page does not close automatically, please close this page yourself.",errorReport:"A script error is detected, do you want to report the BUG?",visitingLink:"Visiting link ...",doTask:"DoTask",undoTask:"UndoTask",verifyTask:"Verify",getKey:"GetKey",selectAll:"SelectAll",selectNone:"SelectNone",invertSelect:"InvertSelect",doFreeTask:"FreeTask",doPointTask:"PointTask",skipTaskOption:"Skip task has been configured in the settings",other:"Other",globalOptions:"Global Options",checkLogin:"Login detection</br>Need to log in to the website automatically log in, part of this website supports.",checkLeftKey:"Key remaining detection</br>The end of the giveaway event prompts whether to close or not, part of this website supports.",twitterVerifyId:"Verify Twitter token by trying to follow the account.</br>The default is the official Twitter account 783214.</br>If you don't want to follow the official account, you can change it to your own account.",youtubeVerifyChannel:"Verify YouTube token by trying to subscribe to the channel.</br>The default is the official YouTube channel UCrXUsMBcfTVqwAS7DKg9C0Q.</br>If you don't want to follow the official channel, you can change it to your own channel.",autoUpdateSource:"The source to update</br>github: Fast update.</br>jsdelivr: Update is delayed.</br>standby: Standby source.</br>auto: Try to update using github, jsdelivr, standby sources in turn.",saveGlobalOptions:"SaveSettings",settingPage:"Setting Page",name:"Name",version:"Version",scriptManager:"Script Manager",script:"Script",environment:"Environment",os:"OS",browser:"Browser",getId:"Get %0 id",getTwitterUserId:"Get Twitter user id (Get id function is only available on the settings page).",getYoutubeChannelId:"Get Youtube channel id (Get id function is only available on the settings page).",showButton:"ShowButton",hideButton:"HideButton",showLog:"ShowLog",hideLog:"HideLog",defaultShowButton:"Default display button",defaultShowLog:"Display log by default",debug:"Output debug log, do not enable this option!",receivePreview:"Receive preview updates",position:"Component position",buttonSideX:"Horizontal positioning of the button area (real-time preview function is only available on the setting page).</br>left: left | right: right",buttonSideY:"The button area is positioned in the vertical direction (real-time preview function is only available on the settings page).</br>top: top | bottom: bottom",buttonDistance:"The distance between the button area and the edge (the real-time preview function is only available on the setting page).</br> Format: X distance, Y distance",showButtonSideX:"ShowButton horizontal positioning (real-time preview function is only available on the setting page).</br>left: left | right: right",showButtonSideY:"ShowButton vertical positioning (real-time preview function is only available on the setting page).</br>top: top | bottom: bottom",showButtonDistance:"The distance between the ShowButton and the edge (real-time preview function is only available on the setting page).</br> Format: X distance, Y distance",logSideX:"Horizontal positioning of the log area (real-time preview function is only available on the setting page).</br>left: left | right: right",logSideY:"Vertical positioning of the log area (real-time preview function is only available on the setting page).</br>top: top | bottom: bottom",logDistance:"The distance between the log area and the edge (the real-time preview function is only available on the setting page).</br> Format: X distance, Y distance",hotKey:"Shortcut key",doTaskKey:"DoTask shortcut keys</br> (real-time preview function is only available on the settings page).",undoTaskKey:"UndoTask shortcut keys</br> (real-time preview function is only available on the settings page).",toggleLogKey:"ShowLog/HideLog shortcut keys</br> (real-time preview function is only available on the settings page).",tasksHistory:"TasksHistory",clearHistory:"Clear history",clearHistoryFinished:"The mission history has been cleared!",deleteTask:"Delete task",lastChangeTime:"Last Change Time",clearTaskFinished:"Delete the following tasks completed!",clearTaskFailed:"Failed to delete the task, the task name was not found!",syncData:"DataSync",settingData:"Uploading data...",gettingData:"Getting data...",help:"Help",fileName:"Filename",upload2gist:"Sync to Gist",downloadFromGist:"Sync from Gist",saveAndTest:"Save configuration and test",testSuccess:"Test success!",testFailed:"Test failed!",saveAndTestNotice:"Please save the configuration and test first!",processingData:"Processing data...",updatingData:"Uploading data...",syncDataSuccess:"Synchronized data successfully!",syncDataFailed:"Failed to synchronize data, please check the error message on the console!",downloadingData:"Downloading data...",checkedNoData:"No remote data is detected, please confirm whether the configuration is correct!",savingData:"Saving data...",syncHistory:"Synchronize tasks history",checkUpdateFailed:"Check update failed",newVersionNotice:'Checked a new version V%0, <a class="high-light" href="%1" target="_blank">click to update</a>',language:"Language</br> Currently only supports zh: Chinese, en: English",gistOptions:"Gist Settings",swalNotice:"It is detected that you are installing the V4 version script for the first time, please go to read the READ ME FIRST content before use!",echoNotice:'It is detected that you are installing the V4 version script for the first time, please <a class="high-light" href="%0" target="_blank">click here</a> to read the READ ME FIRST content before use!',noticeLink:"https://auto-task-doc.js.org/en/guide/#read-me-first",toGithub:"Feedback(Github)",toKeylol:"Feedback(Keylol)",copySuccess:"The error message has been copied to the clipboard. Do you want to go to the Keylol forum to give feedback?",copyFailed:"Please copy the error information below and report back to the Keylol forum!",updateText:"Updates in version %0:",Active:"Active",Ended:"Ended",Banned:"Banned",Paused:"Paused",notStart:"notStart",noRemoteData:"No data remotely",errorRemoteDataFormat:"Remote data has wrong format",updateHistory:'<a class="high-light" href="https://auto-task-doc.js.org/logs/" target="_blank">Click here</a> to view the historical update record.',AsfEnabled:'Use ASF to do Steam related tasks (requires <a href="https://github.com/chr233/ASFEnhance" target="_blank">ASFEnhance</a> plugin)',AsfIpcUrl:"ASF IPC URL",AsfIpcPassword:"ASF IPC Password",groups:"Group",officialGroups:"Official Group",wishlists:"Wishlist",follows:"Follow Game",forums:"Forum",workshops:"Favorite Workshop",curators:"Curator",workshopVotes:"Voteup Workshop",announcements:"Announcement",steamCommunity:"Steam Community",steamStore:"Steam Store",licenses:"Add License",playtests:"Playtest Access",needLoginSteamStore:'Please <a href="https://store.steampowered.com/login/" target="_blank">log in to the Steam Store</a>',needLoginSteamCommunity:'Please <a href="https://steamcommunity.com/login/home/" target="_blank">log in to the Steam Community</a>',joiningSteamGroup:"Joining Steam Group",leavingSteamGroup:"Leaving Steam Group",gettingSteamGroupId:"Getting Steam Group Id",joiningSteamOfficialGroup:"Joining Steam Official Group",leavingSteamOfficialGroup:"Leaving Steam Official Group",gettingSteamOfficialGroupId:"Getting Steam Official Group Id",subscribingForum:"Subscribing the Steam Forum",unsubscribingForum:"Unsubscribing the Steam Forum",gettingForumId:"Getting Steam Forum Id",followingCurator:"Following Steam Curator",unfollowingCurator:"Unfollowing Steam Curator",gettingCuratorId:"Getting Steam Curator Id",addingToWishlist:"Adding the game to the Steam wishlist",removingFromWishlist:"Removing the game from the Steam wishlist",followingGame:"Following Steam games",unfollowingGame:"Unfollowing Steam games",favoritingWorkshop:"Favouring Steam Workshop Items",unfavoritingWorkshop:"Unfavoriting Steam Workshop Items",gettingWorkshopAppId:"Getting Steam Workshop Item Id",votingUpWorkshop:"Liking Steam workshop items",gettingAnnouncementParams:"Getting Steam announcement information",likingAnnouncement:"Liking Steam announcement",changingArea:"Changing Steam area: %0...",notNeededChangeArea:"The current area does not need to be changed",noAnotherArea:"Please check whether the proxy is turned on correctly",gettingAreaInfo:"Getting Steam area information...",changeAreaNotice:"Suspected of a locked zone game, try to change the zone to execute",steamFinishNotice:"Steam task completed, try to change the shopping cart area back to ",gettingSubid:"Getting subid",addingFreeLicense:"Adding free license",missParams:"Missing parameters",gettingLicenses:"Getting licenses...",requestingPlayTestAccess:"Requesting play test access",tryChangeAreaNotice:"This function cannot detect whether the game is limited, so it will try to change the area before entering the library. Failure to change the area will not affect the subsequent storage.",versionNotMatched:"The script manager version is too low, requiring TamperMonkey >= 5.2.0 or TamperMonkey Beta >= 5.2.6196",gettingUserLink:"Getting steam user community link...",retry:"Retry",owned:"Owned",redirect:"Redirect",noSubid:"skip due to unrecognized",initingASF:"Initing ASF...",servers:"Server",joiningDiscordServer:"Joining Discord Server",leavingDiscordServer:"Leaving Discord Server",gettingDiscordGuild:"Getting Discord server Id",getDiscordAuthFailed:"Failed to get Discord token, please check whether the Discord account is logged in",discordImportantNotice:"Important Reminder! ! !",discordImportantNoticeText:"Due to the background update of the Discord website, currently using this script to join a group may cause the Discord account to be forcibly logged out, and two-step verification is required to log in normally, please use it with caution! ! !",continue:"Continue",skipDiscordTask:"Skip",continueAndDontRemindAgain:"Continue without Reminders",users:"User",loginIns:'Please <a href="https://www.instagram.com/accounts/login/" target="_blank">log in to Instagram</a>',insBanned:"Your Instagram account has been banned",verifyingInsAuth:"Verifying Instagram token...",gettingInsUserId:"Getting Instagram user Id",followingIns:"Following Instagram user",unfollowingIns:"Unfollowing Instagram user",reddits:"Reddit/User",loginReddit:'Please <a href="https://www.reddit.com/login/" target="_blank">log in to Reddit</a>',changingRedditVersion:"Switching Reddit to a new version page...",joiningReddit:"Joining the Reddit",leavingReddit:"Leaving the Reddit",followingRedditUser:"Following Reddit User",unfollowingRedditUser:"Unfollowing Reddit User",channels:"Channel",followingTwitchChannel:"Following Twitch Channel",unfollowingTwitchChannel:"Unfollowing Twitch Channel",gettingTwitchChannelId:"Getting Twitch Channel Id",checkingTwitchIntegrity:"Checking Twitch integrity...",twitterUser:"Twitter User",retweets:"Retweet",gettingTwitterUserId:"Getting Twitter User Id",followingTwitterUser:"Following Twitter User",unfollowingTwitterUser:"Unfollowing Twitter User",retweetting:"Retweetting",unretweetting:"Unretweetting",names:"Group/Public/Wall",loginVk:'Please <a href="https://vk.com/login/" target="_blank">log in to Vk</a>',gettingVkId:"Getting Vk task Id",joiningVkGroup:"Joining Vk Group",leavingVkGroup:"Leaving Vk Group",joiningVkPublic:"Joining Vk Public",leavingVkPublic:"Leaving Vk Public",sendingVkWall:"Sending Vk Wall",deletingVkWall:"Deleting Vk Wall",youtubeChannel:"YouTube Channel",likes:"Like",loginYtb:'Please <a href="https://accounts.google.com/ServiceLogin?service=youtube" target="_blank">log in to YouTube</a>',tryUpdateYtbAuth:'Please try to <a href="https://www.youtube.com/#auth" target="_blank">update YouTube token</a>',gettingYtbToken:"Getting YouTube Token...",followingYtbChannel:"Subscribing to YouTube channel",unfollowingYtbChannel:"Unsubscribing to YouTube channel",likingYtbVideo:"Liking YouTube video",unlikingYtbVideo:"Unliking YouTube video",giveKeyNoticeBefore:"Each verification interval is 15s",giveKeyNoticeAfter:'If there is no key, please check at <a href="https://givekey.ru/profile" target="_blank">https://givekey.ru/profile</a>',noPoints:"Not enough points, skip the lottery",getNeedPointsFailed:"ailed to obtain the required points, skip the lottery",joiningLottery:"Joining the lottery",doingGleamTask:"Doing Gleam Task...",gettingGleamLink:"Getting Gleam task link...",gleamTaskNotice:"If this page has not been closed for a long time, please close it yourself after completing any task!",verifiedGleamTasks:"Attempted to verify all tasks. If the verification fails, please try to verify manually or complete it!",campaign:"ReCAPTCHA detected, please complete it and re-verify the tasks!",gsNotice:'In order to avoid getting the "0000-0000-0000" key, the "Grab Key" button has been hidden, please close the script when obtaining the key!',giveeClubVerifyNotice:"Verifying task...",giveeClubVerifyFinished:"Wait for the verification to complete and join it by yourself",doingKeyhubTask:"Doing Keyhub Task...",SweepWidgetNotice:"The task is being processed and verified. There is an interval of 1~3s for each verification task to prevent the triggering of too fast verification warning...",tasksNotCompleted:"Tasks Not Completed",notConnect:"Social platform is not connectted, skip",tgTaskNotice:"The telegram task is checked, need to do it yourself!",confirmingTask:"Confirming task..."}},language=["zh","en"].includes(globalOptions.other.language)?globalOptions.other.language:"en",i18n=(key,...argvs)=>languages[language]?.[key]?languages[language][key].replace(/%([\d]+)/g,(match,index)=>argvs[parseInt(index,10)]):key;function throwError(error,name){window.TRACE&&console.trace("%cAuto-Task[Debug]:","color:blue"),external_Swal_default().fire({title:i18n("errorReport"),icon:"error",showCancelButton:!0,confirmButtonText:i18n("toGithub"),showDenyButton:!0,denyButtonText:i18n("toKeylol"),cancelButtonText:i18n("close")}).then(({isDenied,isConfirmed})=>{isConfirmed?GM_openInTab(`https://github.com/HCLonely/auto-task-v4/issues/new?title=${encodeURIComponent("[BUG] 脚本报错: "+name)}&labels=bug&template=bug_report.yml&website=${encodeURIComponent(window.location.href)}&browser=${encodeURIComponent(JSON.stringify((0,javascript_utils_umd_min.ua)(),null,4))}&manager=${encodeURIComponent(GM_info.scriptHandler+" "+GM_info.version)}&user-script=${encodeURIComponent(GM_info.script.version)}&logs=${encodeURIComponent(error.stack||"null")}&run-logs=`+encodeURIComponent($.makeArray($("#auto-task-info>li")).map(element=>element.innerText).join("\n")),{active:!0}):isDenied&&(isConfirmed=`错误链接: [url=${window.location.href}]${window.location.href}[/url]

环境:

[code]${JSON.stringify((0,javascript_utils_umd_min.ua)(),null,4)}[/code]

脚本管理器: ${GM_info.scriptHandler} ${GM_info.version}
脚本版本: ${GM_info.script.version}

报错信息:
[code]${error.stack}[/code]

执行日志:
[code]${$.makeArray($("#auto-task-info>li")).map(element=>element.innerText).join("\n")}[/code]`,GM_setClipboard(isConfirmed),external_Swal_default().fire({title:i18n("copySuccess"),icon:"success",confirmButtonText:i18n("ok")}).then(()=>{GM_openInTab("https://keylol.com/forum.php?mod=post&action=reply&fid=319&tid=777450",{active:!0})}))}),console.log("%c%s","color:white;background:red",`Auto-Task[Error]: ${name}
`+error.stack)}userDefinedGlobalOptions=class{tasks;getRealParams(name,links,doTask,link2param){try{let realParams=[];return 0<links.length&&(realParams=[...realParams,...links.map(link=>link2param(link)).filter(link=>link)]),!doTask&&0<this.tasks[name].length&&(realParams=[...realParams,...this.tasks[name]]),unique(realParams)}catch(error){return throwError(error,"Social.getRealParams"),[]}}};class Discord extends userDefinedGlobalOptions{tasks;whiteList;#auth=GM_getValue("discordAuth")||{};#cache=GM_getValue("discordCache")||{};#initialized=!1;constructor(){super();var defaultTasksTemplate={servers:[]};this.tasks=defaultTasksTemplate,this.whiteList={...defaultTasksTemplate,...GM_getValue("whiteList")?.discord||{}}}async init(action){try{if(!GM_getValue("dontRemindDiscordAgain"))if(!await external_Swal_default().fire({title:i18n("discordImportantNotice"),text:i18n("discordImportantNoticeText"),showCancelButton:!0,showDenyButton:!0,confirmButtonText:i18n("continue"),cancelButtonText:i18n("skipDiscordTask"),denyButtonText:i18n("continueAndDontRemindAgain")}).then(({isConfirmed,isDenied})=>!!isConfirmed||!!isDenied&&(GM_setValue("dontRemindDiscordAgain",!0),!0)))return this.#initialized=!1,"skip";return GM_getValue("dontRemindDiscordAgain")||"do"===action&&!globalOptions.doTask.discord.servers||"undo"===action&&!globalOptions.undoTask.discord.servers?(this.#initialized=!1,"skip"):!!this.#initialized||(this.#auth.auth?await this.#verifyAuth()||(GM_setValue("discordAuth",{auth:null}),await this.#updateAuth())?(scripts_echoLog({}).success(i18n("initSuccess","Discord")),this.#initialized=!0):(scripts_echoLog({}).error(i18n("initFailed","Discord")),!1):!!await this.#updateAuth()&&(this.#initialized=!0))}catch(error){return throwError(error,"Discord.init"),!1}}async#verifyAuth(){try{var logStatus=scripts_echoLog({text:i18n("verifyingAuth","Discord")}),{result,statusText,status,data}=await tools_httpRequest({url:"https://discord.com/api/v6/users/@me",method:"HEAD",headers:{authorization:this.#auth.auth}});return"Success"===result?200===data?.status?(logStatus.success(),!0):(logStatus.error(`Error:${data?.statusText}(${data?.status})`),!1):(logStatus.error(result+`:${statusText}(${status})`),!1)}catch(error){return throwError(error,"Discord.verifyAuth"),!1}}async#updateAuth(){try{let logStatus=scripts_echoLog({text:i18n("updatingAuth","Discord")});return await new Promise(resolve=>{var newTab=GM_openInTab("https://discord.com/channels/@me",{active:!0,insert:!0,setParent:!0});newTab.name="ATv4_discordAuth",newTab.onclose=async()=>{var auth=GM_getValue("discordAuth")?.auth;auth?(this.#auth={auth:auth},logStatus.success(),resolve(await this.#verifyAuth())):(logStatus.error("Error: Update discord auth failed!"),resolve(!1))}})}catch(error){return throwError(error,"Discord.updateAuth"),!1}}async#joinServer(inviteId){try{var guild,logStatus=scripts_echoLog({type:"joiningDiscordServer",text:inviteId}),{result,statusText,status,data}=await tools_httpRequest({url:"https://discord.com/api/v9/invites/"+inviteId,method:"POST",dataType:"json",headers:{authorization:this.#auth.auth,origin:"https://discord.com",referer:"https://discord.com/invite/"+inviteId}});return"Success"===result&&200===data?.status?(logStatus.success(),(guild=String(data.response?.guild?.id))&&(this.#setCache(inviteId,guild),this.tasks.servers=unique([...this.tasks.servers,inviteId])),!0):(logStatus.error(result+`:${statusText}(${status})`),!1)}catch(error){return throwError(error,"Discord.joinServer"),!1}}async#leaveServer(inviteId){try{if(this.whiteList.servers.includes(inviteId))return scripts_echoLog({type:"whiteList",text:"Discord.leaveServer",id:inviteId}),!0;var guild=await this.#getGuild(inviteId);if(guild){var logStatus=scripts_echoLog({type:"leavingDiscordServer",text:guild}),{result,statusText,status,data}=await tools_httpRequest({url:"https://discord.com/api/v9/users/@me/guilds/"+guild,method:"DELETE",headers:{authorization:this.#auth.auth}});if("Success"===result&&204===data?.status)return logStatus.success(),!0;logStatus.error(result+`:${statusText}(${status})`)}return!1}catch(error){return throwError(error,"Discord.leaveServer"),!1}}async#getGuild(inviteId){try{var logStatus=scripts_echoLog({type:"gettingDiscordGuild",text:inviteId}),guild=this.#cache[inviteId];if(guild)return logStatus.success(),guild;var{result,statusText,status,data}=await tools_httpRequest({url:"https://discord.com/api/v9/invites/"+inviteId,responseType:"json",method:"GET"});if("Success"!==result||200!==data?.status)return logStatus.error(result+`:${statusText}(${status})`),!1;{let guild=data.response?.guild?.id;return guild?(logStatus.success(),this.#setCache(inviteId,guild),guild):(logStatus.error(result+`:${statusText}(${status})`),!1)}}catch(error){return throwError(error,"Discord.getGuild"),!1}}async toggle({doTask=!0,serverLinks=[]}){try{if(!this.#initialized)return scripts_echoLog({text:i18n("needInit")}),!1;var prom=[];if(doTask&&!globalOptions.doTask.discord.servers||!doTask&&!globalOptions.undoTask.discord.servers)scripts_echoLog({type:"globalOptionsSkip",text:"discord.servers"});else{var realServers=this.getRealParams("servers",serverLinks,doTask,link=>link.match(/invite\/(.+)/)?.[1]);if(0<realServers.length)for(var server of realServers)prom.push(doTask?this.#joinServer(server):this.#leaveServer(server)),await delay(1e3)}return await Promise.all(prom).then(()=>!0)}catch(error){return throwError(error,"Discord.toggleServers"),!1}}#setCache(inviteId,guild){try{this.#cache[inviteId]=guild,GM_setValue("discordCache",this.#cache)}catch(error){throwError(error,"Discord.setCache")}}}let social_Discord=Discord;class Instagram extends userDefinedGlobalOptions{tasks;whiteList;#cache=GM_getValue("instagramCache")||{};#auth={};#initialized=!1;constructor(){super();var defaultTasksTemplate={users:[]};this.tasks=defaultTasksTemplate,this.whiteList={...defaultTasksTemplate,...GM_getValue("whiteList")?.instagram||{}}}async init(){try{return this.#initialized?!0:await this.#getUserInfo()?(scripts_echoLog({}).success(i18n("initSuccess","Instagram")),this.#initialized=!0):(scripts_echoLog({}).error(i18n("initFailed","Instagram")),!1)}catch(error){return throwError(error,"Instagram.init"),!1}}async#getUserInfo(name="instagram"){try{var logStatus=scripts_echoLog({type:"instagram"===name?"verifyingInsAuth":"gettingInsUserId",text:name}),userId=this.#cache[name];if(userId&&"instagram"!==name)return logStatus.success(),userId;var csrftoken,hash,id,{result,statusText,status,data}=await tools_httpRequest({url:`https://www.instagram.com/${name}/`,method:"GET"});if("Success"===result)if(data?.finalUrl.includes("accounts/login"))logStatus.error("Error:"+i18n("loginIns"),!0);else if(data?.finalUrl.includes("www.instagram.com/challenge"))logStatus.error("Error:"+i18n("insBanned"));else{if(200===data?.status)return csrftoken=data.responseText.match(/"csrf_token":"(.+?)"/)?.[1],hash=data.responseText.match(/"rollout_hash":"(.+?)"/)?.[1],"instagram"===name?!(!csrftoken||!hash||(this.#auth={csrftoken:csrftoken,hash:hash},0)):(id=data.responseText.match(/"profilePage_([\d]+?)"/)?.[1])?(this.#setCache(name,id),logStatus.success(),id):(logStatus.error("Error: Get ins data error!"),!1);logStatus.error(result+`:${statusText}(${status})`)}return!1}catch(error){return throwError(error,"Instagram.getUserInfo"),!1}}async#followUser(name){try{var id=await this.#getUserInfo(name);if(id){var logStatus=scripts_echoLog({type:"followingIns",text:name}),{result,statusText,status,data}=await tools_httpRequest({url:`https://www.instagram.com/web/friendships/${id}/follow/`,method:"POST",dataType:"json",headers:{"x-csrftoken":this.#auth.csrftoken,origin:"https://www.instagram.com",referer:`https://www.instagram.com/${name}/`,"content-type":"application/x-www-form-urlencoded","sec-fetch-site":"same-origin","x-instagram-ajax":this.#auth.hash}});if("Success"===result)return 200===data?.status&&"following"===data.response?.result?(logStatus.success(),this.tasks.users=unique([...this.tasks.users,name]),!0):(logStatus.error("Error:"+(data?.response?.feedback_message||`${data?.statusText}(${data?.status})`)),!1);logStatus.error(result+`:${statusText}(${status})`)}return!1}catch(error){return throwError(error,"Instagram.followUser"),!1}}async#unfollowUser(name){try{if(this.whiteList.users.includes(name))return scripts_echoLog({type:"whiteList",text:"Instagram.unfollowUser",id:name}),!0;var id=await this.#getUserInfo(name);if(id){var logStatus=scripts_echoLog({type:"unfollowingIns",text:name}),{result,statusText,status,data}=await tools_httpRequest({url:`https://www.instagram.com/web/friendships/${id}/unfollow/`,method:"POST",dataType:"json",headers:{"x-csrftoken":this.#auth.csrftoken,origin:"https://www.instagram.com",referer:`https://www.instagram.com/${name}/`,"content-type":"application/x-www-form-urlencoded","sec-fetch-site":"same-origin","x-instagram-ajax":this.#auth.hash}});if("Success"===result)return 200===data?.status&&"ok"===data.response?.status?(logStatus.success(),!0):(logStatus.error(`Error:${data?.statusText}(${data?.status})`),!1);logStatus.error(result+`:${statusText}(${status})`)}return!1}catch(error){return throwError(error,"Instagram.unfollowUser"),!1}}async toggle({doTask=!0,userLinks=[]}){try{if(!this.#initialized)return scripts_echoLog({text:i18n("needInit")}),!1;var prom=[];if(doTask&&!globalOptions.doTask.instagram.users||!doTask&&!globalOptions.undoTask.instagram.users)scripts_echoLog({type:"globalOptionsSkip",text:"instagram.users"});else{var realUsers=this.getRealParams("users",userLinks,doTask,link=>link.match(/https:\/\/www\.instagram\.com\/(.+)?\//)?.[1]);if(0<realUsers.length)for(var username of realUsers)prom.push(doTask?this.#followUser(username):this.#unfollowUser(username)),await delay(1e3)}return await Promise.all(prom).then(()=>!0)}catch(error){return throwError(error,"Instagram.toggleUsers"),!1}}#setCache(name,id){try{this.#cache[name]=id,GM_setValue("instagramCache",this.#cache)}catch(error){throwError(error,"Instagram.setCache")}}}let social_Instagram=Instagram;class Reddit extends userDefinedGlobalOptions{tasks;whiteList;#auth;#initialized=!1;constructor(){super();var defaultTasksTemplate={reddits:[]};this.tasks=defaultTasksTemplate,this.whiteList={...defaultTasksTemplate,...GM_getValue("whiteList")?.reddit||{}}}async init(){try{return this.#initialized?!0:await this.#updateAuth()?(scripts_echoLog({}).success(i18n("initSuccess","Reddit")),this.#initialized=!0):(scripts_echoLog({}).error(i18n("initFailed","Reddit")),!1)}catch(error){return throwError(error,"Reddit.init"),!1}}async#useBeta(){try{let logStatus=scripts_echoLog({text:i18n("changingRedditVersion")});return await new Promise(resolve=>{var newTab=GM_openInTab("https://www.reddit.com/",{active:!0,insert:!0,setParent:!0});newTab.name="ATv4_redditAuth",newTab.onclose=async()=>{logStatus.success(),resolve(await this.#updateAuth(!0))}})}catch(error){return throwError(error,"Reddit.useBeta"),!1}}async#updateAuth(beta=!1){try{var accessToken,logStatus=scripts_echoLog({text:i18n("updatingAuth","Reddit")}),{result,statusText,status,data}=await tools_httpRequest({url:"https://www.reddit.com/",method:"GET",nochche:!0,headers:{"Cache-Control":"no-cache"}});if("Success"===result)if(data?.responseText.includes("www.reddit.com/login/"))logStatus.error("Error:"+i18n("loginReddit"),!0);else{if(200===data?.status)return data.responseText.includes("redesign-beta-optin-btn")&&!beta?await this.#useBeta():(accessToken=data.responseText.match(/"accessToken":"(.*?)","expires":"(.*?)"/)?.[1])?(this.#auth={token:accessToken},logStatus.success(),!0):(logStatus.error('Error: Parameter "accessToken" not found!'),!1);logStatus.error(`Error:${data?.statusText}(${data?.status})`)}else logStatus.error(result+`:${statusText}(${status})`);return!1}catch(error){return throwError(error,"Reddit.updateAuth"),!1}}async#toggleTask({name,doTask=!0}){try{if(!doTask&&this.whiteList.reddits.includes(name))return scripts_echoLog({type:"whiteList",text:"Reddit.undoTask",id:name}),!0;let type=doTask?"joiningReddit":"leavingReddit";/^u_/.test(name)&&(type=doTask?"followingRedditUser":"unfollowingRedditUser");var logStatus=scripts_echoLog({type:type,text:name}),{result,statusText,status,data}=await tools_httpRequest({url:"https://oauth.reddit.com/api/subscribe?redditWebClient=desktop2x&app=desktop2x-client-production&raw_json=1&gilding_detail=1",method:"POST",headers:{authorization:"Bearer "+this.#auth.token,"content-type":"application/x-www-form-urlencoded"},data:$.param({action:doTask?"sub":"unsub",sr_name:name,api_type:"json"})});return"Success"===result?200===data?.status?(logStatus.success(),doTask&&(this.tasks.reddits=unique([...this.tasks.reddits,name])),!0):(logStatus.error(`Error:${data?.statusText}(${data?.status})`),!1):(logStatus.error(result+`:${statusText}(${status})`),!1)}catch(error){return throwError(error,"Reddit.toggleTask"),!1}}async toggle({doTask=!0,redditLinks=[]}){try{if(!this.#initialized)return scripts_echoLog({text:i18n("needInit")}),!1;var prom=[];if(doTask&&!globalOptions.doTask.reddit.reddits||!doTask&&!globalOptions.undoTask.reddit.reddits)scripts_echoLog({type:"globalOptionsSkip",text:"reddit.reddits"});else{var realReddits=this.getRealParams("reddits",redditLinks,doTask,link=>{var name=link.match(/https?:\/\/www\.reddit\.com\/r\/([^/]*)/)?.[1],link=link.match(/https?:\/\/www\.reddit\.com\/user\/([^/]*)/)?.[1];return link?name||link:name});if(0<realReddits.length)for(var name of realReddits)prom.push(this.#toggleTask({name:name,doTask:doTask})),await delay(1e3)}return await Promise.all(prom).then(()=>!0)}catch(error){return throwError(error,"Reddit.toggle"),!1}}}let social_Reddit=Reddit;class Twitch extends userDefinedGlobalOptions{tasks;whiteList;#auth=GM_getValue("twitchAuth")||{};#cache=GM_getValue("twitchCache")||{};#initialized=!1;#integrityToken;constructor(){super();var defaultTasksTemplate={channels:[]};this.tasks=defaultTasksTemplate,this.whiteList={...defaultTasksTemplate,...GM_getValue("whiteList")?.twitch||{}}}async init(){try{return this.#initialized?!0:this.#auth.authToken&&this.#auth.clientId&&this.#auth.clientVersion&&this.#auth.deviceId&&this.#auth.clientSessionId?await this.#verifyAuth(!0)||(GM_setValue("twitchAuth",null),await this.#updateAuth())?(scripts_echoLog({}).success(i18n("initSuccess","Twitch")),this.#initialized=!0):(scripts_echoLog({}).error(i18n("initFailed","Twitch")),!1):!!await this.#updateAuth()&&(this.#initialized=!0)}catch(error){return throwError(error,"Twitch.init"),!1}}async#verifyAuth(isFirst){try{var logStatus=scripts_echoLog({text:i18n("verifyingAuth","Twitch")}),{result,statusText,status,data}=await tools_httpRequest({url:"https://gql.twitch.tv/gql",method:"POST",dataType:"json",headers:{Authorization:"OAuth "+this.#auth.authToken,"Client-Id":this.#auth.clientId},data:'[{"operationName":"FrontPageNew_User","variables":{"limit":1},"extensions":{"persistedQuery":{"version":1,"sha256Hash":"64bd07a2cbaca80699d62636d966cf6395a5d14a1f0a14282067dcb28b13eb11"}}}]'});return"Success"===result?200===data?.status&&data.response?.[0]?.data?.currentUser?(await this.#integrity(isFirst),logStatus.success(),!0):(logStatus.error(`Error:${data?.statusText}(${data?.status})`),!1):(logStatus.error(result+`:${statusText}(${status})`),!1)}catch(error){return throwError(error,"Twitch.verifyAuth"),!1}}async#integrity(isFirst=!0,ct=""){try{var result,statusText,status,data,logStatus=scripts_echoLog({text:i18n("checkingTwitchIntegrity")});return!isFirst||this.#auth.authToken&&this.#auth.clientId&&this.#auth.clientVersion&&this.#auth.deviceId&&this.#auth.clientSessionId?({result,statusText,status,data}=await tools_httpRequest({url:"https://gql.twitch.tv/integrity",method:"POST",dataType:"json",anonymous:!0,headers:{Origin:"https://www.twitch.tv",Referer:"https://www.twitch.tv/",Authorization:"OAuth "+this.#auth.authToken,"Client-Id":this.#auth.clientId,"Client-Version":this.#auth.clientVersion,"X-Device-Id":this.#auth.deviceId,"Client-Session-Id":this.#auth.clientSessionId,"x-kpsdk-ct":ct}}),"Success"===result?!ct&&data?.responseHeaders?.["x-kpsdk-ct"]?await this.#integrity(isFirst,data.responseHeaders["x-kpsdk-ct"]):200===data?.status&&data.response?.token?(this.#integrityToken=data.response.token,logStatus.success(),!0):(logStatus.error(`Error:${data?.statusText}(${data?.status})`),!1):(logStatus.error(result+`:${statusText}(${status})`),!1)):await this.#updateAuth(!1)}catch(error){return throwError(error,"Twitch.integrity"),!1}}async#updateAuth(isFirst=!0){try{let logStatus=scripts_echoLog({text:i18n("updatingAuth","Twitch")});return await new Promise(resolve=>{var newTab=GM_openInTab("https://www.twitch.tv/",{active:!0,insert:!0,setParent:!0});newTab.name="ATv4_twitchAuth",newTab.onclose=async()=>{var auth=GM_getValue("twitchAuth");auth?(this.#auth=auth,logStatus.success(),resolve(await this.#verifyAuth(isFirst))):(logStatus.error("Error: Update twitch auth failed!"),resolve(!1))}})}catch(error){return throwError(error,"Twitch.updateAuth"),!1}}async#toggleChannel({name,doTask=!0}){try{if(!doTask&&this.whiteList.channels.includes(name))return scripts_echoLog({type:"whiteList",text:"Twitch.unfollowChannel",id:name}),!0;var channelId=await this.#getChannelId(name);if(channelId){var logStatus=scripts_echoLog({type:`${doTask?"":"un"}followingTwitchChannel`,text:name}),followData='[{"operationName":"FollowButton_FollowUser","variables":{"input":{"disableNotifications":false,"targetID":"'+channelId+'"}},"extensions":{"persistedQuery":{"version":1,"sha256Hash":"800e7346bdf7e5278a3c1d3f21b2b56e2639928f86815677a7126b093b2fdd08"}}}]',unfollowData=`[{"operationName":"FollowButton_UnfollowUser","variables":{"input":{"targetID":"${channelId}"}},`+'"extensions":{"persistedQuery":{"version":1,"sha256Hash":"f7dae976ebf41c755ae2d758546bfd176b4eeb856656098bb40e0a672ca0d880"}}}]',{result,statusText,status,data}=await tools_httpRequest({url:"https://gql.twitch.tv/gql",method:"POST",dataType:"json",anonymous:!0,headers:{Origin:"https://www.twitch.tv",Referer:"https://www.twitch.tv/",Authorization:"OAuth "+this.#auth.authToken,"Client-Id":this.#auth.clientId,"Client-Version":this.#auth.clientVersion,"X-Device-Id":this.#auth.deviceId,"Client-Session-Id":this.#auth.clientSessionId,"Client-Integrity":this.#integrityToken},data:doTask?followData:unfollowData});if("Success"===result)return 200===data?.status&&data.response?.[0]&&!data.response[0].errors?(logStatus.success(),doTask&&(this.tasks.channels=unique([...this.tasks.channels,name])),!0):(logStatus.error("Error:"+(data?.response?.[0].errors?.[0]?.message||`${data?.statusText}(${data?.status})`)),!1);logStatus.error(result+`:${statusText}(${status})`)}return!1}catch(error){return throwError(error,"Twitch.toggleChannel"),!1}}async#getChannelId(name){try{var logStatus=scripts_echoLog({type:"gettingTwitchChannelId",text:name}),channelId=this.#cache[name];if(channelId)return logStatus.success(),channelId;var{result,statusText,status,data}=await tools_httpRequest({url:"https://gql.twitch.tv/gql",method:"POST",headers:{Authorization:"OAuth "+this.#auth.authToken,"Client-Id":this.#auth.clientId},responseType:"json",data:`[{"operationName":"ActiveWatchParty","variables":{"channelLogin":"${name}"},`+'"extensions":{"persistedQuery":{"version":1,"sha256Hash":"4a8156c97b19e3a36e081cf6d6ddb5dbf9f9b02ae60e4d2ff26ed70aebc80a30"}}}]'});if("Success"!==result)return logStatus.error(result+`:${statusText}(${status})`),!1;if(200!==data?.status)return logStatus.error(`Error:${data?.statusText}(${data?.status})`),!1;{let channelId=data.response?.[0]?.data?.user?.id;return channelId?(this.#setCache(name,String(channelId)),logStatus.success(),channelId):(logStatus.error(`Error:${data.statusText}(${data.status})`),!1)}}catch(error){return throwError(error,"Twitch.getChannelId"),!1}}async toggle({doTask=!0,channelLinks=[]}){try{if(!this.#initialized)return scripts_echoLog({text:i18n("needInit")}),!1;var prom=[];if(doTask&&!globalOptions.doTask.twitch.channels||!doTask&&!globalOptions.undoTask.twitch.channels)scripts_echoLog({type:"globalOptionsSkip",text:"twitch.channels"});else{var realChannels=this.getRealParams("channels",channelLinks,doTask,link=>link.match(/https:\/\/(www\.)?twitch\.tv\/(.+)/)?.[2]);if(0<realChannels.length)for(var channel of realChannels)prom.push(this.#toggleChannel({name:channel,doTask:doTask})),await delay(1e3)}return Promise.all(prom).then(()=>!0)}catch(error){return throwError(error,"Twitch.toggle"),!1}}#setCache(name,id){try{this.#cache[name]=id,GM_setValue("twitchCache",this.#cache)}catch(error){throwError(error,"Twitch.setCache")}}}function axiosGM(config){let finalConfig={...axiosGM.defaults,...config},retries=finalConfig.retry??0,retryDelay=finalConfig.retryDelay??0,requestAttempt=attempt=>new Promise((resolve,reject)=>{GM_xmlhttpRequest({method:finalConfig.method?finalConfig.method.toUpperCase():"GET",url:finalConfig.url,headers:finalConfig.headers,data:finalConfig.data,responseType:finalConfig.responseType||"json",timeout:finalConfig.timeout,fetch:finalConfig.fetch??!0,onload(response){response={data:response.response||response.responseText,status:response.status,statusText:response.statusText,headers:(headerStr=>{let headers={};return headerStr&&headerStr.split("\r\n").forEach(line=>{var key;line&&(key=(line=line.split(":")).shift()?.trim(),line=line.join(":").trim(),key)&&("set-cookie"===key.toLowerCase()&&headers[key]?Array.isArray(headers[key])?headers[key].push(line):headers[key]=[headers[key],line]:headers[key]=line)}),headers})(response.responseHeaders),config:finalConfig,request:response};resolve(response)},onerror(error){attempt<retries?setTimeout(()=>{requestAttempt(attempt+1).then(resolve).catch(reject)},retryDelay):reject(error)},ontimeout(){attempt<retries?setTimeout(()=>{requestAttempt(attempt+1).then(resolve).catch(reject)},retryDelay):reject("Error: timeout")}})});return requestAttempt(0)}let social_Twitch=Twitch;axiosGM.defaults={},axiosGM.get=function(url,config={}){return axiosGM({...config,url:url,method:"GET"})},axiosGM.post=function(url,data,config={}){return axiosGM({...config,url:url,data:data,method:"POST"})},axiosGM.head=function(url,config={}){return axiosGM({...config,url:url,method:"HEAD"})},axiosGM.create=function(instanceDefaults={}){let instance=config=>{config={...axiosGM.defaults,...instanceDefaults,...config};return axiosGM(config)};return instance.defaults={...axiosGM.defaults,...instanceDefaults},instance.get=function(url,config={}){return instance({...config,url:url,method:"GET"})},instance.post=function(url,data,config={}){return instance({...config,url:url,data:data,method:"POST"})},instance.head=function(url,config={}){return instance({...config,url:url,method:"HEAD"})},instance.create=axiosGM.create,instance};var node_modules_buffer=__webpack_require__(287);let MIGRATION_REDIRECTION_REGEX=/(http?s:\/\/(?:www\.)?(twitter|x){1}\.com(\/x)?\/migrate([/?])?tok=[a-zA-Z0-9%\-_]+)+/;class Cubic{curves;constructor(curves){if(4!==curves.length)throw new Error("Cubic curves array must contain exactly 4 elements");this.curves=curves.map(nn=>Number(nn))}getValue(time){let startGradient=0,endGradient=0,start=0,end=1,mid=0;if(time<=0)return 0<this.curves[0]?startGradient=this.curves[1]/this.curves[0]:0===this.curves[1]&&0<this.curves[2]&&(startGradient=this.curves[3]/this.curves[2]),startGradient*time;if(1<=time)return this.curves[2]<1?endGradient=(this.curves[3]-1)/(this.curves[2]-1):1===this.curves[2]&&this.curves[0]<1&&(endGradient=(this.curves[1]-1)/(this.curves[0]-1)),1+endGradient*(time-1);let iterations=0;for(;start<end&&iterations<20;){mid=(start+end)/2;var xEst=Cubic.calculate(this.curves[0],this.curves[2],mid);if(Math.abs(time-xEst)<1e-5)return Cubic.calculate(this.curves[1],this.curves[3],mid);xEst<time?start=mid:end=mid,iterations+=1}return Cubic.calculate(this.curves[1],this.curves[3],mid)}static calculate(aa,bb,mm){return 3*aa*(1-mm)*(1-mm)*mm+3*bb*(1-mm)*mm*mm+mm*mm*mm}}let interpolate=(fromList,toList,ff)=>{if(fromList.length!==toList.length)throw new Error(`Mismatched interpolation arguments ${fromList}: `+toList);return fromList.map((fromVal,ii)=>((fromVal,toVal,ff)=>{if("number"==typeof fromVal&&"number"==typeof toVal)return fromVal*(1-ff)+toVal*ff;if("boolean"==typeof fromVal&&"boolean"==typeof toVal)return ff<.5?0:1;throw new Error(`Type mismatch in interpolation: ${typeof fromVal} vs `+typeof toVal)})(fromVal,toList[ii],ff))};var sha256=__webpack_require__(312);let ON_DEMAND_FILE_REGEX=/['"](ondemand\.s)['"]:\s*['"]([\w]*)['"]/gim,INDICES_REGEX=/\(\w\[(\d{1,2})\],\s*16\)/gim;class ClientTransaction{static ADDITIONAL_RANDOM_NUMBER=3;static DEFAULT_KEYWORD="obfiowerehiring";homePageHtml;homePageResponse;defaultRowIndex;defaultKeyBytesIndices;key;keyBytes;animationKey;constructor(homePageResponse){var{html:homePageResponse,$:parsed$}=this.validateResponse(homePageResponse);this.homePageHtml=homePageResponse,this.homePageResponse=parsed$}async init(){var[rowIndex,keyIndices]=await this.getIndices();this.defaultRowIndex=rowIndex,this.defaultKeyBytesIndices=keyIndices,this.key=this.getKey(),this.keyBytes=this.getKeyBytes(this.key),this.animationKey=this.getAnimationKey(this.keyBytes)}validateResponse(response){if(response&&response.jquery)return{html:response.prop("outerHTML")||"",$:response};let htmlContent="";if(response?.data)htmlContent=response.data;else{if(!response?.content)throw new Error("Invalid response object");htmlContent=response.content.toString()}return{html:htmlContent,$:$($.parseHTML(htmlContent))}}async getIndices(){var onDemandMatch=ON_DEMAND_FILE_REGEX.exec(this.homePageHtml),keyByteIndices=[];if(onDemandMatch){onDemandMatch=`https://abs.twimg.com/responsive-web/client-web/ondemand.s.${onDemandMatch[2]}a.js`;try{var match,data=(await axiosGM.get(onDemandMatch)).data;for(match of data.matchAll(INDICES_REGEX))keyByteIndices.push(parseInt(match[1],10))}catch(error){console.error("Failed to fetch ondemand file:",error)}}if(keyByteIndices.length<4)throw new Error("Couldn't get KEY_BYTE indices");return[keyByteIndices[0],keyByteIndices.slice(1,4)]}getKey(){var element=this.homePageResponse.find('meta[name="twitter-site-verification"]').first();if(element.length)return element.attr("content")||"";throw new Error("Couldn't get key from the page source")}getKeyBytes(key){return Array.from(node_modules_buffer.hp.from(key,"base64"))}getFrames(){return this.homePageResponse.find('[id^="loading-x-anim"]')}get2DArray(keyBytes){var frames=this.getFrames(),keyBytes=keyBytes[5]%4;return(frames.eq(keyBytes).children().eq(0).children().eq(1).attr("d")||"").slice(9).split("C").map(segment=>segment.replace(/[^\d]+/g," ").trim().split(/\s+/).map(str=>{str=parseInt(str,10);return isNaN(str)?0:str}).filter(num=>0!==num))}solve(value,minVal,maxVal,rounding){value=value*(maxVal-minVal)/255+minVal;return rounding?Math.floor(value):Number(value.toFixed(2))}animate(frameRow,targetTime){var fromColor=[...frameRow.slice(0,3),1],toColor=[...frameRow.slice(3,6),1],toRotation=[this.solve(frameRow[6],60,360,!0)],frameRow=frameRow.slice(7).map((val,idx)=>this.solve(val,idx%2?-1:0,1,!1)),frameRow=new Cubic(frameRow).getValue(targetTime),targetTime=interpolate(fromColor,toColor,frameRow).map(vv=>Math.max(vv,0)),fromColor=(rotation=>{rotation=Math.PI*rotation/180;return[Math.cos(rotation),-Math.sin(rotation),Math.sin(rotation),Math.cos(rotation)]})(interpolate([0],toRotation,frameRow)[0]);return[...targetTime.slice(0,3).map(vv=>Math.round(vv).toString(16).padStart(2,"0")),...fromColor.map(vv=>{vv=(xx=>{let quotient=Math.floor(xx),fraction=xx-quotient;for(var result=[];0<quotient;){var remainder=quotient%16;quotient=Math.floor(quotient/16),result.unshift(9<remainder?String.fromCharCode(remainder+55):remainder.toString())}if(0<fraction){result.push(".");let precision=0;for(;0<fraction&&precision<10;){fraction*=16;var integer=Math.floor(fraction);fraction-=integer,result.push(9<integer?String.fromCharCode(integer+55):integer.toString()),precision+=1}}return 0<result.length?result.join(""):"0"})(Math.abs(Number(vv.toFixed(2))));return vv.startsWith(".")?"0"+vv:vv}),"0","0"].join("").replace(/[.-]/g,"")}getAnimationKey(keyBytes){var rowIndex=keyBytes[this.defaultRowIndex]%16,frameTime=this.defaultKeyBytesIndices.map(ii=>keyBytes[ii]%16).reduce((aa,bb)=>aa*bb,1),arr=this.get2DArray(keyBytes);return this.animate(arr[rowIndex],frameTime/4096)}generateTransactionId(method,path,timeNow){var timeNow=timeNow??Math.floor((Date.now()-16829244e5)/1e3),timeBytes=[timeNow>>24&255,timeNow>>16&255,timeNow>>8&255,255&timeNow],method=method+`!${path}!`+timeNow+ClientTransaction.DEFAULT_KEYWORD+this.animationKey,path=node_modules_buffer.hp.from(sha256.sha256.arrayBuffer(method)),timeNow=Array.from(path.slice(0,16));let randomNum=Math.floor(256*Math.random());method=[...this.keyBytes,...timeBytes,...timeNow,ClientTransaction.ADDITIONAL_RANDOM_NUMBER].map(bb=>bb^randomNum);return path=node_modules_buffer.hp.from([randomNum,...method]),(node_modules_buffer.hp.isBuffer(path)?path:node_modules_buffer.hp.from(path)).toString("base64").replace(/=+$/,"")}}let session=axiosGM.create({headers:{Authority:"x.com","Accept-Language":"en-US,en;q=0.9","Cache-Control":"no-cache",Referer:"https://x.com","User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36","X-Twitter-Active-User":"yes","X-Twitter-Client-Language":"en"},timeout:1e4}),main=async(method,path,attempts=0)=>{for(;attempts<3;)try{var response=await(async session=>{let homePage;var response=await session({method:"GET",url:"https://x.com"});let migrationRedirectionUrl=(homePage=$(`<div>${response.data}</div>`)).find('meta[http-equiv="refresh"]').attr("content")?.match(MIGRATION_REDIRECTION_REGEX)?.[0];migrationRedirectionUrl||(response=response.data.match(MIGRATION_REDIRECTION_REGEX),migrationRedirectionUrl=response?.[0]),migrationRedirectionUrl&&(response=await session({method:"GET",url:migrationRedirectionUrl}),homePage=$(`<div>${response.data}</div>`));response=homePage.find('form[name="f"], form[action="https://x.com/x/migrate"]');if(0<response.length){var formAction=response.attr("action")||"https://x.com/x/migrate",formMethod=response.attr("method")?.toUpperCase()||"POST";let payload={};response.find("input").each((idx,el)=>{var el=$(el),name=el.attr("name"),el=el.attr("value")||"";name&&(payload[name]=el)});response=await session({method:formMethod,url:formAction,data:payload});homePage=$(`<div>${response.data}</div>`)}return homePage})(session),ct=new ClientTransaction(response);return await ct.init(),ct.generateTransactionId(method,path)}catch(error){if(attempts+=1,console.error(`Error in main process (attempt ${attempts}):`,error),!(attempts<3))return console.error("Max retry attempts reached. Returning empty string."),"";console.log("Retrying in 5 seconds..."),await new Promise(resolve=>setTimeout(resolve,5e3))}return""};class Twitter extends userDefinedGlobalOptions{tasks;whiteList;#verifyId=globalOptions.other.twitterVerifyId;#auth=GM_getValue("twitterAuth")||{};#cache=GM_getValue("twitterCache")||{};#initialized=!1;constructor(){super();var defaultTasksTemplate={users:[],retweets:[],likes:[]};this.tasks=defaultTasksTemplate,this.whiteList={...defaultTasksTemplate,...GM_getValue("whiteList")?.twitter||{}}}async init(){try{return this.#initialized?!0:this.#auth.ct0?await this.#verifyAuth()||(GM_setValue("twitterAuth",null),await this.#updateAuth())?(scripts_echoLog({}).success(i18n("initSuccess","Twitter")),this.#initialized=!0):(scripts_echoLog({}).error(i18n("initFailed","Twitter")),!1):!!await this.#updateAuth()&&(this.#initialized=!0)}catch(error){return throwError(error,"Twitter.init"),!1}}async#verifyAuth(){try{return await this.#toggleUser({name:"verify",doTask:!0,verify:!0})}catch(error){return throwError(error,"Twitter.verifyAuth"),!1}}async#updateAuth(){try{let logStatus=scripts_echoLog({text:i18n("updatingAuth","Twitter")});return await new Promise(resolve=>{GM_cookie.list({url:"https://x.com/settings/account"},async(cookies,error)=>{error?(logStatus.error("Error: Update twitter auth failed!"),resolve(!1)):([error,cookies]=cookies.map(cookie=>["ct0","twid"].includes(cookie.name)?cookie.value:null).filter(cookie=>cookie),cookies&&error?(GM_setValue("twitterAuth",{ct0:error}),this.#auth={ct0:error},logStatus.success(),resolve(await this.#verifyAuth())):(logStatus.error(i18n("needLogin")),resolve(!1)))})})}catch(error){return throwError(error,"Twitter.updateToken"),!1}}async#toggleUser({name,doTask=!0,verify=!1,retry=!1}){try{if(!doTask&&!verify&&this.whiteList.users.includes(name))return scripts_echoLog({type:"whiteList",text:"Twitter.unfollowUser",id:name}),!0;var userId=verify?this.#verifyId:await this.userName2id(name);if(userId){var logStatus=verify?scripts_echoLog({text:i18n("verifyingAuth","Twitter")}):scripts_echoLog({type:`${doTask?"":"un"}followingTwitterUser`,text:name}),{result,statusText,status,data}=await tools_httpRequest({url:`https://x.com/i/api/1.1/friendships/${doTask?"create":"destroy"}.json`,method:"POST",headers:{authorization:"Bearer AAAAAAAAAAAAAAAAAAAAANRILgAAAAAAnNwIzUejRCOuH5E6I8xnZz4puTs%3D1Zv7ttfk8LF81IUq16cHjhLTvJu4FA33AGWWjCpTnA","Content-Type":"application/x-www-form-urlencoded","x-csrf-token":this.#auth.ct0,"X-Twitter-Auth-Type":"OAuth2Session","X-Twitter-Active-User":"yes","x-client-transaction-id":await main("POST",`/i/api/1.1/friendships/${doTask?"create":"destroy"}.json`)},responseType:"json",data:$.param({include_profile_interstitial_type:1,include_blocking:1,include_blocked_by:1,include_followed_by:1,include_want_retweets:1,include_mute_edge:1,include_can_dm:1,include_can_media_tag:1,skip_status:1,id:userId})});if("Success"===result){if(200===data?.status)return logStatus.success(),doTask&&!verify&&(this.tasks.users=unique([...this.tasks.users,name])),!0;if(verify&&403===data?.status){if(158===data.response?.errors?.[0]?.code)return logStatus.success(),!0;if(353===data.response?.errors?.[0]?.code&&!retry&&data.responseHeaders?.["set-cookie"])return this.#auth.ct0=data.responseHeaders["set-cookie"]?.find(cookie=>cookie.includes("ct0="))?.split(";")?.at(0)?.split("=")?.at(-1)||this.#auth.ct0,logStatus.warning(i18n("retry")),this.#toggleUser({name:name,doTask:doTask,verify:verify,retry:!0})}logStatus.error(`Error:${data?.statusText}(${data?.status})`)}else logStatus.error(result+`:${statusText}(${status})`)}return!1}catch(error){return throwError(error,"Twitter.toggleUser"),!1}}async userName2id(name){try{var logStatus=scripts_echoLog({type:"gettingTwitterUserId",text:name}),userId=this.#cache[name];if(userId)return logStatus.success(),userId;var{result,statusText,status,data}=await tools_httpRequest({url:"https://x.com/i/api/graphql/mCbpQvZAw6zu_4PvuAUVVQ/UserByScreenName"+`?variables=%7B%22screen_name%22%3A%22${name}%22%2C%22withSafetyModeUserFields%22%3Atrue%2C%22withSuperFollowsUserFields%22%3Atrue%7D`,method:"GET",headers:{authorization:"Bearer AAAAAAAAAAAAAAAAAAAAANRILgAAAAAAnNwIzUejRCOuH5E6I8xnZz4puTs%3D1Zv7ttfk8LF81IUq16cHjhLTvJu4FA33AGWWjCpTnA","content-type":"application/json",referer:"https://x.com/"+name,"x-csrf-token":this.#auth.ct0,"X-Twitter-Auth-Type":"OAuth2Session","X-Twitter-Active-User":"yes","x-client-transaction-id":await main("GET","/i/api/graphql/mCbpQvZAw6zu_4PvuAUVVQ/UserByScreenName"+`?variables=%7B%22screen_name%22%3A%22${name}%22%2C%22withSafetyModeUserFields%22%3Atrue%2C%22withSuperFollowsUserFields%22%3Atrue%7D`)},responseType:"json"});if("Success"!==result)return logStatus.error(result+`:${statusText}(${status})`),!1;if(200!==data?.status)return logStatus.error(`Error:${data?.statusText}(${data?.status})`),!1;{let response=data.response||("object"==typeof data.responseText?data.responseText:null);if(!response)try{response=JSON.parse(data.responseText)}catch(error){response=null}let userId=String(response?.data?.user?.result?.rest_id);return userId?(this.#setCache(name,userId),logStatus.success(),userId):(logStatus.error(`Error:${data.statusText}(${data.status})`),!1)}}catch(error){return throwError(error,"Twitter.getUserId"),!1}}async#toggleRetweet({retweetId,doTask=!0}){try{var logStatus,result,statusText,status,data;return!doTask&&this.whiteList.retweets.includes(retweetId)?(scripts_echoLog({type:"whiteList",text:"Twitter.unretweet",id:retweetId}),!0):(logStatus=scripts_echoLog({type:`${doTask?"":"un"}retweetting`,text:retweetId}),{result,statusText,status,data}=await tools_httpRequest({url:"https://x.com/i/api/graphql/"+(doTask?"ojPdsZsimiJrUGLR1sjUtA/CreateRetweet":"iQtK4dl5hBmXewYZuEOKVw/DeleteRetweet"),method:"POST",headers:{authorization:"Bearer AAAAAAAAAAAAAAAAAAAAANRILgAAAAAAnNwIzUejRCOuH5E6I8xnZz4puTs%3D1Zv7ttfk8LF81IUq16cHjhLTvJu4FA33AGWWjCpTnA","Content-Type":"application/json",origin:"https://x.com",referer:"https://x.com/opquests/status/"+retweetId,"x-csrf-token":this.#auth.ct0,"X-Twitter-Auth-Type":"OAuth2Session","X-Twitter-Active-User":"yes","x-client-transaction-id":await main("POST","/i/api/graphql/"+(doTask?"ojPdsZsimiJrUGLR1sjUtA/CreateRetweet":"iQtK4dl5hBmXewYZuEOKVw/DeleteRetweet"))},data:`{"variables":{"tweet_id":"${retweetId}","dark_request":false},"queryId":"${doTask?"ojPdsZsimiJrUGLR1sjUtA":"iQtK4dl5hBmXewYZuEOKVw"}"}`,responseType:"json"}),"Success"===result?200===data?.status||403===data?.status&&327===data.response?.errors?.[0]?.code?(logStatus.success(),doTask&&(this.tasks.retweets=unique([...this.tasks.retweets,retweetId])),!0):(logStatus.error(`Error:${data?.statusText}(${data?.status})`),!1):(logStatus.error(result+`:${statusText}(${status})`),!1))}catch(error){return throwError(error,"Twitter.toggleRetweet"),!1}}async toggle({doTask=!0,userLinks=[],retweetLinks=[]}){try{if(!this.#initialized)return scripts_echoLog({text:i18n("needInit")}),!1;var prom=[];if(doTask&&!globalOptions.doTask.twitter.users||!doTask&&!globalOptions.undoTask.twitter.users)scripts_echoLog({type:"globalOptionsSkip",text:"twitter.users"});else{var realUsers=this.getRealParams("users",userLinks,doTask,link=>link.match(/https:\/\/x\.com\/(.+)/)?.[1]||link.match(/https:\/\/twitter\.com\/(.+)/)?.[1]);if(0<realUsers.length)for(var user of realUsers)prom.push(this.#toggleUser({name:user,doTask:doTask})),await delay(1e3)}if(doTask&&!globalOptions.doTask.twitter.retweets||!doTask&&!globalOptions.undoTask.twitter.retweets)scripts_echoLog({type:"globalOptionsSkip",text:"twitter.retweets"});else{var realRetweets=this.getRealParams("retweets",retweetLinks,doTask,link=>link.match(/https:\/\/x\.com\/.*?\/status\/([\d]+)/)?.[1]||link.match(/https:\/\/twitter\.com\/.*?\/status\/([\d]+)/)?.[1]);if(0<realRetweets.length)for(var retweet of realRetweets)prom.push(this.#toggleRetweet({retweetId:retweet,doTask:doTask})),await delay(1e3)}return Promise.all(prom).then(()=>!0)}catch(error){return throwError(error,"Twitter.toggle"),!1}}#setCache(name,id){try{this.#cache[name]=id,GM_setValue("twitterCache",this.#cache)}catch(error){throwError(error,"Twitter.setCache")}}}let social_Twitter=Twitter;class Vk extends userDefinedGlobalOptions{tasks;whiteList;#username="";#cache=GM_getValue("vkCache")||{};#initialized=!1;constructor(){super();var defaultTasksTemplate={names:[]};this.tasks=defaultTasksTemplate,this.whiteList={...defaultTasksTemplate,...GM_getValue("whiteList")?.vk||{}}}async init(){try{return this.#initialized?!0:await this.#verifyAuth()?(scripts_echoLog({}).success(i18n("initSuccess","Vk")),this.#initialized=!0):(scripts_echoLog({}).error(i18n("initFailed","Vk")),!1)}catch(error){return throwError(error,"Vk.init"),!1}}async#verifyAuth(){try{var logStatus=scripts_echoLog({text:i18n("verifyAuth","Vk")}),{result,statusText,status,data}=await tools_httpRequest({url:"https://vk.com/im",method:"GET"});if("Success"===result)if(data?.finalUrl.includes("vk.com/login"))logStatus.error("Error:"+i18n("loginVk"),!0);else{if(200===data?.status)return this.#username=data.responseText.match(/TopNavBtn__profileLink" href="\/(.*?)"/)?.[1]||"",logStatus.success(),!0;logStatus.error(`Error:${data?.statusText}(${data?.status})`)}else logStatus.error(result+`:${statusText}(${status})`);return!1}catch(error){return throwError(error,"Vk.verifyAuth"),!1}}async#toggleGroup(name,dataParam,doTask=!0){try{var reqData,result,statusText,status,data,logStatus=scripts_echoLog({type:doTask?"joiningVkGroup":"leavingVkGroup",text:name});return"enter"===dataParam.groupAct&&!doTask||"leave"===dataParam.groupAct&&doTask?(logStatus.success(),!0):(reqData={act:doTask?"enter":"leave",al:1,gid:dataParam.groupId,hash:dataParam.groupHash},{result,statusText,status,data}=(doTask&&(reqData.context="_"),await tools_httpRequest({url:"https://vk.com/al_groups.php",method:"POST",headers:{origin:"https://vk.com",referer:"https://vk.com/"+name,"content-type":"application/x-www-form-urlencoded"},data:$.param(reqData)})),"Success"===result?200===data?.status?(logStatus.success(),doTask&&(this.tasks.names=unique([...this.tasks.names,name])),!0):(logStatus.error(`Error:${data?.statusText}(${data?.status})`),!1):(logStatus.error(result+`:${statusText}(${status})`),!1))}catch(error){return throwError(error,"Vk.toggleGroup"),!1}}async#togglePublic(name,dataParam,doTask=!0){try{var result,statusText,status,data,logStatus=scripts_echoLog({type:doTask?"joiningVkPublic":"leavingVkPublic",text:name});return dataParam.publicJoined&&doTask||!dataParam.publicJoined&&!doTask?(logStatus.success(),!0):({result,statusText,status,data}=await tools_httpRequest({url:"https://vk.com/al_public.php",method:"POST",headers:{origin:"https://vk.com",referer:"https://vk.com/"+name,"content-type":"application/x-www-form-urlencoded"},data:$.param({act:doTask?"a_enter":"a_leave",al:1,pid:dataParam.publicPid,hash:dataParam.publicHash})}),"Success"===result?200===data?.status?(logStatus.success(),doTask&&(this.tasks.names=unique([...this.tasks.names,name])),!0):(logStatus.error(`Error:${data?.statusText}(${data?.status})`),!1):(logStatus.error(result+`:${statusText}(${status})`),!1))}catch(error){return throwError(error,"Vk.togglePublic"),!1}}async#toggleLikeWall(name,dataParam,doTask=!0){try{var logStatus=scripts_echoLog({type:doTask?"likingVkPublic":"unlikingVkPublic",text:name}),postData={act:"a_set_reaction",al:1,event_subtype:"post_modal",from:"wall_page",hash:dataParam.hash,object:dataParam.object,track_code:dataParam.trackCode,wall:2},{result:resultR,statusText:statusTextR,status:statusR,data:dataR}=(doTask&&(postData.reaction_id=0),await tools_httpRequest({url:"https://vk.com/like.php?act=a_set_reaction",method:"POST",headers:{origin:"https://vk.com",referer:"https://vk.com/"+name,"content-type":"application/x-www-form-urlencoded"},data:$.param(postData)}));return"Success"===resultR?200===dataR?.status&&!0===dataR.response?.payload?.[1]?.[1]?.like_my?(logStatus.success(),!0):(logStatus.error(`Error:${dataR?.statusText}(${dataR?.status})`),!1):(logStatus.error(resultR+`:${statusTextR}(${statusR})`),!1)}catch(error){return throwError(error,"Vk.sendWall"),!1}}async#sendWall(name){try{var logStatus=scripts_echoLog({type:"sendingVkWall",text:name}),{result,statusText,status,data}=await tools_httpRequest({url:"https://vk.com/like.php",method:"POST",headers:{origin:"https://vk.com",referer:"https://vk.com/"+name,"content-type":"application/x-www-form-urlencoded"},data:$.param({act:"publish_box",al:1,object:name})});if("Success"===result)if(200===data?.status){var hash=data.responseText.match(/shHash:[\s]*'(.*?)'/)?.[1];if(hash){var{result:resultR,statusText:statusTextR,status:statusR,data:dataR}=await tools_httpRequest({url:"https://vk.com/like.php",method:"POST",headers:{origin:"https://vk.com",referer:"https://vk.com/"+name,"content-type":"application/x-www-form-urlencoded"},data:$.param({Message:"",act:"a_do_publish",al:1,close_comments:0,friends_only:0,from:"box",hash:hash,list:"",mark_as_ads:0,mute_notifications:0,object:name,ret_data:1,to:0})});if("Success"===resultR){if(200===dataR?.status){var postId,ownerId,jsonData=JSON.parse(dataR.responseText?.replace("\x3c!--","")||"{}");if(!0===jsonData?.payload?.[1]?.[1]?.share_my)return logStatus.success(),postId=String(jsonData?.payload?.[1]?.[1]?.post_id),ownerId=String(jsonData?.payload?.[1]?.[1]?.owner_id),postId&&ownerId&&this.#setCache(name,ownerId+"_"+postId),this.tasks.names=unique([...this.tasks.names,name]),!0}logStatus.error(`Error:${dataR?.statusText}(${dataR?.status})`)}else logStatus.error(resultR+`:${statusTextR}(${statusR})`)}else logStatus.error('Error: Get "hash" failed')}else logStatus.error(`Error:${data?.statusText}(${data?.status})`);else logStatus.error(result+`:${statusText}(${status})`);return!1}catch(error){return throwError(error,"Vk.sendWall"),!1}}async#deleteWall(name,dataParams){try{var logStatus=scripts_echoLog({type:"deletingVkWall",text:name}),{result,statusText,status,data}=await tools_httpRequest({url:"https://vk.com/al_wall.php?act=delete",method:"POST",headers:{origin:"https://vk.com",referer:`https://vk.com/${this.#username}?w=wall${this.#cache[name]}%2Fall`,"content-type":"application/x-www-form-urlencoded"},data:$.param({act:"delete",al:1,confirm:0,from:"wkview",hash:dataParams.wallHash,post:this.#cache[name]})});return"Success"===result?200===data?.status&&JSON.parse(data.responseText?.replace("\x3c!--","")||"{}")?.payload?.[1]?.[1]?(logStatus.success(),!0):(logStatus.error(`Error:${data?.statusText}(${data?.status})`),!1):(logStatus.error(result+`:${statusText}(${status})`),!1)}catch(error){return throwError(error,"Vk.deleteWall"),!1}}async#getId(name,doTask){try{let url="https://vk.com/"+name;if(/^wall-/.test(name)){if(doTask)return{type:"sendWall"};if(!this.#cache[name])return{type:"unSupport"};url=`https://vk.com/${this.#username}?w=wall`+this.#cache[name]}var logStatus=scripts_echoLog({type:"gettingVkId",text:name}),{result,statusText,status,data}=await tools_httpRequest({url:url,method:"GET"});if("Success"===result)if(200===data?.status){var[,groupAct,groupId,,groupHash]=data.responseText.match(/Groups.(enter|leave)\(.*?,.*?([\d]+?), (&#39;|')(.*?)(&#39;|')/)||[],publicHash=data.responseText.match(/"enterHash":"(.*?)"/)?.[1],publicPid=data.responseText.match(/"public_id":([\d]+?),/)?.[1],publicJoined=!data.responseText.includes("Public.subscribe");if(groupAct&&groupId&&groupHash)return logStatus.success(),{groupAct:groupAct,groupId:groupId,groupHash:groupHash,type:"group"};if(publicHash&&publicPid)return logStatus.success(),{publicHash:publicHash,publicPid:publicPid,publicJoined:publicJoined,type:"public"};if(name.includes("action=like")){var hash=data.responseText.match(/data-reaction-hash="(.*?)"/)?.[1],trackCode=data.responseText.match(/data-post-track-code="(.*?)"/)?.[1],object=name.match(/wall-[\w_]+/)?.[0];if(hash&&trackCode&&object)return logStatus.success(),{type:"likeWall",hash:hash,trackCode:trackCode,object:object}}else if(data.responseText.includes("wall.deletePost")&&!doTask){var wallHash=data.responseText.match(/wall\.deletePost\(this, '.*?', '(.*?)'\)/)?.[1];if(wallHash)return logStatus.success(),{type:"deleteWall",wallHash:wallHash}}else if(name.includes("wall")&&doTask)return logStatus.success(),{type:"sendWall"};logStatus.error("Error: Parameters not found!")}else logStatus.error(`Error:${data?.statusText}(${data?.status})`);else logStatus.error(result+`:${statusText}(${status})`);return!1}catch(error){return throwError(error,"Vk.getId"),!1}}async#toggleVk({name,doTask=!0}){try{if(!doTask&&this.whiteList.names.includes(name))return scripts_echoLog({type:"whiteList",text:"Vk.undoTask",id:name}),!0;var formatName=name.replace(/\/$/,""),data=await this.#getId(formatName,doTask);if(!data)return!1;switch(data.type){case"group":return await this.#toggleGroup(formatName,data,doTask);case"public":return await this.#togglePublic(formatName,data,doTask);case"likeWall":return await this.#toggleLikeWall(formatName,data,doTask);case"sendWall":return!doTask||await this.#sendWall(formatName);case"deleteWall":return!!doTask||await this.#deleteWall(formatName,data);default:return!1}}catch(error){return throwError(error,"Vk.toggleVk"),!1}}async toggle({doTask=!0,nameLinks=[]}){try{if(!this.#initialized)return scripts_echoLog({text:i18n("needInit")}),!1;var prom=[];if(doTask&&!globalOptions.doTask.vk.names||!doTask&&!globalOptions.undoTask.vk.names)scripts_echoLog({type:"globalOptionsSkip",text:"vk.names"});else{var realNames=this.getRealParams("names",nameLinks,doTask,link=>link.match(/https:\/\/vk\.com\/([^/]+)/)?.[1]);if(0<realNames.length)for(var name of realNames)prom.push(this.#toggleVk({name:name,doTask:doTask})),await delay(1e3)}return Promise.all(prom).then(()=>!0)}catch(error){return throwError(error,"Vk.toggle"),!1}}#setCache(name,postId){try{this.#cache[name]=postId,GM_setValue("vkCache",this.#cache)}catch(error){throwError(error,"Vk.setCache")}}}let social_Vk=Vk,getInfo=async function(link,type){try{var apiKey,context,client,request,channelId,videoId,likeParams,logStatus=scripts_echoLog({text:i18n("gettingYtbToken")}),{result,statusText,status,data}=await tools_httpRequest({url:link,method:"GET"});return"Success"===result?200===data?.status?data.responseText.includes("accounts.google.com/ServiceLogin?service=youtube")?(logStatus.error("Error:"+i18n("loginYtb"),!0),{needLogin:!0}):(apiKey=data.responseText.match(/"INNERTUBE_API_KEY":"(.*?)"/)?.[1],context=(data.responseText.match(/\(\{"INNERTUBE_CONTEXT":([\w\W]*?)\}\)/)||data.responseText.match(/"INNERTUBE_CONTEXT":([\w\W]*?\}),"INNERTUBE/))?.[1]||"{}",{client,request}=JSON.parse(context),apiKey&&client&&request?(client.hl="en","channel"===type?(channelId=data.responseText.match(/"channelId":"(.+?)"/)?.[1])?(logStatus.success(),{params:{apiKey:apiKey,client:client,request:request,channelId:channelId}}):(logStatus.error('Error: Get "channelId" failed!'),{}):"likeVideo"===type?(videoId=data.responseText.match(/<link rel="shortlinkUrl" href="https:\/\/youtu\.be\/(.*?)">/)?.[1],likeParams=data.responseText.match(/"likeParams":"(.*?)"/)?.[1],videoId?(logStatus.success(),{params:{apiKey:apiKey,client:client,request:request,videoId:videoId,likeParams:likeParams}}):(logStatus.error('Error: Get "videoId" failed!'),{})):(logStatus.error("Error: Unknown type"),{})):(logStatus.error('Error: Parameter "apiKey" not found!'),{})):(logStatus.error(`Error:${data?.statusText}(${data?.status})`),{}):(logStatus.error(result+`:${statusText}(${status})`),{})}catch(error){return throwError(error,"Youtube.getInfo"),{}}};class Youtube extends userDefinedGlobalOptions{tasks;whiteList;#auth=GM_getValue("youtubeAuth")||{};#initialized=!1;#verifyChannel="https://www.youtube.com/channel/"+globalOptions.other.youtubeVerifyChannel;constructor(){super();var defaultTasksTemplate={channels:[],likes:[]};this.tasks=defaultTasksTemplate,this.whiteList={...defaultTasksTemplate,...GM_getValue("whiteList")?.youtube||{}}}async init(){try{return this.#initialized?!0:this.#auth.PAPISID?await this.#verifyAuth()||(GM_setValue("youtubeAuth",null),await this.#updateAuth())?(scripts_echoLog({}).success(i18n("initSuccess","Youtube")),this.#initialized=!0):(scripts_echoLog({}).error(i18n("initFailed","Youtube")),!1):!!await this.#updateAuth()&&(this.#initialized=!0)}catch(error){return throwError(error,"Youtube.init"),!1}}async#verifyAuth(){try{return await this.#toggleChannel({link:this.#verifyChannel,doTask:!0,verify:!0})}catch(error){return throwError(error,"Youtube.verifyAuth"),!1}}async#updateAuth(){try{let logStatus=scripts_echoLog({text:i18n("updatingAuth","Youtube")});return await new Promise(resolve=>{GM_cookie.list({url:"https://www.youtube.com/@YouTube"},async(cookies,error)=>{error?(logStatus.error("Error: Update youtube auth failed!"),resolve(!1)):(error=cookies.find(cookie=>"__Secure-3PAPISID"===cookie.name)?.value)?(GM_setValue("youtubeAuth",{PAPISID:error}),this.#auth={PAPISID:error},logStatus.success(),resolve(await this.#verifyAuth())):(logStatus.error(i18n("needLogin")),resolve(!1))})})}catch(error){return throwError(error,"Youtube.updateAuth"),!1}}#getInfo(link,type){return getInfo(link,type)}async#toggleChannel({link,doTask=!0,verify=!1}){try{var{params,needLogin}=await this.#getInfo(link,"channel"),{apiKey,client,request,channelId}=params||{};if(needLogin)scripts_echoLog({html:i18n("loginYtb")});else if(apiKey&&client&&request&&channelId){if(!doTask&&!verify&&this.whiteList.channels.includes(channelId))return scripts_echoLog({type:"whiteList",text:"Youtube.unfollowChannel",id:channelId}),!0;var logStatus=verify?scripts_echoLog({text:i18n("verifyingAuth","Youtube")}):scripts_echoLog({type:doTask?"followingYtbChannel":"unfollowingYtbChannel",text:channelId}),nowTime=parseInt(String((new Date).getTime()/1e3),10),{result,statusText,status,data}=await tools_httpRequest({url:`https://www.youtube.com/youtubei/v1/subscription/${doTask?"":"un"}subscribe?key=${apiKey}&prettyPrint=false`,method:"POST",headers:{origin:"https://www.youtube.com",referer:"https://www.youtube.com/channel/"+channelId,"content-type":"application/json","x-goog-authuser":"0","x-goog-visitor-id":client?.visitorData,"x-origin":"https://www.youtube.com",authorization:`SAPISIDHASH ${nowTime}_`+sha1(`${nowTime} ${this.#auth.PAPISID} https://www.youtube.com`)},data:JSON.stringify({context:{client:client,request:{sessionId:request?.sessionId,internalExperimentFlags:[],consistencyTokenJars:[]},user:{}},channelIds:[channelId],params:doTask?"EgIIAhgA":"CgIIAhgA"})});if("Success"===result)return 200===data?.status?doTask&&(/"subscribed":true/.test(data.responseText)||data.responseText.includes("The subscription already exists"))||!doTask&&/"subscribed":false/.test(data.responseText)?(logStatus.success(),doTask&&!verify&&(this.tasks.channels=unique([...this.tasks.channels,link])),!0):verify&&data.responseText.includes("You may not subscribe to yourself")?(logStatus.success(),!0):(logStatus.error(i18n("tryUpdateYtbAuth"),!0),!1):(logStatus.error(`Error:${data?.statusText}(${data?.status})`),!1);logStatus.error(result+`:${statusText}(${status})`)}else scripts_echoLog({text:'"getYtbToken" failed'});return!1}catch(error){return throwError(error,"Youtube.toggleChannel"),!1}}async#toggleLikeVideo({link,doTask=!0}){try{var{params,needLogin}=await this.#getInfo(link,"likeVideo"),{apiKey,client,request,videoId,likeParams}=params||{};if(needLogin)scripts_echoLog({html:""+i18n("loginYtb")});else if(apiKey&&client&&request&&videoId&&likeParams){if(!doTask&&this.whiteList.likes.includes(videoId))return scripts_echoLog({type:"whiteList",text:"Youtube.unlikeVideo",id:videoId}),!0;var logStatus=scripts_echoLog({type:doTask?"likingYtbVideo":"unlikingYtbVideo",text:videoId}),nowTime=parseInt(String((new Date).getTime()/1e3),10),likeVideoData={context:{client:client,request:{sessionId:request.sessionId,internalExperimentFlags:[],consistencyTokenJars:[]},user:{}},target:{videoId:videoId}};if(doTask){if(!likeParams)return logStatus.error("Empty likeParams"),!1;likeVideoData.params=likeParams}var{result,statusText,status,data}=await tools_httpRequest({url:`https://www.youtube.com/youtubei/v1/like/${doTask?"":"remove"}like?key=`+apiKey,method:"POST",headers:{origin:"https://www.youtube.com",referer:"https://www.youtube.com/watch?v="+videoId,"content-type":"application/json","x-goog-authuser":"0","x-goog-visitor-id":client.visitorData,"x-origin":"https://www.youtube.com",authorization:`SAPISIDHASH ${nowTime}_`+sha1(`${nowTime} ${this.#auth.PAPISID} https://www.youtube.com`)},data:JSON.stringify(likeVideoData)});if("Success"===result)return 200===data?.status?doTask&&data.responseText.includes("Added to Liked videos")||!doTask&&(data.responseText.includes("Removed from Liked videos")||data.responseText.includes("Dislike removed"))?(logStatus.success(),doTask&&(this.tasks.likes=unique([...this.tasks.likes,link])),!0):(logStatus.error(i18n("tryUpdateYtbAuth"),!0),!1):(logStatus.error(`Error:${data?.statusText}(${data?.status})`),!1);logStatus.error(result+`:${statusText}(${status})`)}else scripts_echoLog({text:'"getYtbToken" failed'});return!1}catch(error){return throwError(error,"Youtube.toggleLikeVideo"),!1}}async toggle({doTask=!0,channelLinks=[],videoLinks=[]}){try{if(!this.#initialized)return scripts_echoLog({text:i18n("needInit")}),!1;var prom=[];if(doTask&&!globalOptions.doTask.youtube.channels||!doTask&&!globalOptions.undoTask.youtube.channels)scripts_echoLog({type:"globalOptionsSkip",text:"youtube.channels"});else{var realChannels=this.getRealParams("channels",channelLinks,doTask,link=>/^https:\/\/(www\.)?google\.com.*?\/url\?.*?url=https:\/\/www\.youtube\.com\/.*/.test(link)?link.match(/url=(https:\/\/www\.youtube\.com\/.*)/)?.[1]:link);if(0<realChannels.length)for(var channel of realChannels)prom.push(this.#toggleChannel({link:channel,doTask:doTask})),await delay(1e3)}if(doTask&&!globalOptions.doTask.youtube.likes||!doTask&&!globalOptions.undoTask.youtube.likes)scripts_echoLog({type:"globalOptionsSkip",text:"youtube.likes"});else{var realLikes=this.getRealParams("likes",videoLinks,doTask,link=>/^https:\/\/(www\.)?google\.com.*?\/url\?.*?url=https:\/\/www\.youtube\.com\/.*/.test(link)?link.match(/url=(https:\/\/www\.youtube\.com\/.*)/)?.[1]:link);if(0<realLikes.length)for(var video of realLikes)prom.push(this.#toggleLikeVideo({link:video,doTask:doTask})),await delay(1e3)}return Promise.all(prom).then(()=>!0)}catch(error){return throwError(error,"Youtube.toggle"),!1}}}let social_SteamASF=class{#asfOptions;#botName="asf";#groupInfo;async init(){try{var asfCommandsUrl=new URL("/Api/Command/",globalOptions.ASF.AsfIpcUrl),logStatus=(this.#asfOptions={url:asfCommandsUrl.href,method:"POST",responseType:"json",headers:{accept:"application/json","Content-Type":"application/json",Host:asfCommandsUrl.host,Origin:asfCommandsUrl.origin,Referer:asfCommandsUrl.href,Authentication:globalOptions.ASF.AsfIpcPassword}},globalOptions.ASF.AsfBotname&&(this.#botName=globalOptions.ASF.AsfBotname),scripts_echoLog({text:i18n("initingASF")})),{result,statusText,status,data}=await tools_httpRequest({...this.#asfOptions,data:'{"Command":"!stats"}'});return"Success"===result?!0===data?.response?.Success&&"OK"===data.response.Message&&data.response.Result?(logStatus.success(),!0):(data?.response?.Result||data?.response?.Message?logStatus.error(data?.response?.Result||data.response.Message):logStatus.error(`Error:${data?.statusText}(${data?.status})`),!1):(logStatus.error(result+`:${statusText}(${status})`),!1)}catch(error){return throwError(error,"SteamASF.init"),!1}}async joinGroup(groupName){try{var logStatus=scripts_echoLog({type:"joiningSteamGroup",text:groupName});let{result,statusText,status,data}=await tools_httpRequest({...this.#asfOptions,data:JSON.stringify({Command:`!JOINGROUP ${this.#botName} `+groupName})});return"Success"===result?200===data?.status&&["已加入","已申请","Joined","Applied","Присоединился","costs"].find(text=>data.response?.Result?.includes(text))?(logStatus.success(),!0):(logStatus.error(`Error:${data?.response?.Result||data?.response?.Message||data?.statusText}(${data?.status})`),!1):(logStatus.error(result+`:${statusText}(${status})`),!1)}catch(error){return throwError(error,"SteamASF.joinGroup"),!1}}async leaveGroup(groupName){try{if(this.#groupInfo||await this.#getGroupId()){var groupId=await this.#groupInfo[groupName];if(groupId){var logStatus=scripts_echoLog({type:"leavingSteamGroup",text:groupName});let{result,statusText,status,data}=await tools_httpRequest({...this.#asfOptions,data:JSON.stringify({Command:`!LEAVEGROUP ${this.#botName} `+groupId})});if("Success"===result)return 200===data?.status&&["成功","Success","Успех"].find(text=>data.response?.Result?.includes(text))?(logStatus.success(),!0):(logStatus.error(`Error:${data?.response?.Result||data?.response?.Message||data?.statusText}(${data?.status})`),!1);logStatus.error(result+`:${statusText}(${status})`)}}return!1}catch(error){return throwError(error,"SteamASF.leaveGroup"),!1}}async#getGroupId(){try{var logStatus=scripts_echoLog({type:"gettingSteamGroupId",text:"All"}),{result,statusText,status,data}=await tools_httpRequest({...this.#asfOptions,data:JSON.stringify({Command:"!GROUPLIST "+this.#botName})});return"Success"===result?200===data?.status&&data.response?.Result?.includes("|")?(this.#groupInfo=Object.fromEntries(data.response.Result.split("\n").map(line=>{var[,line,id]=line.trim().split("|");return line&&id?[line,id]:null}).filter(ele=>ele)),logStatus.success(),!0):(logStatus.error(`Error:${data?.response?.Result||data?.response?.Message||data?.statusText}(${data?.status})`),!1):(logStatus.error(result+`:${statusText}(${status})`),!1)}catch(error){return throwError(error,"SteamASF.getGroupID"),!1}}async addToWishlist(gameId){try{var logStatus=scripts_echoLog({type:"addingToWishlist",text:gameId});if(!0===(await this.#checkGame(gameId)).wishlist)return logStatus.success(),!0;let{result,statusText,status,data}=await tools_httpRequest({...this.#asfOptions,data:JSON.stringify({Command:`!ADDWISHLIST ${this.#botName} `+gameId})});return"Success"===result?200===data?.status&&["成功","Success","Успех"].find(text=>data.response?.Result?.includes(text))?(logStatus.success(),!0):(logStatus.error(`Error:${data?.response?.Result||data?.response?.Message||data?.statusText}(${data?.status})`),!1):(logStatus.error(result+`:${statusText}(${status})`),!1)}catch(error){return throwError(error,"SteamASF.addToWishlist"),!1}}async removeFromWishlist(gameId){try{var logStatus=scripts_echoLog({type:"removingFromWishlist",text:gameId});if(!1===(await this.#checkGame(gameId)).wishlist)return logStatus.success(),!0;let{result,statusText,status,data}=await tools_httpRequest({...this.#asfOptions,data:JSON.stringify({Command:`!REMOVEWISHLIST ${this.#botName} `+gameId})});return"Success"===result?200===data?.status&&["成功","Success","Успех"].find(text=>data.response?.Result?.includes(text))?(logStatus.success(),!0):(logStatus.error(`Error:${data?.response?.Result||data?.response?.Message||data?.statusText}(${data?.status})`),!1):(logStatus.error(result+`:${statusText}(${status})`),!1)}catch(error){return throwError(error,"SteamASF.removeFromWishlist"),!1}}async toggleFollowGame(gameId,doTask){try{var logStatus=scripts_echoLog({type:`${doTask?"":"un"}followingGame`,text:gameId});if(doTask&&!0===(await this.#checkGame(gameId)).followed||!doTask&&!1===(await this.#checkGame(gameId)).followed)return logStatus.success(),!0;let{result,statusText,status,data}=await tools_httpRequest({...this.#asfOptions,data:JSON.stringify({Command:`!${doTask?"":"UN"}FOLLOWGAME ${this.#botName} `+gameId})});return"Success"===result?200===data?.status&&["成功","Success","Успех"].find(text=>data.response?.Result?.includes(text))?(logStatus.success(),!0):(logStatus.error(`Error:${data?.response?.Result||data?.response?.Message||data?.statusText}(${data?.status})`),!1):(logStatus.error(result+`:${statusText}(${status})`),!1)}catch(error){return throwError(error,"SteamASF.toggleFollowGame"),!1}}async#checkGame(gameId){try{var matchedResult,{result,data}=await tools_httpRequest({...this.#asfOptions,data:JSON.stringify({Command:`!CHECK ${this.#botName} `+gameId})});return"Success"===result?200===data?.status&&data.response?.Result?.includes(gameId)&&3<(matchedResult=data.response.Result.split("\n").find(result=>result.includes(gameId))?.split("|"))?.length?{wishlist:"√"===matchedResult.at(-3).trim()||"√"===matchedResult.at(-2).trim(),followed:"√"===matchedResult.at(-1).trim()}:{}:{}}catch(error){return throwError(error,"SteamASF.checkGame"),{}}}async toggleCurator(curatorId,doTask=!0){try{var logStatus=scripts_echoLog({type:doTask?"followingCurator":"unfollowingCurator",text:curatorId});let{result,statusText,status,data}=await tools_httpRequest({...this.#asfOptions,data:JSON.stringify({Command:`!${doTask?"":"UN"}FOLLOWCURATOR ${this.#botName} `+curatorId})});return"Success"===result?200===data?.status&&["成功","Success","Успех"].find(text=>data.response?.Result?.includes(text))?(logStatus.success(),!0):(logStatus.error(`Error:${data?.response?.Result||data?.response?.Message||data?.statusText}(${data?.status})`),!1):(logStatus.error(result+`:${statusText}(${status})`),!1)}catch(error){return throwError(error,"Steam.toggleCurator"),!1}}async addLicense(id){try{var[type,ids]=id.split("-");if("appid"===type){var logStatus=scripts_echoLog({type:"addingFreeLicense",text:ids});let{result,statusText,status,data}=await tools_httpRequest({...this.#asfOptions,data:JSON.stringify({Command:`!addlicense ${this.#botName} app/`+ids})});return"Success"===result?200===data?.status&&["AlreadyPurchased","OK"].find(text=>data.response?.Result?.includes(text))?(logStatus.success(),!0):(logStatus.error(`Error:${data?.response?.Result||data?.response?.Message||data?.statusText}(${data?.status})`),!1):(logStatus.error(result+`:${statusText}(${status})`),!1)}if("subid"===type){var idsArr=ids.split(",");let logStatus=scripts_echoLog({type:"addingFreeLicenseSubid",text:ids});var{result,statusText,status,data}=await tools_httpRequest({...this.#asfOptions,data:JSON.stringify({Command:`!addlicense ${this.#botName} `+idsArr.map(id=>"sub/"+id).join(",")})});if("Success"===result){if(200===data?.status&&data.response?.Result){let resultLines=data.response.Result.split("\n");return idsArr.forEach(subid=>{let targetLine=resultLines.find(text=>text.includes(subid));targetLine&&["成功","Success","Успех"].find(text=>targetLine.includes(text))?scripts_echoLog({}).success(targetLine):scripts_echoLog({}).error(targetLine)}),!0}logStatus.error(`Error:${data?.response?.Result||data?.response?.Message||data?.statusText}(${data?.status})`)}else logStatus.error(result+`:${statusText}(${status})`)}return!1}catch(error){return throwError(error,"SteamASF.addLicense"),!1}}async requestPlayTestAccess(id){try{var logStatus=scripts_echoLog({type:"requestingPlayTestAccess",text:id});let{result,statusText,status,data}=await tools_httpRequest({...this.#asfOptions,data:JSON.stringify({Command:`!REQUESTACCESS ${this.#botName} `+id})});return"Success"===result?200===data?.status&&["成功","Success","Успех"].find(text=>data.response?.Result?.includes(text))?(logStatus.success(),!0):(logStatus.error(`Error:${data?.response?.Result||data?.response?.Message||data?.statusText}(${data?.status})`),!1):(logStatus.error(result+`:${statusText}(${status})`),!1)}catch(error){return throwError(error,"Steam.requestPlayTestAccess"),!1}}};class Steam extends userDefinedGlobalOptions{tasks;whiteList;#cache={group:{},officialGroup:{},forum:{},workshop:{},curator:{},...GM_getValue("steamCache")};#auth={};#storeInitialized=!1;#communityInitialized=!1;#area="CN";#oldArea;#areaStatus="end";#ASF;constructor(){super();var defaultTasksTemplate={groups:[],officialGroups:[],wishlists:[],follows:[],forums:[],workshops:[],workshopVotes:[],curators:[],curatorLikes:[],announcements:[],licenses:[],playtests:[]};this.tasks=defaultTasksTemplate,this.whiteList={...defaultTasksTemplate,...GM_getValue("whiteList")?.steam||{}}}async init(type="all"){try{if(globalOptions.ASF.AsfEnabled&&globalOptions.ASF.AsfIpcUrl&&globalOptions.ASF.AsfIpcPassword)return this.#ASF=new social_SteamASF,!!await this.#ASF.init()&&(this.#storeInitialized=!0,this.#communityInitialized=!0);if("store"===type){if(!this.#storeInitialized){let storeInitialized=await this.#updateStoreAuth();if(storeInitialized=storeInitialized||await this.#updateStoreAuthTab(),this.#storeInitialized=storeInitialized,!this.#storeInitialized)return scripts_echoLog({}).error(i18n("initFailed","Steam")),!1;scripts_echoLog({}).success(i18n("initSuccess","SteamStore"))}}else{if("community"!==type)return this.#storeInitialized&&this.#communityInitialized?(scripts_echoLog({}).success(i18n("initSuccess","Steam")),!0):(scripts_echoLog({}).error(i18n("initFailed","Steam")),!1);if(!this.#communityInitialized){let communityInitialized=await this.#updateCommunityAuth();if(communityInitialized||(communityInitialized=await this.#updateCommunityAuthTab(),GM_setValue("steamCommunityAuth",null)),this.#communityInitialized=communityInitialized,!this.#communityInitialized)return scripts_echoLog({}).error(i18n("initFailed","Steam")),!1;scripts_echoLog({}).success(i18n("initSuccess","SteamCommunity"))}}return!0}catch(error){return throwError(error,"Steam.init"),!1}}async#refreshToken(type="steamStore"){try{var host={steamStore:"store.steampowered.com",steamCommunity:"steamcommunity.com"},logStatus=scripts_echoLog({text:i18n("refreshingToken",i18n(type))}),formData=new FormData,{result,statusText,status,data}=(formData.append("redir",`https://${host[type]}/`),await tools_httpRequest({url:"https://login.steampowered.com/jwt/ajaxrefresh",method:"POST",responseType:"json",headers:{Host:"login.steampowered.com",Origin:"https://"+host[type],Referer:`https://${host[type]}/`},data:formData}));return"Success"===result?data?.response?.success?await this.#setStoreToken(data.response,type)?(logStatus.success(),!0):(logStatus.error("Error"),!1):(logStatus.error(`Error:${data?.statusText}(${data?.status})`),!1):(logStatus.error(result+`:${statusText}(${status})`),!1)}catch(error){return throwError(error,"Steam.refreshToken"),!1}}async#setStoreToken(param,type){try{var host={steamStore:"store.steampowered.com",steamCommunity:"steamcommunity.com"},logStatus=scripts_echoLog({text:i18n("settingToken",i18n(type))}),formData=new FormData,{result,statusText,status,data}=(formData.append("steamID",param.steamID),formData.append("nonce",param.nonce),formData.append("redir",param.redir),formData.append("auth",param.auth),await tools_httpRequest({url:`https://${host[type]}/login/settoken`,method:"POST",headers:{Accept:"application/json, text/plain, */*",Host:host[type],Origin:"https://"+host[type]},data:formData}));return"Success"===result?200===data?.status?(logStatus.success(),!0):(logStatus.error(`Error:${data?.statusText}(${data?.status})`),!1):(logStatus.error(result+`:${statusText}(${status})`),!1)}catch(error){return throwError(error,"Steam.setStoreToken"),!1}}async#updateStoreAuth(retry=!1){try{var storeSessionID,logStatus=scripts_echoLog({text:i18n("updatingAuth",i18n("steamStore"))}),{result,statusText,status,data}=await tools_httpRequest({url:"https://store.steampowered.com/",method:"GET",headers:{Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9","Sec-Fetch-Dest":"document","Sec-Fetch-Mode":"navigate","Upgrade-Insecure-Requests":"1"},fetch:!1,redirect:"manual"});return 200===data?.status?data.responseText.includes("data-miniprofile=")?(storeSessionID=data.responseText.match(/g_sessionID = "(.+?)";/)?.[1])?(this.#auth.storeSessionID=storeSessionID,logStatus.success(),!0):(logStatus.error('Error: Get "sessionID" failed'),!1):!await this.#refreshToken("steamStore")||(logStatus.warning(i18n("retry")),retry)?(logStatus.error("Error:"+i18n("needLoginSteamStore"),!0),!1):this.#updateStoreAuth(!0):[301,302].includes(data?.status)?!await this.#refreshToken("steamStore")||(logStatus.warning(i18n("retry")),retry)?(logStatus.error("Error:"+i18n("needLoginSteamStore"),!0),!1):this.#updateStoreAuth(!0):(logStatus.error(result+`:${statusText}(${status})`),!1)}catch(error){return throwError(error,"Steam.updateStoreAuth"),!1}}async#updateStoreAuthTab(){try{let logStatus=scripts_echoLog({text:i18n("updatingAuth",i18n("steamStoreTab"))});return await new Promise(resolve=>{GM_deleteValue("steamStoreAuth"),GM_setValue("ATv4_updateStoreAuth",!0);let newTab=GM_openInTab("https://store.steampowered.com/",{active:!0,setParent:!0}),listenerId=(newTab.name="ATv4_updateStoreAuth",GM_addValueChangeListener("steamStoreAuth",(key,oldValue,newValue)=>{GM_removeValueChangeListener(listenerId),GM_deleteValue("ATv4_updateStoreAuth"),newTab?.close(),window.focus(),newValue&&JSON.stringify(newValue)!==JSON.stringify(oldValue)?(this.#auth.storeSessionID=newValue.storeSessionID,logStatus.success(),resolve(!0)):(logStatus.error("Failed"),resolve(!1))}));newTab.onclose=()=>{GM_deleteValue("ATv4_updateStoreAuth")}})}catch(error){return throwError(error,"Steam.updateStoreAuthTab"),!1}}async#updateCommunityAuthTab(){try{let logStatus=scripts_echoLog({text:i18n("updatingAuth",i18n("steamCommunityTab"))});return await new Promise(resolve=>{GM_deleteValue("steamCommunityAuth"),GM_setValue("ATv4_updateCommunityAuth",!0);let newTab=GM_openInTab("https://steamcommunity.com/my",{active:!0,setParent:!0}),listenerId=(newTab.name="ATv4_updateCommunityAuth",GM_addValueChangeListener("steamCommunityAuth",(key,oldValue,newValue)=>{GM_removeValueChangeListener(listenerId),GM_deleteValue("ATv4_updateCommunityAuth"),newTab?.close(),window.focus(),newValue&&JSON.stringify(newValue)!==JSON.stringify(oldValue)?(this.#auth.steam64Id=newValue.steam64Id,this.#auth.communitySessionID=newValue.communitySessionID,logStatus.success(),resolve(!0)):(logStatus.error("Failed"),resolve(!1))}));newTab.onclose=()=>{GM_deleteValue("ATv4_updateCommunityAuth")}})}catch(error){return throwError(error,"Steam.updateCommunityAuthTab"),!1}}async#updateCommunityAuth(){try{var logStatus=scripts_echoLog({text:i18n("gettingUserLink")}),{result,statusText,status,data}=await tools_httpRequest({url:"https://steamcommunity.com/my",method:"GET",headers:{Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7",Host:"steamcommunity.com","Sec-Fetch-Dest":"document","Sec-Fetch-Mode":"navigate"},fetch:!1});if(200===data?.status)if(data.finalUrl.includes("https://steamcommunity.com/login/home"))logStatus.error("Error:"+i18n("needLoginSteamCommunity"),!0);else{var steam64Id=data.responseText.match(/g_steamID = "(.+?)";/)?.[1],communitySessionID=data.responseText.match(/g_sessionID = "(.+?)";/)?.[1];if(steam64Id&&communitySessionID)return this.#auth.steam64Id=steam64Id,this.#auth.communitySessionID=communitySessionID,logStatus.success(),!0;logStatus.error('Error: Get "sessionID" failed')}else logStatus.error(result+`:${statusText}(${status})`);return!1}catch(error){return throwError(error,"Steam.updateCommunityAuth"),!1}}async#getAreaInfo(){try{var logStatus=scripts_echoLog({text:i18n("gettingAreaInfo")}),{result,statusText,status,data}=await tools_httpRequest({url:"https://store.steampowered.com/cart/",method:"GET"});if("Success"===result)if(200===data?.status){var cartConfigRaw=data.responseText.match(/data-cart_config="(.*?)"/)?.[1],temp=document.createElement("div"),cartConfigStr=(temp.innerHTML=cartConfigRaw||"{}",temp.textContent||temp.innerText);let cartConfig;try{cartConfig=JSON.parse(cartConfigStr)}catch(error){return logStatus.error("Error: get country info filed"),console.error(error),{}}if(cartConfig.rgUserCountryOptions){var userInfoRaw=data.responseText.match(/data-userinfo="(.*?)"/)?.[1],temp1=document.createElement("div"),userInfoStr=(temp1.innerHTML=userInfoRaw||"{}",temp1.textContent||temp1.innerText);let userInfo;try{userInfo=JSON.parse(userInfoStr)}catch(error){return logStatus.error("Error: get country info filed"),console.error(error),{}}var currentArea=userInfo.country_code,areas=Object.keys(cartConfig.rgUserCountryOptions).filter(area=>"help"!==area);if(currentArea&&0<areas.length)return this.#area=currentArea,logStatus.success(),{currentArea:currentArea,areas:areas};logStatus.error("Error: get country info filed")}else logStatus.warning("Warning: Area cannot be changed")}else logStatus.error(`Error:${data?.statusText}(${data?.status})`);else logStatus.error(result+`:${statusText}(${status})`);return{}}catch(error){return throwError(error,"Steam.getAreaInfo"),{}}}async#changeArea(area){try{if("waiting"===this.#areaStatus&&await new Promise(resolve=>{let checker=setInterval(()=>{"waiting"!==this.#areaStatus&&(clearInterval(checker),resolve(!0))})}),this.#area===area||!area&&"CN"!==this.#area)return!0;this.#areaStatus="waiting";let aimedArea=area;if(!aimedArea){var{currentArea,areas}=await this.#getAreaInfo();if(!currentArea||!areas)return!(this.#areaStatus="error");if("CN"!==currentArea)return this.#areaStatus="skip",scripts_echoLog({text:"notNeededChangeArea"}),"skip";var anotherArea=areas.filter(area=>area&&"CN"!==area);if(!anotherArea||0===anotherArea.length)return this.#areaStatus="noAnotherArea",scripts_echoLog({text:"noAnotherArea"}),!1;[aimedArea]=anotherArea}var logStatus=scripts_echoLog({text:i18n("changingArea",aimedArea)}),{result,statusText,status,data}=await tools_httpRequest({url:"https://store.steampowered.com/country/setcountry",method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},data:$.param({cc:aimedArea,sessionid:this.#auth.storeSessionID})});if("Success"!==result)return this.#areaStatus="error",logStatus.error(result+`:${statusText}(${status})`),"CN";if(200!==data?.status||"true"!==data.responseText)return this.#areaStatus="error",logStatus.error(`Error:${data?.statusText}(${data?.status})`),"CN";{let currentArea=(await this.#getAreaInfo()).currentArea;return(currentArea&&(this.#area=currentArea,this.#oldArea||(this.#oldArea=currentArea)),currentArea===aimedArea)?(this.#areaStatus="success",logStatus.success(),currentArea):(this.#areaStatus="error",logStatus.error("Error: change country filed"),"CN")}}catch(error){return this.#areaStatus="error",throwError(error,"Steam.changeArea"),!1}}async#joinGroup(groupName){try{var logStatus,result,statusText,status,data;return this.#ASF?!!await this.#ASF.joinGroup(groupName)&&(this.tasks.groups=unique([...this.tasks.groups,groupName]),!0):(logStatus=scripts_echoLog({type:"joiningSteamGroup",text:groupName}),{result,statusText,status,data}=await tools_httpRequest({url:"https://steamcommunity.com/groups/"+groupName,method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},data:$.param({action:"join",sessionID:this.#auth.communitySessionID})}),"Success"===result?200!==data?.status||data.responseText.includes("grouppage_join_area")?(logStatus.error(`Error:${data?.statusText}(${data?.status})`),!1):(logStatus.success(),this.tasks.groups=unique([...this.tasks.groups,groupName]),!0):(logStatus.error(result+`:${statusText}(${status})`),!1))}catch(error){return throwError(error,"Steam.joinGroup"),!1}}async#leaveGroup(groupName){try{if(this.whiteList.groups.includes(groupName))return scripts_echoLog({type:"whiteList",text:"Steam.leaveGroup",id:groupName}),!0;if(this.#ASF)return await this.#ASF.leaveGroup(groupName);var groupId=await this.#getGroupId(groupName);if(groupId){var logStatus=scripts_echoLog({type:"leavingSteamGroup",text:groupName}),{result,statusText,status,data}=await tools_httpRequest({url:`https://steamcommunity.com/profiles/${this.#auth.steam64Id}/home_process`,method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},data:$.param({sessionID:this.#auth.communitySessionID,action:"leaveGroup",groupId:groupId})});if("Success"===result)return 200===data?.status&&data.finalUrl.includes("groups")&&0===$(data.responseText.replace(/<img.*?>/g,"").toLowerCase()).find(`a[href='https://steamcommunity.com/groups/${groupName.toLowerCase()}']`).length?(logStatus.success(),!0):(logStatus.error(`Error:${data?.statusText}(${data?.status})`),!1);logStatus.error(result+`:${statusText}(${status})`)}return!1}catch(error){return throwError(error,"Steam.leaveGroup"),!1}}async#getGroupId(groupName){try{var logStatus=scripts_echoLog({type:"gettingSteamGroupId",text:groupName}),groupId=this.#cache.group[groupName];if(groupId)return logStatus.success(),groupId;var{result,statusText,status,data}=await tools_httpRequest({url:"https://steamcommunity.com/groups/"+groupName,method:"GET",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}});if("Success"!==result)return logStatus.error(result+`:${statusText}(${status})`),!1;if(200!==data?.status)return logStatus.error(`Error:${data?.statusText}(${data?.status})`),!1;{let groupId=data.responseText.match(/OpenGroupChat\( '([0-9]+)'/)?.[1];return groupId?(this.#setCache("group",groupName,groupId),logStatus.success(),groupId):(logStatus.error(`Error:${data.statusText}(${data.status})`),!1)}}catch(error){return throwError(error,"Steam.getGroupID"),!1}}async#joinOfficialGroup(gameId){try{var logStatus,result,statusText,status,data,groupId;return this.#ASF?!!await this.#ASF.joinGroup(gameId)&&(this.tasks.officialGroups=unique([...this.tasks.officialGroups,gameId]),!0):(logStatus=scripts_echoLog({type:"joiningSteamOfficialGroup",text:gameId}),{result,statusText,status,data}=await tools_httpRequest({url:`https://steamcommunity.com/games/${gameId}?action=join&sessionID=`+this.#auth.communitySessionID,method:"GET",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}),"Success"===result?200!==data?.status||data.responseText.includes('id="publicGroupJoin"')?(logStatus.error(`Error:${data?.statusText}(${data?.status})`),!1):(logStatus.success(),this.tasks.officialGroups=unique([...this.tasks.officialGroups,gameId]),(groupId=data.responseText.match(/steam:\/\/friends\/joinchat\/([0-9]+)/)?.[1])&&this.#setCache("officialGroup",gameId,groupId),!0):(logStatus.error(result+`:${statusText}(${status})`),!1))}catch(error){return throwError(error,"Steam.joinOfficialGroup"),!1}}async#leaveOfficialGroup(gameId){try{if(this.whiteList.officialGroups.includes(gameId))return scripts_echoLog({type:"whiteList",text:"Steam.leaveOfficialGroup",id:gameId}),!0;if(this.#ASF)return await this.#ASF.leaveGroup(gameId);var groupId=await this.#getOfficialGroupId(gameId);if(groupId){var resultR,statusTextR,statusR,dataR,logStatus=scripts_echoLog({type:"leavingSteamOfficialGroup",text:gameId}),{result,statusText,status,data}=await tools_httpRequest({url:`https://steamcommunity.com/profiles/${this.#auth.steam64Id}/home_process`,method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},data:$.param({sessionID:this.#auth.communitySessionID,action:"leaveGroup",groupId:groupId})});if("Success"===result)return 200===data?.status?({result:resultR,statusText:statusTextR,status:statusR,data:dataR}=await tools_httpRequest({url:"https://steamcommunity.com/games/"+gameId,method:"GET",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}),"Success"===resultR?200===dataR?.status&&dataR.responseText.includes('id="publicGroupJoin"')?(logStatus.success(),!0):(logStatus.error(`Error:${dataR?.statusText}(${dataR?.status})`),!1):(logStatus.error(resultR+`:${statusTextR}(${statusR})`),!1)):(logStatus.error(`Error:${data?.statusText}(${data?.status})`),!1);logStatus.error(result+`:${statusText}(${status})`)}return!1}catch(error){return throwError(error,"Steam.leaveOfficialGroup"),!1}}async#getOfficialGroupId(gameId){try{var logStatus=scripts_echoLog({type:"gettingSteamOfficialGroupId",text:gameId}),groupId=this.#cache.officialGroup[gameId];if(groupId)return logStatus.success(),groupId;var{result,statusText,status,data}=await tools_httpRequest({url:"https://steamcommunity.com/games/"+gameId,method:"GET",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}});if("Success"!==result)return logStatus.error(result+`:${statusText}(${status})`),!1;if(200!==data?.status)return logStatus.error(`Error:${data?.statusText}(${data?.status})`),!1;{let groupId=data.responseText.match(/steam:\/\/friends\/joinchat\/([0-9]+)/)?.[1];return groupId?(this.#setCache("officialGroup",gameId,groupId),logStatus.success(),groupId):(logStatus.error(`Error:${data.statusText}(${data.status})`),!1)}}catch(error){return throwError(error,"Steam.getGroupID"),!1}}async#addToWishlist(gameId){try{if(this.#ASF)return!!await this.#ASF.addToWishlist(gameId)&&(this.tasks.wishlists=unique([...this.tasks.wishlists,gameId]),!0);var logStatus=scripts_echoLog({type:"addingToWishlist",text:gameId}),{result,data}=await tools_httpRequest({url:"https://store.steampowered.com/api/addtowishlist",method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},data:$.param({sessionid:this.#auth.storeSessionID,appid:gameId}),dataType:"json"});if("Success"!==result||200!==data?.status||!0!==data.response?.success){var{result:resultR,statusText:statusTextR,status:statusR,data:dataR}=await tools_httpRequest({url:"https://store.steampowered.com/app/"+gameId,method:"GET"});if("Success"!==resultR)return logStatus.error(resultR+`:${statusTextR}(${statusR})`),!1;if(200!==dataR?.status)return logStatus.error(`Error:${dataR?.statusText}(${dataR?.status})`),!1;if("CN"===this.#area&&dataR.responseText.includes('id="error_box"'))return logStatus.warning(i18n("changeAreaNotice")),!!await this.#changeArea()&&await this.#addToWishlist(gameId);if((!dataR.responseText.includes('class="queue_actions_ctn"')||!dataR.responseText.includes('class="already_in_library"'))&&(dataR.responseText.includes('class="queue_actions_ctn"')&&dataR.responseText.includes('id="add_to_wishlist_area_success" style="display: none;')||!dataR.responseText.includes('class="queue_actions_ctn"')))return logStatus.error(`Error:${dataR.statusText}(${dataR.status})`),!1}return logStatus.success(),this.tasks.wishlists=unique([...this.tasks.wishlists,gameId]),!0}catch(error){return throwError(error,"Steam.addToWishlist"),!1}}async#removeFromWishlist(gameId){try{if(this.whiteList.wishlists.includes(gameId))return scripts_echoLog({type:"whiteList",text:"Steam.removeFromWishlist",id:gameId}),!0;if(this.#ASF)return await this.#ASF.removeFromWishlist(gameId);var logStatus=scripts_echoLog({type:"removingFromWishlist",text:gameId}),{result,data}=await tools_httpRequest({url:"https://store.steampowered.com/api/removefromwishlist",method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},data:$.param({sessionid:this.#auth.storeSessionID,appid:gameId}),dataType:"json"});if("Success"===result&&200===data?.status&&!0===data.response?.success)return logStatus.success(),!0;var{result:resultR,statusText:statusTextR,status:statusR,data:dataR}=await tools_httpRequest({url:"https://store.steampowered.com/app/"+gameId,method:"GET"});if("Success"!==resultR)return logStatus.error(resultR+`:${statusTextR}(${statusR})`),!1;if(200!==dataR?.status)return logStatus.error(`Error:${dataR?.statusText}(${dataR?.status})`),!1;if("CN"===this.#area&&dataR.responseText.includes('id="error_box"')){logStatus.warning(i18n("changeAreaNotice"));let result=await this.#changeArea();return result&&"CN"!==result&&"skip"!==result?await this.#removeFromWishlist(gameId):!1}return dataR.responseText.includes('class="queue_actions_ctn"')&&(dataR.responseText.includes("ds_owned_flag ds_flag")||dataR.responseText.includes("add_to_wishlist_area"))?(logStatus.success(),!0):(logStatus.error(`Error:${dataR.statusText}(${dataR.status})`),!1)}catch(error){return throwError(error,"Steam.removeFromWishlist"),!1}}async#toggleFollowGame(gameId,doTask){try{var logStatus,requestData,result,data,followed;return!doTask&&this.whiteList.follows.includes(gameId)?(scripts_echoLog({type:"whiteList",text:"Steam.unfollowGame",id:gameId}),!0):this.#ASF?!!await this.#ASF.toggleFollowGame(gameId,doTask)&&(doTask&&(this.tasks.follows=unique([...this.tasks.follows,gameId])),!0):(logStatus=scripts_echoLog({type:`${doTask?"":"un"}followingGame`,text:gameId}),requestData={sessionid:this.#auth.storeSessionID,appid:gameId},{result,data}=(doTask||(requestData.unfollow="1"),await tools_httpRequest({url:"https://store.steampowered.com/explore/followgame/",method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},data:$.param(requestData)})),"Success"===result&&200===data?.status&&"true"===data.responseText?(logStatus.success(),!0):(followed=await this.#isFollowedGame(gameId),"CN"===this.#area&&"areaLocked"===followed?(logStatus.warning(i18n("changeAreaNotice")),!!await this.#changeArea()&&await this.#toggleFollowGame(gameId,doTask)):doTask===followed?(logStatus.success(),doTask&&(this.tasks.follows=unique([...this.tasks.follows,gameId])),!0):(logStatus.error(`Error:${data?.statusText}(${data?.status})`),!1)))}catch(error){return throwError(error,"Steam.toggleFollowGame"),!1}}async#isFollowedGame(gameId){try{var{result,data}=await tools_httpRequest({url:"https://store.steampowered.com/app/"+gameId,method:"GET"});return"Success"===result?200===data?.status&&("CN"===this.#area&&data.responseText.includes('id="error_box"')?"areaLocked":"none"!==$(data.responseText.replace(/<img.*?>/g,"")).find(".queue_control_button.queue_btn_follow>.btnv6_blue_hoverfade.btn_medium.queue_btn_active").css("display")):!1}catch(error){return throwError(error,"Steam.isFollowedGame"),!1}}async#toggleForum(gameId,doTask=!0){try{if(!doTask&&this.whiteList.forums.includes(gameId))scripts_echoLog({type:"whiteList",text:"Steam.unsubscribeForum",id:gameId});else{var forumId=await this.#getForumId(gameId);if(!forumId)return!1;var logStatus=scripts_echoLog({type:`${doTask?"":"un"}subscribingForum`,text:gameId}),[id,feature]=forumId.split("_"),{result,statusText,status,data}=await tools_httpRequest({url:`https://steamcommunity.com/forum/${id}/General/${doTask?"":"un"}subscribe/${feature||"0"}/`,method:"POST",responseType:"json",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},data:$.param({sessionid:this.#auth.communitySessionID})});"Success"===result?200!==data?.status||1!==data.response?.success&&29!==data.response?.success?logStatus.error(`Error:${data?.statusText}(${data?.status})`):(doTask&&(this.tasks.forums=unique([...this.tasks.forums,gameId])),logStatus.success()):logStatus.error(result+`:${statusText}(${status})`)}return!0}catch(error){return throwError(error,"Steam.toggleForum"),!0}}async#getForumId(gameId){try{var logStatus=scripts_echoLog({type:"gettingForumId",text:gameId}),forumId=this.#cache.forum[gameId];if(forumId)return logStatus.success(),forumId;var{result,statusText,status,data}=await tools_httpRequest({url:`https://steamcommunity.com/app/${gameId}/discussions/`,method:"GET"});if("Success"!==result)return logStatus.error(result+`:${statusText}(${status})`),!1;if(200!==data?.status)return logStatus.error(`Error:${data?.statusText}(${data?.status})`),!1;{let forumId=data.responseText?.match(/General_([\d]+(_[\d]+)?)/)?.[1];return forumId?(this.#setCache("forum",gameId,forumId),logStatus.success(),forumId):(logStatus.error(`Error:${data.statusText}(${data.status})`),!1)}}catch(error){return throwError(error,"Steam.getForumId"),!1}}async#toggleFavoriteWorkshop(id,doTask=!0){try{if(!doTask&&this.whiteList.workshops.includes(id))return scripts_echoLog({type:"whiteList",text:"Steam.unfavoriteWorkshop",id:id}),!0;var appid=await this.#getWorkshopAppId(id);if(appid){var logStatus=scripts_echoLog({type:doTask?"favoritingWorkshop":"unfavoritingWorkshop",text:id}),{result,statusText,status,data}=await tools_httpRequest({url:`https://steamcommunity.com/sharedfiles/${doTask?"":"un"}favorite`,method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},data:$.param({id:id,appid:appid,sessionid:this.#auth.communitySessionID})});if("Success"===result)return 200!==data?.status||data.responseText?(logStatus.error(`Error:${data?.statusText}(${data?.status})`),!1):(doTask&&(this.tasks.workshops=unique([...this.tasks.workshops,id])),logStatus.success(),!0);logStatus.error(result+`:${statusText}(${status})`)}return!1}catch(error){return throwError(error,"Steam.toggleFavoriteWorkshop"),!1}}async#getWorkshopAppId(id){try{var logStatus=scripts_echoLog({type:"gettingWorkshopAppId",text:id}),appId=this.#cache.workshop[id];if(appId)return logStatus.success(),appId;var{result,statusText,status,data}=await tools_httpRequest({url:"https://steamcommunity.com/sharedfiles/filedetails/?id="+id,method:"GET"});if("Success"!==result)return logStatus.error(result+`:${statusText}(${status})`),!1;if(200!==data?.status)return logStatus.error(`Error:${data?.statusText}(${data?.status})`),!1;{let appId=data.responseText.match(/<input type="hidden" name="appid" value="([\d]+?)" \/>/)?.[1];return appId?(this.#setCache("workshop",id,appId),logStatus.success(),appId):(logStatus.error("Error: getWorkshopAppId failed"),!1)}}catch(error){return throwError(error,"Steam.getWorkshopAppId"),!1}}async#voteUpWorkshop(id){try{var logStatus=scripts_echoLog({type:"votingUpWorkshop",text:id}),{result,statusText,status,data}=await tools_httpRequest({url:"https://steamcommunity.com/sharedfiles/voteup",method:"POST",responseType:"json",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},data:$.param({id:id,sessionid:this.#auth.communitySessionID})});return"Success"===result?200===data?.status&&1===data.response?.success?logStatus.success():logStatus.error(`Error:${data?.statusText}(${data?.status})`):logStatus.error(result+`:${statusText}(${status})`),!0}catch(error){return throwError(error,"Steam.voteupWorkshop"),!0}}async#toggleCurator(curatorId,doTask=!0){try{var logStatus,result,statusText,status,data;return!doTask&&this.whiteList.curators.includes(curatorId)?(scripts_echoLog({type:"whiteList",text:"Steam.unfollowCurator",id:curatorId}),!0):this.#ASF?await this.#ASF.toggleCurator(curatorId,doTask):(logStatus=scripts_echoLog({type:doTask?"followingCurator":"unfollowingCurator",text:curatorId}),{result,statusText,status,data}=await tools_httpRequest({url:"https://store.steampowered.com/curators/ajaxfollow",method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},data:$.param({clanid:curatorId,sessionid:this.#auth.storeSessionID,follow:doTask}),dataType:"json"}),"Success"===result?200===data?.status&&1===data.response?.success?.success?(logStatus.success(),!0):(logStatus.error(`Error:${data?.statusText}(`+data?.response?.success||data?.status+")"),!1):(logStatus.error(result+`:${statusText}(${status})`),!1))}catch(error){return throwError(error,"Steam.toggleCurator"),!1}}async getCuratorId(path,name){try{var logStatus=scripts_echoLog({type:"gettingCuratorId",text:path+"/"+name}),curatorId=this.#cache.curator[path+"/"+name];if(curatorId)return logStatus.success(),curatorId;var{result,statusText,status,data}=await tools_httpRequest({url:`https://store.steampowered.com/${path}/`+name,method:"GET",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}});if("Success"!==result)return logStatus.error(result+`:${statusText}(${status})`),!1;if(200!==data?.status)return logStatus.error(`Error:${data?.statusText}(${data?.status})`),!1;{let curatorId=data.responseText.match(/g_pagingData.*?"clanid":([\d]+)/)?.[1];return curatorId?(this.#setCache("curator",path+"/"+name,curatorId),logStatus.success(),curatorId):(logStatus.error(`Error:${data.statusText}(${data.status})`),!1)}}catch(error){return throwError(error,"Steam.getCuratorID"),!1}}async#toggleCuratorLike(link,doTask=!0){try{var curatorId,[path,name]=link.split("/");return path&&name?!!(curatorId=await this.getCuratorId(path,name))&&await this.#toggleCurator(curatorId,doTask):(scripts_echoLog({text:i18n("errorLink",link)}),!1)}catch(error){return throwError(error,"Steam.toggleCuratorLike"),!1}}async#getAnnouncementParams(appId,viewId){try{var clanid,gid,logStatus=scripts_echoLog({type:"gettingAnnouncementParams",text:appId,id:viewId}),{result,statusText,status,data}=await tools_httpRequest({url:`https://store.steampowered.com/events/ajaxgetpartnerevent?appid=${appId}&announcement_gid=${viewId}&lang_list=6_0&last_modified_time=0&origin=https:%2F%2Fstore.steampowered.com&for_edit=false`,method:"GET",responseType:"json",headers:{Host:"store.steampowered.com",Referer:`https://store.steampowered.com/news/app/${appId}/view/`+viewId}});return"Success"===result?200===data?.status&&1===data?.response?.success?({clanid,gid}=data.response.event?.announcement_body||{},clanid?(logStatus.success(),{clanId:clanid,gid:gid}):(logStatus.error(`Error:${data.statusText}(${data.status})`),{})):(logStatus.error(`Error:${data?.statusText}(${data?.status})`),{}):(logStatus.error(result+`:${statusText}(${status})`),{})}catch(error){return throwError(error,"Steam.likeAnnouncement"),{}}}async#likeAnnouncement(id){try{var[appId,viewId]=id.split("/");if(appId&&viewId){var{clanId,gid}=await this.#getAnnouncementParams(appId,viewId);if(clanId){var logStatus=scripts_echoLog({type:"likingAnnouncement",text:appId,id:viewId}),{result,statusText,status,data}=await tools_httpRequest({url:"https://store.steampowered.com/updated/ajaxrateupdate/"+(gid||viewId),method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8",Host:"store.steampowered.com",Origin:"https://store.steampowered.com",Referer:`https://store.steampowered.com/news/app/${appId}/view/`+viewId},data:$.param({sessionid:this.#auth.storeSessionID,voteup:1,clanid:clanId,ajax:1}),dataType:"json"});if("Success"===result)return 200===data?.status&&1===data.response.success?(logStatus.success(),!0):(logStatus.error(`Error:${data?.statusText}(${data?.status})`),!1);logStatus.error(result+`:${statusText}(${status})`)}}else scripts_echoLog({}).error(i18n("missParams")+"(id)");return!1}catch(error){return throwError(error,"Steam.likeAnnouncement"),!1}}async#appid2subid(id){try{var logStatus=scripts_echoLog({type:"gettingSubid",text:id}),{result,statusText,status,data}=await tools_httpRequest({url:"https://store.steampowered.com/app/"+id,method:"GET",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}});if("Success"===result)if(200===data?.status)if(data.responseText.includes("ds_owned_flag ds_flag")||data.responseText.includes('class="already_in_library"'))logStatus.success(i18n("owned"));else{if("CN"===this.#area&&data.responseText.includes('id="error_box"')){logStatus.warning(i18n("changeAreaNotice"));let result=await this.#changeArea();return result&&"CN"!==result&&"skip"!==result?await this.#appid2subid(id):!1}var subid=data.responseText.match(/name="subid" value="([\d]+?)"/)?.[1];if(subid)return logStatus.success(),subid;if(subid=data.responseText.match(/AddFreeLicense\(\s*(\d+)/)?.[1])return logStatus.success(),subid;logStatus.error("Error:"+i18n("noSubid"))}else logStatus.error(`Error:${data?.statusText}(${data?.status})`);else logStatus.error(result+`:${statusText}(${status})`);return!1}catch(error){return throwError(error,"Steam.appid2subid"),!1}}async#getLicenses(){try{var logStatus=scripts_echoLog({text:i18n("gettingLicenses")}),{result,statusText,status,data}=await tools_httpRequest({url:"https://store.steampowered.com/dynamicstore/userdata/?t="+(new Date).getTime(),method:"GET",responseType:"json"});return"Success"===result?200===data?.status?(logStatus.success(),data.response?.rgOwnedPackages):(logStatus.error(`Error:${data?.statusText}(${data?.status})`),!1):(logStatus.error(result+`:${statusText}(${status})`),!1)}catch(error){return throwError(error,"Steam.getLicenses"),!1}}async#addLicense(id){try{if(this.#ASF)return await this.#ASF.addLicense(id);var[type,ids]=id.split("-");if("appid"===type){var subid=await this.#appid2subid(ids);if(subid){var logStatus=scripts_echoLog({type:"addingFreeLicense",text:ids});if(await this.#addFreeLicense(subid,logStatus)){var{result,statusText,status,data}=await tools_httpRequest({url:"https://store.steampowered.com/app/"+ids,method:"GET"});if("Success"===result)return 200===data?.status?data.responseText.includes("ds_owned_flag ds_flag")||data.responseText.includes('class="already_in_library"')?(logStatus.success(),!0):(logStatus.error(`Error:${data.statusText}(${data.status})`),!1):(logStatus.error(`Error:${data?.statusText}(${data?.status})`),!1);logStatus.error(result+`:${statusText}(${status})`)}}return!1}if("subid"!==type)return!1;"CN"===this.#area&&(scripts_echoLog({}).success(i18n("tryChangeAreaNotice")),await this.#changeArea());var logStatusArr={},idsArr=ids.split(",");for(let subid of idsArr){let logStatus=scripts_echoLog({type:"addingFreeLicenseSubid",text:subid});if(!await this.#addFreeLicense(subid,logStatus))return!1;logStatusArr[subid]=logStatus}var licenses=await this.#getLicenses();if(!licenses)return!1;for(let subid of idsArr)licenses.includes(parseInt(subid,10))?logStatusArr[subid].success():logStatusArr[subid].error();return!0}catch(error){return throwError(error,"Steam.addLicense"),!1}}async#addFreeLicense(id,logStatusPre){try{var logStatus=logStatusPre||scripts_echoLog({type:"addingFreeLicenseSubid",text:id}),{result,statusText,status,data}=await tools_httpRequest({url:"https://store.steampowered.com/freelicense/addfreelicense/"+id,method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8",Host:"store.steampowered.com",Origin:"https://store.steampowered.com",Referer:"https://store.steampowered.com/account/licenses/"},data:$.param({ajax:!0,sessionid:this.#auth.storeSessionID}),dataType:"json"});if("Success"!==result)return logStatus.error(result+`:${statusText}(${status})`),!1;if(200!==data?.status)return logStatus.error(`Error:${data?.statusText}(${data?.status})`),!1;if("CN"===this.#area&&data.responseText.includes('id="error_box"')){logStatus.warning(i18n("changeAreaNotice"));let result=await this.#changeArea();return!result||["CN","skip"].includes(result)?!1:await this.#addFreeLicense(id)}return logStatus.success(),!0}catch(error){return throwError(error,"Steam.addFreeLicense"),!1}}async#requestPlayTestAccess(id){try{var logStatus,result,statusText,status,data;return this.#ASF?await this.#ASF.requestPlayTestAccess(id):(logStatus=scripts_echoLog({type:"requestingPlayTestAccess",text:id}),{result,statusText,status,data}=await tools_httpRequest({url:"https://store.steampowered.com/ajaxrequestplaytestaccess/"+id,method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8",Host:"store.steampowered.com",Origin:"https://store.steampowered.com",Referer:"https://store.steampowered.com/app/"+id},data:$.param({sessionid:this.#auth.storeSessionID}),dataType:"json"}),"Success"===result?200===data?.status&&1===data?.response?.success?(logStatus.success(),!0):(logStatus.error(`Error:${data?.statusText}(${data?.status})`),!1):(logStatus.error(result+`:${statusText}(${status})`),!1))}catch(error){return throwError(error,"Steam.requestPlayTestAccess"),!1}}async toggle({doTask=!0,groupLinks=[],officialGroupLinks=[],wishlistLinks=[],followLinks=[],forumLinks=[],workshopLinks=[],workshopVoteLinks=[],curatorLinks=[],curatorLikeLinks=[],announcementLinks=[],licenseLinks=[],playtestLinks=[]}){try{if(0<[...groupLinks,...officialGroupLinks,...forumLinks,...workshopLinks,...workshopVoteLinks].length&&!this.#communityInitialized)return scripts_echoLog({text:i18n("needInit")}),!1;if(0<[...wishlistLinks,...followLinks,...curatorLinks,...curatorLikeLinks,...announcementLinks,...licenseLinks,...playtestLinks].length&&!this.#storeInitialized)return scripts_echoLog({text:i18n("needInit")}),!1;var prom=[];if(doTask&&!globalOptions.doTask.steam.groups||!doTask&&!globalOptions.undoTask.steam.groups)scripts_echoLog({type:"globalOptionsSkip",text:"steam.groups"});else{var realGroups=this.getRealParams("groups",groupLinks,doTask,link=>link.match(/groups\/(.+)\/?/)?.[1]);if(0<realGroups.length)for(var group of realGroups)prom.push(doTask?this.#joinGroup(group):this.#leaveGroup(group)),await delay(1e3)}if(doTask&&!globalOptions.doTask.steam.officialGroups||!doTask&&!globalOptions.undoTask.steam.officialGroups)scripts_echoLog({type:"globalOptionsSkip",text:"steam.officialGroups"});else{var realOfficialGroups=this.getRealParams("officialGroups",officialGroupLinks,doTask,link=>link.match(/games\/(.+)\/?/)?.[1]);if(0<realOfficialGroups.length)for(var officialGroup of realOfficialGroups)prom.push(doTask?this.#joinOfficialGroup(officialGroup):this.#leaveOfficialGroup(officialGroup)),await delay(1e3)}if(doTask&&!globalOptions.doTask.steam.wishlists||!doTask&&!globalOptions.undoTask.steam.wishlists)scripts_echoLog({type:"globalOptionsSkip",text:"steam.wishlists"});else{var realWishlists=this.getRealParams("wishlists",wishlistLinks,doTask,link=>link.match(/app\/([\d]+)/)?.[1]);if(0<realWishlists.length)for(var game of realWishlists)prom.push(doTask?this.#addToWishlist(game):this.#removeFromWishlist(game)),await delay(1e3)}if(doTask&&!globalOptions.doTask.steam.follows||!doTask&&!globalOptions.undoTask.steam.follows)scripts_echoLog({type:"globalOptionsSkip",text:"steam.follows"});else{var realFollows=this.getRealParams("follows",followLinks,doTask,link=>link.match(/app\/([\d]+)/)?.[1]);if(0<realFollows.length)for(let game of realFollows)prom.push(this.#toggleFollowGame(game,doTask)),await delay(1e3)}if(doTask&&!globalOptions.doTask.steam.forums||!doTask&&!globalOptions.undoTask.steam.forums)scripts_echoLog({type:"globalOptionsSkip",text:"steam.forums"});else{var realForums=this.getRealParams("forums",forumLinks,doTask,link=>link.match(/app\/([\d]+)/)?.[1]);if(0<realForums.length)for(var forum of realForums)prom.push(this.#toggleForum(forum,doTask)),await delay(1e3)}if(doTask&&!globalOptions.doTask.steam.workshops||!doTask&&!globalOptions.undoTask.steam.workshops)scripts_echoLog({type:"globalOptionsSkip",text:"steam.workshops"});else{var realWorkshops=this.getRealParams("workshops",workshopLinks,doTask,link=>link.match(/\?id=([\d]+)/)?.[1]);if(0<realWorkshops.length)for(var workshop of realWorkshops)prom.push(this.#toggleFavoriteWorkshop(workshop,doTask)),await delay(1e3)}if(doTask&&!globalOptions.doTask.steam.workshopVotes)scripts_echoLog({type:"globalOptionsSkip",text:"steam.workshopVotes"});else{var realworkshopVotes=this.getRealParams("workshopVotes",workshopVoteLinks,doTask,link=>link.match(/\?id=([\d]+)/)?.[1]);if(doTask&&0<realworkshopVotes.length)for(let workshop of realworkshopVotes)prom.push(this.#voteUpWorkshop(workshop)),await delay(1e3)}if(doTask&&!globalOptions.doTask.steam.curators||!doTask&&!globalOptions.undoTask.steam.curators)scripts_echoLog({type:"globalOptionsSkip",text:"steam.curators"});else{var realCurators=this.getRealParams("curators",curatorLinks,doTask,link=>link.match(/curator\/([\d]+)/)?.[1]),realCuratorLikes=this.getRealParams("curatorLikes",curatorLikeLinks,doTask,link=>link.match(/https?:\/\/store\.steampowered\.com\/(.*?)\/([^/?]+)/)?.slice(1,3).join("/"));if(0<realCurators.length)for(var curator of realCurators)prom.push(this.#toggleCurator(curator,doTask)),await delay(1e3);if(0<realCuratorLikes.length)for(var curatorLike of realCuratorLikes)prom.push(this.#toggleCuratorLike(curatorLike,doTask)),await delay(1e3)}if(doTask&&!globalOptions.doTask.steam.announcements)scripts_echoLog({type:"globalOptionsSkip",text:"steam.announcements"});else{var realAnnouncements=this.getRealParams("announcements",announcementLinks,doTask,link=>(link.includes("store.steampowered.com")?link.match(/store\.steampowered\.com\/news\/app\/([\d]+)\/view\/([\d]+)/):link.match(/steamcommunity\.com\/games\/([\d]+)\/announcements\/detail\/([\d]+)/))?.slice(1,3).join("/"));if(doTask&&0<realAnnouncements.length)for(var id of realAnnouncements)prom.push(this.#likeAnnouncement(id)),await delay(1e3)}if(doTask&&!globalOptions.doTask.steam.licenses)scripts_echoLog({type:"globalOptionsSkip",text:"steam.licenses"});else if(doTask&&globalOptions.doTask.steam.licenses&&0<licenseLinks.length)for(var ids of licenseLinks){var[type,idsStr]=ids.split("-");for(let id of idsStr.split(","))prom.push(this.#addLicense(type+"-"+id)),await delay(1e3)}if(doTask&&!globalOptions.doTask.steam.playtests)scripts_echoLog({type:"globalOptionsSkip",text:"steam.playtests"});else{var realPlaytests=this.getRealParams("playtests",playtestLinks,doTask,link=>link.match(/app\/([\d]+)/)?.[1]);if(doTask&&globalOptions.doTask.steam.playtests&&0<realPlaytests.length)for(let id of realPlaytests)prom.push(this.#requestPlayTestAccess(id)),await delay(1e3)}return Promise.all(prom).then(async()=>(this.#oldArea&&this.#area!==this.#oldArea&&(scripts_echoLog({}).warning(i18n("steamFinishNotice")+this.#oldArea),await this.#changeArea(this.#oldArea)),!0))}catch(error){return throwError(error,"Steam.toggle"),!1}}#setCache(type,name,id){try{this.#cache[type][name]=id,GM_setValue("steamCache",this.#cache)}catch(error){throwError(error,"Steam.setCache")}}}let social_Steam=Steam,defaultTasks=(userDefinedGlobalOptions=class{undoneTasks;socialTasks;giveawayId;socialInitialized={discord:!1,instagram:!1,reddit:!1,twitch:!1,twitter:!1,vk:!1,youtube:!1,steamStore:!1,steamCommunity:!1};initialized=!1;steamTaskType={steamStore:!1,steamCommunity:!1};social={};async#bind(name,init){try{return{name:name,result:await init}}catch(error){return throwError(error,"Website.bind"),{name:name,result:!1}}}async initSocial(action){try{var steamLength,steamCommunityLength,pro=[];let tasks="do"===action?this.undoneTasks:this.socialTasks;return!(tasks.discord&&0<Object.values(tasks.discord).reduce((total,arr)=>[...total,...arr]).length)||this.socialInitialized.discord&&this.social.discord||(this.social.discord=new social_Discord,pro.push(this.#bind("discord",this.social.discord.init(action)))),!(tasks.instagram&&0<Object.values(tasks.instagram).reduce((total,arr)=>[...total,...arr]).length)||this.socialInitialized.instagram&&this.social.instagram||(this.social.instagram=new social_Instagram,pro.push(this.#bind("instagram",this.social.instagram.init()))),!(tasks.reddit&&0<Object.values(tasks.reddit).reduce((total,arr)=>[...total,...arr]).length)||this.socialInitialized.reddit&&this.social.reddit||(this.social.reddit=new social_Reddit,pro.push(this.#bind("reddit",this.social.reddit.init()))),!(tasks.twitch&&0<Object.values(tasks.twitch).reduce((total,arr)=>[...total,...arr]).length)||this.socialInitialized.twitch&&this.social.twitch||(this.social.twitch=new social_Twitch,pro.push(this.#bind("twitch",this.social.twitch.init()))),!(tasks.twitter&&0<Object.values(tasks.twitter).reduce((total,arr)=>[...total,...arr]).length)||this.socialInitialized.twitter&&this.social.twitter||(this.social.twitter=new social_Twitter,pro.push(this.#bind("twitter",this.social.twitter.init()))),!(tasks.vk&&0<Object.values(tasks.vk).reduce((total,arr)=>[...total,...arr]).length)||this.socialInitialized.vk&&this.social.vk||(this.social.vk=new social_Vk,pro.push(this.#bind("vk",this.social.vk.init()))),!(tasks.youtube&&0<Object.values(tasks.youtube).reduce((total,arr)=>[...total,...arr]).length)||this.socialInitialized.youtube&&this.social.youtube||(this.social.youtube=new Youtube,pro.push(this.#bind("youtube",this.social.youtube.init()))),tasks.steam&&0<(steamLength=Object.values(tasks.steam).reduce((total,arr)=>[...total,...arr]).length)&&(this.social.steam||(this.social.steam=new social_Steam),0<steamLength-(steamCommunityLength=Object.keys(tasks.steam).map(type=>["groupLinks","officialGroupLinks","forumLinks","workshopLinks","workshopVoteLinks"].includes(type)&&tasks.steam?.[type]?.length||0).reduce((total,number)=>total+number,0))&&(this.steamTaskType.steamStore=!0,this.socialInitialized.steamStore||pro.push(this.#bind("steamStore",this.social.steam.init("store")))),0<steamCommunityLength)&&(this.socialInitialized.steamCommunity||(this.steamTaskType.steamCommunity=!0,pro.push(this.#bind("steamCommunity",this.social.steam.init("community"))))),tasks.links&&0<tasks.links.length&&(this.social.visitLink=visitLink),await Promise.all(pro).then(result=>{let checked=!0;for(var data of result)data.result?this.socialInitialized[data.name]=data.result:checked=!1;return checked})}catch(error){return throwError(error,"Website.initSocial"),!1}}uniqueTasks(allTasks){try{var social,types,result={};for([social,types]of Object.entries(allTasks)){result[social]={};for(var[type,tasks]of Object.entries(types))result[social][type]=unique(tasks)}return result}catch(error){return throwError(error,"Website.uniqueTasks"),allTasks}}async toggleTask(action){try{if(!this.initialized&&!this.init())return!1;if(!await this.classifyTask(action))return!1;await this.initSocial(action);var pro=[],doTask="do"===action,tasks=doTask?this.undoneTasks:this.socialTasks;if(!0===this.socialInitialized.discord&&this.social.discord&&pro.push(this.social.discord.toggle({doTask:doTask,...tasks.discord})),!0===this.socialInitialized.instagram&&this.social.instagram&&pro.push(this.social.instagram.toggle({doTask:doTask,...tasks.instagram})),!0===this.socialInitialized.reddit&&this.social.reddit&&pro.push(this.social.reddit.toggle({doTask:doTask,...tasks.reddit})),!0===this.socialInitialized.twitch&&this.social.twitch&&pro.push(this.social.twitch.toggle({doTask:doTask,...tasks.twitch})),!0===this.socialInitialized.twitter&&this.social.twitter&&pro.push(this.social.twitter.toggle({doTask:doTask,...tasks.twitter})),!0===this.socialInitialized.vk&&this.social.vk&&pro.push(this.social.vk.toggle({doTask:doTask,...tasks.vk})),!0===this.socialInitialized.youtube&&this.social.youtube&&pro.push(this.social.youtube.toggle({doTask:doTask,...tasks.youtube})),this.steamTaskType.steamCommunity&&!0!==this.socialInitialized.steamCommunity||this.steamTaskType.steamStore&&!0!==this.socialInitialized.steamStore||!this.social.steam||pro.push(this.social.steam.toggle({doTask:doTask,...tasks.steam})),this.social.visitLink&&tasks.links&&doTask)for(var link of tasks.links)pro.push(this.social.visitLink(link));return doTask&&tasks.extra&&this.extraDoTask&&0<Object.values(tasks.extra).reduce((total,arr)=>[...total,...arr]).length&&pro.push(this.extraDoTask(tasks.extra)),await Promise.all(pro),scripts_echoLog({}).success(i18n("allTasksComplete")),!0}catch(error){return throwError(error,"Website.toggleTask"),!1}}async doTask(){try{return await this.toggleTask("do")}catch(error){return throwError(error,"Website.doTask"),!1}}async undoTask(){try{return await this.toggleTask("undo")}catch(error){return throwError(error,"Website.undoTask"),!1}}},JSON.stringify({steam:{groupLinks:[],wishlistLinks:[],curatorLinks:[],followLinks:[]},discord:{serverLinks:[]},vk:{nameLinks:[]},extra:{website:[]}}));class FreeAnyWhere extends userDefinedGlobalOptions{name="FreeAnyWhere";tasks=[];socialTasks=JSON.parse(defaultTasks);undoneTasks=JSON.parse(defaultTasks);buttons=["doTask","undoTask","verifyTask","getKey"];static test(){return"freeanywhere.net"===window.location.host}async init(){try{var logStatus=scripts_echoLog({text:i18n("initing")});return(debug("检测登录按钮"),0===$("div.header__login a[href*=logout]").length)?(window.open("https://freeanywhere.net/game.php?steam_login","_self"),logStatus.warning(i18n("needLogin")),!1):(debug("检测是否为登录页面"),window.location.href.includes("/login")?(logStatus.warning(i18n("needLogin")),!1):(this.initialized=!0,logStatus.success(),!0))}catch(error){return throwError(error,"Freeanywhere.init"),!1}}async classifyTask(action){try{var task,logStatus=scripts_echoLog({text:i18n("getTasksInfo")}),tasks=("undo"===action&&(this.socialTasks=GM_getValue("fawTasks-"+this.giveawayId)?.tasks||JSON.parse(defaultTasks)),$("div.game__content-tasks__task").map((index,element)=>({id:$(element).attr("data-id"),social:$(element).find("div.task-img img").attr("alt"),link:$(element).find("div.task-link a").attr("href"),title:$(element).find("div.task-link").text().trim(),type:$(element).attr("data-type"),isSuccess:$(element).hasClass("done")})).toArray());if(0===tasks.length)return logStatus.success(),!1;"verify"===action&&(this.tasks=[]);for(task of tasks){debug("任务分类",task);var{id,social,title,type,link,isSuccess}=task,taskInfo={id:id,title:title,social:social,type:type};if("verify"!==action||isSuccess)switch(type){case"steam_account_verify":break;case"steam_game_wishlist":"undo"===action&&link&&this.socialTasks.steam.wishlistLinks.push(link),"do"===action&&!isSuccess&&link&&this.undoneTasks.steam.wishlistLinks.push(link);break;case"steam_group_sub":"undo"===action&&link&&this.socialTasks.steam.groupLinks.push(link),"do"===action&&!isSuccess&&link&&this.undoneTasks.steam.groupLinks.push(link);break;case"site_visit":"do"!==action||isSuccess||this.undoneTasks.extra.website.push(`id=${id}&type=${type}&task=true`);break;case"vk_community_sub":"undo"===action&&link&&this.socialTasks.vk.nameLinks.push(link),"do"===action&&!isSuccess&&link&&this.undoneTasks.vk.nameLinks.push(link);break;case"vk_post_like":"undo"===action&&link&&this.socialTasks.vk.nameLinks.push(link+"&action=like"),"do"===action&&!isSuccess&&link&&this.undoneTasks.vk.nameLinks.push(link+"&action=like");break;case"discord_server_sub":"undo"===action&&link&&this.socialTasks.discord.serverLinks.push(link),"do"===action&&!isSuccess&&link&&this.undoneTasks.discord.serverLinks.push(link);break;case"telegram_channel_sub":scripts_echoLog({}).warning(""+i18n("tgTaskNotice"));break;case"none":scripts_echoLog({}).warning(""+i18n("notConnect"));break;default:scripts_echoLog({}).warning(i18n("unKnownTaskType")+": "+type)}else this.tasks.push(taskInfo)}return logStatus.success(),this.undoneTasks=this.uniqueTasks(this.undoneTasks),this.socialTasks=this.uniqueTasks(this.socialTasks),window.DEBUG&&console.log("%cAuto-Task[Debug]:","color:blue",JSON.stringify(this)),GM_setValue("fawTasks-"+this.giveawayId,{tasks:this.socialTasks,time:(new Date).getTime()}),!0}catch(error){return throwError(error,"Freeanywhere.classifyTask"),!1}}async verifyTask(){try{if(!this.initialized&&!this.init())return debug("未初始化"),!1;if(0===this.tasks.length&&!await this.classifyTask("verify"))return debug("任务列表为空",this.tasks),!1;var task,pro=[];for(task of this.tasks)pro.push(this.#verify(task)),await delay(1e3);return await Promise.all(pro),scripts_echoLog({}).success(i18n("allTasksComplete")),!!await this.getKey(!0)}catch(error){return throwError(error,"Freeanywhere.verifyTask"),!1}}async extraDoTask({website}){try{var link,pro=[];for(link of website)pro.push(this.#doVisitWebsite(link));return Promise.all(pro).then(()=>!0)}catch(error){return throwError(error,"FreeAnyWhere.extraDoTask"),!1}}async#doVisitWebsite(link){try{var logStatus=scripts_echoLog({text:i18n("visitingLink")}),{result,statusText,status}=await tools_httpRequest({url:"https://freeanywhere.net/php/task_site_visit_done.php",method:"POST",headers:{"content-type":"application/x-www-form-urlencoded; charset=UTF-8"},data:link});return"Success"===result?(logStatus.success(),!0):(logStatus.error(result+`:${statusText}(${status})`),!1)}catch(error){return throwError(error,"FreeAnyWhere.doVisitWebsite"),!1}}async getKey(initialized){try{if(initialized||this.initialized||this.init()){var logStatus=scripts_echoLog({text:i18n("gettingKey")}),{result,statusText,status,data}=await tools_httpRequest({url:"https://freeanywhere.net/php/user_get_key.php",method:"POST"});if("Success"===result)return-1!==data?.responseText.indexOf("bad")||50<data?.responseText.length?(logStatus.error(data?.responseText),!1):(logStatus.success(),scripts_echoLog({}).success(data.responseText),data.responseText);logStatus.error(result+`:${statusText}(${status})`)}else debug("未初始化");return!1}catch(error){return throwError(error,"FreeAnyWhere.getGiveawayId"),!1}}async#verify(task){try{var logStatus=scripts_echoLog({html:`<li>${i18n("verifyingTask")}${task.title.trim()}...<font></font></li>`}),{result,statusText,status,data}=await tools_httpRequest({url:"https://freeanywhere.net/php/user_task_update.php",method:"POST",headers:{"content-type":"application/x-www-form-urlencoded; charset=UTF-8"},data:`id=${task.id}&type=`+task.type});return"Success"===result?"good"===data?.responseText.trim()?(logStatus.success(),!0):(debug("任务验证结果",data?.response),logStatus.error(`Error:${data?.statusText}(${data?.status})`),!1):(logStatus.error(result+`:${statusText}(${status})`),!1)}catch(error){return throwError(error,"Freeanywhere.verify"),!1}}}var Freeanywhere=FreeAnyWhere;let Giveawaysu_defaultTasks={steam:{groupLinks:[],wishlistLinks:[],curatorLinks:[],curatorLikeLinks:[],followLinks:[],forumLinks:[],announcementLinks:[],workshopVoteLinks:[],playtestLinks:[]},discord:{serverLinks:[]},instagram:{userLinks:[]},vk:{nameLinks:[]},twitch:{channelLinks:[]},reddit:{redditLinks:[]},youtube:{channelLinks:[],likeLinks:[]},twitter:{userLinks:[],retweetLinks:[]}};class GiveawaySu extends userDefinedGlobalOptions{name="GiveawaySu";socialTasks=Giveawaysu_defaultTasks;undoneTasks=Giveawaysu_defaultTasks;buttons=["doTask","undoTask"];static test(){return/^https?:\/\/giveaway\.su\/giveaway\/view\/[\d]+/.test(window.location.href)}async after(){try{this.#checkLogin()||scripts_echoLog({}).warning(i18n("checkLoginFailed")),await this.#checkLeftKey()||scripts_echoLog({}).warning(i18n("checkLeftKeyFailed")),scripts_echoLog({}).warning(i18n("gsNotice"))}catch(error){throwError(error,"Giveawaysu.after")}}init(){try{var logStatus=scripts_echoLog({text:i18n("initing")});return 0<$("a.steam-login").length?(window.open("/steam/redirect","_self"),logStatus.warning(i18n("needLogin")),!1):!!this.#getGiveawayId()&&(this.initialized=!0,logStatus.success(),!0)}catch(error){return throwError(error,"Giveawaysu.init"),!1}}async classifyTask(action){try{var logStatus=scripts_echoLog({text:i18n("getTasksInfo")});if("undo"===action)this.socialTasks=GM_getValue("gasTasks-"+this.giveawayId)?.tasks||Giveawaysu_defaultTasks;else{var pro=[],tasks=$("#actions tr");$("div.bind-discord").is(":visible")&&$("div.bind-discord a")[0].click(),$("div.bind-twitch").is(":visible")&&$("div.bind-twitch a")[0].click();for(let task of tasks)pro.push(new Promise(resolve=>{var td=$(task).find('td:not(".hidden")'),colorfulTask=td.eq(1).find('a:not([data-trigger="link"])'),colorlessTask=td.eq(2).find('a:not([data-trigger="link"])'),colorfulTask=0<colorfulTask.length?colorfulTask:colorlessTask;let taskIcon=td.eq(0).find("i").attr("class")||"",taskName=colorfulTask.text().trim();if(taskIcon.includes("ban")||/disable adblock/gi.test(taskName))return resolve(!0);getRedirectLink(colorfulTask.attr("href")).then(taskLink=>{if(!taskLink)return resolve(!1);taskIcon.includes("steam")&&/join/gi.test(taskName)?this.undoneTasks.steam.groupLinks.push(taskLink):/like.*announcement/gi.test(taskName)?this.undoneTasks.steam.announcementLinks.push(taskLink):/(follow|subscribe).*curator/gim.test(taskName)&&/^https?:\/\/store\.steampowered\.com\/curator\//.test(taskLink)?this.undoneTasks.steam.curatorLinks.push(taskLink):taskIcon.includes("steam")&&/follow|subscribe/gim.test(taskName)?this.undoneTasks.steam.curatorLikeLinks.push(taskLink):/subscribe.*steam.*forum/gim.test(taskName)?this.undoneTasks.steam.forumLinks.push(taskLink):taskIcon.includes("thumbs-up")&&/^https?:\/\/steamcommunity\.com\/sharedfiles\/filedetails\/\?id=[\d]+/.test(taskLink)?this.undoneTasks.steam.workshopVoteLinks.push(taskLink):taskIcon.includes("plus")&&/request.*playtest/gim.test(taskName)?this.undoneTasks.steam.playtestLinks.push(taskLink):taskIcon.includes("discord")||/join.*discord/gim.test(taskName)?this.undoneTasks.discord.serverLinks.push(taskLink):taskIcon.includes("instagram")||/follow.*instagram/gim.test(taskName)?this.undoneTasks.instagram.userLinks.push(taskLink):taskIcon.includes("twitch")||/follow.*twitch.*channel/gim.test(taskName)?this.undoneTasks.twitch.channelLinks.push(taskLink):taskIcon.includes("reddit")||/subscribe.*subreddit/gim.test(taskName)||/follow.*reddit/gim.test(taskName)?this.undoneTasks.reddit.redditLinks.push(taskLink):/watch.*art/gim.test(taskName)?this.undoneTasks.steam.workshopVoteLinks.push(taskLink):/subscribe.*youtube.*channel/gim.test(taskName)?this.undoneTasks.youtube.channelLinks.push(taskLink):/(watch|like).*youtube.*video/gim.test(taskName)||(taskIcon.includes("youtube")||taskIcon.includes("thumbs-up"))&&/(watch|like).*video/gim.test(taskName)?this.undoneTasks.youtube.likeLinks.push(taskLink):taskIcon.includes("vk")||/join.*vk.*group/gim.test(taskName)?this.undoneTasks.vk.nameLinks.push(taskLink):/(on twitter)|(Follow.*on.*Facebook)/gim.test(taskName)||(/wishlist.*game|add.*wishlist/gim.test(taskName)&&this.undoneTasks.steam.wishlistLinks.push(taskLink),/follow.*button/gim.test(taskName)&&this.undoneTasks.steam.followLinks.push(taskLink)),resolve(!0)}).catch(error=>(throwError(error,"Giveawaysu.classifyTask->getRedirectLink"),!1))}));await Promise.all(pro),logStatus.success(),this.undoneTasks=this.uniqueTasks(this.undoneTasks),this.socialTasks=this.undoneTasks,window.DEBUG&&console.log("%cAuto-Task[Debug]:","color:blue",JSON.stringify(this)),GM_setValue("gasTasks-"+this.giveawayId,{tasks:this.socialTasks,time:(new Date).getTime()})}return!0}catch(error){return throwError(error,"Giveawaysu.classifyTask"),!1}}#checkLogin(){try{return globalOptions.other.checkLogin&&0<$("a.steam-login").length&&window.open("/steam/redirect","_self"),!0}catch(error){return throwError(error,"Giveawaysu.checkLogin"),!1}}async#checkLeftKey(){try{return globalOptions.other.checkLeftKey&&0<$(".giveaway-ended").length&&0===$(".giveaway-key").length&&await external_Swal_default().fire({icon:"warning",title:i18n("notice"),text:i18n("noKeysLeft"),confirmButtonText:i18n("confirm"),cancelButtonText:i18n("cancel"),showCancelButton:!0}).then(({value})=>{value&&window.close()}),!0}catch(error){return throwError(error,"Giveawaysu.checkLeftKey"),!1}}#getGiveawayId(){try{var giveawayId=window.location.href.match(/\/view\/([\d]+)/)?.[1];return giveawayId?(this.giveawayId=giveawayId,!0):(scripts_echoLog({text:i18n("getFailed","GiveawayId")}),!1)}catch(error){return throwError(error,"Giveawaysu.getGiveawayId"),!1}}}class Indiedb{name="Indiedb";buttons=["doTask"];static test(){return"www.indiedb.com"===window.location.host}async after(){try{this.#checkLogin()||scripts_echoLog({}).warning(i18n("checkLoginFailed")),await this.#checkLeftKey()||scripts_echoLog({}).warning(i18n("checkLeftKeyFailed"))}catch(error){throwError(error,"Indiedb.after")}}async doTask(){try{return await this.#join()?await this.#do():!1}catch(error){return throwError(error,"Indiedb.doTask"),!1}}async#join(){try{if(0<$("a.buttonenter:contains(Register to join)").length)scripts_echoLog({}).error(i18n("needLogin"));else{var logStatus,result,statusText,status,data,currentoption=$("a.buttonenter.buttongiveaway");if(/join giveaway/gim.test(currentoption.text()))return logStatus=scripts_echoLog({text:i18n("joiningGiveaway")+"..."}),{result,statusText,status,data}=await tools_httpRequest({url:currentoption.attr("href"),method:"POST",data:"ajax=t",dataType:"json",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8",Accept:"application/json, text/javascript, */*; q=0.01",Origin:window.location.origin,referer:window.location.href}}),"Success"===result?200===data?.status?data.response?.success?(currentoption.addClass("buttonentered").text("Success - Giveaway joined"),$("#giveawaysjoined").slideDown(),$("#giveawaysrecommend").slideDown(),logStatus.success("Success"+(data.response?.text?":"+data.response?.text:"")),!0):(logStatus.error("Error"+(data.response?.text?":"+data.response?.text:"")),!1):await this.#join2()?(logStatus.success("Success"),!0):(logStatus.error(`Error:${data?.statusText}(${data?.status})`),!1):(logStatus.error(result+`:${statusText}(${status})`),!1);if(/success/gim.test($("a.buttonenter.buttongiveaway").text()))return!0;scripts_echoLog({}).warning(i18n("needJoinGiveaway"))}return!1}catch(error){return throwError(error,"Indiedb.join"),!1}}async#join2(){try{return await new Promise(resolve=>{var targetNode=document.getElementById("giveawaysjoined");let observer=new MutationObserver(()=>{$("#giveawaysjoined").is(":visible")&&(resolve(!0),observer.disconnect())});observer.observe(targetNode,{attributes:!0}),$("a.buttonenter.buttongiveaway")[0]?.click(),setTimeout(()=>{resolve(!1),observer.disconnect()},3e4)})}catch(error){return throwError(error,"Indiedb.join2"),!1}}async#do(){try{let id=$("script").map((index,script)=>/\$\(document\)/gim.test(script.innerHTML)?[script.innerHTML.match(/"\/[\d]+"/gim)?.[0]?.match(/[\d]+/)?.[0],script.innerHTML.match(/"\/newsletter\/ajax\/subscribeprofile\/optin\/[\d]+"/gim)?.[0]?.match(/[\d]+/)?.[0]]:null);if(2!==id.length)return scripts_echoLog({}).error(i18n("getFailed","TaskId")),!1;var task,pro=[];for(task of $("#giveawaysjoined a[class*=promo]")){let promo=$(task);if(!promo.hasClass("buttonentered")){let status=scripts_echoLog({text:`${i18n("doing")}:${promo.parents("p").text()}...`});if(/facebookpromo|twitterpromo|visitpromo/gim.test(task.className)){let text="";text=promo.hasClass("facebookpromo")?"facebookpromo":promo.hasClass("twitterpromo")?"twitterpromo":"visitpromo",pro.push(new Promise(resolve=>{$.ajax({type:"POST",url:urlPath(`/giveaways/ajax/${text}/`+id[0]),timeout:6e4,dataType:"json",data:{ajax:"t"},error(response,error,exception){window.DEBUG&&console.log("%cAuto-Task[Debug]:","color:red",{response:response,error:error,exception:exception}),status.error("Error:An error has occurred performing the action requested. Please try again shortly."),resolve(!0)},success(response){response.success?(status.success("Success:"+response.text),promo.addClass("buttonentered").closest("p").html(promo.closest("p").find("span").html())):status.error("Error:"+response.text),resolve(!0)}})}))}else promo.hasClass("emailoptinpromo")?pro.push(new Promise(resolve=>{$.ajax({type:"POST",url:urlPath("/newsletter/ajax/subscribeprofile/optin/"+id[1]),timeout:6e4,dataType:"json",data:{ajax:"t",emailsystoggle:4},error(response,error,exception){window.DEBUG&&console.log("%cAuto-Task[Debug]:","color:red",{response:response,error:error,exception:exception}),status.error("Error:An error has occurred performing the action requested. Please try again shortly."),resolve(!0)},success(response){response.success?(status.success("Success:"+response.text),promo.toggleClass("buttonentered").closest("p").html(promo.closest("p").find("span").html())):status.error("Error:"+response.text),resolve(!0)}})})):promo.hasClass("watchingpromo")?pro.push(new Promise(resolve=>{var data=(url=>{try{let query={};return url?url.includes("?")&&url.split("?")[1].replace(/([^?&=]+)=([^&]+)/g,(str,key,value)=>(query[key]=value,str)):window.location.search.replace(/([^?&=]+)=([^&]+)/g,(str,key,value)=>(query[key]=value,str)),query}catch(error){return throwError(error,"getUrlQuery"),{}}})(promo.attr("href"));data.ajax="t",$.ajax({type:"POST",url:urlPath(promo.attr("href")?.split(/[?#]/)[0]),timeout:6e4,dataType:"json",data:data,error(response,error,exception){window.DEBUG&&console.log("%cAuto-Task[Debug]:","color:red",{response:response,error:error,exception:exception}),status.error("Error:An error has occurred performing the action requested. Please try again shortly."),resolve(!0)},success(response){response.success?(status.success("Success:"+response.text),promo.toggleClass("buttonentered").closest("p").html(promo.closest("p").find("span").html())):status.error("Error:"+response.text),resolve(!0)}})})):/the-challenge-of-adblock/gim.test(promo.attr("href"))?status.error("Error:"+i18n("unKnownTaskType")):pro.push(new Promise(resolve=>{$.ajax({type:"POST",url:urlPath(promo.attr("href")),timeout:6e4,dataType:"json",data:{ajax:"t"},error(response,error,exception){window.DEBUG&&console.log("%cAuto-Task[Debug]:","color:red",{response:response,error:error,exception:exception}),status.error("Error:An error has occurred performing the action requested. Please try again shortly."),resolve(!0)},success(response){response.success?(status.success("Success:"+response.text),promo.toggleClass("buttonentered").closest("p").html(promo.closest("p").find("span").html())):status.error("Error:"+response.text),resolve(!0)}})}))}}return await Promise.all(pro),scripts_echoLog({}).success(i18n("allTasksComplete")),!0}catch(error){return throwError(error,"Indiedb.classifyTask"),!1}}#checkLogin(){try{return globalOptions.other.checkLogin&&0<$("a.buttonenter:contains(Register to join)").length&&window.open("/members/login","_self"),!0}catch(error){return throwError(error,"Indiedb.checkLogin"),!1}}async#checkLeftKey(){try{return globalOptions.other.checkLeftKey&&0<$('a.buttonenter:contains("next time"), a.buttonenter:contains("Giveaway is closed")').length&&await external_Swal_default().fire({icon:"warning",title:i18n("notice"),text:i18n("giveawayEnded"),confirmButtonText:i18n("confirm"),cancelButtonText:i18n("cancel"),showCancelButton:!0}).then(({value})=>{value&&window.close()}),!0}catch(error){return throwError(error,"Indiedb.checkLeftKey"),!1}}}var website_Indiedb=Indiedb;let Keyhub_defaultTasks=JSON.stringify({steam:{groupLinks:[],officialGroupLinks:[],wishlistLinks:[],curatorLinks:[]},discord:{serverLinks:[]},extra:{videoTasks:[]},links:[]});class Keyhub extends userDefinedGlobalOptions{name="Keyhub";socialTasks=JSON.parse(Keyhub_defaultTasks);undoneTasks=JSON.parse(Keyhub_defaultTasks);buttons=["doTask","undoTask"];static test(){return"key-hub.eu"===window.location.host}async after(){try{this.#checkLogin()||scripts_echoLog({}).warning(i18n("checkLoginFailed")),await this.#checkLeftKey()||scripts_echoLog({}).warning(i18n("checkLeftKeyFailed")),$(".NSFW").hide()}catch(error){throwError(error,"Keyhub.after")}}init(){try{var logStatus=scripts_echoLog({text:i18n("initing")});return 0<$('a[href*="/connect/steam"]').length?(window.open("/connect/steam","_self"),logStatus.warning(i18n("needLogin")),!1):!!this.#getGiveawayId()&&($("#VPNoverlay").hide(),$("#mainArticleSection").show(),this.initialized=!0,logStatus.success(),!0)}catch(error){return throwError(error,"Keyhub.init"),!1}}async classifyTask(action){try{var task,logStatus=scripts_echoLog({text:i18n("getTasksInfo")}),tasks=("undo"===action&&(this.socialTasks=GM_getValue("khTasks-"+this.giveawayId)?.tasks||JSON.parse(Keyhub_defaultTasks)),$('.task:not(".googleads")').filter((index,element)=>"do"!==action||0===$(element).find("i.fa-check-circle:visible").length).find("a"));for(task of tasks){let link=$(task).attr("href");var taskData,taskDes=$(task).text().trim();link&&((/\/away\?data=/.test(link)||/steamcommunity\.com\/gid\//.test(link))&&(link=await getRedirectLink(link)||link),/https?:\/\/key-hub\.eu\/connect\/discord/.test(link)?GM_openInTab(link,{active:!0}):/steamcommunity\.com\/groups\//.test(link)?("undo"===action&&this.socialTasks.steam.groupLinks.push(link),"do"===action&&this.undoneTasks.steam.groupLinks.push(link)):/steamcommunity\.com\/games\/[\d]+/.test(link)?("undo"===action&&this.socialTasks.steam.officialGroupLinks.push(link),"do"===action&&this.undoneTasks.steam.officialGroupLinks.push(link)):/store\.steampowered\.com\/app\//.test(link)&&/wishlist/gim.test(taskDes)?("undo"===action&&this.socialTasks.steam.wishlistLinks.push(link),"do"===action&&this.undoneTasks.steam.wishlistLinks.push(link)):/store\.steampowered\.com\/curator\//.test(link)?("undo"===action&&this.socialTasks.steam.curatorLinks.push(link),"do"===action&&this.undoneTasks.steam.curatorLinks.push(link)):/^https?:\/\/discord\.com\/invite\//.test(link)?("undo"===action&&this.socialTasks.discord.serverLinks.push(link),"do"===action&&this.undoneTasks.discord.serverLinks.push(link)):/^javascript:videoTask.+/.test(link)?"do"===action&&(taskData=link.match(/javascript:videoTask\('.+?','(.+?)'/)?.[1])&&this.undoneTasks.extra.videoTasks.push(taskData):/^https?:\/\/www\.instagram\.com\/.*/.test(link)||/^https?:\/\/twitter\.com\/.*/.test(link)||/^https?:\/\/www\.twitch\.tv\/.*/.test(link)||/^https?:\/\/www\.facebook\.com\/.*/.test(link)||/^https?:\/\/www\.youtube\.com\/.*/.test(link)||/^https?:\/\/store\.steampowered\.com\/developer\//.test(link)||/^https?:\/\/.*?\.itch\.io\/.*/.test(link)||/^https?:\/\/key-hub\.eu.*/.test(link)||/^https?:\/\/store\.steampowered\.com\/app\/.*/.test(link)||/^https?:\/\/qr\.streamelements\.com\/.*/.test(link)||/^https?:\/\/store\.steampowered\.com\/news\/app\/.*/.test(link)||scripts_echoLog({}).warning(`${i18n("unKnownTaskType")}: ${taskDes}(${link})`))}return logStatus.success(),this.undoneTasks=this.uniqueTasks(this.undoneTasks),this.socialTasks=this.uniqueTasks(this.socialTasks),window.DEBUG&&console.log("%cAuto-Task[Debug]:","color:blue",JSON.stringify(this)),GM_setValue("khTasks-"+this.giveawayId,{tasks:this.socialTasks,time:(new Date).getTime()}),!0}catch(error){return throwError(error,"Keyhub.classifyTask"),!1}}async#doScriptTask(data){try{var logStatus=scripts_echoLog({text:i18n("doingKeyhubTask")}),{result,statusText,status,data:response}=await tools_httpRequest({url:"/away?data="+data,method:"GET",headers:{origin:"https://key-hub.eu",referer:"https://key-hub.eu/"}});return"Success"===result?200===response?.status?(logStatus.success(),!0):(logStatus.error(`Error:${response?.statusText}(${response?.status})`),!1):(logStatus.error(result+`:${statusText}(${status})`),!1)}catch(error){return throwError(error,"Keyhub.doScriptTask"),!1}}async extraDoTask({videoTasks}){try{var data,pro=[];for(data of videoTasks)pro.push(this.#doScriptTask(data));return Promise.all(pro).then(()=>!0)}catch(error){return throwError(error,"Keyhub.extraDoTask"),!1}}#getGiveawayId(){try{var giveawayId=window.location.href.match(/giveaway\/([\d]+)/)?.[1];return giveawayId?(this.giveawayId=giveawayId,!0):(scripts_echoLog({}).error(i18n("getFailed","GiveawayId")),!1)}catch(error){return throwError(error,"Keyhub.getGiveawayId"),!1}}async#checkLeftKey(){try{return globalOptions.other.checkLeftKey&&"0"===$("#keysleft").text().trim()&&await external_Swal_default().fire({icon:"warning",title:i18n("notice"),text:i18n("noKeysLeft"),confirmButtonText:i18n("confirm"),cancelButtonText:i18n("cancel"),showCancelButton:!0}).then(({value})=>{value&&window.close()}),!0}catch(error){return throwError(error,"Keyhub.checkLeftKey"),!1}}#checkLogin(){try{return globalOptions.other.checkLogin&&0<$('a[href*="/connect/steam"]').length&&window.open("/connect/steam","_self"),!0}catch(error){return throwError(error,"Keyhub.checkLogin"),!1}}}var website_Keyhub=Keyhub;let Givekey_defaultTasks=JSON.stringify({steam:{groupLinks:[],wishlistLinks:[],curatorLinks:[],curatorLikeLinks:[]},twitter:{userLinks:[]},vk:{nameLinks:[]},discord:{serverLinks:[]}});class Givekey extends userDefinedGlobalOptions{name="Givekey";tasks=[];socialTasks=JSON.parse(Givekey_defaultTasks);undoneTasks=JSON.parse(Givekey_defaultTasks);userId;buttons=["doTask","undoTask","verifyTask"];static test(){return"givekey.ru"===window.location.host}async after(){try{await new Promise(resolve=>{let checker=setInterval(()=>{0<$("#navbarDropdown").length&&(clearInterval(checker),resolve(!0))},500)}),await this.#checkLeftKey()||scripts_echoLog({}).warning(i18n("checkLeftKeyFailed"))}catch(error){throwError(error,"Givekey.after")}}init(){try{var userId,logStatus=scripts_echoLog({text:i18n("initing")});return 0<$('a[href*="/auth/steam"]').length?(window.open("/auth/steam","_self"),logStatus.warning(i18n("needLogin")),!1):!!this.#getGiveawayId()&&((userId=$('meta[name="user-id"]').attr("content"))?(this.userId=userId,this.initialized=!0,logStatus.success(),!0):(logStatus.error(i18n("getFailed",i18n("userId"))),!1))}catch(error){return throwError(error,"Givekey.init"),!1}}async classifyTask(action){try{var task,logStatus=scripts_echoLog({text:i18n("getTasksInfo")}),tasks=("undo"===action&&(this.socialTasks=GM_getValue("gkTasks-"+this.giveawayId)?.tasks||JSON.parse(Givekey_defaultTasks)),$('.card-body:has("button") .row'));for(task of tasks){var taskEle=$(task),isSuccess=/Complete/i.test(taskEle.find("button").text().trim());if(!isSuccess||"undo"===action){var taskId=taskEle.find("#task_check").attr("data-id");if(taskId&&this.tasks.push(taskId),"verify"!==action){let href=taskEle.find("a").attr("href")||null;var text=taskEle.find("a").text().trim(),icon=taskEle.find("i");href&&text&&(href=/^https?:\/\/givekey\.ru\/giveaway\/[\d]+\/execution_task/.test(href)?await getRedirectLink(href):href)&&(/^https?:\/\/vk\.com\//.test(href)?(this.socialTasks.vk.nameLinks.push(href),"do"!==action||isSuccess||this.undoneTasks.vk.nameLinks.push(href)):/^https?:\/\/steamcommunity\.com\/groups/.test(href)?(this.socialTasks.steam.groupLinks.push(href),"do"!==action||isSuccess||this.undoneTasks.steam.groupLinks.push(href)):/^https?:\/\/store\.steampowered\.com\/app\//.test(href)?(this.socialTasks.steam.wishlistLinks.push(href),"do"!==action||isSuccess||this.undoneTasks.steam.wishlistLinks.push(href)):/Subscribe/gi.test(text)&&icon.hasClass("fa-steam-square")?/^https?:\/\/store\.steampowered\.com\/curator\//.test(href)?(this.socialTasks.steam.curatorLinks.push(href),"do"!==action||isSuccess||this.undoneTasks.steam.curatorLinks.push(href)):(this.socialTasks.steam.curatorLikeLinks.push(href),"do"!==action||isSuccess||this.undoneTasks.steam.curatorLikeLinks.push(href)):/^https?:\/\/twitter\.com\//.test(href)&&/Subscribe/gi.test(text)?(this.socialTasks.twitter.userLinks.push(href),"do"!==action||isSuccess||this.undoneTasks.twitter.userLinks.push(href)):icon.hasClass("fa-discord")||/^https?:\/\/discord\.com\/invite\//.test(href)?(this.socialTasks.discord.serverLinks.push(href),"do"!==action||isSuccess||this.undoneTasks.discord.serverLinks.push(href)):scripts_echoLog({}).warning(`${i18n("unKnownTaskType")}: ${text}(${href})`))}}}return logStatus.success(),this.tasks=unique(this.tasks),this.undoneTasks=this.uniqueTasks(this.undoneTasks),this.socialTasks=this.uniqueTasks(this.socialTasks),window.DEBUG&&console.log("%cAuto-Task[Debug]:","color:blue",JSON.stringify(this)),GM_setValue("gkTasks-"+this.giveawayId,{tasks:this.socialTasks,time:(new Date).getTime()}),!0}catch(error){return throwError(error,"Givekey.classifyTask"),!1}}async verifyTask(){try{if(!this.initialized&&!this.init())return!1;if(0===this.tasks.length&&!await this.classifyTask("verify"))return!1;scripts_echoLog({}).warning(i18n("giveKeyNoticeBefore"));var taskLength=this.tasks.length;for(let i=0;i<taskLength;i++)await this.#verify(this.tasks[i]),i<taskLength-1&&await delay(15e3);return scripts_echoLog({}).success(i18n("allTasksComplete")),scripts_echoLog({html:`<li><font class="warning">${i18n("giveKeyNoticeAfter")}</font></li>`}),!0}catch(error){return throwError(error,"Givekey.verifyTask"),!1}}async#verify(task){try{let logStatus=scripts_echoLog({html:`<li>${i18n("verifyingTask")}${task}...<font></font></li>`});return await new Promise(resolve=>{$.ajax({url:"https://givekey.ru/giveaway/task",method:"POST",data:`id=${task}&user_id=`+this.userId,dataType:"json",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:data=>{data.btn&&$(`button[data-id=${this.userId}]`).html(data.btn),"ok"===data.status?($(".task_check_"+data.id).html(`<button class="btn btn-success mb-2 btn-block" disabled>${data.btn}</button>`),logStatus.success(),resolve(!0)):"end"===data.status?(logStatus.success(),scripts_echoLog({}).success(data.key),resolve(!0)):(logStatus.error("Error:"+data.msg),resolve(!1))},error:xhr=>{logStatus.error(`Error:${xhr.statusText}(${xhr.status})`),resolve(!1)}})})}catch(error){return throwError(error,"Givekey.verify"),!1}}#getGiveawayId(){try{var giveawayId=window.location.href.match(/giveaway\/([\d]+)/)?.[1];return giveawayId?(this.giveawayId=giveawayId,!0):(scripts_echoLog({text:i18n("getFailed","GiveawayId")}),!1)}catch(error){return throwError(error,"Givekey.getGiveawayId"),!1}}async#checkLeftKey(){try{return globalOptions.other.checkLeftKey&&!$("#keys_count").text()&&await external_Swal_default().fire({icon:"warning",title:i18n("notice"),text:i18n("noKeysLeft"),confirmButtonText:i18n("confirm"),cancelButtonText:i18n("cancel"),showCancelButton:!0}).then(({value})=>{value&&window.close()}),!0}catch(error){return throwError(error,"Givekey.checkLeftKey"),!1}}}var website_Givekey=Givekey;class GiveeClub extends GiveawaySu{name="GiveeClub";buttons=["doTask","undoTask","verifyTask"];static test(){return/^https?:\/\/givee\.club\/.*?\/event\/[\d]+/.test(window.location.href)}async after(){try{this.#checkLogin()||scripts_echoLog({}).warning(i18n("checkLoginFailed")),await this.#checkLeftKey()||scripts_echoLog({}).warning(i18n("checkLeftKeyFailed"))}catch(error){throwError(error,"GiveeClub.after")}}init(){try{var logStatus=scripts_echoLog({text:i18n("initing")});return this.#checkLogin()?!!this.#getGiveawayId()&&(this.initialized=!0,logStatus.success(),!0):(logStatus.warning(i18n("needLogin")),!1)}catch(error){return throwError(error,"GiveeClub.init"),!1}}async classifyTask(action){try{var logStatus=scripts_echoLog({text:i18n("getTasksInfo")});if("undo"===action)this.socialTasks=GM_getValue("gcTasks-"+this.giveawayId)?.tasks||Giveawaysu_defaultTasks;else{this.undoneTasks=Giveawaysu_defaultTasks;var pro=[];for(let task of $(".event-actions tr"))pro.push(new Promise(resolve=>{let taskDes=$(task).find(".event-action-label a"),taskIcon=$(task).find(".event-action-icon i").attr("class")||"",taskName=taskDes.text().trim(),taskType=$(task).find("button[data-type]")?.attr("data-type");var taskFinished=$(task).find(".event-action-buttons .btn-success")?.length;if(taskIcon.includes("ban")||/AdBlock/i.test(taskName)||taskIcon.includes("envelope")||taskFinished)return resolve(!0);getRedirectLink(taskDes.attr("href")).then(taskLink=>{if(!taskLink)return resolve(!1);"steam.group.join"===taskType&&/^https?:\/\/steamcommunity\.com\/groups/.test(taskLink)?this.undoneTasks.steam.groupLinks.push(taskLink):/like.*announcement/gi.test(taskName)?this.undoneTasks.steam.announcementLinks.push(taskLink):"steam.game.wishlist"===taskType&&/^https?:\/\/store\.steampowered\.com\/app\//.test(taskLink)?this.undoneTasks.steam.wishlistLinks.push(taskLink):"steam.game.wishlist"===taskType&&taskDes.attr("data-steam-wishlist-appid")?this.undoneTasks.steam.wishlistLinks.push("https://store.steampowered.com/app/"+taskDes.attr("data-steam-wishlist-appid")):"steam.game.follow"===taskType&&/^https?:\/\/store\.steampowered\.com\/app\//.test(taskLink)?this.undoneTasks.steam.followLinks.push(taskLink):/^https?:\/\/store\.steampowered\.com\/curator\//.test(taskLink)?this.undoneTasks.steam.curatorLinks.push(taskLink):taskIcon.includes("steam")&&/follow|subscribe/gim.test(taskName)?this.undoneTasks.steam.curatorLikeLinks.push(taskLink):/subscribe.*steam.*forum/gim.test(taskName)?this.undoneTasks.steam.forumLinks.push(taskLink):taskIcon.includes("discord")?this.undoneTasks.discord.serverLinks.push(taskLink):taskIcon.includes("instagram")?this.undoneTasks.instagram.userLinks.push(taskLink):taskIcon.includes("twitch")?this.undoneTasks.twitch.channelLinks.push(taskLink):taskIcon.includes("reddit")?this.undoneTasks.reddit.redditLinks.push(taskLink):/watch.*art/gim.test(taskName)?this.undoneTasks.steam.workshopVoteLinks.push(taskLink):/subscribe.*youtube.*channel/gim.test(taskName)?this.undoneTasks.youtube.channelLinks.push(taskLink):/(watch|like).*youtube.*video/gim.test(taskName)||(taskIcon.includes("youtube")||taskIcon.includes("thumbs-up"))&&/(watch|like).*video/gim.test(taskName)?this.undoneTasks.youtube.likeLinks.push(taskLink):taskIcon.includes("vk")||/join.*vk.*group/gim.test(taskName)?this.undoneTasks.vk.nameLinks.push(taskLink):taskIcon.includes("twitter")?/https?:\/\/(twitter|x)\.com\/[^/]+\/?$/gim.test(taskLink)?this.undoneTasks.twitter.userLinks.push(taskLink):/https?:\/\/(twitter|x)\.com\/[^/]+?\/status\/[\d]+/gim.test(taskLink)&&this.undoneTasks.twitter.retweetLinks.push(taskLink):/(on twitter)|(Follow.*on.*Facebook)/gim.test(taskName)||/follow.*button/gim.test(taskName)&&this.undoneTasks.steam.followLinks.push(taskLink),resolve(!0)}).catch(error=>(throwError(error,"GiveeClub.classifyTask->getRedirectLink"),!1))}));await Promise.all(pro),logStatus.success(),this.undoneTasks=this.uniqueTasks(this.undoneTasks),this.socialTasks=this.undoneTasks,window.DEBUG&&console.log("%cAuto-Task[Debug]:","color:blue",JSON.stringify(this)),GM_setValue("gcTasks-"+this.giveawayId,{tasks:this.socialTasks,time:(new Date).getTime()})}return!0}catch(error){return throwError(error,"GiveeClub.classifyTask"),!1}}async verifyTask(){try{var button,logStatus=scripts_echoLog({text:i18n("giveeClubVerifyNotice")});for(button of $(".event-actions tr button").has("i.glyphicon-refresh").not('[data-type="user.adblock"]'))button.click(),"steam.game.wishlist"!==$(button).attr("data-type")&&await delay(1e3);return logStatus.warning(i18n("giveeClubVerifyFinished")),!0}catch(error){return throwError(error,"Givekey.verifyTask"),!1}}#checkLogin(){try{return globalOptions.other.checkLogin&&0<$('a[href*="/account/auth"]').length&&window.open($('a[href*="/account/auth"]').attr("href"),"_self"),!0}catch(error){return throwError(error,"GiveeClub.checkLogin"),!1}}#getGiveawayId(){var giveawayId=window.location.href.match(/\/event\/([\d]+)/)?.[1];return giveawayId?(this.giveawayId=giveawayId,!0):(scripts_echoLog({text:i18n("getFailed","GiveawayId")}),!1)}async#checkLeftKey(){try{return globalOptions.other.checkLeftKey&&0<$(".event-ended").length&&0===$(".event-winner").length&&await external_Swal_default().fire({icon:"warning",title:i18n("notice"),text:i18n("giveawayEnded"),confirmButtonText:i18n("confirm"),cancelButtonText:i18n("cancel"),showCancelButton:!0}).then(({value})=>{value&&window.close()}),!0}catch(error){return throwError(error,"Giveawaysu.checkLeftKey"),!1}}}var website_GiveeClub=GiveeClub,website_OpiumPulses=class{name="OpiumPulses";options={maxPoint:"99999999",...GM_getValue("OpiumPulsesOptions")};maxPoints=99999999;myPoints=0;buttons=["doFreeTask","doPointTask"];static test(){return"www.opiumpulses.com"===window.location.host}async after(){try{this.#checkLogin()||scripts_echoLog({}).warning(i18n("checkLoginFailed")),this.maxPoints=parseInt(this.options.maxPoint,10)}catch(error){throwError(error,"OpiumPulses.after")}}async doFreeTask(){try{this.#toggleTask("FREE")}catch(error){throwError(error,"OpiumPulses.doFreeTask")}}async doPointTask(){try{this.myPoints=parseInt($(".page-header__nav-func-user-nav-items.points-items").text().match(/[\d]+/gim)?.[0]||"0",10),this.#toggleTask("points")}catch(error){throwError(error,"OpiumPulses.doPointTask")}}async#toggleTask(type){try{var item;for(item of $(`.giveaways-page-item:contains('${type}'):not(:contains('ENTERED'))`)){var logStatus,aElement,giveawayId,result,statusText,status,data,result0,statusText0,status0,data0,points,needPoints=parseInt($(item).find(".giveaways-page-item-header-points").text().match(/[\d]+/gim)?.[0]||"999999",10),name=$(item).find(".giveaways-page-item-footer-name").text().trim();"points"===type&&needPoints>this.myPoints?scripts_echoLog({}).warning(i18n("noPoints")+": "+name):"points"!==type||needPoints?"points"===type&&needPoints>this.maxPoints||(logStatus=scripts_echoLog({text:`${i18n("joiningLottery")}<a href="${$(item).find("a.giveaways-page-item-img-btn-more").attr("href")}" target="_blank">${name}</a>...`}),(aElement=$(item).find("a.giveaways-page-item-img-btn-enter:contains('enter')"))?.attr("onclick")?.includes("checkUser")&&(giveawayId=aElement.attr("onclick")?.match(/[\d]+/)?.[0])&&checkUser(giveawayId),aElement.attr("href")?({result,statusText,status,data}=await tools_httpRequest({url:aElement.attr("href"),method:"GET"}),"Success"===result?({result:result0,statusText:statusText0,status:status0,data:data0}=await tools_httpRequest({url:data?.finalUrl,method:"GET"}),data0?.responseText&&/You've entered this giveaway/gim.test(data0.responseText)?(logStatus.success(),points=data0.responseText.match(/Points:[\s]*?([\d]+)/)?.[1],"points"===type&&points&&(this.myPoints=parseInt(points,10))):data0?.responseText&&/You're not eligible to enter/gim.test(data0.responseText)?logStatus.error("You're not eligible to enter"):logStatus.error(result0+`:${statusText0}(${status0})`)):logStatus.error(result+`:${statusText}(${status})`)):logStatus.error('Error: No "href".')):scripts_echoLog({}).warning(i18n("getNeedPointsFailed")+": "+name)}scripts_echoLog({text:"-----END-----"})}catch(error){throwError(error,"OpiumPulses.toggleTask")}}init(){return!0}classifyTask(){return!0}#checkLogin(){try{return globalOptions.other.checkLogin&&1<$('a[href*="/site/login"]').length&&window.open("/site/login","_self"),!0}catch(error){return throwError(error,"OpiumPulses.checkLogin"),!1}}};let external_dayjs_namespaceObject=dayjs;var external_dayjs_default=__webpack_require__.n(external_dayjs_namespaceObject);let website_leftKeyChecker={async classify(link){try{return/^https?:\/\/giveaway\.su\/giveaway\/view\/[\d]+/.test(link)?await this.giveawaySu(link):/^https?:\/\/givee\.club\/[\w]+?\/event\/[\d]+/.test(link)?await this.giveeClub(link):/^https?:\/\/gleam\.io\/.+?\/.+/.test(link)?await this.gleam(link):/^https?:\/\/www\.indiedb\.com\/giveaways\/.+/.test(link)?await this.indieDb(link):/^https?:\/\/key-hub\.eu\/giveaway\/[\d]+/.test(link)?await this.keyhub(link):/^https?:\/\/opquests\.com\/quests\/[\d]+/.test(link)?await this.opquests(link):!!/^https?:\/\/itch\.io\/s\/[\d]+?\/.*/.test(link)&&await this.itch(link)}catch(error){return throwError(error,"leftKeyChecker.classify"),!1}},async giveawaySu(link){try{var{result,data}=await tools_httpRequest({url:link,method:"GET"});return"Success"===result&&200===data?.status?!data.responseText.includes('class="steam-login"')&&(data.responseText.includes('class="giveaway-ended"')?"Ended":"Active"):!1}catch(error){return throwError(error,"leftKeyChecker.giveawaySu"),!1}},async giveeClub(link){try{var{result,data}=await tools_httpRequest({url:link,method:"GET"});return"Success"===result&&200===data?.status?data.responseText.includes('class="event-winner"')?"Won":data.responseText.includes('class="event-ended"')?"Ended":"Active":!1}catch(error){return throwError(error,"leftKeyChecker.giveeClub"),!1}},async gleam(link){try{var campaignDiv,campaignString,campaign,{result,data}=await tools_httpRequest({url:link,method:"GET"});return"Success"===result&&200===data?.status?/incentives&quot;:{&quot;[\d]+?&quot;:\[&quot;.+?&quot;\]/.test(data.responseText)?"Won":!!(campaignDiv=data.responseText.match(/<div class='popup-blocks-container'[\w\W]+?'>/)?.[0])&&!!(campaignString=$(campaignDiv).attr("ng-init")?.match(/initCampaign\(([\w\W]+?)\)$/)?.[1])&&(campaign=JSON.parse(campaignString).campaign,campaign.banned?"Banned":campaign.finished?"Ended":campaign.paused?"Paused":(new Date).getTime()<1e3*campaign.starts_at?"NotStart":"Active"):!1}catch(error){return throwError(error,"leftKeyChecker.gleam"),!1}},async indieDb(link){try{var{result,data}=await tools_httpRequest({url:link,method:"GET"});return"Success"===result&&200===data?.status?data.responseText.includes("Congrats you WON")?"Won":data.responseText.includes("Giveaway is closed")||data.responseText.includes("next time")?"Ended":"Active":!1}catch(error){return throwError(error,"leftKeyChecker.indieDb"),!1}},async keyhub(link){try{var keysleft,{result,data}=await tools_httpRequest({url:link,method:"GET"});return"Success"===result&&200===data?.status?!!(keysleft=data.responseText.match(/<span id="keysleft">([\d]+?)<\/span>/)?.[1])&&("0"===keysleft?"Ended":`Active(${keysleft})`):!1}catch(error){return throwError(error,"leftKeyChecker.keyhub"),!1}},async opquests(link){try{var keysleft,{result,data}=await tools_httpRequest({url:link,method:"GET"});return"Success"===result&&200===data?.status?!!(keysleft=data.responseText.match(/<div class="">[\s]*?([\d]+?)[\s]*?of/)?.[1])&&("0"===keysleft?"Ended":`Active(${keysleft})`):404===data?.status&&"Ended"}catch(error){return throwError(error,"leftKeyChecker.opquests"),!1}},async itch(link){try{var endDate,{result,data}=await tools_httpRequest({url:link,method:"GET"});return"Success"===result&&200===data?.status?!!(endDate=data.responseText.match(/{"start_date":"[0-9A-Z-:]+?".*?"end_date":"([0-9A-Z-:]+?)".*?}/)?.[1])&&((new Date).getTime()>new Date(endDate).getTime()?"Ended":`Active(${external_dayjs_default()(endDate).format("YYYY-MM-DD HH:mm:ss")})`):!1}catch(error){return throwError(error,"leftKeyChecker.itch"),!1}}},Keylol_defaultTasks=JSON.stringify({steam:{groupLinks:[],wishlistLinks:[],curatorLinks:[],curatorLikeLinks:[],followLinks:[],forumLinks:[],announcementLinks:[],workshopVoteLinks:[],licenseLinks:[]},discord:{serverLinks:[]},instagram:{userLinks:[]},vk:{nameLinks:[]},twitch:{channelLinks:[]},reddit:{redditLinks:[]},twitter:{userLinks:[],retweetLinks:[]},youtube:{channelLinks:[],likeLinks:[]}});class Keylol extends userDefinedGlobalOptions{name="Keylol";socialTasks=JSON.parse(Keylol_defaultTasks);undoneTasks=JSON.parse(Keylol_defaultTasks);buttons=["doTask","undoTask","selectAll","selectNone","invertSelect"];static test(){return!("keylol.com"!==window.location.host||!$(".subforum_left_title_left_up a").eq(3).attr("href")?.includes("319")&&!$(".subforum_left_title_left_up a").eq(3).attr("href")?.includes("234"))}init(){return!0}after(){try{var selector="Keylol"===this.name?'#postlist>div[id^="post_"]:first':"div.container",mainPost=$(selector),discordLinks=mainPost.find('a[href*="discord.com"]:visible'),redditLinks=mainPost.find('a[href*="reddit.com"]:visible'),insLinks=mainPost.find('a[href*="instagram.com"]:visible'),twitterLinks=mainPost.find('a[href*="twitter.com"]:visible,a[href*="x.com"]:visible'),twitchLinks=mainPost.find('a[href*="twitch.tv"]:visible'),vkLinks=mainPost.find('a[href*="vk.com"]:visible'),steamStoreLinks=mainPost.find('a[href*="store.steampowered.com"]:visible'),steamCommunityLinks=mainPost.find('a[href*="steamcommunity.com"]:visible'),ytbLinks=mainPost.find('a[href*="youtube.com"]:visible');if(0<discordLinks.length)for(var discordLink of discordLinks){var link=$(discordLink).attr("href");link&&/^https?:\/\/discord\.com\/invite\/.+/.test(link)&&this.#addBtn(discordLink,"discord","serverLinks",link)}if(0<redditLinks.length)for(var redditLink of redditLinks){let link=$(redditLink).attr("href");link&&/^https?:\/\/www\.reddit\.com\/(r|user)\/.+/.test(link)&&this.#addBtn(redditLink,"reddit","redditLinks",link)}if(0<insLinks.length)for(var insLink of insLinks){let link=$(insLink).attr("href");link&&/^https:\/\/www\.instagram\.com\/.+/.test(link)&&this.#addBtn(insLink,"instagram","userLinks",link)}if(0<twitterLinks.length)for(var twitterLink of twitterLinks){let link=$(twitterLink).attr("href");link&&/^https:\/\/twitter\.com\/.+/.test(link)&&(/https:\/\/twitter\.com\/.*?\/status\/[\d]+/.test(link)?this.#addBtn(twitterLink,"twitter","retweetLinks",link):this.#addBtn(twitterLink,"twitter","userLinks",link))}if(0<twitchLinks.length)for(var twitchLink of twitchLinks){let link=$(twitchLink).attr("href");link&&/^https:\/\/(www\.)?twitch\.tv\/.+/.test(link)&&this.#addBtn(twitchLink,"twitch","channelLinks",link)}if(0<vkLinks.length)for(var vkLink of vkLinks){let link=$(vkLink).attr("href");link&&/^https:\/\/vk\.com\/.+/.test(link)&&this.#addBtn(vkLink,"vk","nameLinks",link)}if(0<steamStoreLinks.length)for(var steamStoreLink of steamStoreLinks){let link=$(steamStoreLink).attr("href");link&&(/curator\/[\d]+/.test(link)?this.#addBtn(steamStoreLink,"steam","curatorLinks",link):/(publisher|developer|franchise)\/.+/.test(link)?this.#addBtn(steamStoreLink,"steam","curatorLikeLinks",link):/news(hub)?\/app\/[\d]+\/view\/[\d]+/.test(link)?this.#addBtn(steamStoreLink,"steam","announcementLinks",link):/app\/[\d]+/.test(link)&&(this.#addBtn(steamStoreLink,"steam","followLinks",link),this.#addBtn(steamStoreLink,"steam","wishlistLinks",link)))}if(0<steamCommunityLinks.length)for(var steamCommunityLink of steamCommunityLinks){let link=$(steamCommunityLink).attr("href");link&&(/groups\/.+/.test(link)?this.#addBtn(steamCommunityLink,"steam","groupLinks",link):/announcements\/detail\/[\d]+/.test(link)&&this.#addBtn(steamCommunityLink,"steam","announcementLinks",link))}if(0<ytbLinks.length)for(var ytbLink of ytbLinks){let link=$(ytbLink).attr("href");link&&(this.#addBtn(ytbLink,"youtube","channelLinks",link),this.#addBtn(ytbLink,"youtube","likeLinks",link))}var giveawayLinks=mainPost.find('a[href*="giveaway.su/giveaway/view/"]:visible,a[href*="givee.club/"]:visible,a[href*="gleam.io/"]:visible,a[href*="www.indiedb.com/giveaways/"]:visible,a[href*="key-hub.eu/giveaway/"]:visible,a[href*="opquests.com/quests/"]:visible,a[href*="itch.io/s/"]:visible');if(0<giveawayLinks.length)for(var giveawayLink of giveawayLinks){let link=$(giveawayLink).attr("href");link&&website_leftKeyChecker.classify(link).then(status=>{status&&(/^Active/.test(status)?$(`a[href="${link}"]`).after(`<font class="auto-task-giveaway-status active" title="${i18n("Active")}">${status}</font>`):$(`a[href="${link}"]`).after(`<font class="auto-task-giveaway-status not-active" title="${i18n(status)}">${status}</font>`))}).catch(error=>{throwError(error,"keylol.after -> leftKeyChecker")})}if("Keylol"===this.name){var asfLinks=mainPost.find('a[href^="#asf"]:visible');if(0<asfLinks.length)for(var asfLink of asfLinks){let link=$(asfLink).attr("href");link&&this.#addBtn($(`a[href="${link}"]`).after('<span style="color: #ccc; margin: 0 -5px 0 5px"> | </span>').next()[0],"steam","licenseLinks","appid-"+link.replace("#asf",""))}var subid,subLinks=mainPost.find('a[href*="steamdb.info/sub/"]:visible');if(0<subLinks.length)for(var subLink of subLinks){let link=$(subLink).attr("href");link&&(subid=link.match(/^https:\/\/steamdb\.info\/sub\/([\d]+)/)?.[1])&&this.#addBtn(subLink,"steam","licenseLinks","subid-"+subid)}var asfLinks2=mainPost.find('.blockcode:contains("addlicense"):visible');if(0<asfLinks2.length)for(let asfLink of asfLinks2){let appid=[...asfLink.innerText.matchAll(/a(pp)?\/([\d]+)/g)].map(matched=>matched?.[2]).filter(id=>id)||[],subid=(0<appid.length&&this.#addBtn($(asfLink).children("em")[0],"steam","licenseLinks","appid-"+appid.join(",")),asfLink.innerText.match(/[\d]+/g)?.filter(matched=>!appid.includes(matched)));subid&&0!==subid.length&&this.#addBtn($(asfLink).children("em")[0],"steam","licenseLinks","subid-"+subid.join(","))}}if(0<$("#threadindex").length){var[targetNode]=$("#postlist").children('div[id^="post_"]'),config={childList:!0};let observer=new MutationObserver(()=>{observer.disconnect(),this.after()});observer.observe(targetNode,config)}}catch(error){throwError(error,"keylol.after")}}classifyTask(action){try{var btn;this.socialTasks=JSON.parse(Keylol_defaultTasks),this.undoneTasks=JSON.parse(Keylol_defaultTasks);for(btn of $('.auto-task-keylol[selected="selected"]:visible')){var button=$(btn),social=button.attr("data-social"),type=button.attr("data-type"),link=button.attr("data-link");social&&type&&link&&("do"===action&&this.undoneTasks[social][type].push(link),"undo"===action)&&this.socialTasks[social][type].push(link)}return this.undoneTasks=this.uniqueTasks(this.undoneTasks),this.socialTasks=this.uniqueTasks(this.socialTasks),window.DEBUG&&console.log("%cAuto-Task[Debug]:","color:blue",JSON.stringify(this)),!0}catch(error){return throwError(error,"Keylol.classifyTask"),!1}}selectAll(){try{$(".auto-task-keylol:visible").attr("selected","selected")}catch(error){throwError(error,"Keylol.selectAll")}}selectNone(){try{$(".auto-task-keylol:visible").removeAttr("selected")}catch(error){throwError(error,"Keylol.selectNone")}}invertSelect(){try{$(".auto-task-keylol:visible").each((index,element)=>{element.getAttribute("selected")?element.removeAttribute("selected"):element.setAttribute("selected","selected")})}catch(error){throwError(error,"Keylol.invertSelect")}}#addBtn(before,social,linkType,link){try{$(before).after('<a href="javascript:void(0);" class="auto-task-keylol" target="_self"'+" onclick=\"this.getAttribute('selected') ? this.removeAttribute('selected') : this.setAttribute('selected', 'selected')\""+` data-social="${social}" data-type="${linkType}" data-link="${link}">${linkType.replace("Links","")}</a>`)}catch(error){throwError(error,"keylol.addBtn")}}}var website_Keylol=Keylol;class Opquests extends userDefinedGlobalOptions{name="Opquests";undoneTasks={steam:{groupLinks:[],wishlistLinks:[],followLinks:[],curatorLikeLinks:[]},twitter:{userLinks:[],retweetLinks:[]}};buttons=["doTask","verifyTask","getKey"];static test(){return"opquests.com"===window.location.host}async after(){try{this.#checkLogin()||scripts_echoLog({}).warning(i18n("checkLoginFailed"));var taskId,verifyBtn,opquestsVerifyTasks=GM_getValue("opquestsVerifyTasks")||[];if(0<opquestsVerifyTasks.length)return taskId=opquestsVerifyTasks.pop(),[verifyBtn]=(GM_setValue("opquestsVerifyTasks",opquestsVerifyTasks),$(`#task_id[value="${taskId}"]`).parent().find('button[type="button"]').has("i.fa-check")),verifyBtn?void verifyBtn.click():void this.after();GM_getValue("opquestsVerifyTasks")&&GM_deleteValue("opquestsVerifyTasks")}catch(error){throwError(error,"Opquests.after")}}init(){try{var logStatus=scripts_echoLog({text:i18n("initing")});return 0<$('a[href*="/auth/redirect"]').length?(window.open("/auth/redirect","_self"),logStatus.warning(i18n("needLogin")),!1):!!this.#getGiveawayId()&&(this.initialized=!0,logStatus.success(),!0)}catch(error){return throwError(error,"Opquests.init"),!1}}async classifyTask(action){try{if("undo"===action)return scripts_echoLog({text:i18n("cannotUndo")}),!1;var task,logStatus=scripts_echoLog({text:i18n("getTasksInfo")});for(task of $('.w-full:contains("Validate") .items-center')){var link=$(task).find('a:contains("Open")').attr("href"),taskDes=$(task).find("div").eq(1).text().trim();link&&(/steamcommunity\.com\/groups\//.test(link)?this.undoneTasks.steam.groupLinks.push(link):/store\.steampowered\.com\/app\//.test(link)?/wishlist/gim.test(taskDes)?this.undoneTasks.steam.wishlistLinks.push(link):/follow/gim.test(taskDes)&&this.undoneTasks.steam.followLinks.push(link):/store\.steampowered\.com\/(publisher|developer|curator)\//.test(link)&&/follow/gim.test(taskDes)?this.undoneTasks.steam.curatorLikeLinks.push(link):link.includes("//x.com/")&&/follow/gim.test(taskDes)?this.undoneTasks.twitter.userLinks.push(link):link.includes("//x.com/")&&link.includes("status")&&/Repost/gim.test(taskDes)?this.undoneTasks.twitter.retweetLinks.push(link):/clash.gg/.test(link)?scripts_echoLog({}).warning(i18n("unSupporttedTaskType")+`: ${taskDes}(${link})`):scripts_echoLog({}).warning(i18n("unKnownTaskType")+`: ${taskDes}(${link})`))}return logStatus.success(),this.undoneTasks=this.uniqueTasks(this.undoneTasks),window.DEBUG&&console.log("%cAuto-Task[Debug]:","color:blue",JSON.stringify(this)),!0}catch(error){return throwError(error,"Opquests.classifyTask"),!1}}async verifyTask(){try{this.initialized||this.init();var tasks=$.makeArray($(".items-center").has('input[name="task_id"]')).map(ele=>$(ele).find('input[name="task_id"]').val());return GM_setValue("opquestsVerifyTasks",tasks),await this.#confirm(),this.after(),!0}catch(error){return throwError(error,"Opquests.verifyTask"),!1}}async#confirm(){try{var logStatus=scripts_echoLog({html:`<li>${i18n("confirmingTask")}...<font></font></li>`}),{result,statusText,status,data}=await tools_httpRequest({url:`https://opquests.com/quests/${this.giveawayId}?confirm=1`,method:"GET",nochche:!0,headers:{origin:"https://opquests.com",referer:"https://opquests.com/warning?id="+this.giveawayId}});return"Success"===result?200===data?.status?(logStatus.success(),!0):(logStatus.error(`Error:${data?.statusText}(${data?.status})`),!1):(logStatus.error(result+`:${statusText}(${status})`),!1)}catch(error){return throwError(error,"Opquests.confirm"),!1}}async getKey(isButton){try{var key,logStatus=scripts_echoLog({text:i18n("gettingKey")}),{result,statusText,status,data}=await tools_httpRequest({url:"https://opquests.com/keys",method:"GET"});return"Success"===result?data?.responseText?(key=$(data?.responseText).find(`div.items-center:contains("${$("h1.font-bold").text().trim().replace(" Quest","")}")`).find("div.font-bold").next().text())?(logStatus.success(),scripts_echoLog({}).success(key),!0):(logStatus.error("Error: Key was not found"),isButton&&window.open("https://opquests.com/keys","_self"),!1):(logStatus.error(`Error:${data?.statusText}(${data?.status})`),!1):(logStatus.error(result+`:${statusText}(${status})`),!1)}catch(error){return throwError(error,"Opquests.getGiveawayId"),!1}}#getGiveawayId(){try{var giveawayId=window.location.href.match(/quests\/([\d]+)/)?.[1];return giveawayId?(this.giveawayId=giveawayId,!0):(scripts_echoLog({}).error(i18n("getFailed","GiveawayId")),!1)}catch(error){return throwError(error,"Opquests.getGiveawayId"),!1}}#checkLogin(){try{return globalOptions.other.checkLogin&&0<$('a[href*="/auth/redirect"]').length&&window.open("/auth/redirect","_self"),!0}catch(error){return throwError(error,"Opquests.checkLogin"),!1}}}var website_Opquests=Opquests;let Gleam_defaultTasks=JSON.stringify({steam:{groupLinks:[],wishlistLinks:[],followLinks:[],curatorLinks:[],curatorLikeLinks:[]},twitter:{userLinks:[],retweetLinks:[]},twitch:{channelLinks:[]},discord:{serverLinks:[]},youtube:{channelLinks:[]},extra:{gleam:[]}});class Gleam extends userDefinedGlobalOptions{name="Gleam";undoneTasks=JSON.parse(Gleam_defaultTasks);socialTasks=JSON.parse(Gleam_defaultTasks);buttons=["doTask","undoTask","verifyTask"];static test(){return"gleam.io"===window.location.host}before(){try{unsafeWindow.confirm=()=>{},unsafeWindow.alert=()=>{},unsafeWindow.prompt=()=>{}}catch(error){throwError(error,"Gleam.before")}}async after(){try{if(window.location.search.includes("8b07d23f4bfa65f9")){let checkComplete=setInterval(()=>{0<$(".entry-content .entry-method i.fa-check").length&&(clearInterval(checkComplete),window.close())});for(var task of $(".entry-content .entry-method")){var taskInfo=$(task).find(".user-links"),aElements=$(task).find(".expandable").find("a.btn,a:contains(Continue),button:contains(Continue)");if(0<aElements.length)for(var element of aElements){var $element=$(element),href=$element.attr("href");$element.removeAttr("href")[0].click(),$element.attr("href",href),await delay(1e3)}taskInfo[0].click(),await delay(1e3)}scripts_echoLog({}).warning(i18n("gleamTaskNotice"))}else await this.#checkLeftKey()||scripts_echoLog({}).warning(i18n("checkLeftKeyFailed"))}catch(error){throwError(error,"Gleam.after")}}init(){try{var logStatus=scripts_echoLog({text:i18n("initing")});return this.#getGiveawayId()?(this.initialized=!0,logStatus.success(),!0):!1}catch(error){return throwError(error,"Gleam.init"),!1}}async classifyTask(action){try{var task,logStatus=scripts_echoLog({text:i18n("getTasksInfo")}),tasks=("undo"===action&&(this.socialTasks=GM_getValue("gleamTasks-"+this.giveawayId)?.tasks||JSON.parse(Gleam_defaultTasks)),$(".entry-content .entry-method"));for(task of tasks){var $task=$(task);if("do"!==action||0!==$task.find("i.fa-question").length){var gleamLink,socialIcon=$task.find(".icon-wrapper i"),taskText=$task.find(".user-links").text().trim(),aElements=$task.find(".expandable").find("a.btn");if(0<aElements.length)for(var element of aElements){var $element=$(element),href=$element.attr("href");$element.removeAttr("href")[0].click(),$element.attr("href",href)}if(socialIcon.hasClass("fa-twitter")||socialIcon.hasClass("fa-x-twitter")){var link=$task.find('a[href^="https://twitter.com/"],a[href^="https://x.com/"]').attr("href");link&&(/follow/gi.test(taskText)?("undo"===action&&this.socialTasks.twitter.userLinks.push(link),"do"===action&&this.undoneTasks.twitter.userLinks.push(link)):/retweet/gim.test(taskText)&&("undo"===action&&this.socialTasks.twitter.retweetLinks.push(link),"do"===action)&&this.undoneTasks.twitter.retweetLinks.push(link))}else if(socialIcon.hasClass("fa-twitch")){if(/follow/gim.test(taskText)){let link=$task.find('a[href^="https://twitch.tv/"]').attr("href");link&&("undo"===action&&this.socialTasks.twitch.channelLinks.push(link),"do"===action)&&this.undoneTasks.twitch.channelLinks.push(link)}}else if(socialIcon.hasClass("fa-discord")){if(/join/gim.test(taskText)){let link=$task.find('a[href^="https://discord.com/invite/"]').attr("href");if(!link){var ggLink=$task.find('a[href^="https://discord.gg/"]').attr("href")?.match(/discord\.gg\/([^/]+)/)?.[1];if(!ggLink)continue;link="https://discord.com/invite/"+ggLink}"undo"===action&&this.socialTasks.discord.serverLinks.push(link),"do"===action&&this.undoneTasks.discord.serverLinks.push(link)}}else if(!socialIcon.hasClass("fa-external-link-square-alt"))if(socialIcon.hasClass("fa-youtube")){if(/subscribe/gim.test(taskText)){let link=$task.find('a[href^="https://www.youtube.com/channel/"]').attr("href");link&&("undo"===action&&this.socialTasks.youtube.channelLinks.push(link),"do"===action)&&this.undoneTasks.youtube.channelLinks.push(link)}}else if(socialIcon.attr("class")?.includes("steam")){if(/join.*group/gi.test(taskText)){let link=$task.find('a[href^="https://steamcommunity.com/groups/"]').attr("href");link&&("undo"===action&&this.socialTasks.steam.groupLinks.push(link),"do"===action)&&this.undoneTasks.steam.groupLinks.push(link)}else if(/follow.*curator/gi.test(taskText)){let link=$task.find('a[href^="https://store.steampowered.com/curator/"]').attr("href");link&&("undo"===action&&this.socialTasks.steam.curatorLinks.push(link),"do"===action)&&this.undoneTasks.steam.curatorLinks.push(link)}}else socialIcon.hasClass("fa-bullhorn")&&/Complete|Increase/gi.test(taskText)?"do"===action&&(gleamLink=await this.#getGleamLink(taskText))&&this.undoneTasks.extra.gleam.push(gleamLink):socialIcon.hasClass("fa-question")||socialIcon.hasClass("fa-reddit")||socialIcon.hasClass("fa-instagram")||socialIcon.hasClass("fa-facebook-f")||socialIcon.hasClass("fa-telegram-plane")||socialIcon.hasClass("fa-telegram")||socialIcon.hasClass("fa-vk")||socialIcon.hasClass("fa-envelope")||socialIcon.hasClass("fa-gift")||socialIcon.hasClass("fa-square-up-right")||socialIcon.hasClass("fa-gamepad-modern")||socialIcon.hasClass("fa-dollar-sign")||socialIcon.hasClass("fa-tiktok")||socialIcon.hasClass("fa-gamepad-alt")||socialIcon.hasClass("fa-shield")&&taskText.includes("one of our giveaways")||socialIcon.hasClass("fa-shield")&&taskText.includes("Check out")||socialIcon.hasClass("fa-shield")&&taskText.includes("vloot.io")||scripts_echoLog({}).warning(i18n("unKnownTaskType")+": "+taskText)}}return logStatus.success(),this.undoneTasks=this.uniqueTasks(this.undoneTasks),this.socialTasks=this.uniqueTasks(this.socialTasks),window.DEBUG&&console.log("%cAuto-Task[Debug]:","color:blue",JSON.stringify(this)),GM_setValue("gleamTasks-"+this.giveawayId,{tasks:this.socialTasks,time:(new Date).getTime()}),!0}catch(error){return throwError(error,"Gleam.classifyTask"),!1}}async extraDoTask({gleam}){try{var link,pro=[];for(link of gleam)pro.push(this.#doGleamTask(link));return Promise.all(pro).then(()=>!0)}catch(error){return throwError(error,"Gleam.extraDoTask"),!1}}async verifyTask(){try{scripts_echoLog({text:i18n("verifyingTask")+"..."});var task,tasks=$(".entry-content .entry-method");unsafeWindow._OxA="_OxA";for(task of tasks){if(0<$('[campaign-key="campaign.key"]').length)return scripts_echoLog({text:i18n("campaign")});var $task=$(task);if(0!==$task.find("i.fa-question").length){$task.find(".user-links")[0].click();var aElements=$task.find(".expandable").find("a.btn");if(0<aElements.length)for(var element of aElements){var $element=$(element),href=$element.attr("href");$element.removeAttr("href")[0].click(),$element.attr("href",href)}unsafeWindow.$hookTimer?.setSpeed(1e3);0<$task.find(".expandable").find("span:contains(more seconds),button:contains(more seconds)").filter(":visible").length&&unsafeWindow.$hookTimer&&(newTab=GM_openInTab("",{active:!0}),await delay(1e3),newTab?.close(),window.focus()),await delay(3e3),unsafeWindow.$hookTimer?.setSpeed(1);var newTab,evt,valuelimit,button,expandInfo=$task.find(".expandable"),[input]=expandInfo.find("input"),continueBtn=(input&&(evt=new Event("input",{bubbles:!0,cancelable:!0,composed:!0}),valuelimit=[...expandInfo.text().matchAll(/"(.+?)"/g)].at(-1)?.[1],input.value=valuelimit||"vloot",input.dispatchEvent(evt),await delay(1e3)),await this.#checkSync(),$task.find(".expandable").find("span:contains(Continue),button:contains(Continue)"));for(button of continueBtn)button.click(),await delay(500),await this.#checkSync()}}scripts_echoLog({text:i18n("verifiedGleamTasks")})}catch(error){return throwError(error,"Gleam.verifyTask"),!1}}async#checkSync(){try{return await new Promise(resolve=>{let checker=setInterval(()=>{0===$(".entry-content .entry-method i.fa-sync").length&&(clearInterval(checker),resolve(!0))},500)})}catch(error){return throwError(error,"Gleam.checkSync"),!1}}async#doGleamTask(link){try{let logStatus=scripts_echoLog({text:i18n("doingGleamTask")});return await new Promise(resolve=>{GM_openInTab(link+"?8b07d23f4bfa65f9",{active:!0,insert:!0,setParent:!0}).onclose=()=>{logStatus.success(),resolve(!0)}})}catch(error){return throwError(error,"Gleam.doGleamTask"),!1}}#getGiveawayId(){try{var giveawayId=window.location.pathname;return giveawayId?(this.giveawayId=giveawayId,!0):(scripts_echoLog({text:i18n("getFailed","GiveawayId")}),!1)}catch(error){return throwError(error,"Gleam.getGiveawayId"),!1}}async#getGleamLink(title){try{var link,logStatus=scripts_echoLog({text:i18n("gettingGleamLink")}),{result,statusText,status,data}=await tools_httpRequest({url:"https://www.vloot.io/api/v1/giveaways",method:"GET",responseType:"json"});return"Success"===result?200===data?.status&&!0===data?.response?.Success&&data?.response?.Data?(link=(data.response.Data.find(giveaway=>title.replace(/[\s]/g,"").toLowerCase().includes(giveaway.title.replace(/[\s]/g,"").toLowerCase()))||{}).link,link?(logStatus.success(),link):(logStatus.error("Error:"+i18n("getLinkFailed")),!1)):(logStatus.error(`Error:${data?.statusText}(${data?.status})`),!1):(logStatus.error(result+`:${statusText}(${status})`),!1)}catch(error){return throwError(error,"Gleam.getGleamLink"),!1}}async#checkLeftKey(){try{if(globalOptions.other.checkLeftKey){var campaignString=$("div.popup-blocks-container").attr("ng-init")?.match(/initCampaign\(([\w\W]+?)\)$/)?.[1];if(!campaignString)return!1;var{campaign,incentive}=JSON.parse(campaignString),controllerString=$("div.campaign.reward").attr("ng-init")?.match(/initContestant\(([\w\W]+?)\);/)?.[1];let ownedKey=!1;controllerString&&JSON.parse(controllerString).contestant?.claims?.incentives?.[incentive.id]?.length&&(ownedKey=!0),(campaign.banned||campaign.finished&&!ownedKey||campaign.paused||(new Date).getTime()<1e3*campaign.starts_at)&&await external_Swal_default().fire({icon:"warning",title:i18n("notice"),text:i18n("giveawayNotWork"),confirmButtonText:i18n("confirm"),cancelButtonText:i18n("cancel"),showCancelButton:!0}).then(({value})=>{value&&window.close()})}return!0}catch(error){return throwError(error,"Gleam.checkLeftKey"),!1}}}var website_Gleam=Gleam;class SweepWidget extends userDefinedGlobalOptions{name="SweepWidget";options={username:"",email:"",...GM_getValue("SweepWidgetOptions")};buttons=["doTask"];static test(){return/^https?:\/\/sweepwidget\.com\/view\/[\d]+/.test(window.location.href)}async after(){try{this.#checkLogin()||scripts_echoLog({}).warning(i18n("checkLoginFailed"))}catch(error){throwError(error,"SweepWidget.after")}}init(){try{var logStatus=scripts_echoLog({text:i18n("initing")});return this.#checkLogin()?!!this.#getGiveawayId()&&(this.initialized=!0,logStatus.success(),!0):(logStatus.warning(i18n("needLogin")),!1)}catch(error){return throwError(error,"SweepWidget.init"),!1}}classifyTask(){return!0}async doTask(){try{if(0===$("#unlock_rewards_main_wrapper").length&&(0<$('input[name="sw__login_name"]:visible').length&&$('input[name="sw__login_name"]').val(this.options.username),0<$('input[name="sw__login_email"]:visible').length&&$('input[name="sw__login_email"]').val(this.options.email),0<$("#sw_login_button:visible").length&&$("#sw_login_button")[0].click(),!await this.#checkEnter()))return!1;var task,logStatus=scripts_echoLog({text:i18n("SweepWidgetNotice")});for(task of $("#sw_inner_entry_methods_l2_wrapper>div.sw_entry")){var title,aElement,link,$task=$(task);0<$task.find("i.fa-check:visible").length||((title=$task.find(".sw_text_inner"))[0].click(),link=(aElement=$task.find("a.sw_link")).attr("href"),aElement.attr("href","#a").attr("target","_self"),aElement[0]?.click(),await delay(300),aElement.attr("href",link).attr("target","_blank"),$task.find('input[type="text"]').val("test"),!0===$task.find("input.sw_verify").prop("disabled")&&(title[0].click(),await delay(300),title[0].click(),await delay(300)),$task.find("input.sw_verify").removeAttr("disabled")[0]?.click(),await this.#checkFinish($task),await delay(parseInt(""+(2001*Math.random()+1e3),10)))}return logStatus.success(),!0}catch(error){return throwError(error,"SweepWidget.doTask"),!1}}#checkLogin(){try{return 0<$("#twitter_login_button").length&&$("#twitter_login_button")[0].click(),!0}catch(error){return throwError(error,"SweepWidget.checkLogin"),!1}}#getGiveawayId(){try{var giveawayId=window.location.href.match(/\/view\/([\d]+)/)?.[1];return giveawayId?(this.giveawayId=giveawayId,!0):(scripts_echoLog({text:i18n("getFailed","GiveawayId")}),!1)}catch(error){return throwError(error,"SweepWidget.getGiveawayId"),!1}}async#checkEnter(){try{return new Promise(resolve=>{let checker=setInterval(()=>{0<$("#unlock_rewards_main_wrapper").length&&(clearInterval(checker),resolve(!0))},500)})}catch(error){return throwError(error,"SweepWidget.checkEnter"),!1}}async#checkFinish($task){try{return new Promise(resolve=>{let checker=setInterval(()=>{(0<$task.find("i.fa-check:visible").length||0===$task.find(".sw_entry_input:visible").length)&&(clearInterval(checker),resolve(!0))},500)})}catch(error){return throwError(error,"SweepWidget.checkFinish"),!1}}}var website_SweepWidget=SweepWidget;function whiteListOptions(showType){try{let whiteList=(whiteList=>{try{var key,value,newWhiteList={};for([key,value]of Object.entries(defaultWhiteList))newWhiteList[key]={...value,...whiteList[key]};return newWhiteList}catch(error){return throwError(error,"assignWhiteList"),defaultWhiteList}})(GM_getValue("whiteList")||{}),whiteListOptionsForm=`<form id="whiteListForm" class="auto-task-form">
  <table class="auto-task-table"><thead><tr><td>${i18n("website")}</td><td>${i18n("type")}</td><td>${i18n("edit")}</td></tr></thead><tbody>`;for(let[social,types]of Object.entries(whiteList))whiteListOptionsForm+=Object.keys(types).map((type,index)=>disabledType[social]?.includes(type)?"":`<tr style="background-color: ${stringToColour(social)}66">${0===index?`<th rowspan="${Object.keys(types).length-(disabledType[social]||[]).length}" style="background-color: ${stringToColour(social)}66">${social}</th>`:""}<td>${i18n(type)}</td><td><button type="button" class="editWhiteList" data-value="${social}.${type}">${i18n("edit")}</button></td></tr>`).join("");whiteListOptionsForm+="</tbody></table></form>","swal"===showType?external_Swal_default().fire({title:i18n("whiteListOptions"),html:whiteListOptionsForm,showConfirmButton:!1,showCloseButton:!0}):$("body").append(`<h2>${i18n("whiteList")}</h2>`+whiteListOptionsForm),$(".editWhiteList").on("click",function(){var value=$(this).attr("data-value");if(value){let[social,type]=value.split(".");whiteList?.[social]?.[type]?(external_Swal_default().fire({title:i18n("changeWhiteListOption",value),input:"textarea",html:`<input id="socialLink" class="swal2-input" placeholder="在此处输入链接获取id">
        <button id="link2id" data-type="${value}" class="swal2-confirm swal2-styled">获取id</button>
        <p style="margin-bottom:0 !important;">在下方填写白名单，每行一个</p>`,inputValue:whiteList[social][type].join("\n"),showConfirmButton:!0,confirmButtonText:i18n("save"),showCancelButton:!0,cancelButtonText:i18n("close"),showDenyButton:!0,denyButtonText:i18n("return")}).then(({isDenied,isConfirmed,value})=>{isDenied?"swal"===showType&&whiteListOptions(showType):isConfirmed&&(whiteList[social][type]=value.split("\n"),GM_setValue("whiteList",whiteList),external_Swal_default().fire({title:i18n("changeWhiteListSuccess"),icon:"success"}))}),$("#link2id").on("click",async function(){var type=$(this).attr("data-type");$("#socialLink").val(await(async type=>{try{var link=$("#socialLink").val();let id="";switch(type){case"discord.servers":id=link.match(/invite\/(.+)/)?.[1]||"";break;case"instagram.users":id=link.match(/https:\/\/www\.instagram\.com\/(.+)?\//)?.[1]||"";break;case"twitch.channels":id=link.match(/https:\/\/(www\.)?twitch\.tv\/(.+)/)?.[2]||"";break;case"twitter.users":id=link.match(/https:\/\/twitter\.com\/(.+)/)?.[1]||"";break;case"twitter.retweets":id=link.match(/https:\/\/twitter\.com\/.*?\/status\/([\d]+)/)?.[1]||"";break;case"vk.names":id=link.match(/https:\/\/vk\.com\/([^/]+)/)?.[1]||"";break;case"youtube.channels":id=(await getInfo(link,"channel"))?.params?.channelId||"";break;case"youtube.likes":id=(await getInfo(link,"likeVideo"))?.params?.videoId||"";break;case"reddit.reddits":id=link.match(/https?:\/\/www\.reddit\.com\/user\/([^/]*)/)?.[1]||link.match(/https?:\/\/www\.reddit\.com\/r\/([^/]*)/)?.[1]||"";break;case"steam.groups":id=link.match(/groups\/(.+)\/?/)?.[1]||"";break;case"steam.wishlists":case"steam.follows":case"steam.forums":id=link.match(/app\/([\d]+)/)?.[1]||"";break;case"steam.workshops":id=link.match(/\?id=([\d]+)/)?.[1]||"";break;case"steam.curators":if(link.includes("curator"))id=link.match(/curator\/([\d]+)/)?.[1]||"";else{var param=link.match(/https?:\/\/store\.steampowered\.com\/(.*?)\/([^/?]+)/)?.slice(1,3);if(!param||2!==param.length)break;var steam=new social_Steam;await steam.init()&&(id=await steam.getCuratorId(param[0],param[1])||"")}}return id}catch(error){return throwError(error,"link2id"),i18n("getFailed","id")}})(type))})):scripts_echoLog({}).warning(i18n("whiteListNotFound",value))}})}catch(error){throwError(error,"whiteListOptions")}}let defaultWhiteList={discord:{servers:[]},instagram:{users:[]},twitch:{channels:[]},twitter:{users:[],retweets:[],likes:[]},vk:{names:[]},youtube:{channels:[],likes:[]},reddit:{reddits:[]},steam:{groups:[],officialGroups:[],wishlists:[],follows:[],forums:[],workshops:[],curators:[],workshopVotes:[],curatorLikes:[],announcements:[],licenses:[],playtests:[]}},disabledType={steam:["workshopVotes","curatorLikes","announcements"],twitter:["likes"]},whiteList=whiteListOptions,getGistData=async(token,gistId,fileName,test=!1)=>{try{var logStatus=scripts_echoLog({text:i18n("gettingData")}),{result,statusText,status,data}=await tools_httpRequest({url:"https://api.github.com/gists/"+gistId,headers:{Accept:"application/vnd.github.v3+json",Authorization:"token "+token},responseType:"json",method:"GET",timeout:3e4});if("Success"!==result)return logStatus.error(result+`:${statusText}(${status})`),!1;if(200!==data?.status)return logStatus.error(`Error:${data?.statusText}(${data?.status})`),!1;{var content=data.response?.files?.[fileName]?.content;let formatedContent;if(!content)return logStatus.error("Error:"+i18n("noRemoteData")),!1;if(test)return logStatus.success(),!0;try{formatedContent=JSON.parse(content)}catch(error){return logStatus.error("Error:"+i18n("errorRemoteDataFormat")),!1}return logStatus.success(),formatedContent}}catch(error){return throwError(error,"getGistData"),!1}},syncOptions=()=>{try{var{TOKEN,GIST_ID,FILE_NAME,SYNC_HISTORY}=GM_getValue("gistOptions")||{TOKEN:"",GIST_ID:"",FILE_NAME:"",SYNC_HISTORY:!0};external_Swal_default().fire({title:i18n("gistOptions"),html:`<p>Github Token<input id="github-token" class="swal2-input" placeholder="Github Token" value="${TOKEN}"></p>`+`<p>Gist ID<input id="gist-id" class="swal2-input" placeholder="Gist ID" value="${GIST_ID}"></p>`+`<p>${i18n("fileName")}<input id="file-name" class="swal2-input" placeholder="${i18n("fileName")}" value="${FILE_NAME}"></p>`+'<p><label for="sync-history" class="swal2-checkbox-custom" style="display: flex;">'+`<input id="sync-history" type="checkbox"${SYNC_HISTORY?' checked="checked"':""}/>`+`<span class="swal2-label">${i18n("syncHistory")}</span></label></p>`+`<p><button id="upload-data" type="button" class="swal2-confirm swal2-styled" style="display: inline-block;">
      ${i18n("upload2gist")}</button>`+`<button id="download-data" type="button" class="swal2-confirm swal2-styled" style="display: inline-block;">
      ${i18n("downloadFromGist")}</button></p>`,focusConfirm:!1,showLoaderOnConfirm:!0,footer:`<a href="https://auto-task-doc.js.org/guide/#%E6%95%B0%E6%8D%AE%E5%90%8C%E6%AD%A5" target="_blank">${i18n("help")}</a>`,preConfirm:async()=>{var token=$("#github-token").val(),gistId=$("#gist-id").val(),fileName=$("#file-name").val(),syncHistory=$("#sync-history").prop("checked");return GM_setValue("gistOptions",{TOKEN:token,GIST_ID:gistId,FILE_NAME:fileName,SYNC_HISTORY:syncHistory}),getGistData(token,gistId,fileName,!0)},allowOutsideClick:()=>!external_Swal_default().isLoading(),confirmButtonText:i18n("saveAndTest"),showCancelButton:!0,cancelButtonText:i18n("close")}).then(({value})=>{value?external_Swal_default().fire({icon:"success",title:i18n("testSuccess")}).then(syncOptions):void 0!==value&&external_Swal_default().fire({icon:"error",title:i18n("testFailed")}).then(syncOptions)}),$("#upload-data").on("click",async()=>{var{TOKEN,GIST_ID,FILE_NAME}=GM_getValue("gistOptions")||{};if(!(TOKEN&&GIST_ID&&FILE_NAME))return external_Swal_default().fire({icon:"error",title:i18n("saveAndTestNotice")}).then(syncOptions);external_Swal_default().fire({icon:"info",title:i18n("processingData")});var name,data={},names=GM_listValues(),SYNC_HISTORY=$("#sync-history").prop("checked");for(name of names)"gistOptions"===name||/^[\w]+?Auth$/.test(name)||!SYNC_HISTORY&&/^[\w]+?Tasks-/.test(name)||(data[name]=GM_getValue(name));external_Swal_default().update({icon:"info",title:i18n("updatingData")}),await(async(token,gistId,fileName,content)=>{try{var logStatus=scripts_echoLog({text:i18n("settingData")}),contentData=JSON.stringify({files:{[fileName]:{content:JSON.stringify(content)}}}),{result,statusText,status,data}=await tools_httpRequest({url:"https://api.github.com/gists/"+gistId,headers:{Accept:"application/vnd.github.v3+json",Authorization:"token "+token},data:contentData,responseType:"json",method:"POST",timeout:3e4});return"Success"===result?200===data?.status&&data.response.files?.[fileName]?.content===JSON.stringify(content)?(logStatus.success(),!0):(logStatus.error(`Error:${data?.statusText}(${data?.status})`),!1):(logStatus.error(result+`:${statusText}(${status})`),!1)}catch(error){return throwError(error,"setGistData"),!1}})(TOKEN,GIST_ID,FILE_NAME,data)?external_Swal_default().fire({icon:"success",title:i18n("syncDataSuccess")}):external_Swal_default().fire({icon:"error",title:i18n("syncDataFailed")})}),$("#download-data").on("click",async()=>{var{TOKEN,GIST_ID,FILE_NAME}=GM_getValue("gistOptions")||{};if(!(TOKEN&&GIST_ID&&FILE_NAME))return external_Swal_default().fire({icon:"error",title:i18n("saveAndTestNotice")}).then(syncOptions);external_Swal_default().fire({icon:"info",title:i18n("downloadingData")});TOKEN=await getGistData(TOKEN,GIST_ID,FILE_NAME);if(!TOKEN)return external_Swal_default().fire({icon:"error",title:i18n("checkedNoData")}).then(syncOptions);external_Swal_default().update({icon:"info",title:i18n("savingData")});var name,value,SYNC_HISTORY=$("#sync-history").prop("checked");for([name,value]of Object.entries(TOKEN))!SYNC_HISTORY&&/^[\w]+?Tasks-/.test(name)||GM_setValue(name,value);external_Swal_default().fire({icon:"success",title:i18n("syncDataSuccess")})})}catch(error){throwError(error,"syncOptions")}};var dataSync=syncOptions,website_Setting=class{name="Setting";buttons=["saveGlobalOptions","syncData","tasksHistory"];syncData=dataSync;tasksHistory(){GM_openInTab("https://auto-task-v4.hclonely.com/history.html",{active:!0})}static test(){return"auto-task-v4.hclonely.com"===window.location.host&&"/setting.html"===window.location.pathname}before(){try{$("body").html("").addClass("auto-task-options")}catch(error){throwError(error,"Setting.before")}}after(){try{this.#environment(),changeGlobalOptions("page"),whiteList("page"),$('input[name="other.twitterVerifyId"]').after(`<button id="getTwitterUserId" type="button">${i18n("getTwitterUserId")}</button>`),$("#getTwitterUserId").on("click",()=>{this.#getId("twitterUser")}),$('input[name="other.youtubeVerifyChannel"]').after(`<button id="getYoutubeChannelId" type="button">${i18n("getYoutubeChannelId")}</button>`),$("#getYoutubeChannelId").on("click",()=>{this.#getId("youtubeChannel")}),$('input[name^="position"]').on("input",function(){switch($(this).attr("name").replace("position.","")){case"buttonSideX":case"buttonSideY":case"buttonDistance":var distance=$('input[name="position.buttonDistance"]').val(),sideX=$('input[name="position.buttonSideX"]').val(),sideY=$('input[name="position.buttonSideY"]').val();["right","left"].includes(sideX)&&["top","bottom"].includes(sideY)&&/^[\d]+?,[\d]+$/.test(distance)&&(distance=distance.split(","),$("#auto-task-buttons").css(sideX,distance[0]+"px").css(sideY,distance[1]+"px").css("rightleft".replace(sideX,""),"").css("topbottpm".replace(sideY,""),""));break;case"showButtonSideX":case"showButtonSideY":case"showButtonDistance":{let distance=$('input[name="position.showButtonDistance"]').val(),sideX=$('input[name="position.showButtonSideX"]').val(),sideY=$('input[name="position.showButtonSideY"]').val();if(!["right","left"].includes(sideX))break;if(!["top","bottom"].includes(sideY))break;if(!/^[\d]+?,[\d]+$/.test(distance))break;let distanceArr=distance.split(",");$("div.show-button-div").css(sideX,distanceArr[0]+"px").css(sideY,distanceArr[1]+"px").css("rightleft".replace(sideX,""),"").css("topbottpm".replace(sideY,""),"");break}case"logSideX":case"logSideY":case"logDistance":{let distance=$('input[name="position.logDistance"]').val(),sideX=$('input[name="position.logSideX"]').val(),sideY=$('input[name="position.logSideY"]').val();if(!["right","left"].includes(sideX))break;if(!["top","bottom"].includes(sideY))break;if(!/^[\d]+?,[\d]+$/.test(distance))break;let distanceArr=distance.split(",");$("#auto-task-info").css(sideX,distanceArr[0]+"px").css(sideY,distanceArr[1]+"px").css("rightleft".replace(sideX,""),"").css("topbottpm".replace(sideY,""),"");break}}}),$('input[name^="hotKey"]').attr("readonly","readonly").off("keydown").on("keydown",function(event){let functionKey="";event.altKey?functionKey+="alt + ":event.ctrlKey?functionKey+="ctrl + ":event.shiftKey&&(functionKey+="shift + "),$(this).val(functionKey+(1===event.key.length?event.key.toLowerCase():""))})}catch(error){throwError(error,"Setting.after")}}saveGlobalOptions(){try{saveData()}catch(error){throwError(error,"Setting.saveGlobalOptions")}}#getId(social){try{external_Swal_default().fire({title:i18n("getId",i18n(social)),html:`<input id="socialLink" class="swal2-input" placeholder="在此处输入链接获取id">
          <button id="link2id" data-type="${social}" class="swal2-confirm swal2-styled">获取id</button>`,showCancelButton:!0,cancelButtonText:i18n("close"),showConfirmButton:!1}),$("#link2id").on("click",async function(){var link=$("#socialLink").val();if(link){var type=$(this).attr("data-type");if("twitterUser"===type){var name=link.match(/https:\/\/twitter\.com\/(.+)/)?.[1]||link;$("#socialLink").val(await(new social_Twitter).userName2id(name)||"")}else if("youtubeChannel"===type){let name=/^https:\/\/(www\.)?google\.com.*?\/url\?.*?url=https:\/\/www.youtube.com\/.*/.test(link)?link.match(/url=(https:\/\/www\.youtube\.com\/.*)/)?.[1]:link;$("#socialLink").val((await getInfo(name,"channel"))?.params?.channelId||"")}}})}catch(error){throwError(error,"Setting.getId")}}#environment(){try{var userAgent=(0,javascript_utils_umd_min.ua)(),environmentForm=`<form id="environmentForm" class="auto-task-form">
        <table class="auto-task-table"><thead><tr><td>${i18n("type")}</td><td>${i18n("name")}</td><td>${i18n("version")}</td></tr></thead><tbody>
        <tr><td>${i18n("os")}</td><td>${userAgent.os}</td><td>${userAgent.osVersion}</td></tr>
        <tr><td>${i18n("browser")}</td><td>${userAgent.browserZH}</td><td>${userAgent.browserVersion}</td></tr>
        <tr><td>${i18n("scriptManager")}</td><td>${GM_info.scriptHandler}</td><td>${GM_info.version}</td></tr>
        <tr><td>${i18n("script")}</td><td>${GM_info.script.name}</td><td>${GM_info.script.version}</td></tr>
        </tbody></table></form>`;$("body").append(`<h2>${i18n("environment")}</h2>`+environmentForm)}catch(error){throwError(error,"Setting.environment")}}};class History extends website_Keylol{name="History";buttons=["doTask","undoTask","selectAll","selectNone","invertSelect","clearHistory"];static test(){return"auto-task-v4.hclonely.com"===window.location.host&&"/history.html"===window.location.pathname}before(){try{var item;$("body").html('<div class="container"></div>').addClass("auto-task-history");for(item of(GM_listValues()||[]).map(value=>/^[\w]+?Tasks-/.test(value)?value:null).filter(value=>value))this.#addItem(item)}catch(error){throwError(error,"History.before")}}clearHistory(){try{var item;for(item of(GM_listValues()||[]).map(value=>/^[\w]+?Tasks-/.test(value)?value:null).filter(value=>value))GM_deleteValue(item);external_Swal_default().fire({title:i18n("clearHistoryFinished"),icon:"success"})}catch(error){throwError(error,"History.clearHistory")}}#addItem(item){try{var tasksData=GM_getValue(item);if(tasksData?.tasks){let html="",title="",link="";var social,types,[website,id]=item.split("-");switch(website){case"fawTasks":title=`Freeanywhere[${id}]`,link="https://freeanywhere.net/#/giveaway/"+id;break;case"gasTasks":title=`Giveawaysu[${id}]`,link="https://giveaway.su/giveaway/view/"+id;break;case"gcTasks":title=`GiveeClub[${id}]`,link="https://givee.club/event/"+id;break;case"gkTasks":title=`Givekey[${id}]`,link="https://givekey.ru/giveaway/"+id;break;case"gleamTasks":title=`Gleam[${id}]`,link="https://gleam.io"+id;break;case"khTasks":title=`keyhub[${id}]`,link="https://key-hub.eu/giveaway/"+id;break;case"prysTasks":title=`Prys[${id}]`,link="https://prys.revadike.com/giveaway/?id="+id;break;default:return}for([social,types]of Object.entries(tasksData.tasks))for(var[type,tasks]of Object.entries(types))for(var task of tasks)html+=`<li><font class="auto-task-capitalize">${social}.${i18n(type.replace("Link",""))}: </font><a href="${task}" target="_blank">${55<task.length?task.slice(0,55)+"...":task}</a></li>`;$(".container").append(`<div class="card" data-name="${item}"><div class="title"><a href="${link}" target="_blank">${title}</a><span class="delete-task" data-name="${item}" title="${i18n("deleteTask")}"><svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2734" width="32" height="32"><path d="M607.897867 768.043004c-17.717453 0-31.994625-14.277171-31.994625-31.994625L575.903242 383.935495c0-17.717453 14.277171-31.994625 31.994625-31.994625s31.994625 14.277171 31.994625 31.994625l0 351.94087C639.892491 753.593818 625.61532 768.043004 607.897867 768.043004z" p-id="2735" fill="#d81e06"></path><path d="M415.930119 768.043004c-17.717453 0-31.994625-14.277171-31.994625-31.994625L383.935495 383.935495c0-17.717453 14.277171-31.994625 31.994625-31.994625 17.717453 0 31.994625 14.277171 31.994625 31.994625l0 351.94087C447.924744 753.593818 433.647573 768.043004 415.930119 768.043004z" p-id="2736" fill="#d81e06"></path><path d="M928.016126 223.962372l-159.973123 0L768.043004 159.973123c0-52.980346-42.659499-95.983874-95.295817-95.983874L351.94087 63.989249c-52.980346 0-95.983874 43.003528-95.983874 95.983874l0 63.989249-159.973123 0c-17.717453 0-31.994625 14.277171-31.994625 31.994625s14.277171 31.994625 31.994625 31.994625l832.032253 0c17.717453 0 31.994625-14.277171 31.994625-31.994625S945.73358 223.962372 928.016126 223.962372zM319.946246 159.973123c0-17.545439 14.449185-31.994625 31.994625-31.994625l320.806316 0c17.545439 0 31.306568 14.105157 31.306568 31.994625l0 63.989249L319.946246 223.962372 319.946246 159.973123 319.946246 159.973123z" p-id="2737" fill="#d81e06"></path><path d="M736.048379 960.010751 288.123635 960.010751c-52.980346 0-95.983874-43.003528-95.983874-95.983874L192.139761 383.591466c0-17.717453 14.277171-31.994625 31.994625-31.994625s31.994625 14.277171 31.994625 31.994625l0 480.435411c0 17.717453 14.449185 31.994625 31.994625 31.994625l448.096758 0c17.717453 0 31.994625-14.277171 31.994625-31.994625L768.215018 384.795565c0-17.717453 14.277171-31.994625 31.994625-31.994625s31.994625 14.277171 31.994625 31.994625l0 479.231312C832.032253 916.835209 789.028725 960.010751 736.048379 960.010751z" p-id="2738" fill="#d81e06"></path></svg></span></div><ul>${html}</ul><span class="time">${i18n("lastChangeTime")}: ${external_dayjs_namespaceObject(tasksData.time).format("YYYY-MM-DD HH:mm:ss")}</span></div>`),$("span.delete-task").on("click",function(){var itemName=$(this).attr("data-name");itemName?(GM_deleteValue(itemName),$(`div.card[data-name="${itemName}"]`).remove(),external_Swal_default().fire({title:i18n("clearTaskFinished"),text:itemName,icon:"success"})):external_Swal_default().fire({title:i18n("clearTaskFailed"),icon:"error"})})}}catch(error){throwError(error,"History.addItem")}}}var website_History=History;let GiveawayHopper_defaultTasks=JSON.stringify({steam:{groupLinks:[],wishlistLinks:[],followLinks:[],curatorLinks:[],curatorLikeLinks:[]},twitter:{userLinks:[],retweetLinks:[]},twitch:{channelLinks:[]},discord:{serverLinks:[]},youtube:{channelLinks:[]},extra:{giveawayHopper:[]}});class GiveawayHopper extends userDefinedGlobalOptions{name="GiveawayHopper";undoneTasks=JSON.parse(GiveawayHopper_defaultTasks);socialTasks=JSON.parse(GiveawayHopper_defaultTasks);tasks=[];buttons=["doTask","undoTask","verifyTask"];static test(){return"giveawayhopper.com"===window.location.host}async after(){try{this.#checkLogin()||scripts_echoLog({}).warning(i18n("checkLoginFailed")),this.#getGiveawayId()}catch(error){throwError(error,"GiveawayHopper.after")}}async init(){try{var logStatus=scripts_echoLog({text:i18n("initing")});return await this.#checkLeftKey()||scripts_echoLog({}).warning(i18n("checkLeftKeyFailed")),this.initialized=!0,logStatus.success(),!0}catch(error){return throwError(error,"GiveawayHopper.init"),!1}}async classifyTask(action){try{this.giveawayId||await this.#getGiveawayId();var steamGroupLink,logStatus=scripts_echoLog({text:i18n("getTasksInfo")}),{result,statusText,status,data}=("undo"===action&&(this.socialTasks=GM_getValue("giveawayHopperTasks-"+this.giveawayId)?.tasks||JSON.parse(GiveawayHopper_defaultTasks)),await tools_httpRequest({url:`https://giveawayhopper.com/api/v1/campaigns/${this.giveawayId}/with-auth`,method:"GET",responseType:"json",fetch:!0,headers:{authorization:"Bearer "+window.sessionStorage.gw_auth,"x-xsrf-token":decodeURIComponent(document.cookie.match(/XSRF-TOKEN=([^;]+)/)?.[1])}}));if("Success"===result){if(200===data?.status&&data?.response?.tasks){this.tasks=data.response.tasks;for(var task of data.response.tasks)task.isDone||(await tools_httpRequest({url:`https://giveawayhopper.com/api/v1/campaigns/${this.giveawayId}/tasks/${task.id}/visited`,method:"GET",responseType:"json",fetch:!0,headers:{authorization:"Bearer "+window.sessionStorage.gw_auth,"x-xsrf-token":decodeURIComponent(document.cookie.match(/XSRF-TOKEN=([^;]+)/)?.[1])}}),"Steam"===task.category&&"JoinGroup"===task.type?(steamGroupLink=await getRedirectLink("https://steamcommunity.com/gid/"+task.group_id))&&("undo"===action&&this.socialTasks.steam.groupLinks.push(steamGroupLink),"do"===action)&&this.undoneTasks.steam.groupLinks.push(steamGroupLink):"Discord"===task.category&&"JoinServer"===task.type?("undo"===action&&this.socialTasks.discord.serverLinks.push("https://discord.gg/"+task.invite_code),"do"===action&&this.undoneTasks.discord.serverLinks.push("https://discord.gg/"+task.invite_code)):["TikTok","YouTube","General"].includes(task.category)||scripts_echoLog({}).warning(`${i18n("unKnownTaskType")}: ${task.category}-`+task.type));return logStatus.success(),this.undoneTasks=this.uniqueTasks(this.undoneTasks),this.socialTasks=this.uniqueTasks(this.socialTasks),window.DEBUG&&console.log("%cAuto-Task[Debug]:","color:blue",JSON.stringify(this)),GM_setValue("giveawayHopperTasks-"+this.giveawayId,{tasks:this.socialTasks,time:(new Date).getTime()}),!0}logStatus.error(`Error:${data?.statusText}(${data?.status})`)}else logStatus.error(result+`:${statusText}(${status})`);return!1}catch(error){return throwError(error,"GiveawayHopper.classifyTask"),!1}}async verifyTask(){try{for(var task of this.tasks){var logStatus,postData,result,statusText,status,data;task.isDone||(logStatus=scripts_echoLog({text:`${i18n("verifyingTask")}[${task.displayName?.replace(":target",task.targetName)||task.name}]...`}),task.link||("YouTube"===task.category&&"FollowAccount"===task.type?task.link="https://www.youtube.com/@"+task.targetName:"TikTok"===task.category&&"FollowAccount"===task.type?task.link="https://www.tiktok.com/@"+task.targetName:("Steam"===task.category&&"JoinGroup"===task.type||"Discord"===task.category&&"JoinServer"===task.type)&&(task.link="")),task.link&&await tools_httpRequest({url:`https://giveawayhopper.com/fw?url=${encodeURIComponent(task.link)}&src=campaign&src_id=${this.giveawayId}&ref=task&ref_id=${task.id}&token=`+window.sessionStorage.gw_auth,method:"GET",fetch:!0,headers:{authorization:"Bearer "+window.sessionStorage.gw_auth,"x-xsrf-token":decodeURIComponent(document.cookie.match(/XSRF-TOKEN=([^;]+)/)?.[1])}}),await delay(1e3),postData={taskcategory:task.category,taskname:task.type},{result,statusText,status,data}=(["YouTube","TikTok"].includes(task.category)&&(postData.username="1"),await tools_httpRequest({url:`https://giveawayhopper.com/api/v1/campaigns/${this.giveawayId}/tasks/${task.id}/complete`,method:"POST",fetch:!0,headers:{authorization:"Bearer "+window.sessionStorage.gw_auth,"x-xsrf-token":decodeURIComponent(document.cookie.match(/XSRF-TOKEN=([^;]+)/)?.[1]),"content-type":"application/json"},dataType:"json",data:JSON.stringify(postData)})),"Success"===result?200===data?.status&&data?.response?.completed?logStatus.success():logStatus.error(`Error:${data?.statusText}(${data?.status})`):logStatus.error(result+`:${statusText}(${status})`))}}catch(error){return throwError(error,"GiveawayHopper.verifyTask"),!1}}#getGiveawayId(){try{var giveawayId=window.location.pathname.split("/").at(-1);return giveawayId?(this.giveawayId=giveawayId,!0):(scripts_echoLog({text:i18n("getFailed","GiveawayId")}),!1)}catch(error){return throwError(error,"GiveawayHopper.getGiveawayId"),!1}}#checkLogin(){try{return globalOptions.other.checkLogin&&0<$('div.widget-connections-edit:contains("Log in")').length&&$('div.widget-connections-edit:contains("Log in") a')[0].click(),!0}catch(error){return throwError(error,"GiveawayHopper.checkLogin"),!1}}async#checkLeftKey(){try{return!globalOptions.other.checkLeftKey||0<$("p.widget-single-prize span").length&&0<parseInt($("p.widget-single-prize span").text()?.match(/\d+/)?.[0]||"0",10)||await external_Swal_default().fire({icon:"warning",title:i18n("notice"),text:i18n("noKeysLeft"),confirmButtonText:i18n("confirm"),cancelButtonText:i18n("cancel"),showCancelButton:!0}).then(({value})=>{value&&window.close()}),!0}catch(error){return throwError(error,"GiveawayHopper.checkLeftKey"),!1}}}let Websites=[Freeanywhere,GiveawaySu,website_Indiedb,website_Keyhub,website_Givekey,website_GiveeClub,website_OpiumPulses,website_Keylol,website_Opquests,website_Gleam,website_SweepWidget,website_Setting,website_History,GiveawayHopper],options=function(website,options){try{let websiteOptionsForm=`<form id="websiteOptionsForm" class="auto-task-form">
  <table class="auto-task-table"><thead><tr><td>${i18n("option")}</td><td>${i18n("value")}</td></tr></thead><tbody>`;for(var[option,value]of Object.entries(options))websiteOptionsForm+=`<tr><td>${option}</td><td><input class="editOption" type="text" name="${option}" value="${value}"/></td></tr>`;websiteOptionsForm+="</tbody></table></form>",external_Swal_default().fire({title:i18n("websiteOptions"),html:websiteOptionsForm,showConfirmButton:!0,confirmButtonText:i18n("save"),showCancelButton:!0,cancelButtonText:i18n("close")}).then(({isConfirmed})=>{isConfirmed&&($("#websiteOptionsForm").serializeArray().map(value=>(options[value.name]=value.value,value)),GM_setValue(website+"Options",options),external_Swal_default().fire({title:i18n("changeWebsiteOptionsSuccess"),icon:"success"}))})}catch(error){throwError(error,"websiteOptions")}};var userDefinedGlobalOptions=keyboardJS,external_keyboardJS_default=__webpack_require__.n(userDefinedGlobalOptions);let checkUpdate=async(updateLink,auto)=>{try{var checkUrl=updateLink+"package.json?time="+(new Date).getTime(),{result,statusText,status,data}=await tools_httpRequest({url:checkUrl,responseType:"json",method:"GET",timeout:3e4});return"Success"===result?data?.response?.version?data.response:(auto||scripts_echoLog({}).error(`${i18n("checkUpdateFailed")}[${data?.statusText}(${data?.status})]`),!1):(auto||scripts_echoLog({}).error(i18n("checkUpdateFailed")+`[${result}:${statusText}(${status})]`),!1)}catch(error){return throwError(error,"checkUpdate"),!1}},scripts_updateChecker=async()=>{try{var currentVersion=GM_info.script.version,updateSource=globalOptions.other.autoUpdateSource.toLowerCase(),updateLinks={github:"https://github.com/HCLonely/auto-task-new/raw/main/",jsdelivr:"https://cdn.jsdelivr.net/gh/HCLonely/auto-task-v4@main/",standby:"https://auto-task-v4.hclonely.com/"};let version,updateLink="",packageData;["github","jsdelivr","standby"].includes(updateSource)?(updateLink=updateLinks[updateSource],packageData=await checkUpdate(updateLink,!1)):(updateLink=updateLinks.github,(packageData=await checkUpdate(updateLink,!0))||(updateLink=updateLinks.jsdelivr,packageData=await checkUpdate(updateLink,!0))||(updateLink=updateLinks.standby,packageData=await checkUpdate(updateLink,!0))),packageData?version=packageData.version||currentVersion:(version=currentVersion,scripts_echoLog({}).error(i18n("checkUpdateFailed"))),packageData&&((currentVersion,remoteVersion)=>{try{var currentVersion1,currentVersion2,currentVersion3,remoteVersion1,remoteVersion2,remoteVersion3,[currentRealVersion]=currentVersion.split("-"),[remoteRealVersion,isPreview]=remoteVersion.split("-");return isPreview&&!globalOptions.other.receivePreview?!1:([currentVersion1,currentVersion2,currentVersion3]=currentRealVersion.split(".").map(value=>parseInt(value,10)),[remoteVersion1,remoteVersion2,remoteVersion3]=remoteRealVersion.split(".").map(value=>parseInt(value,10)),currentVersion1<remoteVersion1||!(remoteVersion1<currentVersion1)&&(currentVersion2<remoteVersion2||!(remoteVersion2<currentVersion2)&&currentVersion3<remoteVersion3))}catch(error){return throwError(error,"compareVersion"),!1}})(currentVersion,version)&&(scripts_echoLog({html:`<li><font>${i18n("newVersionNotice",version,`${updateLink}dist/${GM_info.script.name}.user.js`)}</font></li>`}),scripts_echoLog({html:`<li>${i18n("updateText",version)}</li><ol class="update-text">${packageData.change?.map(change=>`<li>${change}</li>`).join("")}<li>${i18n("updateHistory")}</li></ol>`}))}catch(error){throwError(error,"updateChecker")}};if(window.STYLE=GM_addStyle(external_Swal_namespaceObject.A+GM_getResourceText("style")),window.DEBUG=!!globalOptions.other?.debug,window.TRACE=!!globalOptions.other?.debug&&"function"==typeof console.trace,Freeanywhere=async()=>{var Website;if("ATv4_twitchAuth"===window.name&&"www.twitch.tv"===window.location.hostname)authToken=external_Cookies_default().get("auth-token"),!!external_Cookies_default().get("login")?(GM_setValue("twitchAuth",{authToken:authToken,clientVersion:__twilightBuildID,clientId:commonOptions?.headers?.["Client-ID"],deviceId:commonOptions?.headers?.["Device-ID"],clientSessionId:window.localStorage.local_storage_app_session_id.replace(/"/g,"")}),window.close(),external_Swal_default().fire("",i18n("closePageNotice"))):external_Swal_default().fire("",i18n("needLogin"));else{if("ATv4_redditAuth"===window.name&&"www.reddit.com"===window.location.hostname)return 0<(authToken=$("#redesign-beta-optin-btn")).length?authToken[0].click():(window.close(),void external_Swal_default().fire("",i18n("closePageNotice")));let website;for(Website of Websites)if(Website.test()){website=new Website;break}if(website){website?.before&&await website?.before(),$("body").append(`
    <div id="auto-task-info"
         style="display:${globalOptions.other.defaultShowLog?"block":"none"};
                ${globalOptions.position.logSideX}:${globalOptions.position.logDistance.split(",")[0]}px;
                ${globalOptions.position.logSideY}:${globalOptions.position.logDistance.split(",")[1]}px;">
    </div>
    <div id="auto-task-buttons"
         style="display:${globalOptions.other.defaultShowButton?"block":"none"};
                ${globalOptions.position.buttonSideX}:${globalOptions.position.buttonDistance.split(",")[0]}px;
                ${globalOptions.position.buttonSideY}:${globalOptions.position.buttonDistance.split(",")[1]}px;">
    </div>
    <div class="show-button-div"
         style="display:${globalOptions.other.defaultShowButton?"none":"block"};
                ${globalOptions.position.showButtonSideX}:${globalOptions.position.showButtonDistance.split(",")[0]}px;
                ${globalOptions.position.showButtonSideY}:${globalOptions.position.showButtonDistance.split(",")[1]}px;">
      <a class="auto-task-website-btn"
         href="javascript:void(0);"
         target="_self"
         title="${i18n("showButton")}"> </a>
    </div>
  `),$("div.show-button-div").on("click",()=>{$("#auto-task-buttons").show(),$("div.show-button-div").hide()});var btnElement,authToken=()=>{var $this=$("#toggle-log");"show"===$this.attr("data-status")?($("#auto-task-info").hide(),$this.attr("data-status","hide").text(i18n("showLog"))):($("#auto-task-info").show(),$this.attr("data-status","show").text(i18n("hideLog")))};if(external_keyboardJS_default().bind(globalOptions.hotKey.doTaskKey,()=>{website.doTask&&website.doTask()}),external_keyboardJS_default().bind(globalOptions.hotKey.undoTaskKey,()=>{website.undoTask&&website.undoTask()}),external_keyboardJS_default().bind(globalOptions.hotKey.toggleLogKey,authToken),website?.after&&await website?.after(),website?.buttons&&0===$("#auto-task-buttons").children().length){$("#auto-task-buttons").addClass(website.name+"-buttons");for(let button of website.buttons)website[button]&&((btnElement=$(`<p><a class="auto-task-website-btn ${website.name}-button" href="javascript:void(0);" target="_self">${i18n(button)}</a></p>`)).find("a.auto-task-website-btn").on("click",()=>{website[button]()}),$("#auto-task-buttons").append(btnElement))}var hideButtonElement=$(`<p><a class="auto-task-website-btn ${website.name}-button" href="javascript:void(0);" target="_self">
      ${i18n("hideButton")}</a></p>`),toggleLogElement=(hideButtonElement.find("a.auto-task-website-btn").on("click",()=>{$("#auto-task-buttons").hide(),$("div.show-button-div").show()}),$(`<p><a id="toggle-log" class="auto-task-website-btn ${website.name}-button" href="javascript:void(0);" target="_self" data-status="${globalOptions.other.defaultShowLog?"show":"hide"}">
        ${globalOptions.other.defaultShowLog?i18n("hideLog"):i18n("showLog")}</a></p>`)),[authToken,hideButtonElement]=(toggleLogElement.find("a.auto-task-website-btn").on("click",authToken),$("#auto-task-buttons").append(hideButtonElement).append(toggleLogElement),website?.options&&GM_registerMenuCommand(i18n("changeWebsiteOptions"),()=>{options(website.name,website.options)}),"Setting"!==website.name&&(GM_registerMenuCommand(i18n("changeGlobalOptions"),()=>{changeGlobalOptions("swal")}),GM_registerMenuCommand(i18n("settingPage"),()=>{GM_openInTab("https://auto-task-v4.hclonely.com/setting.html",{active:!0})})),console.log("%c%s","color:#1bbe1a","Auto-Task[Load]: 脚本加载完成"),GM_info.version?.split(".")||[]);5<=parseInt(authToken,10)&&2<=parseInt(hideButtonElement,10)||scripts_echoLog({}).error(i18n("versionNotMatched")),GM_getValue("notice")||(external_Swal_default().fire({title:i18n("swalNotice"),icon:"warning"}).then(()=>{GM_openInTab(i18n("noticeLink"),{active:!0}),GM_setValue("notice",(new Date).getTime())}),scripts_echoLog({html:`<li><font class="warning">${i18n("echoNotice",i18n("noticeLink"))}</font></li>`}).font?.find("a").on("click",()=>{GM_setValue("notice",(new Date).getTime())})),scripts_updateChecker()}else console.log("%c%s","color:#ff0000","Auto-Task[Warning]: 脚本停止加载，当前网站不支持！")}},"discord.com"===window.location.hostname){website_Indiedb=window.localStorage;if("ATv4_discordAuth"===window.name){window.localStorage.removeItem=()=>!0;website_Keyhub=website_Indiedb?.getItem("token")?.replace(/^"|"$/g,"");website_Keyhub&&0<website_Keyhub.length?(GM_setValue("discordAuth",{auth:website_Keyhub}),window.close(),external_Swal_default().fire("",i18n("closePageNotice"))):external_Swal_default().fire({text:i18n("getDiscordAuthFailed"),icon:"error"})}else{let discordAuth=website_Indiedb?.getItem("token")?.replace(/^"|"$/g,"");discordAuth&&0<discordAuth.length&&GM_setValue("discordAuth",{auth:discordAuth})}}else"opquests.com"===window.location.hostname?Freeanywhere():"ATv4_updateStoreAuth"!==window.name&&!GM_getValue("ATv4_updateStoreAuth")||"store.steampowered.com"!==window.location.host?"ATv4_updateCommunityAuth"!==window.name&&!GM_getValue("ATv4_updateCommunityAuth")||"steamcommunity.com"!==window.location.host?("key-hub.eu"===window.location.hostname&&(unsafeWindow.keyhubtracker=1,unsafeWindow.gaData={}),$(Freeanywhere)):$(()=>{var steam64Id=document.body.innerHTML.match(/g_steamID = "(.+?)";/)?.[1],communitySessionID=document.body.innerHTML.match(/g_sessionID = "(.+?)";/)?.[1];steam64Id&&communitySessionID?(GM_deleteValue("ATv4_updateCommunityAuth"),GM_setValue("steamCommunityAuth",{steam64Id:steam64Id,communitySessionID:communitySessionID}),window.close(),external_Swal_default().fire("",i18n("closePageNotice"))):setTimeout(()=>{external_Swal_default().fire({title:'Error: Get "sessionID" failed',icon:"error"})},3e3)}):$(()=>{var storeSessionID;0!==$("[data-miniprofile]").length&&((storeSessionID=document.body.innerHTML.match(/g_sessionID = "(.+?)";/)?.[1])?(GM_deleteValue("ATv4_updateStoreAuth"),GM_setValue("steamStoreAuth",{storeSessionID:storeSessionID}),window.close(),external_Swal_default().fire("",i18n("closePageNotice"))):external_Swal_default().fire({title:'Error: Get "sessionID" failed',icon:"error"}))})}})();