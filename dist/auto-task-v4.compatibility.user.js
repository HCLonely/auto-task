// ==UserScript==
// @name               auto-task-v4.compatibility
// @namespace          auto-task-v4.compatibility
// @version            4.2.27
// @description        自动完成 Freeanywhere，Giveawaysu，GiveeClub，Givekey，Gleam，Indiedb，keyhub，OpiumPulses，Opquests，SweepWidget 等网站的任务。
// @description:en     Automatically complete the tasks of FreeAnyWhere, GiveawaySu, GiveeClub, Givekey, Gleam, Indiedb, keyhub, OpiumPulses, Opquests, SweepWidget websites.
// @author             HCLonely
// @license            MIT
// @run-at             document-start
// @homepage           https://auto-task-doc.js.org/
// @supportURL         https://github.com/HCLonely/auto-task-v4/issues
// @updateURL          https://github.com/HCLonely/auto-task-new/raw/main/dist/auto-task-v4.compatibility.user.js
// @installURL         https://github.com/HCLonely/auto-task-new/raw/main/dist/auto-task-v4.compatibility.user.js
// @downloadURL        https://github.com/HCLonely/auto-task-new/raw/main/dist/auto-task-v4.compatibility.user.js
// @icon               https://auto-task-v4.hclonely.com/favicon.ico

// @include            *://freeanywhere.net/*
// @include            *://giveaway.su/giveaway/view/*
// @include            *://givee.club/*/event/*
// @include            *://givekey.ru/giveaway/*
// @include            *://www.indiedb.com/giveaways*
// @include            *://key-hub.eu/giveaway/*
// @include            *://keylol.com/*
// @include            *://www.opiumpulses.com/giveaways
// @include            *://prys.revadike.com/giveaway/?id=*
// @include            *://opquests.com/quests/*
// @include            *://gleam.io/*
// @include            *://sweepwidget.com/view/*
// @include            *://discord.com/*
// @include            *://www.twitch.tv/*
// @include            *://www.youtube.com/*
// @include            *://*.reddit.com/*
// @include            *://twitter.com/settings/account?k*
// @include            https://auto-task-v4.hclonely.com/setting.html
// @include            https://auto-task-v4.hclonely.com/history.html

// @grant              GM_setValue
// @grant              GM_getValue
// @grant              GM_listValues
// @grant              GM_deleteValue
// @grant              GM_addStyle
// @grant              GM_xmlhttpRequest
// @grant              GM_registerMenuCommand
// @grant              GM_info
// @grant              GM_openInTab
// @grant              GM_setClipboard
// @grant              GM_getResourceText
// @grant              unsafeWindow
// @grant              window.close
// @grant              window.localStorage

// @connect            cdn.jsdelivr.net
// @connect            store.steampowered.com
// @connect            steamcommunity.com
// @connect            login.steampowered.com
// @connect            twitter.com
// @connect            api.twitter.com
// @connect            youtube.com
// @connect            www.youtube.com
// @connect            facebook.com
// @connect            instagram.com
// @connect            vk.com
// @connect            twitch.tv
// @connect            www.twitch.tv
// @connect            gql.twitch.tv
// @connect            github.com
// @connect            discordapp.com
// @connect            discord.gg
// @connect            discord.com
// @connect            www.reddit.com
// @connect            oauth.reddit.com
// @connect            raw.githubusercontent.com
// @connect            t.me
// @connect            bit.ly
// @connect            giveaway.su
// @connect            google.com
// @connect            www.vloot.io
// @connect            givee.club
// @connect            gleam.io
// @connect            www.indiedb.com
// @connect            key-hub.eu
// @connect            opquests.com
// @connect            itch.io
// @connect            auto-task-v4.hclonely.com
// @connect            *
// @require            https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js
// @require            https://cdn.jsdelivr.net/npm/js-cookie@3.0.1/dist/js.cookie.min.js
// @require            https://cdn.jsdelivr.net/npm/regenerator-runtime@0.13.5/runtime.min.js
// @require            https://cdn.jsdelivr.net/npm/js-sha1@0.6.0/src/sha1.min.js
// @require            https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.js
// @resource           style https://cdn.jsdelivr.net/npm/sweetalert2@11.3.5/dist/sweetalert2.min.css
// @require            https://cdn.jsdelivr.net/npm/keyboardjs@2.6.4/dist/keyboard.min.js
// @require            https://cdn.jsdelivr.net/npm/dayjs@1.10.7/dayjs.min.js

// @noframes
// ==/UserScript==

console.log('%c%s', 'color:blue', 'Auto-Task[Load]: 脚本开始加载');

!function(){var s={588:function(t,e){!function(t){"use strict";var i=function(){return(i=Object.assign||function(t){for(var e,s=1,i=arguments.length;s<i;s++)for(var a in e=arguments[s])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t}).apply(this,arguments)};function a(t,e,s){if(s||2===arguments.length)for(var i,a=0,o=e.length;a<o;a++)!i&&a in e||((i=i||Array.prototype.slice.call(e,0,a))[a]=e[a]);return t.concat(i||Array.prototype.slice.call(e))}function d(t){return"[object Object]"===e(t)}function h(t,e){var s=a(a([],e||[],!0),["_"],!1).join("|");return t.replace(new RegExp("((".concat(s,")[a-z])+"),"g"),function(t,e){return e.replace(new RegExp(s),"").toLocaleUpperCase()})}var e=function(t){return Object.prototype.toString.call(t)},s=(o.prototype.init=function(){try{this.getSystemName(),this.getBrowserName()}catch(t){console.warn("[UA formatter error] ".concat(t))}},o.prototype.getEngine=function(){var t=this.agent;return-1!==t.indexOf("Trident")?"Trident":-1!==t.indexOf("Firefox")?"Gecko":-1!==t.indexOf("Presto")?"Presto":"WebKit"},o.prototype.getSystemName=function(){var t,e=(this.agent.match(/^[a-z]+\/\d+\.\d+\s?\(([a-z\d\s:;./_-]+)\)/i)||[])[1];try{var s="";if(/Windows/i.test(e)){var i=(e.match(/NT\s(\d+\.\d+)/)||[])[1];switch(this.info.os="Windows",i){case"6.3":s="8.1";break;case"6.2":s="8";break;case"6.1":s="7";break;case"5.2":case"5.1":s="XP";break;default:s=i}return this.info.device="PC",void(this.info.osVersion=s)}if(/^Macintosh/i.test(e))return s=(e.match(/X\s((\d+(_|\.))+\d+)/)||[])[1],this.info.os="Macintosh",this.info.device="PC",void(this.info.osVersion=null!==(t=null==s?void 0:s.replace(/_/g,"."))&&void 0!==t?t:"Unknown");if(/^iPad/i.test(e))return s=(e.match(/((\d+_)+\d+)/)||[])[1],this.info.os="iPad",this.info.device="Tablet",void(this.info.osVersion=s.replace(/_/g,"."));if(/^iPhone/i.test(e))return s=(e.match(/((\d+_)+\d+)/)||[])[1],this.info.os="iPhone",this.info.device="Mobile",void(this.info.osVersion=s.replace(/_/g,"."));if(-1!==e.indexOf("Android")){var a=(e.match(/Android\s((\d+\.?)+\d?)/)||[])[1];return this.info.device="Mobile",this.info.os="Android",void(this.info.osVersion=a)}if(/Linux\s[a-z\d_]+/.test(e))return this.info.os="Linux",void(this.info.osVersion="Unknown");this.info.os="Unknown",this.info.osVersion="Unknown"}catch(t){this.info.os="Unknown",this.info.osVersion="Unknown"}},o.prototype.getBrowserName=function(){var t=Object.keys(this.browserNameMap).map(function(t){return new RegExp("".concat(t,"(\\/|\\s)(\\d+\\.)+\\d+"))}),e=1<(e=(this.agent.match(/[a-z\d]+(\/|\s)(\d+\.)+\d+/gi)||[]).filter(function(e){return-1!==t.findIndex(function(t){return t.test(e)})})).length&&!/^Safari/.test(e[e.length-1])?e.reverse():e;this.info=i(i({},this.info),this._formatBrowserVersion(e[0]))},o.prototype._formatBrowserVersion=function(t){var e,s,i,a;try{for(var o=null!==(s=null===(e=t.match(/(?<name>[a-z\d]+)(\/|\s)(?<version>(\d+\.)+\d+)/i))||void 0===e?void 0:e.groups)&&void 0!==s?s:{},n=o.name,r=o.version,c={},u=0,l=Object.entries(this.browserNameMap);u<l.length;u++){var d=l[u],h=d[0],p=d[1];if(new RegExp(h).test(n)){c=p;break}}var g={browserVersion:null!=r?r:"Unknown",browser:null!==(i=c.en)&&void 0!==i?i:"Unknown",browserZH:null!==(a=(null==c?void 0:c.zh)||c.en)&&void 0!==a?a:"Unknown"};return"Trident"===n&&(g.browserVersion={"4.0":8,"5.0":9,"6.0":10,"7.0":11}[r]),g}catch(t){return console.warn("[UA formatter error] ".concat(t)),{browser:"Unknown",browserVersion:"Unknown"}}},o);function o(t){this.agent="",this.info={browser:"",browserZH:"",browserVersion:"",os:"",osVersion:"",device:"Unknown",engine:"WebKit"},this.browserNameMap={MicroMessenger:{en:"MicroMessenger",zh:"微信"},MetaSr:{en:"MetaSr",zh:"搜狗浏览器"},"QQ(Browser)?":{en:"QQBrowser",zh:"QQ浏览器"},UCBrowser:{en:"UCBrowser",zh:"UC浏览器"},"2345Explorer":{en:"2345Explorer",zh:"2345极速浏览器"},Mb2345Browser:{en:"Mb2345Browser",zh:"2345手机浏览器"},Trident:{en:"Internet Explorer"},"Edge?":{en:"Edge"},OPR:{en:"Opera"},Vivaldi:{en:"Vivaldi"},Firefox:{en:"Firefox"},Chrome:{en:"Chrome"},Safari:{en:"Safari"}},this.agent=t,this.init();var e=this.info,s=e.browser,t=e.browserVersion,e=e.osVersion;this.info=i(i({},this.info),{engine:this.getEngine(),browserVersion:"Safari"===s?e:t})}function n(){this.cookies={},this.init()}var r=new(n.prototype.init=function(){var s={};document.cookie.split(/;\s/).forEach(function(t){var e=t.split(/=/),t=e[0],e=e[1];s[t]=e}),this.cookies=s},n.prototype.getItem=function(t){return this.cookies[t]},n.prototype.getAllItems=function(){return this.cookies},n.prototype.setItem=function(t,e,s,i,a,o){document.cookie="".concat(t,"=").concat(e).concat(s?"; expires=".concat(s):"").concat(i?"; path=".concat(i):"").concat(a?"; domain=".concat(a):"").concat(o?"; secure":"")},n);t.countDown=function t(e,s,i,a){if(!window)throw new Error("window is not defind.");if(0<e)return a&&a(),e--,window[s]=window.setTimeout(function(){t(e,s,i,a)},1e3),function(){return clearTimeout(window[s])};clearTimeout(window[s]),i&&i()},t.createRandomID=function(t){void 0===t&&(t=12);for(var e=[],s="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),i=s.length,a=0;a<t;a++)e.push(s[Math.round(Math.random()*i)]);return e.join("")},t.dCookie=r,t.debounce=function(s,i,a){var o;void 0===i&&(i=0);var n=a=void 0===a?!1:a;return function(){var t=this,e=arguments;n&&(s.apply(this,arguments),n=!1),clearTimeout(o),o=setTimeout(function(){a?n=!0:s.apply(t,e)},i)}},t.deepCopy=function t(e){if(d(e)||Array.isArray(e)){var s,i=Array.isArray(e)?[]:{};for(s in e)i[s]=t(e[s]);return i}return e},t.formatQueryParams=function(t){t=null===(t=/\?(?<params>(.*)=.+)/.exec(decodeURIComponent(t)))||void 0===t?void 0:t.groups;if(!t)return{};for(var e=t.params.split("&"),i={},s=0;s<e.length;s++)e[s].replace(/([^?&]*)=([^?&]*)/,function(t,e,s){return i[e]=s,t});return i},t.formatThousandth=function(t){var e="".concat(t).split("."),t=e[0],e=e[1],e=void 0===e?"":e,t=t.replace(/\d{1,3}(?=(\d{3})+$)/g,"$&,");return"".concat(t).concat(e?".".concat(e):"")},t.generateTree=function t(e,s,i,a){for(var o=[],n=0;n<e.length;n++){var r=e[n];r[i]===s&&(o.push(r),r.children=t(e,r[null!=a?a:"id"],i,a))}return o},t.isEmpty=function(t){return Array.isArray(t)?0===t.length:d(t)?0===Object.keys(t).length:["[object Set]","[object Map]"].includes(e(t))?0===t.size:[null,void 0,""].includes(t)},t.isFunction=function(t){return"[object Function]"===e(t)},t.isImageUrl=function(t){return/\.((png)|(jpe?g)|(gif)|(svg)|(webp))$/gi.test(t)},t.isObject=d,t.isRegexp=function(t){return"[object RegExp]"===e(t)},t.objectKeyToCamelCase=function t(e,s,i){if(Array.isArray(e))for(var a=[],o=0;o<e.length;o++)a[o]=t(s&&e[o][s]?e[o][s]:e[o],s,i);else if(d(e)){a={};for(var n=s&&e[s]?e[s]:e,r=0,c=Object.entries(n);r<c.length;r++){var u=(l=c[r])[0],l=l[1];Array.isArray(l)||d(n)?a[h(u,i)]=t(l,s,i):a[h(u,i)]=l}}else a=e;return a},t.realType=e,t.searchParams=function(t,e){return void 0===t&&(t=null===location||void 0===location?void 0:location.search),new URLSearchParams(t).get(e)},t.toLowerCamelCase=h,t.toUnderline=function(t){return t.replace(/([A-Z])/g,function(t){return"_".concat(t.toLocaleLowerCase())})},t.ua=function(t){return void 0===t&&(t=navigator.userAgent),new s(t).info},Object.defineProperty(t,"__esModule",{value:!0})}(e)},301:function(t,e,s){"use strict";s.d(e,{Z:function(){return a}});var i=s(220),e=s.n(i),i=s(400),e=s.n(i)()(e());e.push([t.id,'.colorful-button,#auto-task-buttons a.auto-task-website-btn,.show-button-div a.auto-task-website-btn,body.auto-task-options .auto-task-form table button{position:relative;padding:5px 10px;text-align:center;color:#fff;text-decoration:none;background:linear-gradient(90deg, #03a9f4, #f441a5, #ffeb3b, #03a9f4);border-radius:30px;background-size:400%;text-transform:capitalize}.colorful-button:hover,#auto-task-buttons a.auto-task-website-btn:hover,.show-button-div a.auto-task-website-btn:hover,body.auto-task-options .auto-task-form table button:hover{animation:animate 8s linear infinite;cursor:pointer}.colorful-button:hover::before,#auto-task-buttons a.auto-task-website-btn:hover::before,.show-button-div a.auto-task-website-btn:hover::before,body.auto-task-options .auto-task-form table button:hover::before{filter:blur(10px);opacity:1}.colorful-button::before,#auto-task-buttons a.auto-task-website-btn::before,.show-button-div a.auto-task-website-btn::before,body.auto-task-options .auto-task-form table button::before{content:"";position:absolute;top:-5px;left:-5px;right:-5px;bottom:-5px;z-index:-1;background:linear-gradient(90deg, #03a9f4, #f441a5, #ffeb3b, #03a9f4);border-radius:40px;background-size:400%;opacity:-1;transition:.5s}@keyframes animate{0%{background-position:0%}100%{background-position:100%}}#auto-task-info{position:fixed;bottom:10px;right:10px;width:60%;max-width:500px;max-height:60%;overflow-y:auto;color:#000;background-color:#fff;padding-left:5px;z-index:999999999 !important;border:solid 2px #add8e6;border-radius:10px}#auto-task-info li{text-align:left}#auto-task-info li a.high-light{color:#00aeff;font-weight:bold}#auto-task-info .success{color:green}#auto-task-info .error{color:red}#auto-task-info .warning{color:blue}#auto-task-info .info{color:#ff0}#auto-task-info .update-text{color:green;border:solid 2px #8dcb69;margin:5px 10px 5px 20px;border-radius:10px;padding:5px 20px}.auto-task-keylol{display:inline-block;text-transform:capitalize;margin-left:10px;text-decoration:none !important;border:solid 1px;border-radius:5px;padding:0 2px}.auto-task-keylol[selected=selected]{background-color:blue !important;color:#fff !important}.auto-task-form table{font-family:verdana,arial,sans-serif;font-size:11px;color:#333;border-width:1px;border-color:#999;border-collapse:collapse;width:100%}.auto-task-form table thead td{border-width:1px;padding:8px;border-style:solid;border-color:#a9c6c9;font-weight:bold;background-color:#fff}.auto-task-form table tbody tr{background-color:#d4e3e5}.auto-task-form table tbody tr:hover{background-color:#ff6 !important}.auto-task-form table tbody tr th{background-color:#c3dde0;border-width:1px;padding:8px;border-style:solid;border-color:#a9c6c9;text-transform:capitalize}.auto-task-form table tbody tr td{border-width:1px;padding:8px;border-style:solid;border-color:#a9c6c9}.swal2-modal{width:70% !important;max-width:1000px !important}body.auto-task-options{padding-top:10px;text-align:center}body.auto-task-options .auto-task-form{width:80%;max-width:1000px;margin:0 auto;padding-bottom:20px}body.auto-task-options .auto-task-form table input.editOption{width:80%}body.auto-task-options .auto-task-form table #getTwitterUserId,body.auto-task-options .auto-task-form table #getYoutubeChannelId{margin-top:5px}body.auto-task-options .auto-task-form table button{z-index:1}body.auto-task-options .auto-task-form table input[type=text]{outline-style:none;border:1px solid #ccc;border-radius:3px;padding:5px 10px;font-size:14px}body.auto-task-options .auto-task-form table input[type=text]:focus{border-color:#66afe9;outline:0;box-shadow:inset 0 1px 1px rgba(0,0,0,.075),0 0 8px rgba(102,175,233,.6)}body.auto-task-options .auto-task-form table label{position:relative;width:160px;height:80px;cursor:pointer;transform:scale(0.25);margin:-25% 0;top:-30px;display:inline-block}body.auto-task-options .auto-task-form table label input{position:relative;z-index:1;-webkit-appearance:none;-moz-appearance:none;appearance:none}body.auto-task-options .auto-task-form table label input:checked~span{background:#05be05;box-shadow:0 15px 25px rgba(5,190,5,0.4)}body.auto-task-options .auto-task-form table label input:checked~span i{left:84px}body.auto-task-options .auto-task-form table label input:checked~span i::before{background:#05be05;box-shadow:35px 0 0 #05be05}body.auto-task-options .auto-task-form table label input:checked~span i::after{bottom:12px;height:15px;border-bottom-left-radius:15px;border-bottom-right-radius:15px;background:#05be05}body.auto-task-options .auto-task-form table label span{position:absolute;top:0;left:0;width:100%;height:100%;background:#fe0000;border-radius:80px;transition:.5s;box-shadow:0 15px 25px rgba(254,0,0,0.4)}body.auto-task-options .auto-task-form table label span i{position:absolute;top:4px;left:4px;width:72px;height:72px;background:#fff;border-radius:50%}body.auto-task-options .auto-task-form table label span i::before{content:"";position:absolute;top:22px;left:12px;width:12px;height:12px;border-radius:50%;background:#fe0000;box-shadow:35px 0 0 #fe0000;transition:.5s}body.auto-task-options .auto-task-form table label span i::after{content:"";position:absolute;bottom:15px;left:calc(50% - 15px);width:30px;height:6px;border-radius:6px;background:#fe0000;transition:.5s}body.auto-task-history{font-size:15px;font-weight:400;line-height:1.5}body.auto-task-history .container a{color:#007bff;text-decoration:none;background-color:transparent}body.auto-task-history .container .card{width:80%;max-width:800px;border-radius:10px;background:rgba(118,118,118,0.10196);border-top:1px solid rgba(255,255,255,0.50196);-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px);box-shadow:0 15px 25px rgba(0,0,0,0.10196);margin:20px auto;position:relative;display:flex;flex-direction:column;word-wrap:break-word;-webkit-background-clip:border-box;background-clip:border-box;border:1px solid rgba(0,0,0,.125);border-radius:.25rem}body.auto-task-history .container .card .title{text-align:center;font-size:30px;font-weight:bold;margin:5px 0}body.auto-task-history .container .card .title a:hover{text-decoration:none;background:#93e1ff;border-radius:10px;padding:3px}body.auto-task-history .container .card ul{margin-bottom:25px}body.auto-task-history .container .card ul li{margin-bottom:5px;line-height:20px}body.auto-task-history .container .card ul a:hover{text-decoration:underline}body.auto-task-history .container .card .delete-task{right:10px;width:38px;height:35px;position:absolute;font-size:24px;cursor:pointer;border-radius:10px}body.auto-task-history .container .card .delete-task:hover{background:#fff}body.auto-task-history .container .card .time{right:5px;position:absolute;bottom:0;color:#e83e8c;font-family:\'SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace\';font-size:15px}#auto-task-buttons,.show-button-div{position:fixed;top:30px;right:15px;width:170px;z-index:999999999 !important;transform:scale(0.9)}#auto-task-buttons p,.show-button-div p{line-height:30px;height:40px;text-align:center;margin:5px !important}#auto-task-buttons a.auto-task-website-btn,.show-button-div a.auto-task-website-btn{width:150px;height:40px;line-height:30px;font-size:20px}.show-button-div{width:20px}.auto-task-capitalize{text-transform:capitalize !important}.swal2-file:focus,.swal2-input:focus,.swal2-textarea:focus{box-shadow:inset 0px 0px 4px 1px rgba(100,150,200,.5) !important}.swal2-checkbox-custom{align-items:center;justify-content:center;background:#fff;color:inherit;margin:1em auto}.swal2-checkbox-custom input{flex-shrink:0;margin:0 .4em}.giveaway-actions #getKey{display:none !important}.auto-task-giveaway-status{color:#fff;border-radius:10px;padding:0 5px;margin-left:5px}.auto-task-giveaway-status.active{background-color:#5cb85c}.auto-task-giveaway-status.not-active{background-color:#d9534f}',""]);const a=e.toString()},400:function(t){"use strict";t.exports=function(i){var l=[];return l.toString=function(){return this.map(function(t){var e="",s=void 0!==t[5];return t[4]&&(e+="@supports (".concat(t[4],") {")),t[2]&&(e+="@media ".concat(t[2]," {")),s&&(e+="@layer".concat(0<t[5].length?" ".concat(t[5]):""," {")),e+=i(t),s&&(e+="}"),t[2]&&(e+="}"),t[4]&&(e+="}"),e}).join("")},l.i=function(t,e,s,i,a){"string"==typeof t&&(t=[[null,t,void 0]]);var o={};if(s)for(var n=0;n<this.length;n++){var r=this[n][0];null!=r&&(o[r]=!0)}for(var c=0;c<t.length;c++){var u=[].concat(t[c]);s&&o[u[0]]||(void 0!==a&&(void 0===u[5]||(u[1]="@layer".concat(0<u[5].length?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=a),e&&(u[2]&&(u[1]="@media ".concat(u[2]," {").concat(u[1],"}")),u[2]=e),i&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=i):u[4]="".concat(i)),l.push(u))}},l}},220:function(t){"use strict";t.exports=function(t){return t[1]}},698:function(t){t.exports=function(){"use strict";var u=1e3,l=6e4,d=36e5,c="millisecond",p="second",g="minute",f="hour",m="day",w="week",v="month",h="quarter",k="year",y="date",b="Invalid Date",n=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,T=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,t={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},o=function(t,e,s){var i=String(t);return!i||i.length>=e?t:""+Array(e+1-i.length).join(s)+t},e={s:o,z:function(t){var e=-t.utcOffset(),s=Math.abs(e),i=Math.floor(s/60),a=s%60;return(e<=0?"+":"-")+o(i,2,"0")+":"+o(a,2,"0")},m:function t(e,s){if(e.date()<s.date())return-t(s,e);var i=12*(s.year()-e.year())+(s.month()-e.month()),a=e.clone().add(i,v),o=s-a<0,n=e.clone().add(i+(o?-1:1),v);return+(-(i+(s-a)/(o?a-n:n-a))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(t){return{M:v,y:k,w:w,d:m,D:y,h:f,m:g,s:p,ms:c,Q:h}[t]||String(t||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}},r="en",$={};$[r]=t;var i=function(t){return t instanceof L},a=function(t,e,s){var i;if(!t)return r;if("string"==typeof t)$[t]&&(i=t),e&&($[t]=e,i=t);else{var a=t.name;$[a]=t,i=a}return!s&&i&&(r=i),i||!s&&r},x=function(t,e){if(i(t))return t.clone();var s="object"==typeof e?e:{};return s.date=t,s.args=arguments,new L(s)},S=e;S.l=a,S.i=i,S.w=function(t,e){return x(t,{locale:e.$L,utc:e.$u,x:e.$x,$offset:e.$offset})};var L=function(){function t(t){this.$L=a(t.locale,null,!0),this.parse(t)}var e=t.prototype;return e.parse=function(t){this.$d=function(t){var e=t.date,s=t.utc;if(null===e)return new Date(NaN);if(S.u(e))return new Date;if(e instanceof Date)return new Date(e);if("string"==typeof e&&!/Z$/i.test(e)){var i=e.match(n);if(i){var a=i[2]-1||0,o=(i[7]||"0").substring(0,3);return s?new Date(Date.UTC(i[1],a,i[3]||1,i[4]||0,i[5]||0,i[6]||0,o)):new Date(i[1],a,i[3]||1,i[4]||0,i[5]||0,i[6]||0,o)}}return new Date(e)}(t),this.$x=t.x||{},this.init()},e.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},e.$utils=function(){return S},e.isValid=function(){return!(this.$d.toString()===b)},e.isSame=function(t,e){var s=x(t);return this.startOf(e)<=s&&s<=this.endOf(e)},e.isAfter=function(t,e){return x(t)<this.startOf(e)},e.isBefore=function(t,e){return this.endOf(e)<x(t)},e.$g=function(t,e,s){return S.u(t)?this[e]:this.set(s,t)},e.unix=function(){return Math.floor(this.valueOf()/1e3)},e.valueOf=function(){return this.$d.getTime()},e.startOf=function(t,e){var i=this,a=!!S.u(e)||e,s=S.p(t),o=function(t,e){var s=S.w(i.$u?Date.UTC(i.$y,e,t):new Date(i.$y,e,t),i);return a?s:s.endOf(m)},n=function(t,e){return S.w(i.toDate()[t].apply(i.toDate("s"),(a?[0,0,0,0]:[23,59,59,999]).slice(e)),i)},r=this.$W,c=this.$M,u=this.$D,l="set"+(this.$u?"UTC":"");switch(s){case k:return a?o(1,0):o(31,11);case v:return a?o(1,c):o(0,c+1);case w:var d=this.$locale().weekStart||0,h=(r<d?r+7:r)-d;return o(a?u-h:u+(6-h),c);case m:case y:return n(l+"Hours",0);case f:return n(l+"Minutes",1);case g:return n(l+"Seconds",2);case p:return n(l+"Milliseconds",3);default:return this.clone()}},e.endOf=function(t){return this.startOf(t,!1)},e.$set=function(t,e){var s,i=S.p(t),a="set"+(this.$u?"UTC":""),o=(s={},s[m]=a+"Date",s[y]=a+"Date",s[v]=a+"Month",s[k]=a+"FullYear",s[f]=a+"Hours",s[g]=a+"Minutes",s[p]=a+"Seconds",s[c]=a+"Milliseconds",s)[i],n=i===m?this.$D+(e-this.$W):e;if(i===v||i===k){var r=this.clone().set(y,1);r.$d[o](n),r.init(),this.$d=r.set(y,Math.min(this.$D,r.daysInMonth())).$d}else o&&this.$d[o](n);return this.init(),this},e.set=function(t,e){return this.clone().$set(t,e)},e.get=function(t){return this[S.p(t)]()},e.add=function(s,t){var e,i=this;s=Number(s);var a=S.p(t),o=function(t){var e=x(i);return S.w(e.date(e.date()+Math.round(t*s)),i)};if(a===v)return this.set(v,this.$M+s);if(a===k)return this.set(k,this.$y+s);if(a===m)return o(1);if(a===w)return o(7);var n=(e={},e[g]=l,e[f]=d,e[p]=u,e)[a]||1,r=this.$d.getTime()+s*n;return S.w(r,this)},e.subtract=function(t,e){return this.add(-1*t,e)},e.format=function(t){var a=this,e=this.$locale();if(!this.isValid())return e.invalidDate||b;var o=t||"YYYY-MM-DDTHH:mm:ssZ",s=S.z(this),i=this.$H,n=this.$m,r=this.$M,c=e.weekdays,u=e.months,l=function(t,e,s,i){return t&&(t[e]||t(a,o))||s[e].substr(0,i)},d=function(t){return S.s(i%12||12,t,"0")},h=e.meridiem||function(t,e,s){var i=t<12?"AM":"PM";return s?i.toLowerCase():i},p={YY:String(this.$y).slice(-2),YYYY:this.$y,M:r+1,MM:S.s(r+1,2,"0"),MMM:l(e.monthsShort,r,u,3),MMMM:l(u,r),D:this.$D,DD:S.s(this.$D,2,"0"),d:String(this.$W),dd:l(e.weekdaysMin,this.$W,c,2),ddd:l(e.weekdaysShort,this.$W,c,3),dddd:c[this.$W],H:String(i),HH:S.s(i,2,"0"),h:d(1),hh:d(2),a:h(i,n,!0),A:h(i,n,!1),m:String(n),mm:S.s(n,2,"0"),s:String(this.$s),ss:S.s(this.$s,2,"0"),SSS:S.s(this.$ms,3,"0"),Z:s};return o.replace(T,function(t,e){return e||p[t]||s.replace(":","")})},e.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},e.diff=function(t,e,s){var i,a=S.p(e),o=x(t),n=(o.utcOffset()-this.utcOffset())*l,r=this-o,c=S.m(this,o);return c=(i={},i[k]=c/12,i[v]=c,i[h]=c/3,i[w]=(r-n)/6048e5,i[m]=(r-n)/864e5,i[f]=r/d,i[g]=r/l,i[p]=r/u,i)[a]||r,s?c:S.a(c)},e.daysInMonth=function(){return this.endOf(v).$D},e.$locale=function(){return $[this.$L]},e.locale=function(t,e){if(!t)return this.$L;var s=this.clone(),i=a(t,e,!0);return i&&(s.$L=i),s},e.clone=function(){return S.w(this.$d,this)},e.toDate=function(){return new Date(this.valueOf())},e.toJSON=function(){return this.isValid()?this.toISOString():null},e.toISOString=function(){return this.$d.toISOString()},e.toString=function(){return this.$d.toUTCString()},t}(),s=L.prototype;return x.prototype=s,[["$ms",c],["$s",p],["$m",g],["$H",f],["$W",m],["$M",v],["$y",k],["$D",y]].forEach(function(e){s[e[1]]=function(t){return this.$g(t,e[0],e[1])}}),x.extend=function(t,e){return t.$i||(t(e,L,x),t.$i=!0),x},x.locale=a,x.isDayjs=i,x.unix=function(t){return x(1e3*t)},x.en=$[r],x.Ls=$,x.p={},x}()}},i={};function dt(t){var e=i[t];if(void 0!==e)return e.exports;e=i[t]={id:t,exports:{}};return s[t].call(e.exports,e,e.exports,dt),e.exports}dt.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return dt.d(e,{a:e}),e},dt.d=function(t,e){for(var s in e)dt.o(e,s)&&!dt.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},dt.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)};!function(){"use strict";var t=Swal,p=dt.n(t);const g=Cookies;var e=dt(301),a=dt(588);async function i(s){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;window.TRACE&&console.trace("%cAuto-Task[Debug]:","color:blue");try{var e=await new Promise(e=>{s.dataType&&(s.responseType=s.dataType);var t={timeout:3e4,ontimeout(t){e({result:"Error",statusText:"Timeout",status:601,data:t,options:s})},onabort(t){e({result:"Error",statusText:"Aborted",status:602,data:t,options:s})},onerror(t){e({result:"Error",statusText:"Error",status:603,data:t,options:s})},onload(t){e({result:"Success",statusText:"Load",status:600,data:t,options:s})},...s};GM_xmlhttpRequest(t)});return window.DEBUG&&console.log("%cAuto-Task[httpRequest]:","color:blue",JSON.stringify(e)),600!==e.status&&t<2?await i(s,t+1):e}catch(t){return console.log("%cAuto-Task[httpRequest]:","color:red",JSON.stringify({errorMsg:t,options:s})),R(t,"httpRequest"),{result:"JsError",statusText:"Error",status:604,error:t,options:s}}}const L=i;function P(){let e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1e3;return new Promise(t=>{setTimeout(()=>{t(!0)},e)})}const j=t=>{let{type:e,text:s,html:i,id:a}=t;const o={success:()=>o,error:()=>o,warning:()=>o,info:()=>o,view:()=>o};try{var n;let t;if(e)switch(e){case"joiningSteamGroup":case"leavingSteamGroup":case"gettingSteamGroupId":t=$(`<li>${z(e)}[<a href="https://steamcommunity.com/groups/${s}" target="_blank">${s}</a>]...<font></font></li>`);break;case"joiningSteamOfficialGroup":case"leavingSteamOfficialGroup":case"gettingSteamOfficialGroupId":t=$(`<li>${z(e)}[<a href="https://steamcommunity.com/games/${s}" target="_blank">${s}</a>]...<font></font></li>`);break;case"subscribingForum":case"unsubscribingForum":case"gettingForumId":t=$(`<li>${z(e)}[<a href="https://steamcommunity.com/app/${s}/discussions/" target="_blank">${s}</a>]...<font></font></li>`);break;case"followingCurator":case"unfollowingCurator":case"gettingCuratorId":t=$(`<li>${z(e)}[<a href="https://store.steampowered.com/${null!==s&&void 0!==s&&s.includes("/")?s:"curator/"+s}" target="_blank">${s}</a>]...<font></font></li>`);break;case"addingToWishlist":case"removingFromWishlist":case"followingGame":case"unfollowingGame":case"gettingSubid":case"addingFreeLicense":case"requestingPlayTestAccess":t=$(`<li>${z(e)}[<a href="https://store.steampowered.com/app/${s}" target="_blank">${s}</a>]...<font></font></li>`);break;case"addingFreeLicenseSubid":t=$(`<li>${z("addingFreeLicense")}[<a href="https://steamdb.info/sub/${s}/" target="_blank">${s}</a>]...<font></font></li>`);break;case"favoritingWorkshop":case"unfavoritingWorkshop":case"gettingWorkshopAppId":case"votingUpWorkshop":t=$(`<li>${z(e)}[<a href="https://steamcommunity.com/sharedfiles/filedetails/?id=${s}" target="_blank">
      ${s}</a>]...<font></font></li>`);break;case"gettingAnnouncementParams":case"likingAnnouncement":t=$(`<li>${z(e)}[<a href="https://store.steampowered.com/news/app/${s}/view/${a}" target="_blank">
      ${a}</a>]...<font></font></li>`);break;case"joiningDiscordServer":case"gettingDiscordGuild":t=$(`<li>${z(e)}[<a href="https://discord.com/invite/${s}" target="_blank">${s}</a>]...<font></font></li>`);break;case"leavingDiscordServer":t=$(`<li>${z(e)}[<a href="https://discord.com/channels/@me/${s}" target="_blank">${s}</a>]...<font></font></li>`);break;case"updateDiscordAuth":t=$(`<li style="color:red;">${z("updateDiscordAuth")}</li>`);break;case"followingTwitchChannel":case"unfollowingTwitchChannel":case"gettingTwitchChannelId":t=$(`<li>${z(e)}[<a href="https://www.twitch.tv/${s}" target="_blank">${s}</a>]...<font></font></li>`);break;case"gettingInsUserId":case"followingIns":case"unfollowingIns":t=$(`<li>${z(e)}[<a href="https://www.instagram.com/${s}/" target="_blank">${s}</a>]...<font></font></li>`);break;case"gettingTwitterUserId":case"followingTwitterUser":case"unfollowingTwitterUser":t=$(`<li>${z(e)}[<a href="https://twitter.com/${s}" target="_blank">${s}</a>]...<font></font></li>`);break;case"retweetting":case"unretweetting":t=$(`<li>${z(e)}${s}...<font></font></li>`);break;case"joiningReddit":case"leavingReddit":t=$(`<li>${z(e)}[<a href="https://www.reddit.com/r/${s}/" target="_blank">${s}</a>]...<font></font></li>`);break;case"followingRedditUser":case"unfollowingRedditUser":t=$(`<li>${z(e)}[<a href="https://www.reddit.com/user/${null===s||void 0===s?void 0:s.replace("u_","")}" target="_blank">
      ${null===s||void 0===s?void 0:s.replace("u_","")}</a>]...<font></font></li>`);break;case"followingYtbChannel":case"unfollowingYtbChannel":t=$(`<li>${z(e)}[<a href="https://www.youtube.com/channel/${s}" target="_blank">${s}</a>]...<font></font></li>`);break;case"likingYtbVideo":case"unlikingYtbVideo":t=$(`<li>${z(e)}[<a href="https://www.youtube.com/watch?v=${s}" target="_blank">${s}</a>]...<font></font></li>`);break;case"gettingVkId":case"joiningVkGroup":case"leavingVkGroup":case"joiningVkPublic":case"leavingVkPublic":case"sendingVkWall":case"deletingVkWall":t=$(`<li>${z(e)}[<a href="https://vk.com/${s}/" target="_blank">${s}</a>]...<font></font></li>`);break;case"visitingLink":t=$(`<li>${z("visitingLink")}[<a href="${s}" target="_blank">${s}</a>]...<font></font></li>`);break;case"verifyingInsAuth":case"text":t=$(`<li>${z(s)}<font></font></li>`);break;case"html":t=$(s||i);break;case"whiteList":t=$(`<li><font class="warning">${z("skipTask")}[${s}(${a})](${z("whiteList")})</font></li>`);break;case"globalOptionsSkip":t=$(`<li>${z("skipTaskOption")}<font class="warning">${s}</font></li>`);break;default:t=$(`<li>${z("unKnown")}:${e}(${s})...<font></font></li>`)}else t=s?$(`<li>${z(s)}<font></font></li>`):i?$(i):$("<li><font></font></li>");return t.addClass("card-text"),$("#auto-task-info").append(t),null!==(n=t[0])&&void 0!==n&&n.scrollIntoView(),{font:t.find("font"),success(){var t,e,s=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"Success",i=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return null!==(t=this.font)&&void 0!==t&&t.attr("class","").addClass("success"),i?null!==(e=this.font)&&void 0!==e&&e.html(s):null!==(e=this.font)&&void 0!==e&&e.text(s),this},error(){var t,e,s=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"Error",i=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return null!==(t=this.font)&&void 0!==t&&t.attr("class","").addClass("error"),i?null!==(e=this.font)&&void 0!==e&&e.html(s):null!==(e=this.font)&&void 0!==e&&e.text(s),this},warning(){var t,e,s=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"Warning",i=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return null!==(t=this.font)&&void 0!==t&&t.attr("class","").addClass("warning"),i?null!==(e=this.font)&&void 0!==e&&e.html(s):null!==(e=this.font)&&void 0!==e&&e.text(s),this},info(){var t,e,s=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"Info",i=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return null!==(t=this.font)&&void 0!==t&&t.attr("class","").addClass("info"),i?null!==(e=this.font)&&void 0!==e&&e.html(s):null!==(e=this.font)&&void 0!==e&&e.text(s),this},view(){var t;return null!==(t=this.font)&&void 0!==t&&t[0].scrollIntoView(),this}}}catch(t){return R(t,"echoLog"),o}},I=t=>{try{return[...new Set(t)]}catch(t){return R(t,"unique"),[]}},l=async e=>{try{if(!e)return null;const s=GM_getValue("redirectLinks")||{};return s[e]&&s[e],await L({url:e,method:"GET"}).then(t=>{t=t.data;return null!=t&&t.finalUrl?(s[e]=t.finalUrl,GM_setValue("redirectLinks",s),t.finalUrl):null})}catch(t){return R(t,"getRedirectLink"),null}},o=async(t,e)=>{try{const i=j({type:"visitLink",text:t});return await L({url:t,method:"GET",...e}).then(t=>{var{result:e,statusText:s,status:t}=t;return"Success"===e?(i.success(),!0):(i.error(e+`:${s}(${t})`),!1)})}catch(t){return R(t,"visitLink"),!1}};const c=i=>{try{let e=0;for(let t=0;t<i.length;t++)e=i.charCodeAt(t)+((e<<5)-e);let s="#";for(let t=0;t<3;t++){const a=e>>8*t&255;s+=("00"+a.toString(16)).slice(-2)}return s}catch(t){return R(t,"stringToColour"),"#fff"}},n={doTask:{discord:{servers:!0},instagram:{users:!0},twitch:{channels:!0},twitter:{users:!0,retweets:!0},vk:{names:!0},youtube:{channels:!0,likes:!0},reddit:{reddits:!0},steam:{groups:!0,officialGroups:!0,wishlists:!0,follows:!0,forums:!0,workshops:!0,curators:!0,workshopVotes:!0,announcements:!0,licenses:!0,playtests:!0}},undoTask:{discord:{servers:!0},instagram:{users:!0},twitch:{channels:!0},twitter:{users:!0,retweets:!0},vk:{names:!0},youtube:{channels:!0,likes:!0},reddit:{reddits:!0},steam:{groups:!0,officialGroups:!0,wishlists:!0,follows:!0,forums:!0,workshops:!0,curators:!0}},position:{buttonSideX:"right",buttonSideY:"top",buttonDistance:"15,30",showButtonSideX:"right",showButtonSideY:"top",showButtonDistance:"15,30",logSideX:"right",logSideY:"bottom",logDistance:"10,10"},hotKey:{doTaskKey:"alt + d",undoTaskKey:"alt + u",toggleLogKey:"alt + l"},other:{twitterVerifyId:"783214",youtubeVerifyChannel:"UCrXUsMBcfTVqwAS7DKg9C0Q",autoUpdateSource:"jsdelivr",language:"zh",checkLogin:!0,checkLeftKey:!0,defaultShowButton:!0,defaultShowLog:!0,debug:!1,receivePreview:!0}};var s=GM_getValue("globalOptions")||{};const r=(t,e)=>{try{const a={};for(var[s,i]of Object.entries(t))"[object Object]"===Object.prototype.toString.call(i)&&"[object Object]"===Object.prototype.toString.call(e[s])?a[s]=r(i,e[s]):a[s]=e[s]??i;return a}catch(t){return R(t,"assignObject"),n}},N=r(n,s),u=()=>{try{const i={};$("#globalOptionsForm").serializeArray().map(t=>(i[t.name]=t.value,t)),$.makeArray($("#globalOptionsForm input")).map(t=>{const e=$(t).attr("name");var s=e.split(".");return 3===s.length?N[s[0]][s[1]][s[2]]=!!i[e]&&("on"===i[e]||i[e]):2===s.length&&(N[s[0]][s[1]]=!!i[e]&&("on"===i[e]||i[e])),t}),GM_setValue("globalOptions",N),p().fire({title:z("changeGlobalOptionsSuccess"),icon:"success"})}catch(t){R(t,"saveData")}},f=e=>{try{let t=`<form id="globalOptionsForm" class="auto-task-form">
      <table class="auto-task-table"><thead><tr><td>${z("type")}</td><td>${z("option")}</td><td>${z("value")}</td></tr></thead><tbody>`;for(const[n,r]of Object.entries(N))for(var[s,i]of Object.entries(r))if(["other","position","hotKey"].includes(n))"boolean"==typeof i?t+=`<tr style="background-color: ${c(n)}44">${0===Object.keys(r).indexOf(s)?`<th rowspan="${Object.keys(r).length}">${z(n)}</th>`:""}<td>${z(s)}</td><td><label><input type="checkbox" name="${n}.${s}"${i?' checked="checked"':""}/><span><i></i></span></label></td></tr>`:t+=`<tr style="background-color: ${c(n)}44">${0===Object.keys(r).indexOf(s)?`<th rowspan="${Object.keys(r).length}" style="background-color: ${c(n)}66">${z(n)}</th>`:""}<td>${z(s)}</td><td><input class="editOption" type="text" name="${n}.${s}" value="${i}"/></td></tr>`;else for(var[a,o]of Object.entries(i))t+=`<tr style="background-color: ${c(s)}66">${0===Object.keys(r).indexOf(s)?`<th rowspan="${Object.keys(r).map(t=>Object.keys(r[t]).length).reduce((t,e)=>t+e)}" style="background-color: ${c(n)}66">${z(n)}</th>`:""}<td>${s}.${z(a)}</td><td><label><input type="checkbox" name="${n}.${s}.${a}"${o?' checked="checked"':""}/><span><i></i></span></label></td></tr>`;t+="</tbody></table></form>","swal"===e?p().fire({title:z("globalOptions"),html:t,showConfirmButton:!0,confirmButtonText:z("save"),showCancelButton:!0,cancelButtonText:z("close")}).then(t=>{t=t.isConfirmed;t&&u()}):$("body").append(`<h2>${z("globalOptions")}</h2>`+t)}catch(t){R(t,"changeGlobalOptions")}};const d={zh:{website:"网站",type:"类型",edit:"编辑",whiteList:"白名单",skipTask:"跳过撤销任务",whiteListOptions:"白名单设置",changeWhiteListOption:"设置白名单(%0)",whiteListNotFound:"找不到此项白名单: %0",changeWhiteListSuccess:"白名单修改成功，刷新生效！",changeWebsiteOptions:"网站设置",changeGlobalOptions:"全局设置",ok:"是",save:"保存",close:"关闭",return:"返回",option:"选项",value:"值",websiteOptions:"当前网站设置",changeWebsiteOptionsSuccess:"更改当前网站设置成功，刷新生效！",changeGlobalOptionsSuccess:"更改全局设置成功，刷新生效！",needLogin:"请先登录！",getTasksInfo:"正在获取并处理任务信息...",gettingKey:"正在获取Key...",verifyingTask:"正在验证任务",notice:"自动任务脚本提醒",noKeysLeft:"此页面已经没有剩余key了，是否关闭？",giveawayEnded:"此活动已结束，是否关闭？",giveawayNotWork:"此活动因某些原因(已结束/暂停/未开始...)不可用(如果是脚本误判请及时反馈)，是否关闭？",confirm:"确定",cancel:"取消",unKnown:"未知",unKnownTaskType:"未识别的任务",doing:"正在做任务",allTasksComplete:"所有任务已完成！",getTaskIdFailed:"获取任务Id失败！",initSuccess:"%0 初始化成功！",initFailed:"%0 初始化失败！",errorLink:"链接错误: %0",needInit:"请先初始化",verifyingAuth:"正在验证%0凭证...",updatingAuth:"正在更新%0凭证...",refreshingToken:"正在刷新%0凭证...",settingToken:"正在设置%0凭证...",initing:"正在初始化...",getFailed:"获取%0失败！",checkLoginFailed:"检测登录状态失败！",checkLeftKeyFailed:"检测剩余Key失败！",userId:"用户Id",joiningGiveaway:"正在加入赠Key",needJoinGiveaway:"需要先加入赠Key",cannotUndo:"此网站不支持取消任务",verifyAuth:"正在验证 %0 凭证...",closePageNotice:"如果此页面没有自动关闭，请自行关闭本页面。",errorReport:"检测到脚本报错，是否前往反馈BUG？",visitingLink:"正在访问链接: ",doTask:"做任务",undoTask:"撤销任务",verifyTask:"验证任务",getKey:"获取Key",selectAll:"全选",selectNone:"全不选",invertSelect:"反选",doFreeTask:"加入免费赠品",doPointTask:"加入点数赠品",skipTaskOption:"设置中已配置跳过任务",other:"其他",globalOptions:"全局设置",checkLogin:"登录检测</br>需要登录的网站自动登录，部分本网站支持",checkLeftKey:"剩余Key检测</br>赠Key活动结束提示是否关闭，部分本网站支持",twitterVerifyId:"通过尝试关注该账号验证Twitter凭证</br>默认为Twitter官方帐号 783214</br>不想关注官方账号可以改为自己的帐号",youtubeVerifyChannel:"通过尝试订阅该频道验证YouTube凭证</br>默认为YouTube官方频道 UCrXUsMBcfTVqwAS7DKg9C0Q</br>不想关注官方频道可以改为自己的频道",autoUpdateSource:"更新源</br>github: 需代理，实时更新</br>jsdelivr: 可不用代理，更新有延迟</br>standby: 备用</br>auto: 依次使用github, jsdelivr, standby源进行尝试更新",saveGlobalOptions:"保存全局设置",settingPage:"设置页面",name:"名称",version:"版本",scriptManager:"脚本管理器",script:"脚本",environment:"环境",os:"系统",browser:"浏览器",getId:"获取 %0 id",getTwitterUserId:"获取Twitter用户id(获取id功能仅在设置页面可用)",getYoutubeChannelId:"获取Youtube频道id(获取id功能仅在设置页面可用)",showButton:"显示按钮",hideButton:"隐藏按钮",showLog:"显示日志",hideLog:"隐藏日志",defaultShowButton:"默认显示按钮",defaultShowLog:"默认显示日志",debug:"输出调试日志，不要开启此选项！",receivePreview:"接收预览版更新",position:"组件位置",buttonSideX:"按钮区域水平方向定位(实时预览功能仅在设置页面可用)</br>left: 靠左 | right: 靠右",buttonSideY:"按钮区域垂直方向定位(实时预览功能仅在设置页面可用)</br>top: 靠上 | bottom: 靠下",buttonDistance:"按钮区域距边缘的距离(实时预览功能仅在设置页面可用)</br>格式: X距离,Y距离",showButtonSideX:"显示按钮水平方向定位(实时预览功能仅在设置页面可用)</br>left: 靠左 | right: 靠右",showButtonSideY:"显示按钮垂直方向定位(实时预览功能仅在设置页面可用)</br>top: 靠上 | bottom: 靠下",showButtonDistance:"显示按钮距边缘的距离(实时预览功能仅在设置页面可用)</br>格式: X距离,Y距离",logSideX:"日志区域水平方向定位(实时预览功能仅在设置页面可用)</br>left: 靠左 | right: 靠右",logSideY:"日志区域垂直方向定位(实时预览功能仅在设置页面可用)</br>top: 靠上 | bottom: 靠下",logDistance:"日志区域距边缘的距离(实时预览功能仅在设置页面可用)</br>格式: X距离,Y距离",hotKey:"快捷键",doTaskKey:"做任务快捷键</br>(实时预览功能仅在设置页面可用)",undoTaskKey:"撤销任务快捷键</br>(实时预览功能仅在设置页面可用)",toggleLogKey:"显示/隐藏日志快捷键</br>(实时预览功能仅在设置页面可用)",tasksHistory:"任务历史",clearHistory:"清空历史",clearHistoryFinished:"已清空任务历史！",deleteTask:"删除任务",lastChangeTime:"最后一次修改时间",clearTaskFinished:"删除以下任务完成！",clearTaskFailed:"删除任务失败，没有找到任务名！",syncData:"数据同步",settingData:"正在上传数据...",gettingData:"正在获取数据...",help:"帮助",fileName:"文件名",upload2gist:"同步到Gist",downloadFromGist:"从Gist同步",saveAndTest:"保存配置并测试",testSuccess:"测试成功！",testFailed:"测试失败！",saveAndTestNotice:"请先保存配置并测试！",processingData:"正在处理数据...",updatingData:"正在上传数据...",syncDataSuccess:"同步数据成功！",syncDataFailed:"同步数据失败，请在控制台查看错误信息！",downloadingData:"正在下载数据...",checkedNoData:"没有检测到远程数据，请确认配置是否正确！",savingData:"正在保存数据...",syncHistory:"同步任务历史",checkUpdateFailed:"检测更新失败",newVersionNotice:'检测到新版本V%0, <a class="high-light" href="%1" target="_blank">点此更新</a>',language:"语言</br>目前仅支持zh: 中文, en: 英文",gistOptions:"Gist 设置",swalNotice:"检测到您第一次安装V4版本脚本，请前往阅读用前必读内容！",echoNotice:'检测到您第一次安装V4版本脚本，请<a class="high-light" href="%0" target="_blank">点此前往</a>阅读用前必读内容！',noticeLink:"https://auto-task-doc.js.org/guide/#用前必读",toGithub:"前往Github反馈",toKeylol:"前往其乐论坛反馈",copySuccess:"错误信息已复制到剪切板，是否前往其乐论坛反馈？",copyFailed:"请复制下方错误信息后前往Keylol论坛反馈！",updateText:"%0 版本更新内容：",Active:"进行中",Ended:"已结束",Banned:"已封禁",Paused:"已暂停",notStart:"未开始",noRemoteData:"检测到远程无数据",errorRemoteDataFormat:"远程数据格式错误",updateHistory:'历史更新记录<a class="high-light" href="https://auto-task-doc.js.org/logs/" target="_blank">点此查看</a>',groups:"组",officialGroups:"官方组",wishlists:"愿望单",follows:"游戏关注",forums:"论坛",workshops:"创意工坊收藏",curators:"鉴赏家",workshopVotes:"创意工坊点赞",announcements:"社区通知",steamCommunity:"Steam社区",steamStore:"Steam商店",licenses:"入库免费游戏",playtests:"请求访问权限",needLoginSteamStore:'请先<a href="https://store.steampowered.com/login/" target="_blank">登录Steam商店</a>',needLoginSteamCommunity:'请先<a href="https://steamcommunity.com/login/home/" target="_blank">登录Steam社区</a>',joiningSteamGroup:"正在加入Steam组",leavingSteamGroup:"正在退出Steam组",gettingSteamGroupId:"正在获取Steam组Id",joiningSteamOfficialGroup:"正在加入Steam官方组",leavingSteamOfficialGroup:"正在退出Steam官方组",gettingSteamOfficialGroupId:"正在获取Steam官方组Id",subscribingForum:"正在订阅Steam论坛",unsubscribingForum:"正在取消订阅Steam论坛",gettingForumId:"正在获取Steam论坛Id",followingCurator:"正在关注Steam鉴赏家",unfollowingCurator:"正在取关Steam鉴赏家",gettingCuratorId:"正在获取Steam鉴赏家Id",addingToWishlist:"正在添加游戏到Steam愿望单",removingFromWishlist:"正在从Steam愿望单移除游戏",followingGame:"正在关注Steam游戏",unfollowingGame:"正在取关Steam游戏",favoritingWorkshop:"正在收藏Steam创意工坊物品",unfavoritingWorkshop:"正在取消收藏Steam创意工坊物品",gettingWorkshopAppId:"正在获取Steam创意工坊物品Id",votingUpWorkshop:"正在点赞Steam创意工坊物品",gettingAnnouncementParams:"正在获取Steam通知信息",likingAnnouncement:"正在点赞Steam通知",changingArea:"正在更换Steam地区: %0...",notNeededChangeArea:"当前地区不需要更换",noAnotherArea:"请检测是否开启正确开启代理",gettingAreaInfo:"正在获取Steam地区信息...",changeAreaNotice:"疑似锁区游戏，尝试换区执行",steamFinishNotice:"Steam任务完成，尝试将购物车地区换回CN",gettingSubid:"正在获取游戏subid",addingFreeLicense:"正在入库",missParams:"缺少参数",gettingLicenses:"正在获取Licenses...",requestingPlayTestAccess:"正在请求访问权限",tryChangeAreaNotice:"此功能无法检测游戏是否限区，因此会尝试换区后再入库，换区失败也不影响后续入库",servers:"服务器",joiningDiscordServer:"正在加入Discord服务器",leavingDiscordServer:"正在退出Discord服务器",gettingDiscordGuild:"正在获取Discord服务器Id",getDiscordAuthFailed:"获取Discord凭证失败，请检测Discord帐号是否已登录",discordImportantNotice:"重要提醒！！！",discordImportantNoticeText:"由于Discord网站后台更新，目前使用此脚本加组后可能会导致Discord帐号被强制退出，且需要两步验证才能正常登录，请谨慎使用！！！",continue:"继续",skipDiscordTask:"跳过Discord任务",continueAndDontRemindAgain:"继续且不再提醒",users:"用户",loginIns:'请先<a href="https://www.instagram.com/accounts/login/" target="_blank">登录Instagram</a>',insBanned:"您的Instagram账户已被封禁",verifyingInsAuth:"正在验证Instagram凭证...",gettingInsUserId:"正在获取Instagram用户Id",followingIns:"正在关注Instagram用户",unfollowingIns:"正在取关Instagram用户",reddits:"社区/用户",loginReddit:'请先<a href="https://www.reddit.com/login/" target="_blank">登录Reddit</a>',changingRedditVersion:"正在切换Reddit为新版页面...",joiningReddit:"正在加入Reddit社区",leavingReddit:"正在退出Reddit社区",followingRedditUser:"正在关注Reddit用户",unfollowingRedditUser:"正在取关Reddit用户",channels:"频道",followingTwitchChannel:"正在关注Twitch频道",unfollowingTwitchChannel:"正在取关Twitch频道",gettingTwitchChannelId:"正在获取Twitch频道Id",checkingTwitchIntegrity:"正在检查Twitch完整性...",twitterUser:"推特用户",retweets:"转推",gettingTwitterUserId:"正在获取推特用户Id",followingTwitterUser:"正在关注推特用户",unfollowingTwitterUser:"正在取关推特用户",retweetting:"正在转推",unretweetting:"正在撤销转推",names:"组/社区/动态",loginVk:'请先<a href="https://vk.com/login/" target="_blank">登录Vk</a>',gettingVkId:"正在获取Vk任务Id",joiningVkGroup:"正在加入Vk组",leavingVkGroup:"正在退出Vk组",joiningVkPublic:"正在加入Vk社区",leavingVkPublic:"正在退出Vk社区",sendingVkWall:"正在转发Vk动态",deletingVkWall:"正在撤销转发Vk动态",youtubeChannel:"YouTube频道",likes:"点赞",loginYtb:'请先<a href="https://accounts.google.com/ServiceLogin?service=youtube" target="_blank">登录YouTube</a>',tryUpdateYtbAuth:'请尝试<a href="https://www.youtube.com/#auth" target="_blank">更新YouTube凭证</a>',gettingYtbToken:"正在获取YouTube Token...",followingYtbChannel:"正在订阅YouTube频道",unfollowingYtbChannel:"正在退订YouTube频道",likingYtbVideo:"正在点赞YouTube视频",unlikingYtbVideo:"正在取消点赞YouTube视频",giveKeyNoticeBefore:"每次验证间隔15s",giveKeyNoticeAfter:'如果没有key, 请在<a href="https://givekey.ru/profile" target="_blank">https://givekey.ru/profile</a>查看',noPoints:"点数不够，跳过抽奖",getNeedPointsFailed:"获取所需点数失败，跳过抽奖",joiningLottery:"正在加入抽奖",doingGleamTask:"正在做Gleam任务...",gettingGleamLink:"正在获取Gleam任务链接...",gleamTaskNotice:"如果此页面长时间未关闭，请完成任一任务后自行关闭！",verifiedGleamTasks:"已尝试验证所有任务，验证失败的任务请尝试手动验证或完成！",gsNotice:'为避免得到"0000-0000-0000"key, 已自动屏蔽"Grab Key"按钮，获取key时请关闭脚本！',giveeClubVerifyNotice:"正在验证任务...",giveeClubVerifyFinished:"请等待验证完成后自行加入赠Key",doingKeyhubTask:"正在做Keyhub任务...",SweepWidgetNotice:"正在处理并验证任务，每次验证任务有1~3s间隔防止触发验证过快警告..."},en:{website:"Website",type:"Type",edit:"Edit",whiteList:"Whitelist",skipTask:"Skip undo task",whiteListOptions:"Whitelist options",changeWhiteListOption:"Whitelist option(%0)",whiteListNotFound:"Cannot find this whitelist: %0",changeWhiteListSuccess:"The whitelist is successfully modified, and the page refresh will take effect!",changeWebsiteOptions:"Website options",changeGlobalOptions:"Global options",ok:"OK",save:"Save",close:"Close",return:"Return",option:"Option",value:"Value",websiteOptions:"Current website settings",changeWebsiteOptionsSuccess:"The current website setting is changed successfully, and the page refresh will take effect!",changeGlobalOptionsSuccess:"The global setting is changed successfully, and the refresh will take effect!",needLogin:"Please log in first!",getTasksInfo:"Obtaining and processing task information...",gettingKey:"Getting Key...",verifyingTask:"Verifying task",notice:"Automatic task script notice",noKeysLeft:"There are no more keys left on this page. Do you want to close it?",giveawayEnded:"This event has ended, do you want to close it?",giveawayNotWork:"This activity is unavailable for some reasons (banned/ended/paused/not started...) (if it is a script misjudgment, please give us feedback in time), is it closed?",confirm:"Confirm",cancel:"Cancel",unKnown:"Unknown",unKnownTaskType:"Unrecognized task",doing:"Doing a task",allTasksComplete:"All tasks have been completed!",getTaskIdFailed:"Failed to obtain task Id!",initSuccess:"%0 was initialized successfully!",initFailed:"%0 initialization failed!",errorLink:"Link error: %0",needInit:"Please initialize first",verifyingAuth:"Verifying %0 token...",updatingAuth:"Update %0 token...",initing:"Initializing...",getFailed:"Failed to get %0!",checkLoginFailed:"Failed to detect login status!",checkLeftKeyFailed:"Failed to detect the remaining keys!",userId:"User Id",joiningGiveaway:"Joining giveaway",needJoinGiveaway:"Need to join the giveaway first",cannotUndo:"This website does not support canceling tasks",verifyAuth:"Verifying %0 token...",closePageNotice:"f this page does not close automatically, please close this page yourself.",errorReport:"A script error is detected, do you want to report the BUG?",visitingLink:"Visiting link: ",doTask:"DoTask",undoTask:"UndoTask",verifyTask:"Verify",getKey:"GetKey",selectAll:"SelectAll",selectNone:"SelectNone",invertSelect:"InvertSelect",doFreeTask:"FreeTask",doPointTask:"PointTask",skipTaskOption:"Skip task has been configured in the settings",other:"Other",globalOptions:"Global Options",checkLogin:"Login detection</br>Need to log in to the website automatically log in, part of this website supports.",checkLeftKey:"Key remaining detection</br>The end of the giveaway event prompts whether to close or not, part of this website supports.",twitterVerifyId:"Verify Twitter token by trying to follow the account.</br>The default is the official Twitter account 783214.</br>If you don't want to follow the official account, you can change it to your own account.",youtubeVerifyChannel:"Verify YouTube token by trying to subscribe to the channel.</br>The default is the official YouTube channel UCrXUsMBcfTVqwAS7DKg9C0Q.</br>If you don't want to follow the official channel, you can change it to your own channel.",autoUpdateSource:"The source to update</br>github: Fast update.</br>jsdelivr: Update is delayed.</br>standby: Standby source.</br>auto: Try to update using github, jsdelivr, standby sources in turn.",saveGlobalOptions:"SaveSettings",settingPage:"Setting Page",name:"Name",version:"Version",scriptManager:"Script Manager",script:"Script",environment:"Environment",os:"OS",browser:"Browser",getId:"Get %0 id",getTwitterUserId:"Get Twitter user id (Get id function is only available on the settings page).",getYoutubeChannelId:"Get Youtube channel id (Get id function is only available on the settings page).",showButton:"ShowButton",hideButton:"HideButton",showLog:"ShowLog",hideLog:"HideLog",defaultShowButton:"Default display button",defaultShowLog:"Display log by default",debug:"Output debug log, do not enable this option!",receivePreview:"Receive preview updates",position:"Component position",buttonSideX:"Horizontal positioning of the button area (real-time preview function is only available on the setting page).</br>left: left | right: right",buttonSideY:"The button area is positioned in the vertical direction (real-time preview function is only available on the settings page).</br>top: top | bottom: bottom",buttonDistance:"The distance between the button area and the edge (the real-time preview function is only available on the setting page).</br> Format: X distance, Y distance",showButtonSideX:"ShowButton horizontal positioning (real-time preview function is only available on the setting page).</br>left: left | right: right",showButtonSideY:"ShowButton vertical positioning (real-time preview function is only available on the setting page).</br>top: top | bottom: bottom",showButtonDistance:"The distance between the ShowButton and the edge (real-time preview function is only available on the setting page).</br> Format: X distance, Y distance",logSideX:"Horizontal positioning of the log area (real-time preview function is only available on the setting page).</br>left: left | right: right",logSideY:"Vertical positioning of the log area (real-time preview function is only available on the setting page).</br>top: top | bottom: bottom",logDistance:"The distance between the log area and the edge (the real-time preview function is only available on the setting page).</br> Format: X distance, Y distance",hotKey:"Shortcut key",doTaskKey:"DoTask shortcut keys</br> (real-time preview function is only available on the settings page).",undoTaskKey:"UndoTask shortcut keys</br> (real-time preview function is only available on the settings page).",toggleLogKey:"ShowLog/HideLog shortcut keys</br> (real-time preview function is only available on the settings page).",tasksHistory:"TasksHistory",clearHistory:"Clear history",clearHistoryFinished:"The mission history has been cleared!",deleteTask:"Delete task",lastChangeTime:"Last Change Time",clearTaskFinished:"Delete the following tasks completed!",clearTaskFailed:"Failed to delete the task, the task name was not found!",syncData:"DataSync",settingData:"Uploading data...",gettingData:"Getting data...",help:"Help",fileName:"Filename",upload2gist:"Sync to Gist",downloadFromGist:"Sync from Gist",saveAndTest:"Save configuration and test",testSuccess:"Test success!",testFailed:"Test failed!",saveAndTestNotice:"Please save the configuration and test first!",processingData:"Processing data...",updatingData:"Uploading data...",syncDataSuccess:"Synchronized data successfully!",syncDataFailed:"Failed to synchronize data, please check the error message on the console!",downloadingData:"Downloading data...",checkedNoData:"No remote data is detected, please confirm whether the configuration is correct!",savingData:"Saving data...",syncHistory:"Synchronize tasks history",checkUpdateFailed:"Check update failed",newVersionNotice:'Checked a new version V%0, <a class="high-light" href="%1" target="_blank">click to update</a>',language:"Language</br> Currently only supports zh: Chinese, en: English",gistOptions:"Gist Settings",swalNotice:"It is detected that you are installing the V4 version script for the first time, please go to read the READ ME FIRST content before use!",echoNotice:'It is detected that you are installing the V4 version script for the first time, please <a class="high-light" href="%0" target="_blank">click here</a> to read the READ ME FIRST content before use!',noticeLink:"https://auto-task-doc.js.org/en/guide/#read-me-first",toGithub:"Feedback(Github)",toKeylol:"Feedback(Keylol)",copySuccess:"The error message has been copied to the clipboard. Do you want to go to the Keylol forum to give feedback?",copyFailed:"Please copy the error information below and report back to the Keylol forum!",updateText:"Updates in version %0:",Active:"Active",Ended:"Ended",Banned:"Banned",Paused:"Paused",notStart:"notStart",noRemoteData:"No data remotely",errorRemoteDataFormat:"Remote data has wrong format",updateHistory:'<a class="high-light" href="https://auto-task-doc.js.org/logs/" target="_blank">Click here</a> to view the historical update record.',groups:"Group",officialGroups:"Official Group",wishlists:"Wishlist",follows:"Follow Game",forums:"Forum",workshops:"Favorite Workshop",curators:"Curator",workshopVotes:"Voteup Workshop",announcements:"Announcement",steamCommunity:"Steam Community",steamStore:"Steam Store",licenses:"Add License",playtests:"Playtest Access",needLoginSteamStore:'Please <a href="https://store.steampowered.com/login/" target="_blank">log in to the Steam Store</a>',needLoginSteamCommunity:'Please <a href="https://steamcommunity.com/login/home/" target="_blank">log in to the Steam Community</a>',joiningSteamGroup:"Joining Steam Group",leavingSteamGroup:"Leaving Steam Group",gettingSteamGroupId:"Getting Steam Group Id",joiningSteamOfficialGroup:"Joining Steam Official Group",leavingSteamOfficialGroup:"Leaving Steam Official Group",gettingSteamOfficialGroupId:"Getting Steam Official Group Id",subscribingForum:"Subscribing the Steam Forum",unsubscribingForum:"Unsubscribing the Steam Forum",gettingForumId:"Getting Steam Forum Id",followingCurator:"Following Steam Curator",unfollowingCurator:"Unfollowing Steam Curator",gettingCuratorId:"Getting Steam Curator Id",addingToWishlist:"Adding the game to the Steam wishlist",removingFromWishlist:"Removing the game from the Steam wishlist",followingGame:"Following Steam games",unfollowingGame:"Unfollowing Steam games",favoritingWorkshop:"Favouring Steam Workshop Items",unfavoritingWorkshop:"Unfavoriting Steam Workshop Items",gettingWorkshopAppId:"Getting Steam Workshop Item Id",votingUpWorkshop:"Liking Steam workshop items",gettingAnnouncementParams:"Getting Steam announcement information",likingAnnouncement:"Liking Steam announcement",changingArea:"Changing Steam area: %0...",notNeededChangeArea:"The current area does not need to be changed",noAnotherArea:"Please check whether the proxy is turned on correctly",gettingAreaInfo:"Getting Steam area information...",changeAreaNotice:"Suspected of a locked zone game, try to change the zone to execute",steamFinishNotice:"Steam task completed, try to change the shopping cart area back to CN",gettingSubid:"Getting subid",addingFreeLicense:"Adding free license",missParams:"Missing parameters",gettingLicenses:"Getting licenses...",requestingPlayTestAccess:"Requesting play test access",tryChangeAreaNotice:"This function cannot detect whether the game is limited, so it will try to change the area before entering the library. Failure to change the area will not affect the subsequent storage.",servers:"Server",joiningDiscordServer:"Joining Discord Server",leavingDiscordServer:"Leaving Discord Server",gettingDiscordGuild:"Getting Discord server Id",getDiscordAuthFailed:"Failed to get Discord token, please check whether the Discord account is logged in",discordImportantNotice:"Important Reminder! ! !",discordImportantNoticeText:"Due to the background update of the Discord website, currently using this script to join a group may cause the Discord account to be forcibly logged out, and two-step verification is required to log in normally, please use it with caution! ! !",continue:"Continue",skipDiscordTask:"Skip",continueAndDontRemindAgain:"Continue without Reminders",users:"User",loginIns:'Please <a href="https://www.instagram.com/accounts/login/" target="_blank">log in to Instagram</a>',insBanned:"Your Instagram account has been banned",verifyingInsAuth:"Verifying Instagram token...",gettingInsUserId:"Getting Instagram user Id",followingIns:"Following Instagram user",unfollowingIns:"Unfollowing Instagram user",reddits:"Reddit/User",loginReddit:'Please <a href="https://www.reddit.com/login/" target="_blank">log in to Reddit</a>',changingRedditVersion:"Switching Reddit to a new version page...",joiningReddit:"Joining the Reddit",leavingReddit:"Leaving the Reddit",followingRedditUser:"Following Reddit User",unfollowingRedditUser:"Unfollowing Reddit User",channels:"Channel",followingTwitchChannel:"Following Twitch Channel",unfollowingTwitchChannel:"Unfollowing Twitch Channel",gettingTwitchChannelId:"Getting Twitch Channel Id",checkingTwitchIntegrity:"Checking Twitch integrity...",twitterUser:"Twitter User",retweets:"Retweet",gettingTwitterUserId:"Getting Twitter User Id",followingTwitterUser:"Following Twitter User",unfollowingTwitterUser:"Unfollowing Twitter User",retweetting:"Retweetting",unretweetting:"Unretweetting",names:"Group/Public/Wall",loginVk:'Please <a href="https://vk.com/login/" target="_blank">log in to Vk</a>',gettingVkId:"Getting Vk task Id",joiningVkGroup:"Joining Vk Group",leavingVkGroup:"Leaving Vk Group",joiningVkPublic:"Joining Vk Public",leavingVkPublic:"Leaving Vk Public",sendingVkWall:"Sending Vk Wall",deletingVkWall:"Deleting Vk Wall",youtubeChannel:"YouTube Channel",likes:"Like",loginYtb:'Please <a href="https://accounts.google.com/ServiceLogin?service=youtube" target="_blank">log in to YouTube</a>',tryUpdateYtbAuth:'Please try to <a href="https://www.youtube.com/#auth" target="_blank">update YouTube token</a>',gettingYtbToken:"Getting YouTube Token...",followingYtbChannel:"Subscribing to YouTube channel",unfollowingYtbChannel:"Unsubscribing to YouTube channel",likingYtbVideo:"Liking YouTube video",unlikingYtbVideo:"Unliking YouTube video",giveKeyNoticeBefore:"Each verification interval is 15s",giveKeyNoticeAfter:'If there is no key, please check at <a href="https://givekey.ru/profile" target="_blank">https://givekey.ru/profile</a>',noPoints:"Not enough points, skip the lottery",getNeedPointsFailed:"ailed to obtain the required points, skip the lottery",joiningLottery:"Joining the lottery",doingGleamTask:"Doing Gleam Task...",gettingGleamLink:"Getting Gleam task link...",gleamTaskNotice:"If this page has not been closed for a long time, please close it yourself after completing any task!",verifiedGleamTasks:"Attempted to verify all tasks. If the verification fails, please try to verify manually or complete it!",gsNotice:'In order to avoid getting the "0000-0000-0000" key, the "Grab Key" button has been hidden, please close the script when obtaining the key!',giveeClubVerifyNotice:"Verifying task...",giveeClubVerifyFinished:"Wait for the verification to complete and join it by yourself",doingKeyhubTask:"Doing Keyhub Task...",SweepWidgetNotice:"The task is being processed and verified. There is an interval of 1~3s for each verification task to prevent the triggering of too fast verification warning..."}},h=["zh","en"].includes(N.other.language)?N.other.language:"en";const z=function(t){for(var e,s=arguments.length,i=new Array(1<s?s-1:0),a=1;a<s;a++)i[a-1]=arguments[a];return null!==(e=d[h])&&void 0!==e&&e[t]?d[h][t].replace(/%([\d]+)/g,(t,e)=>i[parseInt(e,10)]):t};function R(s,i){window.TRACE&&console.trace("%cAuto-Task[Debug]:","color:blue"),p().fire({title:z("errorReport"),icon:"error",showCancelButton:!0,confirmButtonText:z("toGithub"),showDenyButton:!0,denyButtonText:z("toKeylol"),cancelButtonText:z("close")}).then(t=>{var{isDenied:e,isConfirmed:t}=t;t?window.open(`https://github.com/HCLonely/auto-task-v4/issues/new?title=${encodeURIComponent("[BUG] 脚本报错: "+i)}&labels=bug&template=bug_report.yml&website=${encodeURIComponent(window.location.href)}&browser=${encodeURIComponent(JSON.stringify((0,a.ua)(),null,4))}&manager=${encodeURIComponent(GM_info.scriptHandler+" "+GM_info.version)}&user-script=${encodeURIComponent(GM_info.script.version)}&logs=${encodeURIComponent(s.stack||"null")}&run-logs=`+encodeURIComponent($.makeArray($("#auto-task-info>li")).map(t=>t.innerText).join("\n")),"_blank"):e&&(e=`错误链接: [url=${window.location.href}]${window.location.href}[/url]

环境:

[code]${JSON.stringify((0,a.ua)(),null,4)}[/code]

脚本管理器: ${GM_info.scriptHandler} ${GM_info.version}
脚本版本: ${GM_info.script.version}

报错信息:
[code]${s.stack}[/code]

执行日志:
[code]${$.makeArray($("#auto-task-info>li")).map(t=>t.innerText).join("\n")}[/code]`,GM_setClipboard(e),p().fire({title:z("copySuccess"),icon:"success",confirmButtonText:z("ok")}).then(()=>{window.open("https://keylol.com/forum.php?mod=post&action=reply&fid=319&tid=777450","_blank")}))}),console.log("%c%s","color:white;background:red",`Auto-Task[Error]: ${i}
`+s.stack)}var m=class{tasks;getRealParams(e,s,i,a){try{let t=[];return 0<s.length&&(t=[...t,...s.map(t=>a(t)).filter(t=>t)]),!i&&0<this.tasks[e].length&&(t=[...t,...this.tasks[e]]),I(t)}catch(t){return R(t,"Social.getRealParams"),[]}}},w=JSON.stringify({servers:[]});const v=class extends m{tasks=JSON.parse(w);whiteList={...JSON.parse(w),...null===(A=GM_getValue("whiteList"))||void 0===A?void 0:A.discord};#auth=GM_getValue("discordAuth")||{};#cache=GM_getValue("discordCache")||{};#initialized=!1;async init(){try{if(!GM_getValue("dontRemindDiscordAgain"))if(!await p().fire({title:z("discordImportantNotice"),text:z("discordImportantNoticeText"),showCancelButton:!0,showDenyButton:!0,confirmButtonText:z("continue"),cancelButtonText:z("skipDiscordTask"),denyButtonText:z("continueAndDontRemindAgain")}).then(t=>{var{isConfirmed:e,isDenied:t}=t;return!!e||!!t&&(GM_setValue("dontRemindDiscordAgain",!0),!0)}))return this.#initialized=!1,"skip";return this.#initialized?!0:this.#auth.auth?await this.#verifyAuth()?(j({}).success(z("initSuccess","Discord")),this.#initialized=!0):(GM_setValue("discordAuth",{auth:null}),await this.#updateAuth()?(j({}).success(z("initSuccess","Discord")),this.#initialized=!0):(j({}).error(z("initFailed","Discord")),!1)):!!await this.#updateAuth()&&(this.#initialized=!0)}catch(t){return R(t,"Discord.init"),!1}}async#verifyAuth(){try{const a=j({text:z("verifyingAuth","Discord")});var{result:t,statusText:e,status:s,data:i}=await L({url:"https://discord.com/api/v6/users/@me",method:"HEAD",headers:{authorization:this.#auth.auth}});return"Success"===t?200===(null==i?void 0:i.status)?(a.success(),!0):(a.error(`Error:${null==i?void 0:i.statusText}(${null==i?void 0:i.status})`),!1):(a.error(t+`:${e}(${s})`),!1)}catch(t){return R(t,"Discord.verifyAuth"),!1}}async#updateAuth(){try{const s=j({text:z("updatingAuth","Discord")});return await new Promise(e=>{const t=GM_openInTab("https://discord.com/channels/@me#auth",{active:!0,insert:!0,setParent:!0});t.onclose=async()=>{var t=null===(t=GM_getValue("discordAuth"))||void 0===t?void 0:t.auth;t?(this.#auth={auth:t},s.success(),e(await this.#verifyAuth())):(s.error("Error: Update discord auth failed!"),e(!1))}})}catch(t){return R(t,"Discord.updateAuth"),!1}}async#joinServer(t){try{const c=j({type:"joiningDiscordServer",text:t});var e,s,{result:i,statusText:a,status:o,data:n}=await L({url:"https://discord.com/api/v9/invites/"+t,method:"POST",dataType:"json",headers:{authorization:this.#auth.auth,origin:"https://discord.com",referer:"https://discord.com/invite/"+t}});if("Success"!==i||200!==(null==n?void 0:n.status))return c.error(i+`:${a}(${o})`),!1;c.success();var r=String(null===(e=n.response)||void 0===e||null===(s=e.guild)||void 0===s?void 0:s.id);return r&&(this.#setCache(t,r),this.tasks.servers=I([...this.tasks.servers,t])),!0}catch(t){return R(t,"Discord.joinServer"),!1}}async#leaveServer(t){try{if(this.whiteList.servers.includes(t))return j({type:"whiteList",text:"Discord.leaveServer",id:t}),!0;var e=await this.#getGuild(t);if(!e)return!1;const n=j({type:"leavingDiscordServer",text:e});var{result:s,statusText:i,status:a,data:o}=await L({url:"https://discord.com/api/v9/users/@me/guilds/"+e,method:"DELETE",headers:{authorization:this.#auth.auth}});return"Success"===s&&204===(null==o?void 0:o.status)?(n.success(),!0):(n.error(s+`:${i}(${a})`),!1)}catch(t){return R(t,"Discord.leaveServer"),!1}}async#getGuild(t){try{const u=j({type:"gettingDiscordGuild",text:t});var e=this.#cache[t];if(e)return u.success(),e;var{result:s,statusText:i,status:a,data:o}=await L({url:"https://discord.com/api/v9/invites/"+t,responseType:"json",method:"GET"});if("Success"!==s||200!==(null==o?void 0:o.status))return u.error(s+`:${i}(${a})`),!1;var n,r,c=null===(n=o.response)||void 0===n||null===(r=n.guild)||void 0===r?void 0:r.id;return c?(u.success(),this.#setCache(t,c),c):(u.error(s+`:${i}(${a})`),!1)}catch(t){return R(t,"Discord.getGuild"),!1}}async toggle(t){var{doTask:e=!0,serverLinks:t=[]}=t;try{if(!this.#initialized)return j({text:z("needInit")}),!1;const i=[];if(e&&!N.doTask.discord.servers||!e&&!N.undoTask.discord.servers)j({type:"globalOptionsSkip",text:"discord.servers"});else{var s=this.getRealParams("servers",t,e,t=>{return null===(t=t.match(/invite\/(.+)/))||void 0===t?void 0:t[1]});if(0<s.length)for(const a of s)e?i.push(this.#joinServer(a)):i.push(this.#leaveServer(a)),await P(1e3)}return await Promise.all(i).then(()=>!0)}catch(t){return R(t,"Discord.toggleServers"),!1}}#setCache(t,e){try{this.#cache[t]=e,GM_setValue("discordCache",this.#cache)}catch(t){R(t,"Discord.setCache")}}};var k=JSON.stringify({users:[]});const y=class extends m{tasks=JSON.parse(k);whiteList={...JSON.parse(k),...null===(C=GM_getValue("whiteList"))||void 0===C?void 0:C.instagram};#cache=GM_getValue("instagramCache")||{};#auth={};#initialized=!1;async init(){try{return this.#initialized?!0:await this.#getUserInfo()?(j({}).success(z("initSuccess","Instagram")),this.#initialized=!0):(j({}).error(z("initFailed","Instagram")),!1)}catch(t){return R(t,"Instagram.init"),!1}}async#getUserInfo(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"instagram";try{const c=j({type:"instagram"===t?"verifyingInsAuth":"gettingInsUserId",text:t});var e=this.#cache[t];if(e&&"instagram"!==t)return c.success(),e;const{result:u,statusText:l,status:d,data:h}=await L({url:`https://www.instagram.com/${t}/`,method:"GET"});if("Success"!==u)return!1;if(null!==h&&void 0!==h&&h.finalUrl.includes("accounts/login"))return c.error("Error:"+z("loginIns"),!0),!1;if(null!==h&&void 0!==h&&h.finalUrl.includes("www.instagram.com/challenge"))return c.error("Error:"+z("insBanned")),!1;if(200!==(null===h||void 0===h?void 0:h.status))return c.error(u+`:${l}(${d})`),!1;var s,i,a,o=null===(s=h.responseText.match(/"csrf_token":"(.+?)"/))||void 0===s?void 0:s[1],n=null===(i=h.responseText.match(/"rollout_hash":"(.+?)"/))||void 0===i?void 0:i[1];if("instagram"===t)return!(!o||!n)&&(this.#auth={csrftoken:o,hash:n},!0);var r=null===(a=h.responseText.match(/"profilePage_([\d]+?)"/))||void 0===a?void 0:a[1];return r?(this.#setCache(t,r),c.success(),r):(c.error("Error: Get ins data error!"),!1)}catch(t){return R(t,"Instagram.getUserInfo"),!1}}async#followUser(t){try{var e=await this.#getUserInfo(t);if(!e)return!1;const c=j({type:"followingIns",text:t});var s,i,{result:a,statusText:o,status:n,data:r}=await L({url:`https://www.instagram.com/web/friendships/${e}/follow/`,method:"POST",dataType:"json",headers:{"x-csrftoken":this.#auth.csrftoken,origin:"https://www.instagram.com",referer:`https://www.instagram.com/${t}/`,"content-type":"application/x-www-form-urlencoded","sec-fetch-site":"same-origin","x-instagram-ajax":this.#auth.hash}});return"Success"===a?200===(null==r?void 0:r.status)&&"following"===(null===(s=r.response)||void 0===s?void 0:s.result)?(c.success(),this.tasks.users=I([...this.tasks.users,t]),!0):(c.error("Error:"+((null==r||null===(i=r.response)||void 0===i?void 0:i.feedback_message)||`${null==r?void 0:r.statusText}(${null==r?void 0:r.status})`)),!1):(c.error(a+`:${o}(${n})`),!1)}catch(t){return R(t,"Instagram.followUser"),!1}}async#unfollowUser(t){try{if(this.whiteList.users.includes(t))return j({type:"whiteList",text:"Instagram.unfollowUser",id:t}),!0;var e=await this.#getUserInfo(t);if(!e)return!1;const r=j({type:"unfollowingIns",text:t});var s,{result:i,statusText:a,status:o,data:n}=await L({url:`https://www.instagram.com/web/friendships/${e}/unfollow/`,method:"POST",dataType:"json",headers:{"x-csrftoken":this.#auth.csrftoken,origin:"https://www.instagram.com",referer:`https://www.instagram.com/${t}/`,"content-type":"application/x-www-form-urlencoded","sec-fetch-site":"same-origin","x-instagram-ajax":this.#auth.hash}});return"Success"===i?200===(null==n?void 0:n.status)&&"ok"===(null===(s=n.response)||void 0===s?void 0:s.status)?(r.success(),!0):(r.error(`Error:${null==n?void 0:n.statusText}(${null==n?void 0:n.status})`),!1):(r.error(i+`:${a}(${o})`),!1)}catch(t){return R(t,"Instagram.unfollowUser"),!1}}async toggle(t){var{doTask:e=!0,userLinks:t=[]}=t;try{if(!this.#initialized)return j({text:z("needInit")}),!1;const i=[];if(e&&!N.doTask.instagram.users||!e&&!N.undoTask.instagram.users)j({type:"globalOptionsSkip",text:"instagram.users"});else{var s=this.getRealParams("users",t,e,t=>{return null===(t=t.match(/https:\/\/www\.instagram\.com\/(.+)?\//))||void 0===t?void 0:t[1]});if(0<s.length)for(const a of s)e?i.push(this.#followUser(a)):i.push(this.#unfollowUser(a)),await P(1e3)}return await Promise.all(i).then(()=>!0)}catch(t){return R(t,"Instagram.toggleUsers"),!1}}#setCache(t,e){try{this.#cache[t]=e,GM_setValue("instagramCache",this.#cache)}catch(t){R(t,"Instagram.setCache")}}};var b=JSON.stringify({reddits:[]});const T=class extends m{tasks=JSON.parse(b);whiteList={...JSON.parse(b),...null===(E=GM_getValue("whiteList"))||void 0===E?void 0:E.reddit};#auth;#initialized=!1;async init(){try{return this.#initialized?!0:await this.#updateAuth()?(j({}).success(z("initSuccess","Reddit")),this.#initialized=!0):(j({}).error(z("initFailed","Reddit")),!1)}catch(t){return R(t,"Reddit.init"),!1}}async#useBeta(){try{const s=j({text:z("changingRedditVersion")});return GM_setValue("redditAuth",null),await new Promise(t=>{const e=GM_openInTab("https://www.reddit.com/#auth",{active:!0,insert:!0,setParent:!0});e.onclose=async()=>{s.success(),t(await this.#updateAuth(!0))}})}catch(t){return R(t,"Reddit.useBeta"),!1}}async#updateAuth(){var t,e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];try{const i=j({text:z("updatingAuth","Reddit")}),{result:a,statusText:o,status:n,data:r}=await L({url:"https://www.reddit.com/",method:"GET",nochche:!0,headers:{"Cache-Control":"no-cache"}});if("Success"!==a)return i.error(a+`:${o}(${n})`),!1;if(null!==r&&void 0!==r&&r.responseText.includes("www.reddit.com/login/"))return i.error("Error:"+z("loginReddit"),!0),!1;if(200!==(null===r||void 0===r?void 0:r.status))return i.error(`Error:${null===r||void 0===r?void 0:r.statusText}(${null===r||void 0===r?void 0:r.status})`),!1;if(r.responseText.includes("redesign-beta-optin-btn")&&!e)return await this.#useBeta();var s=null===(t=r.responseText.match(/"accessToken":"(.*?)","expires":"(.*?)"/))||void 0===t?void 0:t[1];return s?(this.#auth={token:s},i.success(),!0):(i.error('Error: Parameter "accessToken" not found!'),!1)}catch(t){return R(t,"Reddit.updateAuth"),!1}}async toggleTask(e){var{name:s,doTask:e=!0}=e;try{if(!e&&this.whiteList.reddits.includes(s))return j({type:"whiteList",text:"Reddit.undoTask",id:s}),!0;let t=e?"joiningReddit":"leavingReddit";/^u_/.test(s)&&(t=e?"followingRedditUser":"unfollowingRedditUser");const r=j({type:t,text:s});var{result:i,statusText:a,status:o,data:n}=await L({url:"https://oauth.reddit.com/api/subscribe?redditWebClient=desktop2x&app=desktop2x-client-production&raw_json=1&gilding_detail=1",method:"POST",headers:{authorization:"Bearer "+this.#auth.token,"content-type":"application/x-www-form-urlencoded"},data:$.param({action:e?"sub":"unsub",sr_name:s,api_type:"json"})});return"Success"===i?200===(null==n?void 0:n.status)?(r.success(),e&&(this.tasks.reddits=I([...this.tasks.reddits,s])),!0):(r.error(`Error:${null==n?void 0:n.statusText}(${null==n?void 0:n.status})`),!1):(r.error(i+`:${a}(${o})`),!1)}catch(t){return R(t,"Reddit.toggleTask"),!1}}async toggle(t){var{doTask:e=!0,redditLinks:t=[]}=t;try{if(!this.#initialized)return j({text:z("needInit")}),!1;const i=[];if(e&&!N.doTask.reddit.reddits||!e&&!N.undoTask.reddit.reddits)j({type:"globalOptionsSkip",text:"reddit.reddits"});else{var s=this.getRealParams("reddits",t,e,t=>{var e=null===(e=t.match(/https?:\/\/www\.reddit\.com\/r\/([^/]*)/))||void 0===e?void 0:e[1],t=null===(t=t.match(/https?:\/\/www\.reddit\.com\/user\/([^/]*)/))||void 0===t?void 0:t[1];return t?e||t:e});if(0<s.length)for(const a of s)i.push(this.toggleTask({name:a,doTask:e})),await P(1e3)}return await Promise.all(i).then(()=>!0)}catch(t){return R(t,"Reddit.toggle"),!1}}};var x=JSON.stringify({channels:[]});const S=class extends m{tasks=JSON.parse(x);whiteList={...JSON.parse(x),...null===(t=GM_getValue("whiteList"))||void 0===t?void 0:t.twitch};#auth=GM_getValue("twitchAuth")||{};#cache=GM_getValue("twitchCache")||{};#initialized=!1;#integrityToken;async init(){try{return this.#initialized?!0:this.#auth.authToken&&this.#auth.clientId&&this.#auth.clientVersion&&this.#auth.deviceId&&this.#auth.clientSessionId?await this.#verifyAuth()?(j({}).success(z("initSuccess","Twitch")),this.#initialized=!0):(GM_setValue("twitchAuth",null),await this.#updateAuth()?(j({}).success(z("initSuccess","Twitch")),this.#initialized=!0):(j({}).error(z("initFailed","Twitch")),!1)):!!await this.#updateAuth()&&(this.#initialized=!0)}catch(t){return R(t,"Twitch.init"),!1}}async#verifyAuth(){try{const r=j({text:z("verifyingAuth","Twitch")});var t,e,s,{result:i,statusText:a,status:o,data:n}=await L({url:"https://gql.twitch.tv/gql",method:"POST",dataType:"json",headers:{Authorization:"OAuth "+this.#auth.authToken,"Client-Id":this.#auth.clientId},data:'[{"operationName":"FrontPageNew_User","variables":{"limit":1},"extensions":{"persistedQuery":{"version":1,"sha256Hash":"64bd07a2cbaca80699d62636d966cf6395a5d14a1f0a14282067dcb28b13eb11"}}}]'});return"Success"===i?200===(null==n?void 0:n.status)&&null!==(t=n.response)&&void 0!==t&&null!==(e=t[0])&&void 0!==e&&null!==(s=e.data)&&void 0!==s&&s.currentUser?(await this.#integrity(),r.success(),!0):(r.error(`Error:${null==n?void 0:n.statusText}(${null==n?void 0:n.status})`),!1):(r.error(i+`:${a}(${o})`),!1)}catch(t){return R(t,"Twitch.verifyAuth"),!1}}async#integrity(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";try{const r=j({text:z("checkingTwitchIntegrity")});var e,s,{result:i,statusText:a,status:o,data:n}=await L({url:"https://gql.twitch.tv/integrity",method:"POST",dataType:"json",anonymous:!0,headers:{Origin:"https://www.twitch.tv",Referer:"https://www.twitch.tv/",Authorization:"OAuth "+this.#auth.authToken,"Client-Id":this.#auth.clientId,"Client-Version":this.#auth.clientVersion,"X-Device-Id":this.#auth.deviceId,"Client-Session-Id":this.#auth.clientSessionId,"x-kpsdk-ct":t}});return"Success"===i?!t&&null!=n&&null!==(e=n.responseHeaders)&&void 0!==e&&e["x-kpsdk-ct"]?await this.#integrity(n.responseHeaders["x-kpsdk-ct"]):200===(null==n?void 0:n.status)&&null!==(s=n.response)&&void 0!==s&&s.token?(this.#integrityToken=n.response.token,r.success(),!0):(r.error(`Error:${null==n?void 0:n.statusText}(${null==n?void 0:n.status})`),!1):(r.error(i+`:${a}(${o})`),!1)}catch(t){return R(t,"Twitch.integrity"),!1}}async#updateAuth(){try{const s=j({text:z("updatingAuth","Twitch")});return await new Promise(e=>{const t=GM_openInTab("https://www.twitch.tv/#auth",{active:!0,insert:!0,setParent:!0});t.onclose=async()=>{var t=GM_getValue("twitchAuth");t?(this.#auth=t,s.success(),e(await this.#verifyAuth())):(s.error("Error: Update twitch auth failed!"),e(!1))}})}catch(t){return R(t,"Twitch.updateAuth"),!1}}async#toggleChannel(t){var{name:e,doTask:t=!0}=t;try{if(!t&&this.whiteList.channels.includes(e))return j({type:"whiteList",text:"Twitch.unfollowChannel",id:e}),!0;var s=await this.#getChannelId(e);if(!s)return!1;const p=j({type:`${t?"":"un"}followingTwitchChannel`,text:e});var i,a,o,n,r='[{"operationName":"FollowButton_FollowUser","variables":{"input":{"disableNotifications":false,"targetID":"'+s+'"}},"extensions":{"persistedQuery":{"version":1,"sha256Hash":"800e7346bdf7e5278a3c1d3f21b2b56e2639928f86815677a7126b093b2fdd08"}}}]',c=`[{"operationName":"FollowButton_UnfollowUser","variables":{"input":{"targetID":"${s}"}},`+'"extensions":{"persistedQuery":{"version":1,"sha256Hash":"f7dae976ebf41c755ae2d758546bfd176b4eeb856656098bb40e0a672ca0d880"}}}]',{result:u,statusText:l,status:d,data:h}=await L({url:"https://gql.twitch.tv/gql",method:"POST",dataType:"json",anonymous:!0,headers:{Origin:"https://www.twitch.tv",Referer:"https://www.twitch.tv/",Authorization:"OAuth "+this.#auth.authToken,"Client-Id":this.#auth.clientId,"Client-Version":this.#auth.clientVersion,"X-Device-Id":this.#auth.deviceId,"Client-Session-Id":this.#auth.clientSessionId,"Client-Integrity":this.#integrityToken},data:t?r:c});return"Success"===u?200===(null==h?void 0:h.status)&&null!==(i=h.response)&&void 0!==i&&i[0]&&!h.response[0].errors?(p.success(),t&&(this.tasks.channels=I([...this.tasks.channels,e])),!0):(p.error("Error:"+((null==h||null===(a=h.response)||void 0===a||null===(o=a[0].errors)||void 0===o||null===(n=o[0])||void 0===n?void 0:n.message)||`${null==h?void 0:h.statusText}(${null==h?void 0:h.status})`)),!1):(p.error(u+`:${l}(${d})`),!1)}catch(t){return R(t,"Twitch.toggleChannel"),!1}}async#getChannelId(t){try{const d=j({type:"gettingTwitchChannelId",text:t});var e=this.#cache[t];if(e)return d.success(),e;var{result:s,statusText:i,status:a,data:o}=await L({url:"https://gql.twitch.tv/gql",method:"POST",headers:{Authorization:"OAuth "+this.#auth.authToken,"Client-Id":this.#auth.clientId},responseType:"json",data:`[{"operationName":"ActiveWatchParty","variables":{"channelLogin":"${t}"},`+'"extensions":{"persistedQuery":{"version":1,"sha256Hash":"4a8156c97b19e3a36e081cf6d6ddb5dbf9f9b02ae60e4d2ff26ed70aebc80a30"}}}]'});if("Success"!==s)return d.error(s+`:${i}(${a})`),!1;if(200!==(null==o?void 0:o.status))return d.error(`Error:${null==o?void 0:o.statusText}(${null==o?void 0:o.status})`),!1;var n,r,c,u,l=null===(n=o.response)||void 0===n||null===(r=n[0])||void 0===r||null===(c=r.data)||void 0===c||null===(u=c.user)||void 0===u?void 0:u.id;return l?(this.#setCache(t,String(l)),d.success(),l):(d.error(`Error:${o.statusText}(${o.status})`),!1)}catch(t){return R(t,"Twitch.getChannelId"),!1}}async toggle(t){var{doTask:e=!0,channelLinks:t=[]}=t;try{if(!this.#initialized)return j({text:z("needInit")}),!1;const i=[];if(e&&!N.doTask.twitch.channels||!e&&!N.undoTask.twitch.channels)j({type:"globalOptionsSkip",text:"twitch.channels"});else{var s=this.getRealParams("channels",t,e,t=>{return null===(t=t.match(/https:\/\/(www\.)?twitch\.tv\/(.+)/))||void 0===t?void 0:t[2]});if(0<s.length)for(const a of s)i.push(this.#toggleChannel({name:a,doTask:e})),await P(1e3)}return Promise.all(i).then(()=>!0)}catch(t){return R(t,"Twitch.toggle"),!1}}#setCache(t,e){try{this.#cache[t]=e,GM_setValue("twitchCache",this.#cache)}catch(t){R(t,"Twitch.setCache")}}};s=JSON.stringify({users:[],retweets:[],likes:[]});const G=class extends m{tasks=JSON.parse(s);whiteList={...JSON.parse(s),...null===(w=GM_getValue("whiteList"))||void 0===w?void 0:w.twitter};#verifyId=N.other.twitterVerifyId;#auth=GM_getValue("twitterAuth")||{};#cache=GM_getValue("twitterCache")||{};#initialized=!1;async init(){try{return this.#initialized?!0:this.#auth.ct0?await this.#verifyAuth()?(j({}).success(z("initSuccess","Twitter")),this.#initialized=!0):(GM_setValue("twitterAuth",null),await this.#updateAuth()?(j({}).success(z("initSuccess","Twitter")),this.#initialized=!0):(j({}).error(z("initFailed","Twitter")),!1)):!!await this.#updateAuth()&&(this.#initialized=!0)}catch(t){return R(t,"Twitter.init"),!1}}async#verifyAuth(){try{return await this.#toggleUser({name:"verify",doTask:!0,verify:!0})}catch(t){return R(t,"Twitter.verifyAuth"),!1}}async#updateAuth(){try{const s=j({text:z("updatingAuth","Twitter")});return await new Promise(e=>{const t=GM_openInTab("https://twitter.com/settings/account?k#auth",{active:!0,insert:!0,setParent:!0});t.onclose=async()=>{var t=GM_getValue("twitterAuth");t?(this.#auth=t,s.success(),e(await this.#verifyAuth())):(s.error("Error: Update twitter auth failed!"),e(!1))}})}catch(t){return R(t,"Twitter.updateToken"),!1}}async#toggleUser(t){var{name:e,doTask:s=!0,verify:t=!1}=t;try{if(!s&&!t&&this.whiteList.users.includes(e))return j({type:"whiteList",text:"Twitter.unfollowUser",id:e}),!0;var i=t?this.#verifyId:await this.userName2id(e);if(!i)return!1;const d=t?j({text:z("verifyingAuth","Twitter")}):j({type:`${s?"":"un"}followingTwitterUser`,text:e});var a,o,n,{result:r,statusText:c,status:u,data:l}=await L({url:`https://api.twitter.com/1.1/friendships/${s?"create":"destroy"}.json`,method:"POST",headers:{authorization:"Bearer AAAAAAAAAAAAAAAAAAAAANRILgAAAAAAnNwIzUejRCOuH5E6I8xnZz4puTs%3D1Zv7ttfk8LF81IUq16cHjhLTvJu4FA33AGWWjCpTnA","Content-Type":"application/x-www-form-urlencoded","x-csrf-token":this.#auth.ct0},responseType:"json",data:$.param({include_profile_interstitial_type:1,include_blocking:1,include_blocked_by:1,include_followed_by:1,include_want_retweets:1,include_mute_edge:1,include_can_dm:1,include_can_media_tag:1,skip_status:1,id:i})});return"Success"===r?200===(null==l?void 0:l.status)?(d.success(),s&&!t&&(this.tasks.users=I([...this.tasks.users,e])),!0):t&&403===(null==l?void 0:l.status)&&158===(null===(a=l.response)||void 0===a||null===(o=a.errors)||void 0===o||null===(n=o[0])||void 0===n?void 0:n.code)?(d.success(),!0):(d.error(`Error:${null==l?void 0:l.statusText}(${null==l?void 0:l.status})`),!1):(d.error(r+`:${c}(${u})`),!1)}catch(t){return R(t,"Twitter.toggleUser"),!1}}async userName2id(t){try{const d=j({type:"gettingTwitterUserId",text:t});var e=this.#cache[t];if(e)return d.success(),e;var s,i,a,o,{result:n,statusText:r,status:c,data:u}=await L({url:"https://api.twitter.com/graphql/mCbpQvZAw6zu_4PvuAUVVQ/UserByScreenName"+`?variables=%7B%22screen_name%22%3A%22${t}%22%2C%22withSafetyModeUserFields%22%3Atrue%2C%22withSuperFollowsUserFields%22%3Atrue%7D`,method:"GET",headers:{authorization:"Bearer AAAAAAAAAAAAAAAAAAAAANRILgAAAAAAnNwIzUejRCOuH5E6I8xnZz4puTs%3D1Zv7ttfk8LF81IUq16cHjhLTvJu4FA33AGWWjCpTnA","content-type":"application/json",referer:"https://twitter.com/"+t,"x-csrf-token":this.#auth.ct0},responseType:"json"});if("Success"!==n)return d.error(n+`:${r}(${c})`),!1;if(200!==(null==u?void 0:u.status))return d.error(`Error:${null==u?void 0:u.statusText}(${null==u?void 0:u.status})`),!1;{let e=u.response||("object"==typeof u.responseText?u.responseText:null);if(!e)try{e=JSON.parse(u.responseText)}catch(t){e=null}var l=String(null===(s=e)||void 0===s||null===(i=s.data)||void 0===i||null===(a=i.user)||void 0===a||null===(o=a.result)||void 0===o?void 0:o.rest_id);return l?(this.#setCache(t,l),d.success(),l):(d.error(`Error:${u.statusText}(${u.status})`),!1)}}catch(t){return R(t,"Twitter.getUserId"),!1}}async#toggleRetweet(t){var{retweetId:e,doTask:t=!0}=t;try{if(!t&&this.whiteList.retweets.includes(e))return j({type:"whiteList",text:"Twitter.unretweet",id:e}),!0;const u=j({type:`${t?"":"un"}retweetting`,text:e});var s,i,a,{result:o,statusText:n,status:r,data:c}=await L({url:`https://api.twitter.com/1.1/statuses/${t?"":"un"}retweet.json`,method:"POST",headers:{authorization:"Bearer AAAAAAAAAAAAAAAAAAAAANRILgAAAAAAnNwIzUejRCOuH5E6I8xnZz4puTs%3D1Zv7ttfk8LF81IUq16cHjhLTvJu4FA33AGWWjCpTnA","Content-Type":"application/x-www-form-urlencoded","x-csrf-token":this.#auth.ct0},data:$.param({tweet_mode:"extended",id:e}),responseType:"json"});return"Success"===o?200===(null==c?void 0:c.status)||403===(null==c?void 0:c.status)&&327===(null===(s=c.response)||void 0===s||null===(i=s.errors)||void 0===i||null===(a=i[0])||void 0===a?void 0:a.code)?(u.success(),t&&(this.tasks.retweets=I([...this.tasks.retweets,e])),!0):(u.error(`Error:${null==c?void 0:c.statusText}(${null==c?void 0:c.status})`),!1):(u.error(o+`:${n}(${r})`),!1)}catch(t){return R(t,"Twitter.toggleRetweet"),!1}}async toggle(t){var{doTask:e=!0,userLinks:s=[],retweetLinks:t=[]}=t;try{if(!this.#initialized)return j({text:z("needInit")}),!1;const o=[];if(e&&!N.doTask.twitter.users||!e&&!N.undoTask.twitter.users)j({type:"globalOptionsSkip",text:"twitter.users"});else{var i=this.getRealParams("users",s,e,t=>{return null===(t=t.match(/https:\/\/twitter\.com\/(.+)/))||void 0===t?void 0:t[1]});if(0<i.length)for(const n of i)o.push(this.#toggleUser({name:n,doTask:e})),await P(1e3)}if(e&&!N.doTask.twitter.retweets||!e&&!N.undoTask.twitter.retweets)j({type:"globalOptionsSkip",text:"twitter.retweets"});else{var a=this.getRealParams("retweets",t,e,t=>{return null===(t=t.match(/https:\/\/twitter\.com\/.*?\/status\/([\d]+)/))||void 0===t?void 0:t[1]});if(0<a.length)for(const r of a)o.push(this.#toggleRetweet({retweetId:r,doTask:e})),await P(1e3)}return Promise.all(o).then(()=>!0)}catch(t){return R(t,"Twitter.toggle"),!1}}#setCache(t,e){try{this.#cache[t]=e,GM_setValue("twitterCache",this.#cache)}catch(t){R(t,"Twitter.setCache")}}};var A=JSON.stringify({names:[]});const _=class extends m{tasks=JSON.parse(A);whiteList={...JSON.parse(A),...null===(k=GM_getValue("whiteList"))||void 0===k?void 0:k.vk};#username="";#cache=GM_getValue("vkCache")||{};#initialized=!1;async init(){try{return this.#initialized?!0:await this.#verifyAuth()?(j({}).success(z("initSuccess","Vk")),this.#initialized=!0):(j({}).error(z("initFailed","Vk")),!1)}catch(t){return R(t,"Vk.init"),!1}}async#verifyAuth(){try{const e=j({text:z("verifyAuth","Vk")}),{result:s,statusText:i,status:a,data:o}=await L({url:"https://vk.com/im",method:"GET"});var t;return"Success"===s?null!==o&&void 0!==o&&o.finalUrl.includes("vk.com/login")?(e.error("Error:"+z("loginVk"),!0),!1):200===(null===o||void 0===o?void 0:o.status)?(this.#username=(null===(t=o.responseText.match(/TopNavBtn__profileLink" href="\/(.*?)"/))||void 0===t?void 0:t[1])||"",e.success(),!0):(e.error(`Error:${null===o||void 0===o?void 0:o.statusText}(${null===o||void 0===o?void 0:o.status})`),!1):(e.error(s+`:${i}(${a})`),!1)}catch(t){return R(t,"Vk.verifyAuth"),!1}}async#toggleGroup(t,e){var s=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];try{const r=j({type:s?"joiningVkGroup":"leavingVkGroup",text:t});if("enter"===e.groupAct&&!s||"leave"===e.groupAct&&s)return r.success(),!0;const c={act:s?"enter":"leave",al:1,gid:e.groupId,hash:e.groupHash};s&&(c.context="_");var{result:i,statusText:a,status:o,data:n}=await L({url:"https://vk.com/al_groups.php",method:"POST",headers:{origin:"https://vk.com",referer:"https://vk.com/"+t,"content-type":"application/x-www-form-urlencoded"},data:$.param(c)});return"Success"===i?200===(null==n?void 0:n.status)?(r.success(),s&&(this.tasks.names=I([...this.tasks.names,t])),!0):(r.error(`Error:${null==n?void 0:n.statusText}(${null==n?void 0:n.status})`),!1):(r.error(i+`:${a}(${o})`),!1)}catch(t){return R(t,"Vk.toggleGroup"),!1}}async#togglePublic(t,e){var s=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];try{const r=j({type:s?"joiningVkPublic":"leavingVkPublic",text:t});if(e.publicJoined&&s||!e.publicJoined&&!s)return r.success(),!0;var{result:i,statusText:a,status:o,data:n}=await L({url:"https://vk.com/al_public.php",method:"POST",headers:{origin:"https://vk.com",referer:"https://vk.com/"+t,"content-type":"application/x-www-form-urlencoded"},data:$.param({act:s?"a_enter":"a_leave",al:1,pid:e.publicPid,hash:e.publicHash})});return"Success"===i?200===(null==n?void 0:n.status)?(r.success(),s&&(this.tasks.names=I([...this.tasks.names,t])),!0):(r.error(`Error:${null==n?void 0:n.statusText}(${null==n?void 0:n.status})`),!1):(r.error(i+`:${a}(${o})`),!1)}catch(t){return R(t,"Vk.togglePublic"),!1}}async#sendWall(t){try{const y=j({type:"sendingVkWall",text:t}),{result:b,statusText:T,status:x,data:S}=await L({url:"https://vk.com/like.php",method:"POST",headers:{origin:"https://vk.com",referer:"https://vk.com/"+t,"content-type":"application/x-www-form-urlencoded"},data:$.param({act:"publish_box",al:1,object:t})});if("Success"!==b)return y.error(b+`:${T}(${x})`),!1;if(200!==(null===S||void 0===S?void 0:S.status))return y.error(`Error:${null===S||void 0===S?void 0:S.statusText}(${null===S||void 0===S?void 0:S.status})`),!1;var e,s=null===(e=S.responseText.match(/shHash:[\s]*'(.*?)'/))||void 0===e?void 0:e[1];if(s){var{result:i,statusText:a,status:o,data:n}=await L({url:"https://vk.com/like.php",method:"POST",headers:{origin:"https://vk.com",referer:"https://vk.com/"+t,"content-type":"application/x-www-form-urlencoded"},data:$.param({Message:"",act:"a_do_publish",al:1,close_comments:0,friends_only:0,from:"box",hash:s,list:"",mark_as_ads:0,mute_notifications:0,object:t,ret_data:1,to:0})});if("Success"!==i)return y.error(i+`:${a}(${o})`),!1;if(200===(null==n?void 0:n.status)){var r,c,u,l,d,h,p,g,f,m,w=JSON.parse((null===(r=n.responseText)||void 0===r?void 0:r.replace("\x3c!--",""))||"{}");if(!0===(null==w||null===(c=w.payload)||void 0===c||null===(u=c[1])||void 0===u||null===(l=u[1])||void 0===l?void 0:l.share_my)){y.success();var v=String(null==w||null===(d=w.payload)||void 0===d||null===(h=d[1])||void 0===h||null===(p=h[1])||void 0===p?void 0:p.post_id),k=String(null==w||null===(g=w.payload)||void 0===g||null===(f=g[1])||void 0===f||null===(m=f[1])||void 0===m?void 0:m.owner_id);return v&&k&&this.#setCache(t,k+"_"+v),this.tasks.names=I([...this.tasks.names,t]),!0}}return y.error(`Error:${null==n?void 0:n.statusText}(${null==n?void 0:n.status})`),!1}return y.error('Error: Get "hash" failed'),!1}catch(t){return R(t,"Vk.sendWall"),!1}}async#deleteWall(t,e){try{const l=j({type:"deletingVkWall",text:t});var{result:s,statusText:i,status:a,data:o}=await L({url:"https://vk.com/al_wall.php?act=delete",method:"POST",headers:{origin:"https://vk.com",referer:`https://vk.com/${this.#username}?w=wall${this.#cache[t]}%2Fall`,"content-type":"application/x-www-form-urlencoded"},data:$.param({act:"delete",al:1,confirm:0,from:"wkview",hash:e.wallHash,post:this.#cache[t]})});if("Success"!==s)return l.error(s+`:${i}(${a})`),!1;if(200!==(null==o?void 0:o.status))return l.error(`Error:${null==o?void 0:o.statusText}(${null==o?void 0:o.status})`),!1;var n,r,c,u=JSON.parse((null===(n=o.responseText)||void 0===n?void 0:n.replace("\x3c!--",""))||"{}");return null!=u&&null!==(r=u.payload)&&void 0!==r&&null!==(c=r[1])&&void 0!==c&&c[1]?(l.success(),!0):(l.error(`Error:${null==o?void 0:o.statusText}(${null==o?void 0:o.status})`),!1)}catch(t){return R(t,"Vk.deleteWall"),!1}}async#getId(e,s){try{let t="https://vk.com/"+e;if(/^wall-/.test(e)){if(s)return{type:"sendWall"};if(!this.#cache[e])return{type:"unSupport"};t=`https://vk.com/${this.#username}?w=wall`+this.#cache[e]}const p=j({type:"gettingVkId",text:e}),{result:g,statusText:f,status:m,data:w}=await L({url:t,method:"GET"});if("Success"!==g)return p.error(g+`:${f}(${m})`),!1;if(200!==(null===w||void 0===w?void 0:w.status))return p.error(`Error:${null===w||void 0===w?void 0:w.statusText}(${null===w||void 0===w?void 0:w.status})`),!1;var i,a,[,o,n,,r]=w.responseText.match(/Groups.(enter|leave)\(.*?,.*?([\d]+?), (&#39;|')(.*?)(&#39;|')/)||[],c=null===(i=w.responseText.match(/"enterHash":"(.*?)"/))||void 0===i?void 0:i[1],u=null===(a=w.responseText.match(/"public_id":([\d]+?),/))||void 0===a?void 0:a[1],l=!w.responseText.includes("Public.subscribe");if(o&&n&&r)return p.success(),{groupAct:o,groupId:n,groupHash:r,type:"group"};if(c&&u)return p.success(),{publicHash:c,publicPid:u,publicJoined:l,type:"public"};if(w.responseText.includes("wall.deletePost")&&!s){var d,h=null===(d=w.responseText.match(/wall\.deletePost\(this, '.*?', '(.*?)'\)/))||void 0===d?void 0:d[1];if(h)return p.success(),{type:"deleteWall",wallHash:h}}else if(e.includes("wall")&&s)return p.success(),{type:"sendWall"};return p.error("Error: Parameters not found!"),!1}catch(t){return R(t,"Vk.getId"),!1}}async#toggleVk(t){let{name:e,doTask:s=!0}=t;try{if(!s&&this.whiteList.names.includes(e))return j({type:"whiteList",text:"Vk.undoTask",id:e}),!0;var i=e.replace(/\/$/,""),a=await this.#getId(i,s);if(!a)return!1;switch(a.type){case"group":return await this.#toggleGroup(i,a,s);case"public":return await this.#togglePublic(i,a,s);case"sendWall":return!s||await this.#sendWall(i);case"deleteWall":return!!s||await this.#deleteWall(i,a);default:return!1}}catch(t){return R(t,"Vk.toggleVk"),!1}}async toggle(t){var{doTask:e=!0,nameLinks:t=[]}=t;try{if(!this.#initialized)return j({text:z("needInit")}),!1;const i=[];if(e&&!N.doTask.vk.names||!e&&!N.undoTask.vk.names)j({type:"globalOptionsSkip",text:"vk.names"});else{var s=this.getRealParams("names",t,e,t=>{return null===(t=t.match(/https:\/\/vk\.com\/([^/]+)/))||void 0===t?void 0:t[1]});if(0<s.length)for(const a of s)i.push(this.#toggleVk({name:a,doTask:e})),await P(1e3)}return Promise.all(i).then(()=>!0)}catch(t){return R(t,"Vk.toggle"),!1}}#setCache(t,e){try{this.#cache[t]=e,GM_setValue("vkCache",this.#cache)}catch(t){R(t,"Vk.setCache")}}};var C=JSON.stringify({channels:[],likes:[]});const O=async function(t,e){try{const h=j({text:z("gettingYtbToken")}),{result:p,statusText:g,status:f,data:m}=await L({url:t,method:"GET"});if("Success"!==p)return h.error(p+`:${g}(${f})`),{};if(200!==(null===m||void 0===m?void 0:m.status))return h.error(`Error:${null===m||void 0===m?void 0:m.statusText}(${null===m||void 0===m?void 0:m.status})`),{};{var s,i;if(m.responseText.includes("accounts.google.com/ServiceLogin?service=youtube"))return h.error("Error:"+z("loginYtb"),!0),{needLogin:!0};var a=null===(s=m.responseText.match(/"INNERTUBE_API_KEY":"(.*?)"/))||void 0===s?void 0:s[1],o=(null===(i=m.responseText.match(/\(\{"INNERTUBE_CONTEXT":([\w\W]*?)\}\)/)||m.responseText.match(/"INNERTUBE_CONTEXT":([\w\W]*?\}),"INNERTUBE/))||void 0===i?void 0:i[1])||"{}";const{client:w,request:v}=JSON.parse(o);if(a&&w&&v){if(w.hl="en","channel"===e){var n,r=null===(n=m.responseText.match(/<meta itemprop="channelId" content="(.+?)">/))||void 0===n?void 0:n[1];return r?(h.success(),{params:{apiKey:a,client:w,request:v,channelId:r}}):(h.error('Error: Get "channelId" failed!'),{})}if("likeVideo"!==e)return h.error("Error: Unknown type"),{};var c,u,l=null===(c=m.responseText.match(/<link rel="shortlinkUrl" href="https:\/\/youtu\.be\/(.*?)">/))||void 0===c?void 0:c[1],d=null===(u=m.responseText.match(/"likeParams":"(.*?)"/))||void 0===u?void 0:u[1];return l?(h.success(),{params:{apiKey:a,client:w,request:v,videoId:l,likeParams:d}}):(h.error('Error: Get "videoId" failed!'),{})}return h.error('Error: Parameter "apiKey" not found!'),{}}}catch(t){return R(t,"Youtube.getInfo"),{}}};class D extends m{tasks=JSON.parse(C);whiteList={...JSON.parse(C),...null===(b=GM_getValue("whiteList"))||void 0===b?void 0:b.youtube};#auth=GM_getValue("youtubeAuth")||{};#initialized=!1;#verifyChannel="https://www.youtube.com/channel/"+N.other.youtubeVerifyChannel;async init(){try{return this.#initialized?!0:this.#auth.PAPISID?await this.#verifyAuth()?(j({}).success(z("initSuccess","Youtube")),this.#initialized=!0):(GM_setValue("youtubeAuth",null),await this.#updateAuth()?(j({}).success(z("initSuccess","Youtube")),this.#initialized=!0):(j({}).error(z("initFailed","Youtube")),!1)):!!await this.#updateAuth()&&(this.#initialized=!0)}catch(t){return R(t,"Youtube.init"),!1}}async#verifyAuth(){try{return await this.#toggleChannel({link:this.#verifyChannel,doTask:!0,verify:!0})}catch(t){return R(t,"Youtube.verifyAuth"),!1}}async#updateAuth(){try{const s=j({text:z("updatingAuth","Youtube")});return await new Promise(e=>{const t=GM_openInTab("https://www.youtube.com/#auth",{active:!0,insert:!0,setParent:!0});t.onclose=async()=>{var t=GM_getValue("youtubeAuth");t?(this.#auth=t,s.success(),this.#verifyAuth().then(t=>{e(t)})):(s.error("Error: Update youtube auth failed!"),e(!1))}})}catch(t){return R(t,"Discord.updateAuth"),!1}}#getInfo(t,e){return O(t,e)}async#toggleChannel(t){var{link:e,doTask:s=!0,verify:t=!1}=t;try{var{params:i,needLogin:a}=await this.#getInfo(e,"channel"),{apiKey:o,client:n,request:r,channelId:c}=i||{};if(a)return j({html:z("loginYtb")}),!1;if(!(o&&n&&r&&c))return j({text:'"getYtbToken" failed'}),!1;if(!s&&!t&&this.whiteList.channels.includes(c))return j({type:"whiteList",text:"Youtube.unfollowChannel",id:c}),!0;const l=t?j({text:z("verifyingAuth","Youtube")}):j({type:s?"followingYtbChannel":"unfollowingYtbChannel",text:c});var u=parseInt(String((new Date).getTime()/1e3),10);const{result:d,statusText:h,status:p,data:g}=await L({url:`https://www.youtube.com/youtubei/v1/subscription/${s?"":"un"}subscribe?key=`+o,method:"POST",headers:{origin:"https://www.youtube.com",referer:"https://www.youtube.com/channel/"+c,"content-type":"application/json","x-goog-authuser":"0","x-goog-visitor-id":null==n?void 0:n.visitorData,"x-origin":"https://www.youtube.com",authorization:`SAPISIDHASH ${u}_`+sha1(`${u} ${this.#auth.PAPISID} https://www.youtube.com`)},data:JSON.stringify({context:{client:n,request:{sessionId:null==r?void 0:r.sessionId,internalExperimentFlags:[],consistencyTokenJars:[]},user:{}},channelIds:[c],params:s?"EgIIAhgA":"CgIIAhgA"})});return"Success"===d?200===(null===g||void 0===g?void 0:g.status)?s&&(/"subscribed": true/.test(g.responseText)||g.responseText.includes("The subscription already exists"))||!s&&/"subscribed": false/.test(g.responseText)?(l.success(),s&&!t&&(this.tasks.channels=I([...this.tasks.channels,e])),!0):t&&g.responseText.includes("You may not subscribe to yourself")?(l.success(),!0):(l.error(z("tryUpdateYtbAuth"),!0),!1):(l.error(`Error:${null===g||void 0===g?void 0:g.statusText}(${null===g||void 0===g?void 0:g.status})`),!1):(l.error(d+`:${h}(${p})`),!1)}catch(t){return R(t,"Youtube.toggleChannel"),!1}}async#toggleLikeVideo(t){var{link:e,doTask:t=!0}=t;try{var{params:s,needLogin:i}=await this.#getInfo(e,"likeVideo"),{apiKey:a,client:o,request:n,videoId:r,likeParams:c}=s||{};if(i)return j({html:""+z("loginYtb")}),!1;if(!(a&&o&&n&&r&&c))return j({text:'"getYtbToken" failed'}),!1;if(!t&&this.whiteList.likes.includes(r))return j({type:"whiteList",text:"Youtube.unlikeVideo",id:r}),!0;const l=j({type:t?"likingYtbVideo":"unlikingYtbVideo",text:r});var u=parseInt(String((new Date).getTime()/1e3),10);const d={context:{client:o,request:{sessionId:n.sessionId,internalExperimentFlags:[],consistencyTokenJars:[]},user:{}},target:{videoId:r}};if(t){if(!c)return l.error("Empty likeParams"),!1;d.params=c}const{result:h,statusText:p,status:g,data:f}=await L({url:`https://www.youtube.com/youtubei/v1/like/${t?"":"remove"}like?key=`+a,method:"POST",headers:{origin:"https://www.youtube.com",referer:"https://www.youtube.com/watch?v="+r,"content-type":"application/json","x-goog-authuser":"0","x-goog-visitor-id":o.visitorData,"x-origin":"https://www.youtube.com",authorization:`SAPISIDHASH ${u}_`+sha1(`${u} ${this.#auth.PAPISID} https://www.youtube.com`)},data:JSON.stringify(d)});return"Success"===h?200===(null===f||void 0===f?void 0:f.status)?t&&f.responseText.includes("Added to Liked videos")||!t&&(f.responseText.includes("Removed from Liked videos")||f.responseText.includes("Dislike removed"))?(l.success(),t&&(this.tasks.likes=I([...this.tasks.likes,e])),!0):(l.error(z("tryUpdateYtbAuth"),!0),!1):(l.error(`Error:${null===f||void 0===f?void 0:f.statusText}(${null===f||void 0===f?void 0:f.status})`),!1):(l.error(h+`:${p}(${g})`),!1)}catch(t){return R(t,"Youtube.toggleLikeVideo"),!1}}async toggle(t){var{doTask:e=!0,channelLinks:s=[],videoLinks:t=[]}=t;try{if(!this.#initialized)return j({text:z("needInit")}),!1;const o=[];if(e&&!N.doTask.youtube.channels||!e&&!N.undoTask.youtube.channels)j({type:"globalOptionsSkip",text:"youtube.channels"});else{var i=this.getRealParams("channels",s,e,t=>{var e;return/^https:\/\/(www\.)?google\.com.*?\/url\?.*?url=https:\/\/www\.youtube\.com\/.*/.test(t)?null===(e=t.match(/url=(https:\/\/www\.youtube\.com\/.*)/))||void 0===e?void 0:e[1]:t});if(0<i.length)for(const n of i)o.push(this.#toggleChannel({link:n,doTask:e})),await P(1e3)}if(e&&!N.doTask.youtube.likes||!e&&!N.undoTask.youtube.likes)j({type:"globalOptionsSkip",text:"youtube.likes"});else{var a=this.getRealParams("likes",t,e,t=>{var e;return/^https:\/\/(www\.)?google\.com.*?\/url\?.*?url=https:\/\/www\.youtube\.com\/.*/.test(t)?null===(e=t.match(/url=(https:\/\/www\.youtube\.com\/.*)/))||void 0===e?void 0:e[1]:t});if(0<a.length)for(const r of a)o.push(this.#toggleLikeVideo({link:r,doTask:e})),await P(1e3)}return Promise.all(o).then(()=>!0)}catch(t){return R(t,"Youtube.toggle"),!1}}}var E=JSON.stringify({groups:[],officialGroups:[],wishlists:[],follows:[],forums:[],workshops:[],workshopVotes:[],curators:[],curatorLikes:[],announcements:[],licenses:[],playtests:[]});const F=class extends m{tasks=JSON.parse(E);whiteList={...JSON.parse(E),...null===(x=GM_getValue("whiteList"))||void 0===x?void 0:x.steam};#cache={group:{},officialGroup:{},forum:{},workshop:{},curator:{},...GM_getValue("steamCache")};#auth={};#storeInitialized=!1;#communityInitialized=!1;#area="CN";#areaStatus="end";async init(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"all";try{return"store"===t?!!this.#storeInitialized||(this.#storeInitialized=await this.#updateStoreAuth(),this.#storeInitialized?(j({}).success(z("initSuccess","SteamStore")),!0):(j({}).error(z("initFailed","Steam")),!1)):"community"===t?!!this.#communityInitialized||(this.#communityInitialized=await this.#updateCommunityAuth(),this.#communityInitialized?(j({}).success(z("initSuccess","SteamCommunity")),!0):(j({}).error(z("initFailed","Steam")),!1)):(this.#storeInitialized=await this.#updateStoreAuth(),this.#communityInitialized=await this.#updateCommunityAuth(),this.#storeInitialized&&this.#communityInitialized?(j({}).success(z("initSuccess","Steam")),!0):(j({}).error(z("initFailed","Steam")),!1))}catch(t){return R(t,"Steam.init"),!1}}async#refreshStoreToken(){try{const o=j({text:z("refreshingToken",z("steamStore"))}),n=new FormData;n.append("redir","https://store.steampowered.com/");var t,{result:e,statusText:s,status:i,data:a}=await L({url:"https://login.steampowered.com/jwt/ajaxrefresh",method:"POST",responseType:"json",headers:{Host:"login.steampowered.com",Origin:"https://store.steampowered.com",Referer:"https://store.steampowered.com/"},data:n});return"Success"===e?null!=a&&null!==(t=a.response)&&void 0!==t&&t.success?await this.#setStoreToken(a.response)?(o.success(),!0):(o.error("Error"),!1):(o.error(`Error:${null==a?void 0:a.statusText}(${null==a?void 0:a.status})`),!1):(o.error(e+`:${s}(${i})`),!1)}catch(t){return R(t,"Steam.refreshStoreToken"),!1}}async#setStoreToken(t){try{const o=j({text:z("settingToken",z("steamStore"))}),n=new FormData;n.append("steamID",t.steamID),n.append("nonce",t.nonce),n.append("redir",t.redir),n.append("auth",t.auth);var{result:e,statusText:s,status:i,data:a}=await L({url:"https://store.steampowered.com/login/settoken",method:"POST",headers:{Accept:"application/json, text/plain, */*",Host:"store.steampowered.com",Origin:"https://store.steampowered.com",Referer:"https://store.steampowered.com/login"},data:n});return"Success"===e?200===(null==a?void 0:a.status)?(o.success(),!0):(o.error(`Error:${null==a?void 0:a.statusText}(${null==a?void 0:a.status})`),!1):(o.error(e+`:${s}(${i})`),!1)}catch(t){return R(t,"Steam.setStoreToken"),!1}}async#updateStoreAuth(){try{const s=j({text:z("updatingAuth",z("steamStore"))}),{result:i,statusText:a,status:o,data:n}=await L({url:"https://store.steampowered.com/",method:"GET",headers:{Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9","Cache-Control":"max-age=0","Sec-Fetch-Dest":"document","Sec-Fetch-Mode":"navigate","Upgrade-Insecure-Requests":"1"}});if("Success"!==i)return s.error(i+`:${a}(${o})`),!1;if(200!==(null===n||void 0===n?void 0:n.status))return s.error(`Error:${null===n||void 0===n?void 0:n.statusText}(${null===n||void 0===n?void 0:n.status})`),!1;var t;if(!n.responseText.includes("data-miniprofile="))return await this.#refreshStoreToken(),s.error("Error:"+z("needLoginSteamStore"),!0),!1;var e=null===(t=n.responseText.match(/g_sessionID = "(.+?)";/))||void 0===t?void 0:t[1];return e?(this.#auth.storeSessionID=e,s.success(),!0):(s.error('Error: Get "sessionID" failed'),!1)}catch(t){return R(t,"Steam.updateStoreAuth"),!1}}async#updateCommunityAuth(){try{const n=j({text:z("updatingAuth",z("steamCommunity"))}),{result:r,statusText:c,status:u,data:l}=await L({url:"https://steamcommunity.com/my",method:"GET",headers:{Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9","Cache-Control":"max-age=0","Sec-Fetch-Dest":"document","Sec-Fetch-Mode":"navigate","Upgrade-Insecure-Requests":"1"}});if("Success"!==r)return n.error(r+`:${c}(${u})`),!1;if(200!==(null===l||void 0===l?void 0:l.status))return n.error(`Error:${null===l||void 0===l?void 0:l.statusText}(${null===l||void 0===l?void 0:l.status})`),!1;var t,e,s;if(l.responseText.includes('href="https://steamcommunity.com/login/home/'))return n.error("Error:"+z("needLoginSteamCommunity"),!0),!1;var i=null===(t=l.responseText.match(/g_steamID = "(.+?)";/))||void 0===t?void 0:t[1],a=null===(e=l.responseText.match(/g_sessionID = "(.+?)";/))||void 0===e?void 0:e[1],o=null===(s=l.responseText.match(/steamcommunity.com\/id\/(.+?)\/friends\//))||void 0===s?void 0:s[1];return(i&&(this.#auth.steam64Id=i),o&&(this.#auth.userName=o),a)?(this.#auth.communitySessionID=a,n.success(),!0):(n.error('Error: Get "sessionID" failed'),!1)}catch(t){return R(t,"Steam.updateCommunityAuth"),!1}}async#getAreaInfo(){try{const i=j({text:z("gettingAreaInfo")}),{result:a,statusText:o,status:n,data:r}=await L({url:"https://store.steampowered.com/cart/",method:"GET"});if("Success"!==a)return i.error(a+`:${o}(${n})`),{};if(200!==(null===r||void 0===r?void 0:r.status))return i.error(`Error:${null===r||void 0===r?void 0:r.statusText}(${null===r||void 0===r?void 0:r.status})`),{};var t,e=null===(t=r.responseText.match(/<input id="usercountrycurrency".*?value="(.+?)"/))||void 0===t?void 0:t[1],s=[...r.responseText.matchAll(/<div class="currency_change_option .*?" data-country="(.+?)" >/g)].map(t=>t[1]);return e&&0<s.length?(this.#area=e,i.success(),{currentArea:e,areas:s}):(i.error("Error: get country info filed"),{})}catch(t){return R(t,"Steam.getAreaInfo"),{}}}async#changeArea(e){try{if("waiting"===this.#areaStatus&&await new Promise(t=>{const e=setInterval(()=>{"waiting"!==this.#areaStatus&&(clearInterval(e),t(!0))})}),this.#area===e||!e&&"CN"!==this.#area)return!0;this.#areaStatus="waiting";let t=e;if(!t){const{currentArea:u,areas:l}=await this.#getAreaInfo();if(!u||!l)return!(this.#areaStatus="error");if("CN"!==u)return this.#areaStatus="skip",j({text:"notNeededChangeArea"}),"skip";var s=l.filter(t=>t&&"CN"!==t);if(!s||0===s.length)return this.#areaStatus="noAnotherArea",j({text:"noAnotherArea"}),!1;[t]=s}const c=j({text:z("changingArea",t)});var{result:i,statusText:a,status:o,data:n}=await L({url:"https://store.steampowered.com/account/setcountry",method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},data:$.param({cc:t,sessionid:this.#auth.storeSessionID})});if("Success"!==i)return this.#areaStatus="error",c.error(i+`:${a}(${o})`),"CN";if(200!==(null==n?void 0:n.status)||"true"!==n.responseText)return this.#areaStatus="error",c.error(`Error:${null==n?void 0:n.statusText}(${null==n?void 0:n.status})`),"CN";var r=(await this.#getAreaInfo())["currentArea"];return r===t?(this.#areaStatus="success",c.success(),r):(this.#areaStatus="error",c.error("Error: change country filed"),"CN")}catch(t){return this.#areaStatus="error",R(t,"Steam.changeArea"),!1}}async#joinGroup(t){try{const e=j({type:"joiningSteamGroup",text:t}),{result:s,statusText:i,status:a,data:o}=await L({url:"https://steamcommunity.com/groups/"+t,method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},data:$.param({action:"join",sessionID:this.#auth.communitySessionID})});return"Success"===s?200!==(null===o||void 0===o?void 0:o.status)||o.responseText.includes("grouppage_join_area")?(e.error(`Error:${null===o||void 0===o?void 0:o.statusText}(${null===o||void 0===o?void 0:o.status})`),!1):(e.success(),this.tasks.groups=I([...this.tasks.groups,t]),!0):(e.error(s+`:${i}(${a})`),!1)}catch(t){return R(t,"Steam.joinGroup"),!1}}async#leaveGroup(t){try{if(this.whiteList.groups.includes(t))return j({type:"whiteList",text:"Steam.leaveGroup",id:t}),!0;var e=await this.#getGroupId(t);if(!e)return!1;const s=j({type:"leavingSteamGroup",text:t}),{result:i,statusText:a,status:o,data:n}=await L({url:`https://steamcommunity.com/id/${this.#auth.userName}/home_process`,method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},data:$.param({sessionID:this.#auth.communitySessionID,action:"leaveGroup",groupId:e})});return"Success"===i?200===(null===n||void 0===n?void 0:n.status)&&n.finalUrl.includes("groups")&&0===$(n.responseText.replace(/<img.*?>/g,"").toLowerCase()).find(`a[href='https://steamcommunity.com/groups/${t.toLowerCase()}']`).length?(s.success(),!0):(s.error(`Error:${null===n||void 0===n?void 0:n.statusText}(${null===n||void 0===n?void 0:n.status})`),!1):(s.error(i+`:${a}(${o})`),!1)}catch(t){return R(t,"Steam.leaveGroup"),!1}}async#getGroupId(t){try{const a=j({type:"gettingSteamGroupId",text:t});var e=this.#cache.group[t];if(e)return a.success(),e;const{result:o,statusText:n,status:r,data:c}=await L({url:"https://steamcommunity.com/groups/"+t,method:"GET",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}});if("Success"!==o)return a.error(o+`:${n}(${r})`),!1;if(200!==(null===c||void 0===c?void 0:c.status))return a.error(`Error:${null===c||void 0===c?void 0:c.statusText}(${null===c||void 0===c?void 0:c.status})`),!1;var s,i=null===(s=c.responseText.match(/OpenGroupChat\( '([0-9]+)'/))||void 0===s?void 0:s[1];return i?(this.#setCache("group",t,i),a.success(),i):(a.error(`Error:${c.statusText}(${c.status})`),!1)}catch(t){return R(t,"Steam.getGroupID"),!1}}async#joinOfficialGroup(t){try{const i=j({type:"joiningSteamOfficialGroup",text:t}),{result:a,statusText:o,status:n,data:r}=await L({url:`https://steamcommunity.com/games/${t}?action=join&sessionID=`+this.#auth.communitySessionID,method:"GET",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}});if("Success"!==a)return i.error(a+`:${o}(${n})`),!1;if(200!==(null===r||void 0===r?void 0:r.status)||r.responseText.includes('id="publicGroupJoin"'))return i.error(`Error:${null===r||void 0===r?void 0:r.statusText}(${null===r||void 0===r?void 0:r.status})`),!1;var e;i.success(),this.tasks.officialGroups=I([...this.tasks.officialGroups,t]);var s=null===(e=r.responseText.match(/steam:\/\/friends\/joinchat\/([0-9]+)/))||void 0===e?void 0:e[1];return s&&this.#setCache("officialGroup",t,s),!0}catch(t){return R(t,"Steam.joinOfficialGroup"),!1}}async#leaveOfficialGroup(t){try{if(this.whiteList.officialGroups.includes(t))return j({type:"whiteList",text:"Steam.leaveOfficialGroup",id:t}),!0;var e=await this.#getOfficialGroupId(t);if(!e)return!1;const n=j({type:"leavingSteamOfficialGroup",text:t});var{result:s,statusText:i,status:a,data:o}=await L({url:`https://steamcommunity.com/id/${this.#auth.userName}/home_process`,method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},data:$.param({sessionID:this.#auth.communitySessionID,action:"leaveGroup",groupId:e})});if("Success"!==s)return n.error(s+`:${i}(${a})`),!1;if(200!==(null==o?void 0:o.status))return n.error(`Error:${null==o?void 0:o.statusText}(${null==o?void 0:o.status})`),!1;{const{result:r,statusText:c,status:u,data:l}=await L({url:"https://steamcommunity.com/games/"+t,method:"GET",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}});return"Success"===r?200===(null===l||void 0===l?void 0:l.status)&&l.responseText.includes('id="publicGroupJoin"')?(n.success(),!0):(n.error(`Error:${null===l||void 0===l?void 0:l.statusText}(${null===l||void 0===l?void 0:l.status})`),!1):(n.error(r+`:${c}(${u})`),!1)}}catch(t){return R(t,"Steam.leaveOfficialGroup"),!1}}async#getOfficialGroupId(t){try{const a=j({type:"gettingSteamOfficialGroupId",text:t});var e=this.#cache.officialGroup[t];if(e)return a.success(),e;const{result:o,statusText:n,status:r,data:c}=await L({url:"https://steamcommunity.com/games/"+t,method:"GET",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}});if("Success"!==o)return a.error(o+`:${n}(${r})`),!1;if(200!==(null===c||void 0===c?void 0:c.status))return a.error(`Error:${null===c||void 0===c?void 0:c.statusText}(${null===c||void 0===c?void 0:c.status})`),!1;var s,i=null===(s=c.responseText.match(/steam:\/\/friends\/joinchat\/([0-9]+)/))||void 0===s?void 0:s[1];return i?(this.#setCache("officialGroup",t,i),a.success(),i):(a.error(`Error:${c.statusText}(${c.status})`),!1)}catch(t){return R(t,"Steam.getGroupID"),!1}}async#addToWishlist(t){try{var e;const a=j({type:"addingToWishlist",text:t});var{result:s,data:i}=await L({url:"https://store.steampowered.com/api/addtowishlist",method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},data:$.param({sessionid:this.#auth.storeSessionID,appid:t}),dataType:"json"});if("Success"===s&&200===(null==i?void 0:i.status)&&!0===(null===(e=i.response)||void 0===e?void 0:e.success))return a.success(),this.tasks.wishlists=I([...this.tasks.wishlists,t]),!0;const{result:o,statusText:n,status:r,data:c}=await L({url:"https://store.steampowered.com/app/"+t,method:"GET"});return"Success"===o?200===(null===c||void 0===c?void 0:c.status)?"CN"===this.#area&&c.responseText.includes('id="error_box"')?(a.warning(z("changeAreaNotice")),!!await this.#changeArea()&&await this.#addToWishlist(t)):(!c.responseText.includes('class="queue_actions_ctn"')||!c.responseText.includes('class="already_in_library"'))&&(c.responseText.includes('class="queue_actions_ctn"')&&c.responseText.includes('id="add_to_wishlist_area_success" style="display: none;')||!c.responseText.includes('class="queue_actions_ctn"'))?(a.error(`Error:${c.statusText}(${c.status})`),!1):(a.success(),this.tasks.wishlists=I([...this.tasks.wishlists,t]),!0):(a.error(`Error:${null===c||void 0===c?void 0:c.statusText}(${null===c||void 0===c?void 0:c.status})`),!1):(a.error(o+`:${n}(${r})`),!1)}catch(t){return R(t,"Steam.addToWishlist"),!1}}async#removeFromWishlist(t){try{var e;if(this.whiteList.wishlists.includes(t))return j({type:"whiteList",text:"Steam.removeFromWishlist",id:t}),!0;const o=j({type:"removingFromWishlist",text:t});var{result:s,data:i}=await L({url:"https://store.steampowered.com/api/removefromwishlist",method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},data:$.param({sessionid:this.#auth.storeSessionID,appid:t}),dataType:"json"});if("Success"===s&&200===(null==i?void 0:i.status)&&!0===(null===(e=i.response)||void 0===e?void 0:e.success))return o.success(),!0;const{result:n,statusText:r,status:c,data:u}=await L({url:"https://store.steampowered.com/app/"+t,method:"GET"});if("Success"!==n)return o.error(n+`:${r}(${c})`),!1;if(200!==(null===u||void 0===u?void 0:u.status))return o.error(`Error:${null===u||void 0===u?void 0:u.statusText}(${null===u||void 0===u?void 0:u.status})`),!1;if("CN"===this.#area&&u.responseText.includes('id="error_box"')){o.warning(z("changeAreaNotice"));var a=await this.#changeArea();return a&&"CN"!==a&&"skip"!==a?await this.#removeFromWishlist(t):!1}return u.responseText.includes('class="queue_actions_ctn"')&&(u.responseText.includes("ds_owned_flag ds_flag")||u.responseText.includes("add_to_wishlist_area"))?(o.success(),!0):(o.error(`Error:${u.statusText}(${u.status})`),!1)}catch(t){return R(t,"Steam.removeFromWishlist"),!1}}async#toggleFollowGame(t,e){try{if(!e&&this.whiteList.follows.includes(t))return j({type:"whiteList",text:"Steam.unfollowGame",id:t}),!0;const o=j({type:`${e?"":"un"}followingGame`,text:t}),n={sessionid:this.#auth.storeSessionID,appid:t};e||(n.unfollow="1");var{result:s,data:i}=await L({url:"https://store.steampowered.com/explore/followgame/",method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},data:$.param(n)});if("Success"===s&&200===(null==i?void 0:i.status)&&"true"===i.responseText)return o.success(),!0;var a=await this.#isFollowedGame(t);return"CN"===this.#area&&"areaLocked"===a?(o.warning(z("changeAreaNotice")),!!await this.#changeArea()&&await this.#removeFromWishlist(t)):e===a?(o.success(),e&&(this.tasks.follows=I([...this.tasks.follows,t])),!0):(o.error(`Error:${null==i?void 0:i.statusText}(${null==i?void 0:i.status})`),!1)}catch(t){return R(t,"Steam.toggleFollowGame"),!1}}async#isFollowedGame(t){try{const{result:e,data:s}=await L({url:"https://store.steampowered.com/app/"+t,method:"GET"});return"Success"===e?200===(null===s||void 0===s?void 0:s.status)&&("CN"===this.#area&&s.responseText.includes('id="error_box"')?"areaLocked":"none"!==$(s.responseText.replace(/<img.*?>/g,"")).find(".queue_control_button.queue_btn_follow>.btnv6_blue_hoverfade.btn_medium.queue_btn_active").css("display")):!1}catch(t){return R(t,"Steam.isFollowedGame"),!1}}async#toggleForum(t){var e=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];try{if(!e&&this.whiteList.forums.includes(t))return j({type:"whiteList",text:"Steam.unsubscribeForum",id:t}),!0;const l=await this.#getForumId(t);if(!l)return!1;const d=j({type:`${e?"":"un"}subscribingForum`,text:t});var s,i,[a,o]=l.split("_"),{result:n,statusText:r,status:c,data:u}=await L({url:`https://steamcommunity.com/forum/${a}/General/${e?"":"un"}subscribe/${o||"0"}/`,method:"POST",responseType:"json",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},data:$.param({sessionid:this.#auth.communitySessionID})});return"Success"===n?(200!==(null==u?void 0:u.status)||1!==(null===(s=u.response)||void 0===s?void 0:s.success)&&29!==(null===(i=u.response)||void 0===i?void 0:i.success)?d.error(`Error:${null==u?void 0:u.statusText}(${null==u?void 0:u.status})`):(e&&(this.tasks.forums=I([...this.tasks.forums,t])),d.success()),!0):(d.error(n+`:${r}(${c})`),!0)}catch(t){return R(t,"Steam.toggleForum"),!0}}async#getForumId(t){try{const u=j({type:"gettingForumId",text:t});var e=this.#cache.forum[t];if(e)return u.success(),e;var{result:s,statusText:i,status:a,data:o}=await L({url:`https://steamcommunity.com/app/${t}/discussions/`,method:"GET"});if("Success"!==s)return u.error(s+`:${i}(${a})`),!1;if(200!==(null==o?void 0:o.status))return u.error(`Error:${null==o?void 0:o.statusText}(${null==o?void 0:o.status})`),!1;var n,r,c=null===(n=o.responseText)||void 0===n||null===(r=n.match(/General_([\d]+(_[\d]+)?)/))||void 0===r?void 0:r[1];return c?(this.#setCache("forum",t,c),u.success(),c):(u.error(`Error:${o.statusText}(${o.status})`),!1)}catch(t){return R(t,"Steam.getForumId"),!1}}async#toggleFavoriteWorkshop(t){var e=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];try{if(!e&&this.whiteList.workshops.includes(t))return j({type:"whiteList",text:"Steam.unfavoriteWorkshop",id:t}),!0;var s=await this.#getWorkshopAppId(t);if(!s)return!1;const r=j({type:e?"favoritingWorkshop":"unfavoritingWorkshop",text:t});var{result:i,statusText:a,status:o,data:n}=await L({url:`https://steamcommunity.com/sharedfiles/${e?"":"un"}favorite`,method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},data:$.param({id:t,appid:s,sessionid:this.#auth.communitySessionID})});return"Success"===i?200!==(null==n?void 0:n.status)||n.responseText?(r.error(`Error:${null==n?void 0:n.statusText}(${null==n?void 0:n.status})`),!1):(e&&(this.tasks.workshops=I([...this.tasks.workshops,t])),r.success(),!0):(r.error(i+`:${a}(${o})`),!1)}catch(t){return R(t,"Steam.toggleFavoriteWorkshop"),!1}}async#getWorkshopAppId(t){try{const a=j({type:"gettingWorkshopAppId",text:t});var e=this.#cache.workshop[t];if(e)return a.success(),e;const{result:o,statusText:n,status:r,data:c}=await L({url:"https://steamcommunity.com/sharedfiles/filedetails/?id="+t,method:"GET"});if("Success"!==o)return a.error(o+`:${n}(${r})`),!1;if(200!==(null===c||void 0===c?void 0:c.status))return a.error(`Error:${null===c||void 0===c?void 0:c.statusText}(${null===c||void 0===c?void 0:c.status})`),!1;var s,i=null===(s=c.responseText.match(/<input type="hidden" name="appid" value="([\d]+?)" \/>/))||void 0===s?void 0:s[1];return i?(this.#setCache("workshop",t,i),a.success(),i):(a.error("Error: getWorkshopAppId failed"),!1)}catch(t){return R(t,"Steam.getWorkshopAppId"),!1}}async#voteUpWorkshop(t){try{const n=j({type:"votingUpWorkshop",text:t});var e,{result:s,statusText:i,status:a,data:o}=await L({url:"https://steamcommunity.com/sharedfiles/voteup",method:"POST",responseType:"json",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},data:$.param({id:t,sessionid:this.#auth.communitySessionID})});return"Success"===s?(200===(null==o?void 0:o.status)&&1===(null===(e=o.response)||void 0===e?void 0:e.success)?n.success():n.error(`Error:${null==o?void 0:o.statusText}(${null==o?void 0:o.status})`),!0):(n.error(s+`:${i}(${a})`),!0)}catch(t){return R(t,"Steam.voteupWorkshop"),!0}}async#toggleCurator(t){var e=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];try{if(!e&&this.whiteList.curators.includes(t))return j({type:"whiteList",text:"Steam.unfollowCurator",id:t}),!0;const u=j({type:e?"followingCurator":"unfollowingCurator",text:t});var s,i,a,{result:o,statusText:n,status:r,data:c}=await L({url:"https://store.steampowered.com/curators/ajaxfollow",method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},data:$.param({clanid:t,sessionid:this.#auth.storeSessionID,follow:e}),dataType:"json"});return"Success"===o?200===(null==c?void 0:c.status)&&1===(null===(s=c.response)||void 0===s||null===(i=s.success)||void 0===i?void 0:i.success)?(u.success(),!0):(u.error(`Error:${null==c?void 0:c.statusText}(`+(null==c||null===(a=c.response)||void 0===a?void 0:a.success)||`${null==c?void 0:c.status})`),!1):(u.error(o+`:${n}(${r})`),!1)}catch(t){return R(t,"Steam.toggleCurator"),!1}}async getCuratorId(t,e){try{const o=j({type:"gettingCuratorId",text:t+"/"+e});var s=this.#cache.curator[t+"/"+e];if(s)return o.success(),s;const{result:n,statusText:r,status:c,data:u}=await L({url:`https://store.steampowered.com/${t}/`+e,method:"GET",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}});if("Success"!==n)return o.error(n+`:${r}(${c})`),!1;if(200!==(null===u||void 0===u?void 0:u.status))return o.error(`Error:${null===u||void 0===u?void 0:u.statusText}(${null===u||void 0===u?void 0:u.status})`),!1;var i,a=null===(i=u.responseText.match(/g_pagingData.*?"clanid":([\d]+)/))||void 0===i?void 0:i[1];return a?(this.#setCache("curator",t+"/"+e,a),o.success(),a):(o.error(`Error:${u.statusText}(${u.status})`),!1)}catch(t){return R(t,"Steam.getCuratorID"),!1}}async#toggleCuratorLike(t){var e=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];try{var[s,i]=t.split("/");if(!s||!i)return j({text:z("errorLink",t)}),!1;var a=await this.getCuratorId(s,i);return a?await this.#toggleCurator(a,e):!1}catch(t){return R(t,"Steam.toggleCuratorLike"),!1}}async#getAnnouncementParams(t,e){try{const l=j({type:"gettingAnnouncementParams",text:t,id:e});var s,{result:i,statusText:a,status:o,data:n}=await L({url:`https://store.steampowered.com/events/ajaxgetpartnerevent?appid=${t}&announcement_gid=${e}&lang_list=6_0&last_modified_time=0&origin=https:%2F%2Fstore.steampowered.com&for_edit=false`,method:"GET",responseType:"json",headers:{Host:"store.steampowered.com",Referer:`https://store.steampowered.com/news/app/${t}/view/`+e}});if("Success"!==i)return l.error(i+`:${a}(${o})`),{};if(200!==(null==n?void 0:n.status)||1!==(null==n||null===(s=n.response)||void 0===s?void 0:s.success))return l.error(`Error:${null==n?void 0:n.statusText}(${null==n?void 0:n.status})`),{};var r,{clanid:c,gid:u}=(null===(r=n.response.event)||void 0===r?void 0:r.announcement_body)||{};return c?(l.success(),{clanId:c,gid:u}):(l.error(`Error:${n.statusText}(${n.status})`),{})}catch(t){return R(t,"Steam.likeAnnouncement"),{}}}async#likeAnnouncement(t){try{var[e,s]=t.split("/");if(!e||!s)return j({}).error(z("missParams")+"(id)"),!1;var{clanId:i,gid:a}=await this.#getAnnouncementParams(e,s);if(!i)return!1;const u=j({type:"likingAnnouncement",text:e,id:s});var{result:o,statusText:n,status:r,data:c}=await L({url:"https://store.steampowered.com/updated/ajaxrateupdate/"+(a||s),method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8",Host:"store.steampowered.com",Origin:"https://store.steampowered.com",Referer:`https://store.steampowered.com/news/app/${e}/view/`+s},data:$.param({sessionid:this.#auth.storeSessionID,voteup:1,clanid:i,ajax:1}),dataType:"json"});return"Success"===o?200===(null==c?void 0:c.status)&&1===c.response.success?(u.success(),!0):(u.error(`Error:${null==c?void 0:c.statusText}(${null==c?void 0:c.status})`),!1):(u.error(o+`:${n}(${r})`),!1)}catch(t){return R(t,"Steam.likeAnnouncement"),!1}}async#appid2subid(t){try{const a=j({type:"gettingSubid",text:t}),{result:o,statusText:n,status:r,data:c}=await L({url:"https://store.steampowered.com/app/"+t,method:"GET",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}});if("Success"!==o)return a.error(o+`:${n}(${r})`),!1;if(200!==(null===c||void 0===c?void 0:c.status))return a.error(`Error:${null===c||void 0===c?void 0:c.statusText}(${null===c||void 0===c?void 0:c.status})`),!1;var e;if("CN"===this.#area&&c.responseText.includes('id="error_box"')){a.warning(z("changeAreaNotice"));var s=await this.#changeArea();return s&&"CN"!==s&&"skip"!==s?await this.#appid2subid(t):!1}var i=null===(e=c.responseText.match(/name="subid" value="([\d]+?)"/))||void 0===e?void 0:e[1];return i?(a.success(),i):(a.error(`Error:${c.statusText}(${c.status})`),!1)}catch(t){return R(t,"Steam.appid2subid"),!1}}async#getLicenses(){try{const o=j({text:z("gettingLicenses")});var t,{result:e,statusText:s,status:i,data:a}=await L({url:"https://store.steampowered.com/dynamicstore/userdata/?t="+(new Date).getTime(),method:"GET",responseType:"json"});return"Success"===e?200===(null==a?void 0:a.status)?(o.success(),null===(t=a.response)||void 0===t?void 0:t.rgOwnedPackages):(o.error(`Error:${null==a?void 0:a.statusText}(${null==a?void 0:a.status})`),!1):(o.error(e+`:${s}(${i})`),!1)}catch(t){return R(t,"Steam.getLicenses"),!1}}async#addLicense(t){try{const[a,o]=t.split("-");if("appid"===a){var e=await this.#appid2subid(o);if(!e)return!1;const n=j({type:"addingFreeLicense",text:o});if(!await this.#addFreeLicense(e,n))return!1;const{result:r,statusText:c,status:u,data:l}=await L({url:"https://store.steampowered.com/app/"+o,method:"GET"});return"Success"===r?200===(null===l||void 0===l?void 0:l.status)?l.responseText.includes("ds_owned_flag ds_flag")||l.responseText.includes('class="already_in_library"')?(n.success(),!0):(n.error(`Error:${l.statusText}(${l.status})`),!1):(n.error(`Error:${null===l||void 0===l?void 0:l.statusText}(${null===l||void 0===l?void 0:l.status})`),!1):(n.error(r+`:${c}(${u})`),!1)}if("subid"!==a)return!1;{"CN"===this.#area&&(j({}).success(z("tryChangeAreaNotice")),await this.#changeArea());const d={};var s=o.split(",");for(const p of s){var i=j({type:"addingFreeLicenseSubid",text:p});if(!await this.#addFreeLicense(p,i))return!1;d[p]=i}const h=await this.#getLicenses();if(!h)return!1;for(const g of s)h.includes(parseInt(g,10))?d[g].success():d[g].error();return!0}}catch(t){return R(t,"Steam.addLicense"),!1}}async#addFreeLicense(t,e){try{const i=e||j({type:"addingFreeLicenseSubid",text:t}),{result:a,statusText:o,status:n,data:r}=await L({url:"https://store.steampowered.com/checkout/addfreelicense",method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8",Host:"store.steampowered.com",Origin:"https://store.steampowered.com",Referer:"https://store.steampowered.com/account/licenses/"},data:$.param({action:"add_to_cart",sessionid:this.#auth.storeSessionID,subid:t}),dataType:"json"});if("Success"!==a)return i.error(a+`:${o}(${n})`),!1;if(200!==(null===r||void 0===r?void 0:r.status))return i.error(`Error:${null===r||void 0===r?void 0:r.statusText}(${null===r||void 0===r?void 0:r.status})`),!1;if("CN"===this.#area&&r.responseText.includes('id="error_box"')){i.warning(z("changeAreaNotice"));var s=await this.#changeArea();return s&&"CN"!==s?await this.#addFreeLicense(t):!1}return i.success(),!0}catch(t){return R(t,"Steam.addFreeLicense"),!1}}async#requestPlayTestAccess(t){try{const n=j({type:"requestingPlayTestAccess",text:t});var e,{result:s,statusText:i,status:a,data:o}=await L({url:"https://store.steampowered.com/ajaxrequestplaytestaccess/"+t,method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8",Host:"store.steampowered.com",Origin:"https://store.steampowered.com",Referer:"https://store.steampowered.com/app/"+t},data:$.param({sessionid:this.#auth.storeSessionID}),dataType:"json"});return"Success"===s?200===(null==o?void 0:o.status)&&1===(null==o||null===(e=o.response)||void 0===e?void 0:e.success)?(n.success(),!0):(n.error(`Error:${null==o?void 0:o.statusText}(${null==o?void 0:o.status})`),!1):(n.error(s+`:${i}(${a})`),!1)}catch(t){return R(t,"Steam.requestPlayTestAccess"),!1}}async toggle(t){var{doTask:e=!0,groupLinks:s=[],officialGroupLinks:i=[],wishlistLinks:a=[],followLinks:o=[],forumLinks:n=[],workshopLinks:r=[],workshopVoteLinks:c=[],curatorLinks:u=[],curatorLikeLinks:l=[],announcementLinks:d=[],licenseLinks:h=[],playtestLinks:t=[]}=t;try{if(0<[...s,...i,...n,...r,...c].length&&!this.#communityInitialized)return j({text:z("needInit")}),!1;if(0<[...a,...o,...u,...l,...d,...h,...t].length&&!this.#storeInitialized)return j({text:z("needInit")}),!1;const x=[];if(e&&!N.doTask.steam.groups||!e&&!N.undoTask.steam.groups)j({type:"globalOptionsSkip",text:"steam.groups"});else{var p=this.getRealParams("groups",s,e,t=>{return null===(t=t.match(/groups\/(.+)\/?/))||void 0===t?void 0:t[1]});if(0<p.length)for(const S of p)e?x.push(this.#joinGroup(S)):x.push(this.#leaveGroup(S)),await P(1e3)}if(e&&!N.doTask.steam.officialGroups||!e&&!N.undoTask.steam.officialGroups)j({type:"globalOptionsSkip",text:"steam.officialGroups"});else{var g=this.getRealParams("officialGroups",i,e,t=>{return null===(t=t.match(/games\/(.+)\/?/))||void 0===t?void 0:t[1]});if(0<g.length)for(const L of g)e?x.push(this.#joinOfficialGroup(L)):x.push(this.#leaveOfficialGroup(L)),await P(1e3)}if(e&&!N.doTask.steam.wishlists||!e&&!N.undoTask.steam.wishlists)j({type:"globalOptionsSkip",text:"steam.wishlists"});else{var f=this.getRealParams("wishlists",a,e,t=>{return null===(t=t.match(/app\/([\d]+)/))||void 0===t?void 0:t[1]});if(0<f.length)for(const I of f)e?x.push(this.#addToWishlist(I)):x.push(this.#removeFromWishlist(I)),await P(1e3)}if(e&&!N.doTask.steam.follows||!e&&!N.undoTask.steam.follows)j({type:"globalOptionsSkip",text:"steam.follows"});else{var m=this.getRealParams("follows",o,e,t=>{return null===(t=t.match(/app\/([\d]+)/))||void 0===t?void 0:t[1]});if(0<m.length)for(const G of m)x.push(this.#toggleFollowGame(G,e)),await P(1e3)}if(e&&!N.doTask.steam.forums||!e&&!N.undoTask.steam.forums)j({type:"globalOptionsSkip",text:"steam.forums"});else{var w=this.getRealParams("forums",n,e,t=>{return null===(t=t.match(/app\/([\d]+)/))||void 0===t?void 0:t[1]});if(0<w.length)for(const A of w)x.push(this.#toggleForum(A,e)),await P(1e3)}if(e&&!N.doTask.steam.workshops||!e&&!N.undoTask.steam.workshops)j({type:"globalOptionsSkip",text:"steam.workshops"});else{var v=this.getRealParams("workshops",r,e,t=>{return null===(t=t.match(/\?id=([\d]+)/))||void 0===t?void 0:t[1]});if(0<v.length)for(const _ of v)x.push(this.#toggleFavoriteWorkshop(_,e)),await P(1e3)}if(e&&!N.doTask.steam.workshopVotes)j({type:"globalOptionsSkip",text:"steam.workshopVotes"});else{var k=this.getRealParams("workshopVotes",c,e,t=>{return null===(t=t.match(/\?id=([\d]+)/))||void 0===t?void 0:t[1]});if(e&&0<k.length)for(const C of k)x.push(this.#voteUpWorkshop(C)),await P(1e3)}if(e&&!N.doTask.steam.curators||!e&&!N.undoTask.steam.curators)j({type:"globalOptionsSkip",text:"steam.curators"});else{var y=this.getRealParams("curators",u,e,t=>{return null===(t=t.match(/curator\/([\d]+)/))||void 0===t?void 0:t[1]}),b=this.getRealParams("curatorLikes",l,e,t=>{return null===(t=t.match(/https?:\/\/store\.steampowered\.com\/(.*?)\/([^/?]+)/))||void 0===t?void 0:t.slice(1,3).join("/")});if(0<y.length)for(const O of y)x.push(this.#toggleCurator(O,e)),await P(1e3);if(0<b.length)for(const D of b)x.push(this.#toggleCuratorLike(D,e)),await P(1e3)}if(e&&!N.doTask.steam.announcements)j({type:"globalOptionsSkip",text:"steam.announcements"});else{var T=this.getRealParams("announcements",d,e,t=>{var e;return t.includes("store.steampowered.com")?null===(e=t.match(/store\.steampowered\.com\/news\/app\/([\d]+)\/view\/([\d]+)/))||void 0===e?void 0:e.slice(1,3).join("/"):null===(t=t.match(/steamcommunity\.com\/games\/([\d]+)\/announcements\/detail\/([\d]+)/))||void 0===t?void 0:t.slice(1,3).join("/")});if(e&&0<T.length)for(const E of T)x.push(this.#likeAnnouncement(E)),await P(1e3)}if(e&&!N.doTask.steam.licenses)j({type:"globalOptionsSkip",text:"steam.licenses"});else if(e&&N.doTask.steam.licenses&&0<h.length)for(const F of h)x.push(this.#addLicense(F)),await P(1e3);if(e&&!N.doTask.steam.playtests)j({type:"globalOptionsSkip",text:"steam.playtests"});else{var $=this.getRealParams("playtests",t,e,t=>{return null===(t=t.match(/app\/([\d]+)/))||void 0===t?void 0:t[1]});if(e&&N.doTask.steam.playtests&&0<$.length)for(const V of $)x.push(this.#requestPlayTestAccess(V)),await P(1e3)}return Promise.all(x).then(async()=>("CN"!==this.#area&&(j({}).warning(z("steamFinishNotice")),await this.#changeArea("CN")),!0))}catch(t){return R(t,"Steam.toggle"),!1}}#setCache(t,e,s){try{this.#cache[t][e]=s,GM_setValue("steamCache",this.#cache)}catch(t){R(t,"Steam.setCache")}}};t=class{undoneTasks;socialTasks;giveawayId;socialInitialized={discord:!1,instagram:!1,reddit:!1,twitch:!1,twitter:!1,vk:!1,youtube:!1,steamStore:!1,steamCommunity:!1};initialized=!1;social={};async#bind(e,t){try{return{name:e,result:await t}}catch(t){return R(t,"Website.bind"),{name:e,result:!1}}}async initSocial(t){try{const i=[],a="do"===t?this.undoneTasks:this.socialTasks;var e,s;return a.discord&&(!(0<Object.values(a.discord).reduce((t,e)=>[...t,...e]).length)||this.socialInitialized.discord&&this.social.discord||(this.social.discord=new v,i.push(this.#bind("discord",this.social.discord.init())))),a.instagram&&(!(0<Object.values(a.instagram).reduce((t,e)=>[...t,...e]).length)||this.socialInitialized.instagram&&this.social.instagram||(this.social.instagram=new y,i.push(this.#bind("instagram",this.social.instagram.init())))),a.reddit&&(!(0<Object.values(a.reddit).reduce((t,e)=>[...t,...e]).length)||this.socialInitialized.reddit&&this.social.reddit||(this.social.reddit=new T,i.push(this.#bind("reddit",this.social.reddit.init())))),a.twitch&&(!(0<Object.values(a.twitch).reduce((t,e)=>[...t,...e]).length)||this.socialInitialized.twitch&&this.social.twitch||(this.social.twitch=new S,i.push(this.#bind("twitch",this.social.twitch.init())))),a.twitter&&(!(0<Object.values(a.twitter).reduce((t,e)=>[...t,...e]).length)||this.socialInitialized.twitter&&this.social.twitter||(this.social.twitter=new G,i.push(this.#bind("twitter",this.social.twitter.init())))),a.vk&&(!(0<Object.values(a.vk).reduce((t,e)=>[...t,...e]).length)||this.socialInitialized.vk&&this.social.vk||(this.social.vk=new _,i.push(this.#bind("vk",this.social.vk.init())))),a.youtube&&(!(0<Object.values(a.youtube).reduce((t,e)=>[...t,...e]).length)||this.socialInitialized.youtube&&this.social.youtube||(this.social.youtube=new D,i.push(this.#bind("youtube",this.social.youtube.init())))),!a.steam||0<(e=Object.values(a.steam).reduce((t,e)=>[...t,...e]).length)&&(this.social.steam||(this.social.steam=new F),0<e-(s=Object.keys(a.steam).map(t=>{var e,s;return["groupLinks","officialGroupLinks","forumLinks","workshopLinks","workshopVoteLinks"].includes(t)&&(null===(e=a.steam)||void 0===e||null===(s=e[t])||void 0===s?void 0:s.length)||0}).reduce((t,e)=>t+e,0))&&!this.socialInitialized.steamStore&&i.push(this.#bind("steamStore",this.social.steam.init("store"))),0<s&&!this.socialInitialized.steamCommunity&&i.push(this.#bind("steamCommunity",this.social.steam.init("community")))),a.links&&0<a.links.length&&(this.social.visitLink=o),await Promise.all(i).then(t=>{let e=!0;for(const s of t)s.result?this.socialInitialized[s.name]=s.result:e=!1;return e})}catch(t){return R(t,"Website.initSocial"),!1}}uniqueTasks(t){const e={};for(var[s,i]of Object.entries(t)){e[s]={};for(var[a,o]of Object.entries(i))e[s][a]=I(o)}return e}async toggleTask(t){try{if(!this.initialized&&!this.init())return!1;if(!await this.classifyTask(t))return!1;if(!await this.initSocial(t))return!1;const i=[];var e="do"===t,s=e?this.undoneTasks:this.socialTasks;if("skip"!==this.socialInitialized.discord&&this.social.discord&&i.push(this.social.discord.toggle({doTask:e,...s.discord})),this.social.instagram&&i.push(this.social.instagram.toggle({doTask:e,...s.instagram})),this.social.reddit&&i.push(this.social.reddit.toggle({doTask:e,...s.reddit})),this.social.twitch&&i.push(this.social.twitch.toggle({doTask:e,...s.twitch})),this.social.twitter&&i.push(this.social.twitter.toggle({doTask:e,...s.twitter})),this.social.vk&&i.push(this.social.vk.toggle({doTask:e,...s.vk})),this.social.youtube&&i.push(this.social.youtube.toggle({doTask:e,...s.youtube})),this.social.steam&&i.push(this.social.steam.toggle({doTask:e,...s.steam})),this.social.visitLink&&s.links&&e)for(const a of s.links)i.push(this.social.visitLink(a));return e&&s.extra&&this.extraDoTask&&0<Object.values(s.extra).reduce((t,e)=>[...t,...e]).length&&i.push(this.extraDoTask(s.extra)),await Promise.all(i),j({}).success(z("allTasksComplete")),!0}catch(t){return R(t,"Website.toggleTask"),!1}}async doTask(){try{return await this.toggleTask("do")}catch(t){return R(t,"Website.doTask"),!1}}async undoTask(){try{return await this.toggleTask("undo")}catch(t){return R(t,"Website.undoTask"),!1}}};const V=JSON.stringify({steam:{groupLinks:[],wishlistLinks:[],curatorLinks:[],followLinks:[]},vk:{nameLinks:[]}});s=class extends t{name="FreeAnyWhere";tasks=[];socialTasks=JSON.parse(V);undoneTasks=JSON.parse(V);buttons=["doTask","undoTask","verifyTask","getKey"];static test(){return"freeanywhere.net"===window.location.host}async init(){try{const s=j({text:z("initing")});if(0<$('a[href="#/login"]').length)return window.open("/#/login","_self"),s.warning(z("needLogin")),!1;if(window.location.href.includes("/login"))return s.warning(z("needLogin")),!1;if(!/^https?:\/\/freeanywhere\.net\/#\/giveaway\/[\d]+/.test(window.location.href)){var t,e=null===(t=window.location.href.match(/https?:\/\/freeanywhere\.net\/.*?#\/giveaway\/([\d]+)/))||void 0===t?void 0:t[1];if(!e)return s.error(z("getFailed","Id")),!1;window.location.href="https://freeanywhere.net/#/giveaway/"+e}return this.#getGiveawayId()?(await this.#checkLeftKey()||j({}).warning(z("checkLeftKeyFailed")),this.initialized=!0,s.success(),!0):!1}catch(t){return R(t,"Freeanywhere.init"),!1}}async classifyTask(t){try{const l=j({text:z("getTasksInfo")});var e;"undo"===t&&(this.socialTasks=(null===(e=GM_getValue("fawTasks-"+this.giveawayId))||void 0===e?void 0:e.tasks)||JSON.parse(V));var{result:s,statusText:i,status:a,data:o}=await L({url:`https://freeanywhere.net/api/v1/giveaway/${this.giveawayId}/?format=json`,method:"GET",headers:{authorization:"Token "+window.localStorage.getItem("token"),"x-csrftoken":g.get("csrftoken")},responseType:"json"});if("Success"!==s)return l.error(s+`:${i}(${a})`),!1;var n,r=null==o||null===(n=o.response)||void 0===n?void 0:n.challenges;if(r){"verify"===t&&(this.tasks=[]);for(const d of r){var c=d.challenge,u=d.challenge_provider;const h={id:d.id,title:d.title};if("verify"!==t||d.is_success)switch(u){case"steam":switch(h.social="steam",c){case"WL":"undo"===t&&this.socialTasks.steam.wishlistLinks.push(d.link),"do"!==t||d.is_success||this.undoneTasks.steam.wishlistLinks.push(d.link);break;case"JTG":"undo"===t&&this.socialTasks.steam.groupLinks.push(d.link),"do"!==t||d.is_success||this.undoneTasks.steam.groupLinks.push(d.link);break;case"STC":"undo"===t&&this.socialTasks.steam.curatorLinks.push(d.link),"do"!==t||d.is_success||this.undoneTasks.steam.curatorLinks.push(d.link);break;case"GF":"undo"===t&&this.socialTasks.steam.followLinks.push(d.link),"do"!==t||d.is_success||this.undoneTasks.steam.followLinks.push(d.link)}break;case"vk-oauth2":"undo"===t&&this.socialTasks.vk.nameLinks.push(d.link),"do"!==t||d.is_success||this.undoneTasks.vk.nameLinks.push(d.link);break;case"website":break;default:j({}).warning(z("unKnownTaskType")+": "+u)}else this.tasks.push(h)}return l.success(),this.undoneTasks=this.uniqueTasks(this.undoneTasks),this.socialTasks=this.uniqueTasks(this.socialTasks),window.DEBUG&&console.log("%cAuto-Task[Debug]:","color:blue",JSON.stringify(this)),GM_setValue("fawTasks-"+this.giveawayId,{tasks:this.socialTasks,time:(new Date).getTime()}),!0}return l.error(`Error:${null==o?void 0:o.statusText}(${null==o?void 0:o.status})`),!1}catch(t){return R(t,"Freeanywhere.classifyTask"),!1}}async verifyTask(){try{if(!this.initialized&&!this.init())return!1;if(0===this.tasks.length&&!await this.classifyTask("verify"))return!1;const t=[];for(const e of this.tasks)t.push(this.#verify(e)),await P(1e3);return await Promise.all(t),j({}).success(z("allTasksComplete")),!!await this.getKey(!0)}catch(t){return R(t,"Freeanywhere.verifyTask"),!1}}async getKey(t){try{if(!t&&!this.initialized&&!this.init())return!1;const n=j({text:z("gettingKey")});var e,{result:s,statusText:i,status:a,data:o}=await L({url:`https://freeanywhere.net/api/v1/giveaway/${this.giveawayId}/reward/?format=json`,method:"GET",dataType:"json",headers:{authorization:"Token "+window.localStorage.getItem("token")}});return"Success"===s?null!=o&&null!==(e=o.response)&&void 0!==e&&e.reward?(n.success(),j({}).success(o.response.reward),o.response.reward):(n.error(`Error:${null==o?void 0:o.statusText}(${null==o?void 0:o.status})`),!1):(n.error(s+`:${i}(${a})`),!1)}catch(t){return R(t,"FreeAnyWhere.getGiveawayId"),!1}}#getGiveawayId(){try{var t,e=null===(t=window.location.href.match(/\/giveaway\/([\d]+)/))||void 0===t?void 0:t[1];return e?(this.giveawayId=e,!0):(j({}).error(z("getFailed","GiveawayId")),!1)}catch(t){R(t,"FreeAnyWhere.getGiveawayId")}}async#verify(t){try{const n=j({html:`<li>${z("verifyingTask")}${t.title.trim()}...<font></font></li>`});var e,{result:s,statusText:i,status:a,data:o}=await L({url:`https://freeanywhere.net/api/v1/giveaway/${this.giveawayId}/challenge-status/${t.id}/?format=json`,method:"GET",dataType:"json",headers:{authorization:"Token "+window.localStorage.getItem("token"),"x-csrftoken":g.get("csrftoken")}});return"Success"===s?null!=o&&null!==(e=o.response)&&void 0!==e&&e.status?(n.success(),!0):(n.error(`Error:${null==o?void 0:o.statusText}(${null==o?void 0:o.status})`),!1):(n.error(s+`:${i}(${a})`),!1)}catch(t){return R(t,"Freeanywhere.verify"),!1}}async#checkLeftKey(){try{var t;if(!N.other.checkLeftKey)return!0;var e=(await L({url:"https://freeanywhere.net/api/v1/widget/?format=json",method:"GET",dataType:"json",headers:{authorization:"Token "+window.localStorage.getItem("token")}}))["data"];return null!=e&&null!==(t=e.response)&&void 0!==t&&t.giveaways.find(t=>""+(null==t?void 0:t.id)===this.giveawayId)?!0:(await p().fire({icon:"warning",title:z("notice"),text:z("noKeysLeft"),confirmButtonText:z("confirm"),cancelButtonText:z("cancel"),showCancelButton:!0}).then(t=>{t=t.value;t&&window.close()}),!0)}catch(t){return R(t,"Giveawaysu.checkLeftKey"),!1}}};const U={steam:{groupLinks:[],wishlistLinks:[],curatorLinks:[],curatorLikeLinks:[],followLinks:[],forumLinks:[],announcementLinks:[],workshopVoteLinks:[],playtestLinks:[]},discord:{serverLinks:[]},instagram:{userLinks:[]},vk:{nameLinks:[]},twitch:{channelLinks:[]},reddit:{redditLinks:[]},youtube:{channelLinks:[],likeLinks:[]},twitter:{userLinks:[],retweetLinks:[]}};class M extends t{name="GiveawaySu";socialTasks=U;undoneTasks=U;buttons=["doTask","undoTask"];static test(){return/^https?:\/\/giveaway\.su\/giveaway\/view\/[\d]+/.test(window.location.href)}async after(){try{this.#checkLogin()||j({}).warning(z("checkLoginFailed")),await this.#checkLeftKey()||j({}).warning(z("checkLeftKeyFailed")),j({}).warning(z("gsNotice"))}catch(t){R(t,"Giveawaysu.after")}}init(){try{const t=j({text:z("initing")});return 0<$("a.steam-login").length?(window.open("/steam/redirect","_self"),t.warning(z("needLogin")),!1):!!this.#getGiveawayId()&&(this.initialized=!0,t.success(),!0)}catch(t){return R(t,"Giveawaysu.init"),!1}}async classifyTask(t){try{const i=j({text:z("getTasksInfo")});var e;if("undo"===t)return this.socialTasks=(null===(e=GM_getValue("gasTasks-"+this.giveawayId))||void 0===e?void 0:e.tasks)||U,!0;const a=[];var s=$("#actions tr");$("div.bind-discord").is(":visible")&&$("div.bind-discord a")[0].click(),$("div.bind-twitch").is(":visible")&&$("div.bind-twitch a")[0].click();for(const r of s)a.push(new Promise(e=>{const t=$(r).find('td:not(".hidden")');var s=t.eq(1).find('a:not([data-trigger="link"])'),i=t.eq(2).find('a:not([data-trigger="link"])');const a=0<s.length?s:i,o=t.eq(0).find("i").attr("class")||"",n=a.text().trim();if(o.includes("ban")||/disable adblock/gi.test(n))return e(!0);l(a.attr("href")).then(t=>t?(o.includes("steam")&&/join/gi.test(n)?this.undoneTasks.steam.groupLinks.push(t):/like.*announcement/gi.test(n)?this.undoneTasks.steam.announcementLinks.push(t):/(follow|subscribe).*curator/gim.test(n)&&/^https?:\/\/store\.steampowered\.com\/curator\//.test(t)?this.undoneTasks.steam.curatorLinks.push(t):o.includes("steam")&&/follow|subscribe/gim.test(n)?this.undoneTasks.steam.curatorLikeLinks.push(t):/subscribe.*steam.*forum/gim.test(n)?this.undoneTasks.steam.forumLinks.push(t):o.includes("thumbs-up")&&/^https?:\/\/steamcommunity\.com\/sharedfiles\/filedetails\/\?id=[\d]+/.test(t)?this.undoneTasks.steam.workshopVoteLinks.push(t):o.includes("plus")&&/request.*playtest/gim.test(n)?this.undoneTasks.steam.playtestLinks.push(t):o.includes("discord")||/join.*discord/gim.test(n)?this.undoneTasks.discord.serverLinks.push(t):o.includes("instagram")||/follow.*instagram/gim.test(n)?this.undoneTasks.instagram.userLinks.push(t):o.includes("twitch")||/follow.*twitch.*channel/gim.test(n)?this.undoneTasks.twitch.channelLinks.push(t):o.includes("reddit")||/subscribe.*subreddit/gim.test(n)||/follow.*reddit/gim.test(n)?this.undoneTasks.reddit.redditLinks.push(t):/watch.*art/gim.test(n)?this.undoneTasks.steam.workshopVoteLinks.push(t):/subscribe.*youtube.*channel/gim.test(n)?this.undoneTasks.youtube.channelLinks.push(t):/(watch|like).*youtube.*video/gim.test(n)||(o.includes("youtube")||o.includes("thumbs-up"))&&/(watch|like).*video/gim.test(n)?this.undoneTasks.youtube.likeLinks.push(t):o.includes("vk")||/join.*vk.*group/gim.test(n)?this.undoneTasks.vk.nameLinks.push(t):/(on twitter)|(Follow.*on.*Facebook)/gim.test(n)||(/wishlist.*game|add.*wishlist/gim.test(n)&&this.undoneTasks.steam.wishlistLinks.push(t),/follow.*button/gim.test(n)&&this.undoneTasks.steam.followLinks.push(t)),void e(!0)):e(!1)).catch(t=>(R(t,"Giveawaysu.classifyTask->getRedirectLink"),!1))}));return await Promise.all(a),i.success(),this.undoneTasks=this.uniqueTasks(this.undoneTasks),this.socialTasks=this.undoneTasks,window.DEBUG&&console.log("%cAuto-Task[Debug]:","color:blue",JSON.stringify(this)),GM_setValue("gasTasks-"+this.giveawayId,{tasks:this.socialTasks,time:(new Date).getTime()}),!0}catch(t){return R(t,"Giveawaysu.classifyTask"),!1}}#checkLogin(){try{return N.other.checkLogin?(0<$("a.steam-login").length&&window.open("/steam/redirect","_self"),!0):!0}catch(t){return R(t,"Giveawaysu.checkLogin"),!1}}async#checkLeftKey(){try{return N.other.checkLeftKey?(0<$(".giveaway-ended").length&&0===$(".giveaway-key").length&&await p().fire({icon:"warning",title:z("notice"),text:z("noKeysLeft"),confirmButtonText:z("confirm"),cancelButtonText:z("cancel"),showCancelButton:!0}).then(t=>{t=t.value;t&&window.close()}),!0):!0}catch(t){return R(t,"Giveawaysu.checkLeftKey"),!1}}#getGiveawayId(){var t=null===(t=window.location.href.match(/\/view\/([\d]+)/))||void 0===t?void 0:t[1];return t?(this.giveawayId=t,!0):(j({text:z("getFailed","GiveawayId")}),!1)}}w=class{name="Indiedb";buttons=["doTask"];static test(){return"www.indiedb.com"===window.location.host}async after(){try{this.#checkLogin()||j({}).warning(z("checkLoginFailed")),await this.#checkLeftKey()||j({}).warning(z("checkLeftKeyFailed"))}catch(t){R(t,"Indiedb.after")}}async doTask(){try{return await this.#join()?await this.#do():!1}catch(t){return R(t,"Indiedb.doTask"),!1}}async#join(){try{if(0<$("a.buttonenter:contains(Register to join)").length)return j({}).error(z("needLogin")),!1;const u=$("a.buttonenter.buttongiveaway");if(/join giveaway/gim.test(u.text())){const l=j({text:z("joiningGiveaway")+"..."});var t,e,s,i,a,{result:o,statusText:n,status:r,data:c}=await L({url:u.attr("href"),method:"POST",data:"ajax=t",dataType:"json",headers:{"content-type":"application/x-www-form-urlencoded; charset=UTF-8",accept:"application/json, text/javascript, */*; q=0.01",origin:window.location.origin}});return"Success"===o?200===(null==c?void 0:c.status)?null!==(t=c.response)&&void 0!==t&&t.success?(u.addClass("buttonentered").text("Success - Giveaway joined"),$("#giveawaysjoined").slideDown(),$("#giveawaysrecommend").slideDown(),l.success("Success"+(null!==(i=c.response)&&void 0!==i&&i.text?":"+(null===(a=c.response)||void 0===a?void 0:a.text):"")),!0):(l.error("Error"+(null!==(e=c.response)&&void 0!==e&&e.text?":"+(null===(s=c.response)||void 0===s?void 0:s.text):"")),!1):(l.error(`Error:${null==c?void 0:c.statusText}(${null==c?void 0:c.status})`),!1):(l.error(o+`:${n}(${r})`),!1)}return/success/gim.test($("a.buttonenter.buttongiveaway").text())?!0:(j({}).warning(z("needJoinGiveaway")),!1)}catch(t){return R(t,"Indiedb.init"),!1}}async#do(){try{const e=$("script").map((t,e)=>{var s,i,a,o,n;return/\$\(document\)/gim.test(e.innerHTML)?[null===(s=e.innerHTML.match(/"\/[\d]+"/gim))||void 0===s||null===(i=s[0])||void 0===i||null===(a=i.match(/[\d]+/))||void 0===a?void 0:a[0],null===(e=e.innerHTML.match(/"\/newsletter\/ajax\/subscribeprofile\/optin\/[\d]+"/gim))||void 0===e||null===(o=e[0])||void 0===o||null===(n=o.match(/[\d]+/))||void 0===n?void 0:n[0]]:null});if(2!==e.length)return j({}).error(z("getFailed","TaskId")),!1;{const s=[];for(const t of $("#giveawaysjoined a[class*=promo]")){const a=$(t);if(!a.hasClass("buttonentered")){const o=j({text:`${z("doing")}:${a.parents("p").text()}...`});if(/facebookpromo|twitterpromo|visitpromo/gim.test(t.className)){let t="";t=a.hasClass("facebookpromo")?"facebookpromo":a.hasClass("twitterpromo")?"twitterpromo":"visitpromo",s.push(new Promise(i=>{$.ajax({type:"POST",url:urlPath(`/giveaways/ajax/${t}/`+e[0]),timeout:6e4,dataType:"json",data:{ajax:"t"},error(t,e,s){window.DEBUG&&console.log("%cAuto-Task[Debug]:","color:red",{response:t,error:e,exception:s}),o.error("Error:An error has occurred performing the action requested. Please try again shortly."),i(!0)},success(t){t.success?(o.success("Success:"+t.text),a.addClass("buttonentered").closest("p").html(a.closest("p").find("span").html())):o.error("Error:"+t.text),i(!0)}})}))}else a.hasClass("emailoptinpromo")?s.push(new Promise(i=>{$.ajax({type:"POST",url:urlPath("/newsletter/ajax/subscribeprofile/optin/"+e[1]),timeout:6e4,dataType:"json",data:{ajax:"t",emailsystoggle:4},error(t,e,s){window.DEBUG&&console.log("%cAuto-Task[Debug]:","color:red",{response:t,error:e,exception:s}),o.error("Error:An error has occurred performing the action requested. Please try again shortly."),i(!0)},success(t){t.success?(o.success("Success:"+t.text),a.toggleClass("buttonentered").closest("p").html(a.closest("p").find("span").html())):o.error("Error:"+t.text),i(!0)}})})):a.hasClass("watchingpromo")?s.push(new Promise(i=>{var t;const e=(t=>{try{const i={};return t?t.includes("?")&&t.split("?")[1].replace(/([^?&=]+)=([^&]+)/g,(t,e,s)=>(i[e]=s,t)):window.location.search.replace(/([^?&=]+)=([^&]+)/g,(t,e,s)=>(i[e]=s,t)),i}catch(t){return R(t,"getUrlQuery"),{}}})(a.attr("href"));e.ajax="t",$.ajax({type:"POST",url:urlPath(null===(t=a.attr("href"))||void 0===t?void 0:t.split(/[?#]/)[0]),timeout:6e4,dataType:"json",data:e,error(t,e,s){window.DEBUG&&console.log("%cAuto-Task[Debug]:","color:red",{response:t,error:e,exception:s}),o.error("Error:An error has occurred performing the action requested. Please try again shortly."),i(!0)},success(t){t.success?(o.success("Success:"+t.text),a.toggleClass("buttonentered").closest("p").html(a.closest("p").find("span").html())):o.error("Error:"+t.text),i(!0)}})})):/the-challenge-of-adblock/gim.test(a.attr("href"))?o.error("Error:"+z("unKnownTaskType")):s.push(new Promise(i=>{$.ajax({type:"POST",url:urlPath(a.attr("href")),timeout:6e4,dataType:"json",data:{ajax:"t"},error(t,e,s){window.DEBUG&&console.log("%cAuto-Task[Debug]:","color:red",{response:t,error:e,exception:s}),o.error("Error:An error has occurred performing the action requested. Please try again shortly."),i(!0)},success(t){t.success?(o.success("Success:"+t.text),a.toggleClass("buttonentered").closest("p").html(a.closest("p").find("span").html())):o.error("Error:"+t.text),i(!0)}})}))}}return await Promise.all(s),j({}).success(z("allTasksComplete")),!0}}catch(t){return R(t,"Indiedb.classifyTask"),!1}}#checkLogin(){try{return N.other.checkLogin?(0<$("a.buttonenter:contains(Register to join)").length&&window.open("/members/login","_self"),!0):!0}catch(t){return R(t,"Indiedb.checkLogin"),!1}}async#checkLeftKey(){try{return N.other.checkLeftKey?(0<$('a.buttonenter:contains("next time")，a.buttonenter:contains("Giveaway is closed")').length&&await p().fire({icon:"warning",title:z("notice"),text:z("giveawayEnded"),confirmButtonText:z("confirm"),cancelButtonText:z("cancel"),showCancelButton:!0}).then(t=>{t=t.value;t&&window.close()}),!0):!0}catch(t){return R(t,"Indiedb.checkLeftKey"),!1}}};const B=JSON.stringify({steam:{groupLinks:[],officialGroupLinks:[],wishlistLinks:[],curatorLinks:[]},discord:{serverLinks:[]},extra:{videoTasks:[]},links:[]});A=class extends t{name="Keyhub";socialTasks=JSON.parse(B);undoneTasks=JSON.parse(B);buttons=["doTask","undoTask"];static test(){return"key-hub.eu"===window.location.host}async after(){try{this.#checkLogin()||j({}).warning(z("checkLoginFailed")),await this.#checkLeftKey()||j({}).warning(z("checkLeftKeyFailed")),$(".NSFW").hide()}catch(t){R(t,"Keyhub.after")}}init(){try{const t=j({text:z("initing")});return 0<$('a[href*="/connect/steam"]').length?(window.open("/connect/steam","_self"),t.warning(z("needLogin")),!1):!!this.#getGiveawayId()&&($("#VPNoverlay").hide(),$("#mainArticleSection").show(),this.initialized=!0,t.success(),!0)}catch(t){return R(t,"Keyhub.init"),!1}}async classifyTask(s){try{const o=j({text:z("getTasksInfo")});var t;"undo"===s&&(this.socialTasks=(null===(t=GM_getValue("khTasks-"+this.giveawayId))||void 0===t?void 0:t.tasks)||JSON.parse(B));for(const n of $('.task:not(".googleads")').filter((t,e)=>"do"!==s||0===$(e).find("i.fa-check-circle:visible").length).find("a")){let t=$(n).attr("href");var e,i,a=$(n).text().trim();t&&((/\/away\?data=/.test(t)||/steamcommunity\.com\/gid\//.test(t))&&(t=await l(t)||t),/https?:\/\/key-hub\.eu\/connect\/discord/.test(t)?window.open(t,"_blank"):/steamcommunity\.com\/groups\//.test(t)?("undo"===s&&this.socialTasks.steam.groupLinks.push(t),"do"===s&&this.undoneTasks.steam.groupLinks.push(t)):/steamcommunity\.com\/games\/[\d]+/.test(t)?("undo"===s&&this.socialTasks.steam.officialGroupLinks.push(t),"do"===s&&this.undoneTasks.steam.officialGroupLinks.push(t)):/store\.steampowered\.com\/app\//.test(t)&&/wishlist/gim.test(a)?("undo"===s&&this.socialTasks.steam.wishlistLinks.push(t),"do"===s&&this.undoneTasks.steam.wishlistLinks.push(t)):/store\.steampowered\.com\/curator\//.test(t)?("undo"===s&&this.socialTasks.steam.curatorLinks.push(t),"do"===s&&this.undoneTasks.steam.curatorLinks.push(t)):/^https?:\/\/discord\.com\/invite\//.test(t)?("undo"===s&&this.socialTasks.discord.serverLinks.push(t),"do"===s&&this.undoneTasks.discord.serverLinks.push(t)):/^javascript:videoTask.+/.test(t)?"do"!==s||(i=null===(e=t.match(/javascript:videoTask\('.+?','(.+?)'/))||void 0===e?void 0:e[1])&&this.undoneTasks.extra.videoTasks.push(i):/^https?:\/\/www\.instagram\.com\/.*/.test(t)||/^https?:\/\/twitter\.com\/.*/.test(t)||/^https?:\/\/www\.twitch\.tv\/.*/.test(t)||/^https?:\/\/www\.facebook\.com\/.*/.test(t)||/^https?:\/\/www\.youtube\.com\/.*/.test(t)||/^https?:\/\/store\.steampowered\.com\/developer\//.test(t)||/^https?:\/\/.*?\.itch\.io\/.*/.test(t)||/^https?:\/\/key-hub\.eu.*/.test(t)||/^https?:\/\/store\.steampowered\.com\/app\/.*/.test(t)||/^https?:\/\/qr\.streamelements\.com\/.*/.test(t)||/^https?:\/\/store\.steampowered\.com\/news\/app\/.*/.test(t)||j({}).warning(`${z("unKnownTaskType")}: ${a}(${t})`))}return o.success(),this.undoneTasks=this.uniqueTasks(this.undoneTasks),this.socialTasks=this.uniqueTasks(this.socialTasks),window.DEBUG&&console.log("%cAuto-Task[Debug]:","color:blue",JSON.stringify(this)),GM_setValue("khTasks-"+this.giveawayId,{tasks:this.socialTasks,time:(new Date).getTime()}),!0}catch(t){return R(t,"Keyhub.classifyTask"),!1}}async#doScriptTask(t){try{const o=j({text:z("doingKeyhubTask")});var{result:e,statusText:s,status:i,data:a}=await L({url:"/away?data="+t,method:"GET",headers:{origin:"https://key-hub.eu",referer:"https://key-hub.eu/"}});return"Success"===e?200===(null==a?void 0:a.status)?(o.success(),!0):(o.error(`Error:${null==a?void 0:a.statusText}(${null==a?void 0:a.status})`),!1):(o.error(e+`:${s}(${i})`),!1)}catch(t){return R(t,"Keyhub.doScriptTask"),!1}}async extraDoTask(t){t=t.videoTasks;try{const e=[];for(const s of t)e.push(this.#doScriptTask(s));return Promise.all(e).then(()=>!0)}catch(t){return R(t,"Keyhub.extraDoTask"),!1}}#getGiveawayId(){try{var t,e=null===(t=window.location.href.match(/giveaway\/([\d]+)/))||void 0===t?void 0:t[1];return e?(this.giveawayId=e,!0):(j({}).error(z("getFailed","GiveawayId")),!1)}catch(t){return R(t,"Keyhub.getGiveawayId"),!1}}async#checkLeftKey(){try{return N.other.checkLeftKey?("0"===$("#keysleft").text().trim()&&await p().fire({icon:"warning",title:z("notice"),text:z("noKeysLeft"),confirmButtonText:z("confirm"),cancelButtonText:z("cancel"),showCancelButton:!0}).then(t=>{t=t.value;t&&window.close()}),!0):!0}catch(t){return R(t,"Keyhub.checkLeftKey"),!1}}#checkLogin(){try{return N.other.checkLogin?(0<$('a[href*="/connect/steam"]').length&&window.open("/connect/steam","_self"),!0):!0}catch(t){return R(t,"Keyhub.checkLogin"),!1}}};const K=JSON.stringify({steam:{groupLinks:[],wishlistLinks:[],curatorLinks:[],curatorLikeLinks:[]},twitter:{userLinks:[]},vk:{nameLinks:[]},discord:{serverLinks:[]}});k=class extends t{name="Givekey";tasks=[];socialTasks=JSON.parse(K);undoneTasks=JSON.parse(K);userId;buttons=["doTask","undoTask","verifyTask"];static test(){return"givekey.ru"===window.location.host}async after(){try{await new Promise(t=>{const e=setInterval(()=>{0<$("#navbarDropdown").length&&(clearInterval(e),t(!0))})}),await this.#checkLeftKey()||j({}).warning(z("checkLeftKeyFailed"))}catch(t){return R(t,"Givekey.after"),!1}}init(){try{const e=j({text:z("initing")});if(0<$('a[href*="/auth/steam"]').length)return window.open("/auth/steam","_self"),e.warning(z("needLogin")),!1;if(!this.#getGiveawayId())return!1;var t=$('meta[name="user-id"]').attr("content");return t?(this.userId=t,this.initialized=!0,e.success(),!0):(e.error(z("getFailed",z("userId"))),!1)}catch(t){return R(t,"Givekey.init"),!1}}async classifyTask(e){try{const o=j({text:z("getTasksInfo")});var t;"undo"===e&&(this.socialTasks=(null===(t=GM_getValue("gkTasks-"+this.giveawayId))||void 0===t?void 0:t.tasks)||JSON.parse(K));for(const n of $('.card-body:has("button") .row')){const r=$(n);var s=/Complete/i.test(r.find("button").text().trim());if(!s||"undo"===e){const c=r.find("#task_check");var i=c.attr("data-id");if(i&&this.tasks.push(i),"verify"!==e){let t=r.find("a").attr("href")||null;var a=r.find("a").text().trim();const u=r.find("i");t&&a&&(/^https?:\/\/givekey\.ru\/giveaway\/[\d]+\/execution_task/.test(t)&&(t=await l(t)),t&&(/^https?:\/\/vk\.com\//.test(t)?(this.socialTasks.vk.nameLinks.push(t),"do"!==e||s||this.undoneTasks.vk.nameLinks.push(t)):/^https?:\/\/steamcommunity\.com\/groups/.test(t)?(this.socialTasks.steam.groupLinks.push(t),"do"!==e||s||this.undoneTasks.steam.groupLinks.push(t)):/^https?:\/\/store\.steampowered\.com\/app\//.test(t)?(this.socialTasks.steam.wishlistLinks.push(t),"do"!==e||s||this.undoneTasks.steam.wishlistLinks.push(t)):/Subscribe/gi.test(a)&&u.hasClass("fa-steam-square")?/^https?:\/\/store\.steampowered\.com\/curator\//.test(t)?(this.socialTasks.steam.curatorLinks.push(t),"do"!==e||s||this.undoneTasks.steam.curatorLinks.push(t)):(this.socialTasks.steam.curatorLikeLinks.push(t),"do"!==e||s||this.undoneTasks.steam.curatorLikeLinks.push(t)):/^https?:\/\/twitter\.com\//.test(t)&&/Subscribe/gi.test(a)?(this.socialTasks.twitter.userLinks.push(t),"do"!==e||s||this.undoneTasks.twitter.userLinks.push(t)):u.hasClass("fa-discord")||/^https?:\/\/discord\.com\/invite\//.test(t)?(this.socialTasks.discord.serverLinks.push(t),"do"!==e||s||this.undoneTasks.discord.serverLinks.push(t)):j({}).warning(`${z("unKnownTaskType")}: ${a}(${t})`)))}}}return o.success(),this.tasks=I(this.tasks),this.undoneTasks=this.uniqueTasks(this.undoneTasks),this.socialTasks=this.uniqueTasks(this.socialTasks),window.DEBUG&&console.log("%cAuto-Task[Debug]:","color:blue",JSON.stringify(this)),GM_setValue("gkTasks-"+this.giveawayId,{tasks:this.socialTasks,time:(new Date).getTime()}),!0}catch(t){return R(t,"Givekey.classifyTask"),!1}}async verifyTask(){try{if(!this.initialized&&!this.init())return!1;if(0===this.tasks.length&&!await this.classifyTask("verify"))return!1;j({}).warning(z("giveKeyNoticeBefore"));var e=this.tasks.length;for(let t=0;t<e;t++)await this.#verify(this.tasks[t]),t<e-1&&await P(15e3);return j({}).success(z("allTasksComplete")),j({html:`<li><font class="warning">${z("giveKeyNoticeAfter")}</font></li>`}),!0}catch(t){return R(t,"Givekey.verifyTask"),!1}}async#verify(t){try{const s=j({html:`<li>${z("verifyingTask")}${t}...<font></font></li>`});return await new Promise(e=>{$.ajax({url:"https://givekey.ru/giveaway/task",method:"POST",data:`id=${t}&user_id=`+this.userId,dataType:"json",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:t=>{t.btn&&$(`button[data-id=${this.userId}]`).html(t.btn),"ok"===t.status?($(".task_check_"+t.id).html(`<button class="btn btn-success mb-2 btn-block" disabled>${t.btn}</button>`),s.success(),e(!0)):"end"===t.status?(s.success(),j({}).success(t.key),e(!0)):(s.error("Error:"+t.msg),e(!1))},error:t=>{s.error(`Error:${t.statusText}(${t.status})`),e(!1)}})})}catch(t){return R(t,"Givekey.verify"),!1}}#getGiveawayId(){try{var t,e=null===(t=window.location.href.match(/giveaway\/([\d]+)/))||void 0===t?void 0:t[1];return e?(this.giveawayId=e,!0):(j({text:z("getFailed","GiveawayId")}),!1)}catch(t){return R(t,"Givekey.getGiveawayId"),!1}}async#checkLeftKey(){try{return N.other.checkLeftKey?($("#keys_count").text()||await p().fire({icon:"warning",title:z("notice"),text:z("noKeysLeft"),confirmButtonText:z("confirm"),cancelButtonText:z("cancel"),showCancelButton:!0}).then(t=>{t=t.value;t&&window.close()}),!0):!0}catch(t){return R(t,"Givekey.checkLeftKey"),!1}}};C=class extends M{name="GiveeClub";buttons=["doTask","undoTask","verifyTask"];static test(){return/^https?:\/\/givee\.club\/.*?\/event\/[\d]+/.test(window.location.href)}async after(){try{this.#checkLogin()||j({}).warning(z("checkLoginFailed")),await this.#checkLeftKey()||j({}).warning(z("checkLeftKeyFailed"))}catch(t){R(t,"GiveeClub.after")}}init(){try{const t=j({text:z("initing")});return this.#checkLogin()?!!this.#getGiveawayId()&&(this.initialized=!0,t.success(),!0):(t.warning(z("needLogin")),!1)}catch(t){return R(t,"GiveeClub.init"),!1}}async classifyTask(t){try{const s=j({text:z("getTasksInfo")});var e;if("undo"===t)return this.socialTasks=(null===(e=GM_getValue("gcTasks-"+this.giveawayId))||void 0===e?void 0:e.tasks)||U,!0;const i=[];for(const n of $(".event-actions tr"))i.push(new Promise(e=>{const s=$(n).find(".event-action-label a"),i=$(n).find(".event-action-icon i").attr("class")||"",a=s.text().trim(),o=null===(t=$(n).find("button[data-type]"))||void 0===t?void 0:t.attr("data-type");var t=null===(t=$(n).find(".event-action-buttons .btn-success"))||void 0===t?void 0:t.length;if(i.includes("ban")||/AdBlock/i.test(a)||i.includes("envelope")||t)return e(!0);l(s.attr("href")).then(t=>t?("steam.group.join"===o&&/^https?:\/\/steamcommunity\.com\/groups/.test(t)?this.undoneTasks.steam.groupLinks.push(t):/like.*announcement/gi.test(a)?this.undoneTasks.steam.announcementLinks.push(t):"steam.game.wishlist"===o&&/^https?:\/\/store\.steampowered\.com\/app\//.test(t)?this.undoneTasks.steam.wishlistLinks.push(t):"steam.game.wishlist"===o&&s.attr("data-steam-wishlist-appid")?this.undoneTasks.steam.wishlistLinks.push("https://store.steampowered.com/app/"+s.attr("data-steam-wishlist-appid")):"steam.game.follow"===o&&/^https?:\/\/store\.steampowered\.com\/app\//.test(t)?this.undoneTasks.steam.followLinks.push(t):/^https?:\/\/store\.steampowered\.com\/curator\//.test(t)?this.undoneTasks.steam.curatorLinks.push(t):i.includes("steam")&&/follow|subscribe/gim.test(a)?this.undoneTasks.steam.curatorLikeLinks.push(t):/subscribe.*steam.*forum/gim.test(a)?this.undoneTasks.steam.forumLinks.push(t):i.includes("discord")?this.undoneTasks.discord.serverLinks.push(t):i.includes("instagram")?this.undoneTasks.instagram.userLinks.push(t):i.includes("twitch")?this.undoneTasks.twitch.channelLinks.push(t):i.includes("reddit")?this.undoneTasks.reddit.redditLinks.push(t):/watch.*art/gim.test(a)?this.undoneTasks.steam.workshopVoteLinks.push(t):/subscribe.*youtube.*channel/gim.test(a)?this.undoneTasks.youtube.channelLinks.push(t):/(watch|like).*youtube.*video/gim.test(a)||(i.includes("youtube")||i.includes("thumbs-up"))&&/(watch|like).*video/gim.test(a)?this.undoneTasks.youtube.likeLinks.push(t):i.includes("vk")||/join.*vk.*group/gim.test(a)?this.undoneTasks.vk.nameLinks.push(t):i.includes("twitter")?/https?:\/\/twitter\.com\/[^/]+\/?$/gim.test(t)?this.undoneTasks.twitter.userLinks.push(t):/https?:\/\/twitter\.com\/[^/]+?\/status\/[\d]+/gim.test(t)&&this.undoneTasks.twitter.retweetLinks.push(t):/(on twitter)|(Follow.*on.*Facebook)/gim.test(a)||/follow.*button/gim.test(a)&&this.undoneTasks.steam.followLinks.push(t),void e(!0)):e(!1)).catch(t=>(R(t,"GiveeClub.classifyTask->getRedirectLink"),!1))}));return await Promise.all(i),s.success(),this.undoneTasks=this.uniqueTasks(this.undoneTasks),this.socialTasks=this.undoneTasks,window.DEBUG&&console.log("%cAuto-Task[Debug]:","color:blue",JSON.stringify(this)),GM_setValue("gcTasks-"+this.giveawayId,{tasks:this.socialTasks,time:(new Date).getTime()}),!0}catch(t){return R(t,"GiveeClub.classifyTask"),!1}}async verifyTask(){try{const t=j({text:z("giveeClubVerifyNotice")});for(const e of $(".event-actions tr button").has("i.glyphicon-refresh").not('[data-type="user.adblock"]'))e.click(),"steam.game.wishlist"!==$(e).attr("data-type")&&await P(1e3);return t.warning(z("giveeClubVerifyFinished")),!0}catch(t){return R(t,"Givekey.verifyTask"),!1}}#checkLogin(){try{return N.other.checkLogin?(0<$('a[href*="/account/auth"]').length&&window.open($('a[href*="/account/auth"]').attr("href"),"_self"),!0):!0}catch(t){return R(t,"GiveeClub.checkLogin"),!1}}#getGiveawayId(){var t=null===(t=window.location.href.match(/\/event\/([\d]+)/))||void 0===t?void 0:t[1];return t?(this.giveawayId=t,!0):(j({text:z("getFailed","GiveawayId")}),!1)}async#checkLeftKey(){try{return N.other.checkLeftKey?(0<$(".event-ended").length&&0===$(".event-winner").length&&await p().fire({icon:"warning",title:z("notice"),text:z("giveawayEnded"),confirmButtonText:z("confirm"),cancelButtonText:z("cancel"),showCancelButton:!0}).then(t=>{t=t.value;t&&window.close()}),!0):!0}catch(t){return R(t,"Giveawaysu.checkLeftKey"),!1}}};var b=class{name="OpiumPulses";options={maxPoint:"99999999",...GM_getValue("OpiumPulsesOptions")};maxPoints=99999999;myPoints=0;buttons=["doFreeTask","doPointTask"];static test(){return"www.opiumpulses.com"===window.location.host}async after(){try{this.#checkLogin()||j({}).warning(z("checkLoginFailed")),this.maxPoints=parseInt(this.options.maxPoint,10)}catch(t){R(t,"OpiumPulses.after")}}async doFreeTask(){try{this.#toggleTask("FREE")}catch(t){R(t,"OpiumPulses.doFreeTask")}}async doPointTask(){try{var t;this.myPoints=parseInt((null===(t=$(".page-header__nav-func-user-nav-items.points-items").text().match(/[\d]+/gim))||void 0===t?void 0:t[0])||"0",10),this.#toggleTask("points")}catch(t){R(t,"OpiumPulses.doPointTask")}}async#toggleTask(t){try{for(const l of $(`.giveaways-page-item:contains('${t}'):not(:contains('ENTERED'))`)){var e,s,i,a,o,n,r,c=parseInt((null===(e=$(l).find(".giveaways-page-item-header-points").text().match(/[\d]+/gim))||void 0===e?void 0:e[0])||"999999",10),u=$(l).find(".giveaways-page-item-footer-name").text().trim();if("points"===t&&c>this.myPoints)j({}).warning(z("noPoints")+": "+u);else if("points"!==t||c){if(!("points"===t&&c>this.maxPoints)){const d=j({text:`${z("joiningLottery")}<a href="${$(l).find("a.giveaways-page-item-img-btn-more").attr("href")}" target="_blank">${u}</a>...`}),h=$(l).find("a.giveaways-page-item-img-btn-enter:contains('enter')");if(null===h||void 0===h||null===(s=h.attr("onclick"))||void 0===s||!s.includes("checkUser")||(o=null===(i=h.attr("onclick"))||void 0===i||null===(a=i.match(/[\d]+/))||void 0===a?void 0:a[0])&&checkUser(o),h.attr("href")){const{result:p,statusText:g,status:f,data:m}=await L({url:h.attr("href"),method:"GET"});"Success"===p?null!==m&&void 0!==m&&m.responseText&&/You've entered this giveaway/gim.test(m.responseText)?(d.success(),r=null===(n=m.responseText.match(/Points:[\s]*?([\d]+)/))||void 0===n?void 0:n[1],"points"===t&&r&&(this.myPoints=parseInt(r,10))):d.error(`Error:${null===m||void 0===m?void 0:m.statusText}(${null===m||void 0===m?void 0:m.status})`):d.error(p+`:${g}(${f})`)}else d.error('Error: No "href".')}}else j({}).warning(z("getNeedPointsFailed")+": "+u)}j({text:"-----END-----"})}catch(t){R(t,"OpiumPulses.toggleTask")}}init(){return!0}classifyTask(){return!0}#checkLogin(){try{return N.other.checkLogin?(1<$('a[href*="/site/login"]').length&&window.open("/site/login","_self"),!0):!0}catch(t){return R(t,"OpiumPulses.checkLogin"),!1}}},W=dt(698),Y=dt.n(W);const q={async classify(t){try{return/^https?:\/\/giveaway\.su\/giveaway\/view\/[\d]+/.test(t)?await this.giveawaySu(t):/^https?:\/\/givee\.club\/[\w]+?\/event\/[\d]+/.test(t)?await this.giveeClub(t):/^https?:\/\/gleam\.io\/.+?\/.+/.test(t)?await this.gleam(t):/^https?:\/\/www\.indiedb\.com\/giveaways\/.+/.test(t)?await this.indieDb(t):/^https?:\/\/key-hub\.eu\/giveaway\/[\d]+/.test(t)?await this.keyhub(t):/^https?:\/\/opquests\.com\/quests\/[\d]+/.test(t)?await this.opquests(t):!!/^https?:\/\/itch\.io\/s\/[\d]+?\/.*/.test(t)&&await this.itch(t)}catch(t){return R(t,"leftKeyChecker.classify"),!1}},async giveawaySu(t){try{const{result:e,data:s}=await L({url:t,method:"GET"});return"Success"===e&&200===(null===s||void 0===s?void 0:s.status)?!s.responseText.includes('class="steam-login"')&&(s.responseText.includes('class="giveaway-ended"')?"Ended":"Active"):!1}catch(t){return R(t,"leftKeyChecker.giveawaySu"),!1}},async giveeClub(t){try{const{result:e,data:s}=await L({url:t,method:"GET"});return"Success"===e&&200===(null===s||void 0===s?void 0:s.status)?s.responseText.includes('class="event-winner"')?"Won":s.responseText.includes('class="event-ended"')?"Ended":"Active":!1}catch(t){return R(t,"leftKeyChecker.giveeClub"),!1}},async gleam(t){try{const{result:r,data:c}=await L({url:t,method:"GET"});if("Success"!==r||200!==(null===c||void 0===c?void 0:c.status))return!1;var e,s,i;if(/incentives&quot;:{&quot;[\d]+?&quot;:\[&quot;.+?&quot;\]/.test(c.responseText))return"Won";var a=null===(e=c.responseText.match(/<div class='popup-blocks-container'[\w\W]+?'>/))||void 0===e?void 0:e[0];if(!a)return!1;var o=null===(s=$(a).attr("ng-init"))||void 0===s||null===(i=s.match(/initCampaign\(([\w\W]+?)\)$/))||void 0===i?void 0:i[1];if(!o)return!1;var n=JSON.parse(o)["campaign"];return n.banned?"Banned":n.finished?"Ended":n.paused?"Paused":(new Date).getTime()<1e3*n.starts_at?"NotStart":"Active"}catch(t){return R(t,"leftKeyChecker.gleam"),!1}},async indieDb(t){try{const{result:e,data:s}=await L({url:t,method:"GET"});return"Success"===e&&200===(null===s||void 0===s?void 0:s.status)?s.responseText.includes("Congrats you WON")?"Won":s.responseText.includes("Giveaway is closed")||s.responseText.includes("next time")?"Ended":"Active":!1}catch(t){return R(t,"leftKeyChecker.indieDb"),!1}},async keyhub(t){try{const{result:i,data:a}=await L({url:t,method:"GET"});if("Success"!==i||200!==(null===a||void 0===a?void 0:a.status))return!1;var e,s=null===(e=a.responseText.match(/<span id="keysleft">([\d]+?)<\/span>/))||void 0===e?void 0:e[1];return s?"0"===s?"Ended":`Active(${s})`:!1}catch(t){return R(t,"leftKeyChecker.keyhub"),!1}},async opquests(t){try{const{result:i,data:a}=await L({url:t,method:"GET"});if("Success"!==i||200!==(null===a||void 0===a?void 0:a.status))return 404===(null===a||void 0===a?void 0:a.status)&&"Ended";var e,s=null===(e=a.responseText.match(/<div class="">[\s]*?([\d]+?)[\s]*?of/))||void 0===e?void 0:e[1];return s?"0"===s?"Ended":`Active(${s})`:!1}catch(t){return R(t,"leftKeyChecker.opquests"),!1}},async itch(t){try{const{result:i,data:a}=await L({url:t,method:"GET"});if("Success"!==i||200!==(null===a||void 0===a?void 0:a.status))return!1;var e,s=null===(e=a.responseText.match(/{"start_date":"[0-9A-Z-:]+?".*?"end_date":"([0-9A-Z-:]+?)".*?}/))||void 0===e?void 0:e[1];return s?(new Date).getTime()>new Date(s).getTime()?"Ended":`Active(${Y()(s).format("YYYY-MM-DD HH:mm:ss")})`:!1}catch(t){return R(t,"leftKeyChecker.opquests"),!1}}};const J=JSON.stringify({steam:{groupLinks:[],wishlistLinks:[],curatorLinks:[],curatorLikeLinks:[],followLinks:[],forumLinks:[],announcementLinks:[],workshopVoteLinks:[],licenseLinks:[]},discord:{serverLinks:[]},instagram:{userLinks:[]},vk:{nameLinks:[]},twitch:{channelLinks:[]},reddit:{redditLinks:[]},twitter:{userLinks:[],retweetLinks:[]},youtube:{channelLinks:[],likeLinks:[]}});m=class extends t{name="Keylol";socialTasks=JSON.parse(J);undoneTasks=JSON.parse(J);buttons=["doTask","undoTask","selectAll","selectNone","invertSelect"];static test(){var t;return!!("keylol.com"===window.location.host&&(null!==(t=$(".subforum_left_title_left_up a").eq(3).attr("href"))&&void 0!==t&&t.includes("319")||null!==(t=$(".subforum_left_title_left_up a").eq(3).attr("href"))&&void 0!==t&&t.includes("234")))}init(){return!0}after(){try{var t="Keylol"===this.name?'#postlist>div[id^="post_"]:first':"div.container";const L=$(t);var e=L.find('a[href*="discord.com"]:visible'),s=L.find('a[href*="reddit.com"]:visible'),i=L.find('a[href*="instagram.com"]:visible'),a=L.find('a[href*="twitter.com"]:visible'),o=L.find('a[href*="twitch.tv"]:visible'),n=L.find('a[href*="vk.com"]:visible'),r=L.find('a[href*="store.steampowered.com"]:visible'),c=L.find('a[href*="steamcommunity.com"]:visible'),u=L.find('a[href*="youtube.com"]:visible');if(0<e.length)for(const I of e){var l=$(I).attr("href");l&&/^https?:\/\/discord\.com\/invite\/.+/.test(l)&&this.#addBtn(I,"discord","serverLinks",l)}if(0<s.length)for(const G of s){var d=$(G).attr("href");d&&/^https?:\/\/www\.reddit\.com\/(r|user)\/.+/.test(d)&&this.#addBtn(G,"reddit","redditLinks",d)}if(0<i.length)for(const A of i){var h=$(A).attr("href");h&&/^https:\/\/www\.instagram\.com\/.+/.test(h)&&this.#addBtn(A,"instagram","userLinks",h)}if(0<a.length)for(const _ of a){var p=$(_).attr("href");p&&/^https:\/\/twitter\.com\/.+/.test(p)&&(/https:\/\/twitter\.com\/.*?\/status\/[\d]+/.test(p)?this.#addBtn(_,"twitter","retweetLinks",p):this.#addBtn(_,"twitter","userLinks",p))}if(0<o.length)for(const C of o){var g=$(C).attr("href");g&&/^https:\/\/(www\.)?twitch\.tv\/.+/.test(g)&&this.#addBtn(C,"twitch","channelLinks",g)}if(0<n.length)for(const O of n){var f=$(O).attr("href");f&&/^https:\/\/vk\.com\/.+/.test(f)&&this.#addBtn(O,"vk","nameLinks",f)}if(0<r.length)for(const D of r){var m=$(D).attr("href");m&&(/curator\/[\d]+/.test(m)?this.#addBtn(D,"steam","curatorLinks",m):/(publisher|developer|franchise)\/.+/.test(m)?this.#addBtn(D,"steam","curatorLikeLinks",m):/news(hub)?\/app\/[\d]+\/view\/[\d]+/.test(m)?this.#addBtn(D,"steam","announcementLinks",m):/app\/[\d]+/.test(m)&&(this.#addBtn(D,"steam","followLinks",m),this.#addBtn(D,"steam","wishlistLinks",m)))}if(0<c.length)for(const E of c){var w=$(E).attr("href");w&&(/groups\/.+/.test(w)?this.#addBtn(E,"steam","groupLinks",w):/announcements\/detail\/[\d]+/.test(w)&&this.#addBtn(E,"steam","announcementLinks",w))}if(0<u.length)for(const F of u){var v=$(F).attr("href");v&&(this.#addBtn(F,"youtube","channelLinks",v),this.#addBtn(F,"youtube","likeLinks",v))}var k=L.find('a[href*="giveaway.su/giveaway/view/"]:visible,a[href*="givee.club/"]:visible,a[href*="gleam.io/"]:visible,a[href*="www.indiedb.com/giveaways/"]:visible,a[href*="key-hub.eu/giveaway/"]:visible,a[href*="opquests.com/quests/"]:visible,a[href*="itch.io/s/"]:visible');if(0<k.length)for(const V of k){const P=$(V).attr("href");P&&q.classify(P).then(t=>{t&&(/^Active/.test(t)?$(`a[href="${P}"]`).after(`<font class="auto-task-giveaway-status active" title="${z("Active")}">${t}</font>`):$(`a[href="${P}"]`).after(`<font class="auto-task-giveaway-status not-active" title="${z(t)}">${t}</font>`))}).catch(t=>{R(t,"keylol.after -> leftKeyChecker")})}if("Keylol"===this.name){var y=L.find('a[href^="#asf"]:visible');if(0<y.length)for(const j of y){const N=$(j).attr("href");N&&this.#addBtn($(`a[href="${N}"]`).after('<span style="color: #ccc; margin: 0 -5px 0 5px"> | </span>').next()[0],"steam","licenseLinks","appid-"+N.replace("#asf",""))}var b,T,x=L.find('a[href*="steamdb.info/sub/"]:visible');if(0<x.length)for(const U of x){const M=$(U).attr("href");M&&((T=null===(b=M.match(/^https:\/\/steamdb\.info\/sub\/([\d]+)/))||void 0===b?void 0:b[1])&&this.#addBtn(U,"steam","licenseLinks","subid-"+T))}var S=L.find('.blockcode:contains("addlicense"):visible');if(0<S.length)for(const B of S){const K=B.innerText.match(/[\d]+/g);K&&0!==K.length&&this.#addBtn($(B).children("em")[0],"steam","licenseLinks","subid-"+K.join(","))}}}catch(t){R(t,"keylol.after")}}classifyTask(t){try{this.socialTasks=JSON.parse(J),this.undoneTasks=JSON.parse(J);for(const a of $('.auto-task-keylol[selected="selected"]:visible')){const o=$(a);var e=o.attr("data-social"),s=o.attr("data-type"),i=o.attr("data-link");e&&s&&i&&("do"===t&&this.undoneTasks[e][s].push(i),"undo"===t&&this.socialTasks[e][s].push(i))}return this.undoneTasks=this.uniqueTasks(this.undoneTasks),this.socialTasks=this.uniqueTasks(this.socialTasks),window.DEBUG&&console.log("%cAuto-Task[Debug]:","color:blue",JSON.stringify(this)),!0}catch(t){return R(t,"Keylol.classifyTask"),!1}}selectAll(){try{$(".auto-task-keylol:visible").attr("selected","selected")}catch(t){R(t,"Keylol.selectAll")}}selectNone(){try{$(".auto-task-keylol:visible").removeAttr("selected")}catch(t){R(t,"Keylol.selectNone")}}invertSelect(){try{$(".auto-task-keylol:visible").each((t,e)=>{e.getAttribute("selected")?e.removeAttribute("selected"):e.setAttribute("selected","selected")})}catch(t){R(t,"Keylol.invertSelect")}}#addBtn(t,e,s,i){try{$(t).after('<a href="javascript:void(0);" class="auto-task-keylol" target="_self"'+" onclick=\"this.getAttribute('selected') ? this.removeAttribute('selected') : this.setAttribute('selected', 'selected')\""+` data-social="${e}" data-type="${s}" data-link="${i}">${s.replace("Links","")}</a>`)}catch(t){R(t,"keylol.addBtn")}}};E=class extends t{name="Opquests";undoneTasks={steam:{groupLinks:[],wishlistLinks:[],followLinks:[],curatorLikeLinks:[]}};buttons=["doTask","verifyTask","getKey"];static test(){return"opquests.com"===window.location.host}async after(){try{this.#checkLogin()||j({}).warning(z("checkLoginFailed"))}catch(t){R(t,"Opquests.after")}}init(){try{const t=j({text:z("initing")});return 0<$('a[href*="/auth/redirect"]').length?(window.open("/auth/redirect","_self"),t.warning(z("needLogin")),!1):!!this.#getGiveawayId()&&(this.initialized=!0,t.success(),!0)}catch(t){return R(t,"Opquests.init"),!1}}async classifyTask(t){try{if("undo"===t)return j({text:z("cannotUndo")}),!1;const i=j({text:z("getTasksInfo")});for(const a of $('.w-full:contains("Validate") .items-center')){var e=$(a).find('a:contains("Open")').attr("href"),s=$(a).find("div").eq(1).text().trim();e&&(/steamcommunity\.com\/groups\//.test(e)?this.undoneTasks.steam.groupLinks.push(e):/store\.steampowered\.com\/app\//.test(e)?/wishlist/gim.test(s)?this.undoneTasks.steam.wishlistLinks.push(e):/follow/gim.test(s)&&this.undoneTasks.steam.followLinks.push(e):/store\.steampowered\.com\/(publisher|developer|curator)\//.test(e)&&/follow/gim.test(s)?this.undoneTasks.steam.curatorLikeLinks.push(e):j({}).warning(z("unKnownTaskType")+`: ${s}(${e})`))}return i.success(),this.undoneTasks=this.uniqueTasks(this.undoneTasks),window.DEBUG&&console.log("%cAuto-Task[Debug]:","color:blue",JSON.stringify(this)),!0}catch(t){return R(t,"Opquests.classifyTask"),!1}}async verifyTask(){try{var t=$.makeArray($("div.w-full").find(".items-center").has("button.submit-loader")).map(t=>({token:$(t).find('input[name="_token"]').val(),taskId:$(t).find('input[name="task_id"]').val(),title:$(t).find("span.text-sm").text().trim()}));const e=[];for(const s of t)e.push(this.#verify(s)),await P(1e3);return(await Promise.all(e),j({}).success(z("allTasksComplete")),await this.getKey())?!0:(window.location.reload(),!1)}catch(t){return R(t,"Opquests.verifyTask"),!1}}async#verify(t){try{const u=j({html:`<li>${z("verifyingTask")}${t.title.trim()}...<font></font></li>`});var e,s,i,{result:a,statusText:o,status:n,data:r}=await L({url:"https://opquests.com/entries",method:"POST",dataType:"json",nochche:!0,headers:{origin:"https://opquests.com",pragma:"no-cache",referer:window.location.href,"content-type":"application/x-www-form-urlencoded"},data:`_token=${t.token}&task_id=`+t.taskId});if("Success"!==a)return u.error(a+`:${o}(${n})`),!1;if(null!=r&&null!==(e=r.responseText)&&void 0!==e&&e.includes("Successfully completed task")||null!=r&&null!==(s=r.responseText)&&void 0!==s&&s.includes("unlocked the key"))return u.success(),!0;var c=null===(i=$((null==r?void 0:r.responseText)||"").find('button[data-clipboard-text]:contains("Copy")').attr("data-clipboard-text"))||void 0===i?void 0:i.trim();return c?(u.success(),j({}).success(c),!0):(u.error(`Error:${null==r?void 0:r.statusText}(${null==r?void 0:r.status})`),!1)}catch(t){return R(t,"Opquests.verify"),!1}}async getKey(t){try{const n=j({text:z("gettingKey")});var{result:e,statusText:s,status:i,data:a}=await L({url:"https://opquests.com/keys",method:"GET"});if("Success"!==e)return n.error(e+`:${s}(${i})`),!1;if(null!=a&&a.responseText){var o=$(null==a?void 0:a.responseText).find(`div.items-center:contains("${$("h1.font-bold").text().trim().replace(" Quest","")}")`).find("div.font-bold").next().text();return o?(n.success(),j({}).success(o),!0):(n.error("Error: Key was not found"),t&&window.open("https://opquests.com/keys","_self"),!1)}return n.error(`Error:${null==a?void 0:a.statusText}(${null==a?void 0:a.status})`),!1}catch(t){return R(t,"Opquests.getGiveawayId"),!1}}#getGiveawayId(){try{var t,e=null===(t=window.location.href.match(/quests\/([\d]+)/))||void 0===t?void 0:t[1];return e?(this.giveawayId=e,!0):(j({}).error(z("getFailed","GiveawayId")),!1)}catch(t){return R(t,"Opquests.getGiveawayId"),!1}}#checkLogin(){try{return N.other.checkLogin?(0<$('a[href*="/auth/redirect"]').length&&window.open("/auth/redirect","_self"),!0):!0}catch(t){return R(t,"Opquests.checkLogin"),!1}}};const H=JSON.stringify({steam:{groupLinks:[],wishlistLinks:[],followLinks:[],curatorLinks:[],curatorLikeLinks:[]},twitter:{userLinks:[],retweetLinks:[]},twitch:{channelLinks:[]},discord:{serverLinks:[]},youtube:{channelLinks:[]},extra:{gleam:[]}});function X(n){try{const r=(t=>{try{const i={};for(var[e,s]of Object.entries(Z))i[e]={...s,...t[e]};return i}catch(t){return R(t,"assignWhiteList"),Z}})(GM_getValue("whiteList")||{});let t=`<form id="whiteListForm" class="auto-task-form">
  <table class="auto-task-table"><thead><tr><td>${z("website")}</td><td>${z("type")}</td><td>${z("edit")}</td></tr></thead><tbody>`;for(const[i,a]of Object.entries(r))t+=Object.keys(a).map((t,e)=>{var s;return null!==(s=tt[i])&&void 0!==s&&s.includes(t)?"":`<tr style="background-color: ${c(i)}66">${0===e?`<th rowspan="${Object.keys(a).length-(tt[i]||[]).length}" style="background-color: ${c(i)}66">${i}</th>`:""}<td>${z(t)}</td><td><button type="button" class="editWhiteList" data-value="${i}.${t}">${z("edit")}</button></td></tr>`}).join("");t+="</tbody></table></form>","swal"===n?p().fire({title:z("whiteListOptions"),html:t,showConfirmButton:!1,showCloseButton:!0}):$("body").append(`<h2>${z("whiteList")}</h2>`+t),$(".editWhiteList").on("click",function(){var t;const e=$(this).attr("data-value");if(e){const[a,o]=e.split(".");null!==r&&void 0!==r&&null!==(t=r[a])&&void 0!==t&&t[o]?(p().fire({title:z("changeWhiteListOption",e),input:"textarea",html:`<input id="socialLink" class="swal2-input" placeholder="在此处输入链接获取id">
        <button id="link2id" data-type="${e}" class="swal2-confirm swal2-styled">获取id</button>
        <p style="margin-bottom:0 !important;">在下方填写白名单，每行一个</p>`,inputValue:r[a][o].join("\n"),showConfirmButton:!0,confirmButtonText:z("save"),showCancelButton:!0,cancelButtonText:z("close"),showDenyButton:!0,denyButtonText:z("return")}).then(t=>{let{isDenied:e,isConfirmed:s,value:i}=t;e?"swal"===n&&X(n):s&&(r[a][o]=i.split("\n"),GM_setValue("whiteList",r),p().fire({title:z("changeWhiteListSuccess"),icon:"success"}))}),$("#link2id").on("click",async function(){var t=$(this).attr("data-type");$("#socialLink").val(await async function(e){var s,i,a,o,n,r,c,u,l,d,h,p,g,f,m,w;try{const y=$("#socialLink").val();let t="";switch(e){case"discord.servers":t=(null===(s=y.match(/invite\/(.+)/))||void 0===s?void 0:s[1])||"";break;case"instagram.users":t=(null===(i=y.match(/https:\/\/www\.instagram\.com\/(.+)?\//))||void 0===i?void 0:i[1])||"";break;case"twitch.channels":t=(null===(a=y.match(/https:\/\/(www\.)?twitch\.tv\/(.+)/))||void 0===a?void 0:a[2])||"";break;case"twitter.users":t=(null===(o=y.match(/https:\/\/twitter\.com\/(.+)/))||void 0===o?void 0:o[1])||"";break;case"twitter.retweets":t=(null===(n=y.match(/https:\/\/twitter\.com\/.*?\/status\/([\d]+)/))||void 0===n?void 0:n[1])||"";break;case"vk.names":t=(null===(r=y.match(/https:\/\/vk\.com\/([^/]+)/))||void 0===r?void 0:r[1])||"";break;case"youtube.channels":t=(null===(c=await O(y,"channel"))||void 0===c||null===(u=c.params)||void 0===u?void 0:u.channelId)||"";break;case"youtube.likes":t=(null===(l=await O(y,"likeVideo"))||void 0===l||null===(d=l.params)||void 0===d?void 0:d.videoId)||"";break;case"reddit.reddits":t=(null===(h=y.match(/https?:\/\/www\.reddit\.com\/user\/([^/]*)/))||void 0===h?void 0:h[1])||(null===(p=y.match(/https?:\/\/www\.reddit\.com\/r\/([^/]*)/))||void 0===p?void 0:p[1])||"";break;case"steam.groups":t=(null===(g=y.match(/groups\/(.+)\/?/))||void 0===g?void 0:g[1])||"";break;case"steam.wishlists":case"steam.follows":case"steam.forums":t=(null===(f=y.match(/app\/([\d]+)/))||void 0===f?void 0:f[1])||"";break;case"steam.workshops":t=(null===(m=y.match(/\?id=([\d]+)/))||void 0===m?void 0:m[1])||"";break;case"steam.curators":if(y.includes("curator"))t=(null===(w=y.match(/curator\/([\d]+)/))||void 0===w?void 0:w[1])||"";else{var v,k=null===(v=y.match(/https?:\/\/store\.steampowered\.com\/(.*?)\/([^/?]+)/))||void 0===v?void 0:v.slice(1,3);if(!k||2!==k.length)break;const b=new F;await b.init()&&(t=await b.getCuratorId(k[0],k[1])||"")}}return t}catch(t){return R(t,"link2id"),z("getFailed","id")}}(t))})):j({}).warning(z("whiteListNotFound",e))}})}catch(t){R(t,"whiteListOptions")}}async function Q(t,e,s){var i=3<arguments.length&&void 0!==arguments[3]&&arguments[3];try{const h=j({text:z("gettingData")});var{result:a,statusText:o,status:n,data:r}=await L({url:"https://api.github.com/gists/"+e,headers:{Accept:"application/vnd.github.v3+json",Authorization:"token "+t},responseType:"json",method:"GET",timeout:3e4});if("Success"!==a)return h.error(a+`:${o}(${n})`),!1;if(200!==(null==r?void 0:r.status))return h.error(`Error:${null==r?void 0:r.statusText}(${null==r?void 0:r.status})`),!1;{var c,u,l,d=null===(c=r.response)||void 0===c||null===(u=c.files)||void 0===u||null===(l=u[s])||void 0===l?void 0:l.content;let t;if(!d)return h.error("Error:"+z("noRemoteData")),!1;if(i)return h.success(),!0;try{t=JSON.parse(d)}catch(t){return h.error("Error:"+z("errorRemoteDataFormat")),!1}return h.success(),t}}catch(t){return R(t,"getGistData"),!1}}const Z={discord:{servers:[]},instagram:{users:[]},twitch:{channels:[]},twitter:{users:[],retweets:[],likes:[]},vk:{names:[]},youtube:{channels:[],likes:[]},reddit:{reddits:[]},steam:{groups:[],officialGroups:[],wishlists:[],follows:[],forums:[],workshops:[],curators:[],workshopVotes:[],curatorLikes:[],announcements:[],licenses:[],playtests:[]}},tt={steam:["workshopVotes","curatorLikes","announcements"],twitter:["likes"]},et=X,st=()=>{try{var{TOKEN:t,GIST_ID:e,FILE_NAME:s,SYNC_HISTORY:i}=GM_getValue("gistOptions")||{TOKEN:"",GIST_ID:"",FILE_NAME:"",SYNC_HISTORY:!0};p().fire({title:z("gistOptions"),html:`<p>Github Token<input id="github-token" class="swal2-input" placeholder="Github Token" value="${t}"></p>`+`<p>Gist ID<input id="gist-id" class="swal2-input" placeholder="Gist ID" value="${e}"></p>`+`<p>${z("fileName")}<input id="file-name" class="swal2-input" placeholder="${z("fileName")}" value="${s}"></p>`+'<p><label for="sync-history" class="swal2-checkbox-custom" style="display: flex;">'+`<input id="sync-history" type="checkbox"${i?' checked="checked"':""}/>`+`<span class="swal2-label">${z("syncHistory")}</span></label></p>`+`<p><button id="upload-data" type="button" class="swal2-confirm swal2-styled" style="display: inline-block;">
      ${z("upload2gist")}</button>`+`<button id="download-data" type="button" class="swal2-confirm swal2-styled" style="display: inline-block;">
      ${z("downloadFromGist")}</button></p>`,focusConfirm:!1,showLoaderOnConfirm:!0,footer:`<a href="https://auto-task-doc.js.org/guide/#%E6%95%B0%E6%8D%AE%E5%90%8C%E6%AD%A5" target="_blank">${z("help")}</a>`,preConfirm:async()=>{var t=$("#github-token").val(),e=$("#gist-id").val(),s=$("#file-name").val(),i=$("#sync-history").prop("checked");return GM_setValue("gistOptions",{TOKEN:t,GIST_ID:e,FILE_NAME:s,SYNC_HISTORY:i}),Q(t,e,s,!0)},allowOutsideClick:()=>!p().isLoading(),confirmButtonText:z("saveAndTest"),showCancelButton:!0,cancelButtonText:z("close")}).then(t=>{t=t.value;t?p().fire({icon:"success",title:z("testSuccess")}).then(st):void 0!==t&&p().fire({icon:"error",title:z("testFailed")}).then(st)}),$("#upload-data").on("click",async()=>{var{TOKEN:t,GIST_ID:e,FILE_NAME:s}=GM_getValue("gistOptions")||{};if(!(t&&e&&s))return p().fire({icon:"error",title:z("saveAndTestNotice")}).then(st);p().fire({icon:"info",title:z("processingData")});const i={};var a=GM_listValues(),o=$("#sync-history").prop("checked");for(const n of a)"gistOptions"===n||/^[\w]+?Auth$/.test(n)||!o&&/^[\w]+?Tasks-/.test(n)||(i[n]=GM_getValue(n));p().update({icon:"info",title:z("updatingData")}),await(async(t,e,s,i)=>{try{const d=j({text:z("settingData")});var a,o,n=JSON.stringify({files:{[s]:{content:JSON.stringify(i)}}}),{result:r,statusText:c,status:u,data:l}=await L({url:"https://api.github.com/gists/"+e,headers:{Accept:"application/vnd.github.v3+json",Authorization:"token "+t},data:n,responseType:"json",method:"POST",timeout:3e4});return"Success"===r?200===(null==l?void 0:l.status)&&(null===(a=l.response.files)||void 0===a||null===(o=a[s])||void 0===o?void 0:o.content)===JSON.stringify(i)?(d.success(),!0):(d.error(`Error:${null==l?void 0:l.statusText}(${null==l?void 0:l.status})`),!1):(d.error(r+`:${c}(${u})`),!1)}catch(t){return R(t,"setGistData"),!1}})(t,e,s,i)?p().fire({icon:"success",title:z("syncDataSuccess")}):p().fire({icon:"error",title:z("syncDataFailed")})}),$("#download-data").on("click",async()=>{var{TOKEN:t,GIST_ID:e,FILE_NAME:s}=GM_getValue("gistOptions")||{};if(!(t&&e&&s))return p().fire({icon:"error",title:z("saveAndTestNotice")}).then(st);p().fire({icon:"info",title:z("downloadingData")});s=await Q(t,e,s);if(!s)return p().fire({icon:"error",title:z("checkedNoData")}).then(st);p().update({icon:"info",title:z("savingData")});var i,a,o=$("#sync-history").prop("checked");for([i,a]of Object.entries(s))!o&&/^[\w]+?Tasks-/.test(i)||GM_setValue(i,a);p().fire({icon:"success",title:z("syncDataSuccess")})})}catch(t){R(t,"syncOptions")}};x=st;const it=[s,M,w,A,k,C,b,m,E,class extends t{name="Gleam";undoneTasks=JSON.parse(H);socialTasks=JSON.parse(H);options={vlootUsername:"",gameroundUsername:"",...GM_getValue("GleamOptions")};buttons=["doTask","undoTask","verifyTask"];static test(){return"gleam.io"===window.location.host}async after(){try{if(window.location.search.includes("8b07d23f4bfa65f9")){const s=setInterval(()=>{0<$(".entry-content .entry-method i.fa-check").length&&(clearInterval(s),window.close())});for(const i of $(".entry-content .entry-method")){const a=$(i).find(".user-links"),o=$(i).find(".expandable");var t=o.find("a.btn,a:contains(Continue),button:contains(Continue)");if(0<t.length)for(const n of t){const r=$(n);var e=r.attr("href");r.removeAttr("href")[0].click(),r.attr("href",e),await P(1e3)}a[0].click(),await P(1e3)}j({}).warning(z("gleamTaskNotice"))}else await this.#checkLeftKey()||j({}).warning(z("checkLeftKeyFailed"))}catch(t){return R(t,"Gleam.after"),!1}}init(){try{const t=j({text:z("initing")});return this.#getGiveawayId()?(this.initialized=!0,t.success(),!0):!1}catch(t){return R(t,"Gleam.init"),!1}}async classifyTask(e){try{const g=j({text:z("getTasksInfo")});var t,s;"undo"===e&&(this.socialTasks=(null===(t=GM_getValue("gleamTasks-"+this.giveawayId))||void 0===t?void 0:t.tasks)||JSON.parse(H));for(const f of $(".entry-content .entry-method")){const m=$(f);if("do"!==e||0!==m.find("i.fa-question").length){const w=m.find(".icon-wrapper i"),v=m.find(".user-links"),k=v.text().trim(),y=m.find(".expandable");var i,a,o,n,r,c=y.find("a.btn");if(0<c.length)for(const b of c){const T=$(b);var u=T.attr("href");T.removeAttr("href")[0].click(),T.attr("href",u)}if(w.hasClass("fa-twitter")){var l=m.find('a[href^="https://twitter.com/"]').attr("href");l&&(/follow/gi.test(k)?("undo"===e&&this.socialTasks.twitter.userLinks.push(l),"do"===e&&this.undoneTasks.twitter.userLinks.push(l)):/retweet/gim.test(k)&&("undo"===e&&this.socialTasks.twitter.retweetLinks.push(l),"do"===e&&this.undoneTasks.twitter.retweetLinks.push(l)))}else if(w.hasClass("fa-twitch"))!/follow/gim.test(k)||(i=m.find('a[href^="https://twitch.tv/"]').attr("href"))&&("undo"===e&&this.socialTasks.twitch.channelLinks.push(i),"do"===e&&this.undoneTasks.twitch.channelLinks.push(i));else if(w.hasClass("fa-discord")){if(/join/gim.test(k)){let t=m.find('a[href^="https://discord.com/invite/"]').attr("href");if(!t){var d,h,p=null===(d=m.find('a[href^="https://discord.gg/"]').attr("href"))||void 0===d||null===(h=d.match(/discord\.gg\/([^/]+)/))||void 0===h?void 0:h[1];if(!p)continue;t="https://discord.com/invite/"+p}"undo"===e&&this.socialTasks.discord.serverLinks.push(t),"do"===e&&this.undoneTasks.discord.serverLinks.push(t)}}else if(!w.hasClass("fa-external-link-square-alt"))if(w.hasClass("fa-youtube"))!/subscribe/gim.test(k)||(a=m.find('a[href^="https://www.youtube.com/channel/"]').attr("href"))&&("undo"===e&&this.socialTasks.youtube.channelLinks.push(a),"do"===e&&this.undoneTasks.youtube.channelLinks.push(a));else if(null!==(s=w.attr("class"))&&void 0!==s&&s.includes("steam"))/join.*group/gi.test(k)?(o=m.find('a[href^="https://steamcommunity.com/groups/"]').attr("href"))&&("undo"===e&&this.socialTasks.steam.groupLinks.push(o),"do"===e&&this.undoneTasks.steam.groupLinks.push(o)):!/follow.*curator/gi.test(k)||(n=m.find('a[href^="https://store.steampowered.com/curator/"]').attr("href"))&&("undo"===e&&this.socialTasks.steam.curatorLinks.push(n),"do"===e&&this.undoneTasks.steam.curatorLinks.push(n));else if(w.hasClass("fa-shield")&&k.includes("vloot.io")||w.hasClass("fa-tiktok"))for(const x of y.find("span:contains(Continue),button:contains(Continue)"))x.click(),await P(500),y.find("input").val(this.options.vlootUsername);else if(w.hasClass("fa-gamepad-alt")&&k.includes("Gameround"))for(const S of y.find("span:contains(Continue),button:contains(Continue)"))S.click(),await P(500),y.find("input").val(this.options.gameroundUsername);else w.hasClass("fa-bullhorn")&&/Complete/gi.test(k)?"do"!==e||(r=await this.#getGleamLink(k))&&this.undoneTasks.extra.gleam.push(r):w.hasClass("fa-question")||w.hasClass("fa-reddit")||w.hasClass("fa-instagram")||w.hasClass("fa-facebook-f")||w.hasClass("fa-telegram-plane")||w.hasClass("fa-envelope")||w.hasClass("fa-gift")||w.hasClass("fa-shield")&&k.includes("Check out")||j({}).warning(z("unKnownTaskType")+": "+k)}}return g.success(),this.undoneTasks=this.uniqueTasks(this.undoneTasks),this.socialTasks=this.uniqueTasks(this.socialTasks),window.DEBUG&&console.log("%cAuto-Task[Debug]:","color:blue",JSON.stringify(this)),GM_setValue("gleamTasks-"+this.giveawayId,{tasks:this.socialTasks,time:(new Date).getTime()}),!0}catch(t){return R(t,"Gleam.classifyTask"),!1}}async extraDoTask(t){t=t.gleam;try{const e=[];for(const s of t)e.push(this.#doGleamTask(s));return Promise.all(e).then(()=>!0)}catch(t){return R(t,"Gleam.extraDoTask"),!1}}async verifyTask(){try{j({text:z("verifyingTask")+"..."});for(const t of $(".entry-content .entry-method")){const e=$(t);if(0!==e.find("i.fa-question").length){const s=e.find(".user-links");s[0].click(),await P(500),await this.#checkSync();for(const i of e.find(".expandable").find("span:contains(Continue),button:contains(Continue)"))i.click(),await P(500),await this.#checkSync()}}j({text:z("verifiedGleamTasks")})}catch(t){return R(t,"Gleam.verifyTask"),!1}}async#checkSync(){try{return await new Promise(t=>{const e=setInterval(()=>{0===$(".entry-content .entry-method i.fa-sync").length&&(clearInterval(e),t(!0))},500)})}catch(t){return R(t,"Gleam.checkSync"),!1}}async#doGleamTask(e){try{const s=j({text:z("doingGleamTask")});return await new Promise(t=>{GM_openInTab(e+"?8b07d23f4bfa65f9",{active:!0,insert:!0,setParent:!0}).onclose=()=>{s.success(),t(!0)}})}catch(t){return R(t,"Gleam.doGleamTask"),!1}}#getGiveawayId(){try{var t=window.location.pathname;return t?(this.giveawayId=t,!0):(j({text:z("getFailed","GiveawayId")}),!1)}catch(t){return R(t,"Gleam.getGiveawayId"),!1}}async#getGleamLink(e){try{const a=j({text:z("gettingGleamLink")}),{result:o,statusText:n,status:r,data:c}=await L({url:"https://www.vloot.io/api/v1/giveaways",method:"GET",responseType:"json"});if("Success"!==o)return a.error(o+`:${n}(${r})`),!1;var t,s;if(200===(null===c||void 0===c?void 0:c.status)&&!0===(null===c||void 0===c||null===(t=c.response)||void 0===t?void 0:t.Success)&&null!==c&&void 0!==c&&null!==(s=c.response)&&void 0!==s&&s.Data){var i=(c.response.Data.find(t=>e.replace(/[\s]/g,"").toLowerCase().includes(t.title.replace(/[\s]/g,"").toLowerCase()))||{})["link"];return i?(a.success(),i):(a.error("Error:"+z("getLinkFailed")),!1)}return a.error(`Error:${null===c||void 0===c?void 0:c.statusText}(${null===c||void 0===c?void 0:c.status})`),!1}catch(t){return R(t,"Gleam.getGleamLink"),!1}}async#checkLeftKey(){try{var e,s,i,a;if(!N.other.checkLeftKey)return!0;var o=null===(e=$("div.popup-blocks-container").attr("ng-init"))||void 0===e||null===(s=e.match(/initCampaign\(([\w\W]+?)\)$/))||void 0===s?void 0:s[1];if(!o)return!1;var n,r,c,u,{campaign:l,incentive:d}=JSON.parse(o),h=null===(i=$("div.campaign.reward").attr("ng-init"))||void 0===i||null===(a=i.match(/initContestant\(([\w\W]+?)\);/))||void 0===a?void 0:a[1];let t=!1;return h&&null!==(n=JSON.parse(h).contestant)&&void 0!==n&&null!==(r=n.claims)&&void 0!==r&&null!==(c=r.incentives)&&void 0!==c&&null!==(u=c[d.id])&&void 0!==u&&u.length&&(t=!0),(l.banned||l.finished&&!t||l.paused||(new Date).getTime()<1e3*l.starts_at)&&await p().fire({icon:"warning",title:z("notice"),text:z("giveawayNotWork"),confirmButtonText:z("confirm"),cancelButtonText:z("cancel"),showCancelButton:!0}).then(t=>{t=t.value;t&&window.close()}),!0}catch(t){return R(t,"Gleam.checkLeftKey"),!1}}},class extends t{name="SweepWidget";options={username:"",email:"",...GM_getValue("SweepWidgetOptions")};buttons=["doTask"];static test(){return/^https?:\/\/sweepwidget\.com\/view\/[\d]+/.test(window.location.href)}async after(){try{this.#checkLogin()||j({}).warning(z("checkLoginFailed"))}catch(t){R(t,"SweepWidget.after")}}init(){try{const t=j({text:z("initing")});return this.#checkLogin()?!!this.#getGiveawayId()&&(this.initialized=!0,t.success(),!0):(t.warning(z("needLogin")),!1)}catch(t){return R(t,"SweepWidget.init"),!1}}classifyTask(){return!0}async doTask(){try{if(0===$("#unlock_rewards_main_wrapper").length&&(0<$('input[name="sw__login_name"]:visible').length&&$('input[name="sw__login_name"]').val(this.options.username),0<$('input[name="sw__login_email"]:visible').length&&$('input[name="sw__login_email"]').val(this.options.email),0<$("#sw_login_button:visible").length&&$("#sw_login_button")[0].click(),!await this.#checkEnter()))return!1;const i=j({text:z("SweepWidgetNotice")});var t,e;for(const a of $("#sw_inner_entry_methods_l2_wrapper>div.sw_entry")){const o=$(a);if(!(0<o.find("i.fa-check:visible").length)){const n=o.find(".sw_text_inner");n[0].click();const r=o.find("a.sw_link");var s=r.attr("href");r.attr("href","#a").attr("target","_self"),null!==(t=r[0])&&void 0!==t&&t.click(),await P(300),r.attr("href",s).attr("target","_blank"),o.find('input[type="text"]').val("test");const c=o.find("input.sw_verify");!0===c.prop("disabled")&&(n[0].click(),await P(300),n[0].click(),await P(300)),null!==(e=o.find("input.sw_verify").removeAttr("disabled")[0])&&void 0!==e&&e.click(),await this.#checkFinish(o),await P(parseInt(""+(2001*Math.random()+1e3),10))}}return i.success(),!0}catch(t){return R(t,"SweepWidget.doTask"),!1}}#checkLogin(){try{return 0<$("#twitter_login_button").length&&$("#twitter_login_button")[0].click(),!0}catch(t){return R(t,"SweepWidget.checkLogin"),!1}}#getGiveawayId(){try{var t,e=null===(t=window.location.href.match(/\/view\/([\d]+)/))||void 0===t?void 0:t[1];return e?(this.giveawayId=e,!0):(j({text:z("getFailed","GiveawayId")}),!1)}catch(t){return R(t,"SweepWidget.getGiveawayId"),!1}}async#checkEnter(){try{return new Promise(t=>{const e=setInterval(()=>{0<$("#unlock_rewards_main_wrapper").length&&(clearInterval(e),t(!0))})})}catch(t){return R(t,"SweepWidget.checkEnter"),!1}}async#checkFinish(s){try{return new Promise(t=>{const e=setInterval(()=>{(0<s.find("i.fa-check:visible").length||0===s.find(".sw_entry_input:visible").length)&&(clearInterval(e),t(!0))})})}catch(t){return R(t,"SweepWidget.checkFinish"),!1}}},class{name="Setting";buttons=["saveGlobalOptions","syncData","tasksHistory"];syncData=x;tasksHistory(){window.open("https://auto-task-v4.hclonely.com/history.html","_blank")}static test(){return"auto-task-v4.hclonely.com"===window.location.host&&"/setting.html"===window.location.pathname}before(){$("body").html("").addClass("auto-task-options")}after(){try{this.#environment(),f("page"),et("page"),$('input[name="other.twitterVerifyId"]').after(`<button id="getTwitterUserId" type="button">${z("getTwitterUserId")}</button>`),$("#getTwitterUserId").on("click",()=>{this.#getId("twitterUser")}),$('input[name="other.youtubeVerifyChannel"]').after(`<button id="getYoutubeChannelId" type="button">${z("getYoutubeChannelId")}</button>`),$("#getYoutubeChannelId").on("click",()=>{this.#getId("youtubeChannel")}),$('input[name^="position"]').on("input",function(){var t="rightleft",e="topbottpm";switch($(this).attr("name").replace("position.","")){case"buttonSideX":case"buttonSideY":case"buttonDistance":{const c=$('input[name="position.buttonDistance"]').val();var s=$('input[name="position.buttonSideX"]').val(),i=$('input[name="position.buttonSideY"]').val();if(!["right","left"].includes(s))break;if(!["top","bottom"].includes(i))break;if(!/^[\d]+?,[\d]+$/.test(c))break;var a=c.split(",");$("#auto-task-buttons").css(s,a[0]+"px").css(i,a[1]+"px").css(t.replace(s,""),"").css(e.replace(i,""),"");break}case"showButtonSideX":case"showButtonSideY":case"showButtonDistance":{const u=$('input[name="position.showButtonDistance"]').val();var o=$('input[name="position.showButtonSideX"]').val(),n=$('input[name="position.showButtonSideY"]').val();if(!["right","left"].includes(o))break;if(!["top","bottom"].includes(n))break;if(!/^[\d]+?,[\d]+$/.test(u))break;var r=u.split(",");$("div.show-button-div").css(o,r[0]+"px").css(n,r[1]+"px").css(t.replace(o,""),"").css(e.replace(n,""),"");break}case"logSideX":case"logSideY":case"logDistance":{const l=$('input[name="position.logDistance"]').val();r=$('input[name="position.logSideX"]').val(),o=$('input[name="position.logSideY"]').val();if(!["right","left"].includes(r))break;if(!["top","bottom"].includes(o))break;if(!/^[\d]+?,[\d]+$/.test(l))break;n=l.split(",");$("#auto-task-info").css(r,n[0]+"px").css(o,n[1]+"px").css(t.replace(r,""),"").css(e.replace(o,""),"");break}}}),$('input[name^="hotKey"]').attr("readonly","readonly").off("keydown").on("keydown",function(t){let e="";t.altKey?e+="alt + ":t.ctrlKey?e+="ctrl + ":t.shiftKey&&(e+="shift + "),$(this).val(e+(1===t.key.length?t.key.toLowerCase():""))})}catch(t){R(t,"Setting.after")}}saveGlobalOptions(){u()}#getId(t){try{p().fire({title:z("getId",z(t)),html:`<input id="socialLink" class="swal2-input" placeholder="在此处输入链接获取id">
        <button id="link2id" data-type="${t}" class="swal2-confirm swal2-styled">获取id</button>`,showCancelButton:!0,cancelButtonText:z("close"),showConfirmButton:!1}),$("#link2id").on("click",async function(){const t=$("#socialLink").val();var e,s,i,a;t&&("twitterUser"===(e=$(this).attr("data-type"))?(s=(null===(s=t.match(/https:\/\/twitter\.com\/(.+)/))||void 0===s?void 0:s[1])||t,$("#socialLink").val(await(new G).userName2id(s)||"")):"youtubeChannel"===e&&(a=/^https:\/\/(www\.)?google\.com.*?\/url\?.*?url=https:\/\/www.youtube.com\/.*/.test(t)?null===(a=t.match(/url=(https:\/\/www\.youtube\.com\/.*)/))||void 0===a?void 0:a[1]:t,$("#socialLink").val((null===(a=await O(a,"channel"))||void 0===a||null===(i=a.params)||void 0===i?void 0:i.channelId)||"")))})}catch(t){R(t,"Setting.getId")}}#environment(){try{var t=(0,a.ua)(),e=`<form id="environmentForm" class="auto-task-form">
        <table class="auto-task-table"><thead><tr><td>${z("type")}</td><td>${z("name")}</td><td>${z("version")}</td></tr></thead><tbody>
        <tr><td>${z("os")}</td><td>${t.os}</td><td>${t.osVersion}</td></tr>
        <tr><td>${z("browser")}</td><td>${t.browserZH}</td><td>${t.browserVersion}</td></tr>
        <tr><td>${z("scriptManager")}</td><td>${GM_info.scriptHandler}</td><td>${GM_info.version}</td></tr>
        <tr><td>${z("script")}</td><td>${GM_info.script.name}</td><td>${GM_info.script.version}</td></tr>
        </tbody></table></form>`;$("body").append(`<h2>${z("environment")}</h2>`+e)}catch(t){R(t,"Setting.environment")}}},class extends m{name="History";buttons=["doTask","undoTask","selectAll","selectNone","invertSelect","clearHistory"];static test(){return"auto-task-v4.hclonely.com"===window.location.host&&"/history.html"===window.location.pathname}before(){try{$("body").html('<div class="container"></div>').addClass("auto-task-history");const t=GM_listValues()||[];for(const e of t.map(t=>/^[\w]+?Tasks-/.test(t)?t:null).filter(t=>t))this.#addItem(e)}catch(t){R(t,"History.before")}}clearHistory(){try{const t=GM_listValues()||[];for(const e of t.map(t=>/^[\w]+?Tasks-/.test(t)?t:null).filter(t=>t))GM_deleteValue(e);p().fire({title:z("clearHistoryFinished"),icon:"success"})}catch(t){R(t,"History.after")}}#addItem(i){try{var a=GM_getValue(i);if(null==a||!a.tasks)return;let t="",e="",s="";var o,n,[r,c]=i.split("-");switch(r){case"fawTasks":e=`Freeanywhere[${c}]`,s="https://freeanywhere.net/#/giveaway/"+c;break;case"gasTasks":e=`Giveawaysu[${c}]`,s="https://giveaway.su/giveaway/view/"+c;break;case"gcTasks":e=`GiveeClub[${c}]`,s="https://givee.club/event/"+c;break;case"gkTasks":e=`Givekey[${c}]`,s="https://givekey.ru/giveaway/"+c;break;case"gleamTasks":e=`Gleam[${c}]`,s="https://gleam.io"+c;break;case"khTasks":e=`keyhub[${c}]`,s="https://key-hub.eu/giveaway/"+c;break;case"prysTasks":e=`Prys[${c}]`,s="https://prys.revadike.com/giveaway/?id="+c;break;default:return}for([o,n]of Object.entries(a.tasks))for(var[u,l]of Object.entries(n))for(const d of l)t+=`<li><font class="auto-task-capitalize">${o}.${z(u.replace("Link",""))}: </font><a href="${d}" target="_blank">${55<d.length?d.slice(0,55)+"...":d}</a></li>`;$(".container").append(`<div class="card" data-name="${i}"><div class="title"><a href="${s}" target="_blank">${e}</a><span class="delete-task" data-name="${i}" title="${z("deleteTask")}"><svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2734" width="32" height="32"><path d="M607.897867 768.043004c-17.717453 0-31.994625-14.277171-31.994625-31.994625L575.903242 383.935495c0-17.717453 14.277171-31.994625 31.994625-31.994625s31.994625 14.277171 31.994625 31.994625l0 351.94087C639.892491 753.593818 625.61532 768.043004 607.897867 768.043004z" p-id="2735" fill="#d81e06"></path><path d="M415.930119 768.043004c-17.717453 0-31.994625-14.277171-31.994625-31.994625L383.935495 383.935495c0-17.717453 14.277171-31.994625 31.994625-31.994625 17.717453 0 31.994625 14.277171 31.994625 31.994625l0 351.94087C447.924744 753.593818 433.647573 768.043004 415.930119 768.043004z" p-id="2736" fill="#d81e06"></path><path d="M928.016126 223.962372l-159.973123 0L768.043004 159.973123c0-52.980346-42.659499-95.983874-95.295817-95.983874L351.94087 63.989249c-52.980346 0-95.983874 43.003528-95.983874 95.983874l0 63.989249-159.973123 0c-17.717453 0-31.994625 14.277171-31.994625 31.994625s14.277171 31.994625 31.994625 31.994625l832.032253 0c17.717453 0 31.994625-14.277171 31.994625-31.994625S945.73358 223.962372 928.016126 223.962372zM319.946246 159.973123c0-17.545439 14.449185-31.994625 31.994625-31.994625l320.806316 0c17.545439 0 31.306568 14.105157 31.306568 31.994625l0 63.989249L319.946246 223.962372 319.946246 159.973123 319.946246 159.973123z" p-id="2737" fill="#d81e06"></path><path d="M736.048379 960.010751 288.123635 960.010751c-52.980346 0-95.983874-43.003528-95.983874-95.983874L192.139761 383.591466c0-17.717453 14.277171-31.994625 31.994625-31.994625s31.994625 14.277171 31.994625 31.994625l0 480.435411c0 17.717453 14.449185 31.994625 31.994625 31.994625l448.096758 0c17.717453 0 31.994625-14.277171 31.994625-31.994625L768.215018 384.795565c0-17.717453 14.277171-31.994625 31.994625-31.994625s31.994625 14.277171 31.994625 31.994625l0 479.231312C832.032253 916.835209 789.028725 960.010751 736.048379 960.010751z" p-id="2738" fill="#d81e06"></path></svg></span></div><ul>${t}</ul><span class="time">${z("lastChangeTime")}: ${W(a.time).format("YYYY-MM-DD HH:mm:ss")}</span></div>`),$("span.delete-task").on("click",function(){var t=$(this).attr("data-name");t?(GM_deleteValue(t),$(`div.card[data-name="${t}"]`).remove(),p().fire({title:z("clearTaskFinished"),text:t,icon:"success"})):p().fire({title:z("clearTaskFailed"),icon:"error"})})}catch(t){R(t,"History.addItem")}}}];const at=function(e,s){try{let t=`<form id="websiteOptionsForm" class="auto-task-form">
  <table class="auto-task-table"><thead><tr><td>${z("option")}</td><td>${z("value")}</td></tr></thead><tbody>`;for(var[i,a]of Object.entries(s))t+=`<tr><td>${i}</td><td><input class="editOption" type="text" name="${i}" value="${a}"/></td></tr>`;t+="</tbody></table></form>",p().fire({title:z("websiteOptions"),html:t,showConfirmButton:!0,confirmButtonText:z("save"),showCancelButton:!0,cancelButtonText:z("close")}).then(t=>{t=t.isConfirmed;t&&($("#websiteOptionsForm").serializeArray().map(t=>(s[t.name]=t.value,t)),GM_setValue(e+"Options",s),p().fire({title:z("changeWebsiteOptionsSuccess"),icon:"success"}))})}catch(t){R(t,"websiteOptions")}};var m=keyboardJS,ot=dt.n(m);const nt=async(t,e)=>{try{var s,i=t+"package.json?time="+(new Date).getTime(),{result:a,statusText:o,status:n,data:r}=await L({url:i,responseType:"json",method:"GET",timeout:3e4});return"Success"===a?null!=r&&null!==(s=r.response)&&void 0!==s&&s.version?r.response:(e||j({}).error(`${z("checkUpdateFailed")}[${null==r?void 0:r.statusText}(${null==r?void 0:r.status})]`),!1):(e||j({}).error(z("checkUpdateFailed")+`[${a}:${o}(${n})]`),!1)}catch(t){return R(t,"checkUpdate"),!1}};const rt=async()=>{try{var i,a=GM_info.script.version,o=N.other.autoUpdateSource.toLowerCase(),n={github:"https://github.com/HCLonely/auto-task-new/raw/main/",jsdelivr:"https://cdn.jsdelivr.net/gh/HCLonely/auto-task-v4@main/",standby:"https://auto-task-v4.hclonely.com/"};let t,e="",s;["github","jsdelivr","standby"].includes(o)?(e=n[o],s=await nt(e,!1)):(e=n.github,s=await nt(e,!0),s||(e=n.jsdelivr,s=await nt(e,!0),s||(e=n.standby,s=await nt(e,!0)))),s?t=s.version||a:(t=a,j({}).error(z("checkUpdateFailed"))),s&&((t,e)=>{try{const[c]=t.split("-"),[u,l]=e.split("-");if(l&&!N.other.receivePreview)return!1;var[s,i,a]=c.split(".").map(t=>parseInt(t,10)),[o,n,r]=u.split(".").map(t=>parseInt(t,10));return s<o?!0:!(o<s)&&(i<n||!(n<i)&&a<r)}catch(t){return R(t,"compareVersion"),!1}})(a,t)&&(j({html:`<li><font>${z("newVersionNotice",t,`${e}dist/${GM_info.script.name}.user.js`)}</font></li>`}),j({html:`<li>${z("updateText",t)}</li><ol class="update-text">${null===(i=s.change)||void 0===i?void 0:i.map(t=>`<li>${t}</li>`).join("")}<li>${z("updateHistory")}</li></ol>`}))}catch(t){R(t,"updateChecker")}};window.STYLE=GM_addStyle(e.Z+GM_getResourceText("style")),window.DEBUG=!(null===(e=N.other)||void 0===e||!e.debug),window.TRACE=!(null===(e=N.other)||void 0===e||!e.debug)&&"function"==typeof console.trace;var ct,ut,e=async()=>{var e,s;if("www.twitch.tv"!==window.location.hostname||"#auth"!==window.location.hash)if("twitter.com"!==window.location.hostname||"#auth"!==window.location.hash)if("www.youtube.com"!==window.location.hostname||"#auth"!==window.location.hash){if("www.reddit.com"===window.location.hostname&&("#auth"===window.location.hash||"#auth"===GM_getValue("redditAuth"))){const r=$("#redesign-beta-optin-btn");return 0<r.length?(GM_setValue("redditAuth","#auth"),r[0].click()):(GM_setValue("redditAuth",null),window.close(),void p().fire("",z("closePageNotice")))}let t;for(const c of it)if(c.test()){t=new c;break}if(t){null!==(i=t)&&void 0!==i&&i.before&&await(null===(e=t)||void 0===e?void 0:e.before()),$("body").append(`<div id="auto-task-info" style="display:${N.other.defaultShowLog?"block":"none"};${N.position.logSideX}:${N.position.logDistance.split(",")[0]}px;${N.position.logSideY}:${N.position.logDistance.split(",")[1]}px;"></div><div id="auto-task-buttons" style="display:${N.other.defaultShowButton?"block":"none"};${N.position.buttonSideX}:${N.position.buttonDistance.split(",")[0]}px;${N.position.buttonSideY}:${N.position.buttonDistance.split(",")[1]}px;"></div><div class="show-button-div" style="display:${N.other.defaultShowButton?"none":"block"};${N.position.showButtonSideX}:${N.position.showButtonDistance.split(",")[0]}px;${N.position.showButtonSideY}:${N.position.showButtonDistance.split(",")[1]}px;"><a class="auto-task-website-btn" href="javascript:void(0);" target="_self" title="${z("showButton")}"></a></div>`),$("div.show-button-div").on("click",()=>{$("#auto-task-buttons").show(),$("div.show-button-div").hide()});var i=()=>{const t=$("#toggle-log");"show"===t.attr("data-status")?($("#auto-task-info").hide(),t.attr("data-status","hide").text(z("showLog"))):($("#auto-task-info").show(),t.attr("data-status","show").text(z("hideLog")))};if(ot().bind(N.hotKey.doTaskKey,()=>{t.doTask&&t.doTask()}),ot().bind(N.hotKey.undoTaskKey,()=>{t.undoTask&&t.doTask()}),ot().bind(N.hotKey.toggleLogKey,i),null!==(e=t)&&void 0!==e&&e.after&&await(null===(s=t)||void 0===s?void 0:s.after()),null!==(s=t)&&void 0!==s&&s.buttons&&0===$("#auto-task-buttons").children().length){$("#auto-task-buttons").addClass(t.name+"-buttons");for(const d of t.buttons)if(t[d]){const h=$(`<p><a class="auto-task-website-btn ${t.name}-button" href="javascript:void(0);" target="_self">${z(d)}</a></p>`);h.find("a.auto-task-website-btn").on("click",()=>{t[d]()}),$("#auto-task-buttons").append(h)}}const u=$(`<p><a class="auto-task-website-btn ${t.name}-button" href="javascript:void(0);" target="_self">
    ${z("hideButton")}</a></p>`);u.find("a.auto-task-website-btn").on("click",()=>{$("#auto-task-buttons").hide(),$("div.show-button-div").show()});const l=$(`<p><a id="toggle-log" class="auto-task-website-btn ${t.name}-button" href="javascript:void(0);" target="_self" data-status="${N.other.defaultShowLog?"show":"hide"}">
      ${N.other.defaultShowLog?z("hideLog"):z("showLog")}</a></p>`);l.find("a.auto-task-website-btn").on("click",i),$("#auto-task-buttons").append(u).append(l),null!==(i=t)&&void 0!==i&&i.options&&GM_registerMenuCommand(z("changeWebsiteOptions"),()=>{at(t.name,t.options)}),"Setting"!==t.name&&(GM_registerMenuCommand(z("changeGlobalOptions"),()=>{f("swal")}),GM_registerMenuCommand(z("settingPage"),()=>{window.open("https://auto-task-v4.hclonely.com/setting.html","_blank")})),console.log("%c%s","color:#1bbe1a","Auto-Task[Load]: 脚本加载完成"),GM_getValue("notice")||(p().fire({title:z("swalNotice"),icon:"warning"}).then(()=>{window.open(z("noticeLink"),"_blank"),GM_setValue("notice",(new Date).getTime())}),null!==(a=j({html:`<li><font class="warning">${z("echoNotice",z("noticeLink"))}</font></li>`}).font)&&void 0!==a&&a.find("a").on("click",()=>{GM_setValue("notice",(new Date).getTime())})),rt()}else console.log("%c%s","color:#ff0000","Auto-Task[Warning]: 脚本停止加载，当前网站不支持！")}else{var a=g.get("__Secure-3PAPISID");a?(GM_setValue("youtubeAuth",{PAPISID:a}),window.close(),p().fire("",z("closePageNotice"))):p().fire("",z("needLogin"))}else{var t=g.get("ct0");!!g.get("twid")&&t?(GM_setValue("twitterAuth",{ct0:t}),window.close(),p().fire("",z("closePageNotice"))):p().fire("",z("needLogin"))}else{var o,n,t=g.get("auth-token");!!g.get("login")?(GM_setValue("twitchAuth",{authToken:t,clientVersion:__twilightBuildID,clientId:null===(t=commonOptions)||void 0===t||null===(o=t.headers)||void 0===o?void 0:o["Client-ID"],deviceId:null===(o=commonOptions)||void 0===o||null===(n=o.headers)||void 0===n?void 0:n["Device-ID"],clientSessionId:window.localStorage.local_storage_app_session_id.replace(/"/g,"")}),window.close(),p().fire("",z("closePageNotice"))):p().fire("",z("needLogin"))}};if("discord.com"===window.location.hostname){const lt=window.localStorage;"#auth"===window.location.hash?(window.localStorage.removeItem=()=>!0,(ct=null===lt||void 0===lt||null===(ct=lt.getItem("token"))||void 0===ct?void 0:ct.replace(/^"|"$/g,""))&&0<ct.length?(GM_setValue("discordAuth",{auth:ct}),window.close(),p().fire("",z("closePageNotice"))):p().fire({text:z("getDiscordAuthFailed"),icon:"error"})):(ut=null===lt||void 0===lt||null===(ut=lt.getItem("token"))||void 0===ut?void 0:ut.replace(/^"|"$/g,""))&&0<ut.length&&GM_setValue("discordAuth",{auth:ut})}else"opquests.com"===window.location.hostname?e():("key-hub.eu"===window.location.hostname&&(unsafeWindow.keyhubtracker=1,unsafeWindow.gaData={}),$(e))}()}();